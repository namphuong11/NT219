<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Openssl Guides: Proposal for OSSL_PARAM futures</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Openssl Guides
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Proposal for OSSL_PARAM futures</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Format:</p>
<div class="fragment"><div class="line">{-</div>
<div class="line">use OpenSSL::paramnames qw(produce_param_handlers);</div>
<div class="line">-}</div>
<div class="line"> </div>
<div class="line">/*</div>
<div class="line"> * Machine generated parameter handling</div>
<div class="line"> * generated by util/perl/OpenSSL/paramnames.pm</div>
<div class="line"> */</div>
<div class="line">{-</div>
<div class="line">produce_param_handlers(</div>
<div class="line">    &#39;name&#39; =&gt; &#39;kdf_scrypt&#39;,</div>
<div class="line">    &#39;functions&#39; =&gt; &#39;both&#39;,   # getter or setter being the other options</div>
<div class="line">    &#39;prologue&#39; =&gt; &quot;KDF_SCRYPT *ctx = vctx;&quot;,</div>
<div class="line">    &quot;static&quot; =&gt; &quot;yes&quot;,      # &quot;yes&quot; to generate static functions (default) or</div>
<div class="line">                            # &quot;no&quot; to not</div>
<div class="line">    &#39;params&#39; =&gt; (</div>
<div class="line">        &#39;KDF_PARAM_PASSWORD&#39; =&gt; (</div>
<div class="line">            &#39;type&#39; =&gt; &#39;octet string&#39;,</div>
<div class="line">            &#39;access&#39; =&gt; &#39;writeonly&#39;,</div>
<div class="line">            &#39;setaction&#39; =&gt; qq(</div>
<div class="line">                if (!scrypt_set_membuf(&amp;ctx-&gt;pass, &amp;ctx-&gt;pass_len, p))</div>
<div class="line">                    return 0;</div>
<div class="line">            ),</div>
<div class="line">        ),</div>
<div class="line"> </div>
<div class="line">        &#39;KDF_PARAM_SALT&#39; =&gt; (</div>
<div class="line">            &#39;type&#39; =&gt; &#39;octet string&#39;,</div>
<div class="line">            &#39;access&#39; =&gt; &#39;readwrite&#39;,</div>
<div class="line">            &#39;setaction&#39; =&gt; qq(</div>
<div class="line">                if (!scrypt_set_membuf(&amp;ctx-&gt;salt, &amp;ctx-&gt;salt_len, p))</div>
<div class="line">                    return 0;</div>
<div class="line">            ),</div>
<div class="line">            &#39;getaction&#39; =&gt; qq(</div>
<div class="line">                p-&gt;return_size = ctx-&gt;salt_len;</div>
<div class="line">                if (p-&gt;data_size &gt;= ctx-&gt;salt_len)</div>
<div class="line">                    memcpy(p-&gt;data, ctx-&gt;salt, p-&gt;data_size &gt;= ctx-&gt;salt_len);</div>
<div class="line">            ),</div>
<div class="line">        ),</div>
<div class="line"> </div>
<div class="line">        &#39;KDF_PARAM_SCRYPT_N&#39; =&gt; (</div>
<div class="line">            &#39;type&#39; =&gt; &#39;integer&#39;,</div>
<div class="line">            &#39;ctype&#39; =&gt; &#39;uint64_t&#39;,</div>
<div class="line">            &#39;access&#39; =&gt; &#39;readwrite&#39;,</div>
<div class="line">            &#39;field&#39; =&gt; &quot;ctx-&gt;N&quot;,</div>
<div class="line">            &#39;sanitycheck&#39; =&gt; &quot;value &gt; 1 &amp;&amp; is_power_of_two(value)&quot;</div>
<div class="line">        ),</div>
<div class="line"> </div>
<div class="line">        &#39;KDF_PARAM_SCRYPT_R&#39; =&gt; (</div>
<div class="line">            &#39;type&#39; =&gt; &#39;integer&#39;,</div>
<div class="line">            &#39;ctype&#39; =&gt; &#39;uint64_t&#39;,</div>
<div class="line">            &#39;access&#39; =&gt; &#39;readwrite&#39;,</div>
<div class="line">            &#39;field&#39; =&gt; &quot;ctx-&gt;r&quot;,</div>
<div class="line">            &#39;sanitycheck&#39; =&gt; &quot;value &gt;= 1&quot;,</div>
<div class="line">        ),</div>
<div class="line"> </div>
<div class="line">        &#39;KDF_PARAM_SCRYPT_P&#39; =&gt; (</div>
<div class="line">            &#39;type&#39; =&gt; &#39;integer&#39;,</div>
<div class="line">            &#39;ctype&#39; =&gt; &#39;uint64_t&#39;,</div>
<div class="line">            &#39;access&#39; =&gt; &#39;readwrite&#39;,</div>
<div class="line">            &#39;field&#39; =&gt; &quot;ctx-&gt;p&quot;,</div>
<div class="line">            &#39;sanitycheck&#39; =&gt; &quot;value &gt;= 1&quot;,</div>
<div class="line">        ),</div>
<div class="line"> </div>
<div class="line">        &#39;KDF_PARAM_SCRYPT_MAXMEM&#39; =&gt; (</div>
<div class="line">            &#39;type&#39; =&gt; &#39;integer&#39;,</div>
<div class="line">            &#39;ctype&#39; =&gt; &#39;uint64_t&#39;,</div>
<div class="line">            &#39;access&#39; =&gt; &#39;readwrite&#39;,</div>
<div class="line">            &#39;field&#39; =&gt; &quot;ctx-&gt;maxmem_bytes&quot;,</div>
<div class="line">            &#39;sanitycheck&#39; =&gt; &quot;value &gt;= 1&quot;,</div>
<div class="line">        ),</div>
<div class="line"> </div>
<div class="line">        &#39;KDF_PARAM_PROPERTIES&#39; =&gt; (</div>
<div class="line">            &#39;type&#39; =&gt; &#39;utf8_string&#39;,</div>
<div class="line">            &#39;access&#39; =&gt; &#39;readwrite&#39;,</div>
<div class="line">            &#39;setaction&#39; =&gt; qq(</div>
<div class="line">                if (!set_property_query(ctx, p-&gt;data) || !set_digest(ctx))</div>
<div class="line">                    return 0;</div>
<div class="line">            ),</div>
<div class="line">        ),</div>
<div class="line"> </div>
<div class="line">        &#39;KDF_PARAM_SIZE&#39; =&gt; (</div>
<div class="line">            &#39;type&#39; =&gt; &#39;integer&#39;,</div>
<div class="line">            &#39;ctype&#39; =&gt; &#39;size_t&#39;,</div>
<div class="line">            &#39;access&#39; =&gt; &#39;readonly&#39;,</div>
<div class="line">            &#39;field&#39; =&gt; &quot;SIZE_MAX&quot;,</div>
<div class="line">        ),</div>
<div class="line">    );</div>
<div class="line">);</div>
<div class="line">-}</div>
<div class="line">/* End of generated code */</div>
</div><!-- fragment --><p>THe top level attributes are:</p>
<ul>
<li>"name" is the name the functions will derive from e.g. "kdf_scrypt" to this will be appended _[gs]et[_ctx]_params</li>
<li>"functions" is the functions to generate. By default both setters and getters but either can be omitted.</li>
<li>"prologue" defines some introductory code emitted in the generated functions. Function arguments are: <code>void *vctx, OSSL_PARAM params[]</code> and this can be used to specialise the void pointer or declare locals.</li>
<li>"epilogue" defines some post decode code emitted in the generated function</li>
<li>"params" defines the parameters both gettable and settable</li>
</ul>
<p>Within the "params" the fields specify each parameter by label.</p>
<p>Each parameter is then specialised with attributes:</p>
<ul>
<li>"type" is the OSSL_PARAM type</li>
<li>"ctype" is the underlying C type (e.g. for an integer parameter size_t could be the C type)</li>
<li>"access" is readwrite, readonly or writeonly. This determines if the parameter is a settable, gettable or both</li>
<li>"field" is an accessor to the field itself</li>
<li>"sanitycheck" is a validation check for the parameter. If present, code will be generated <code>if (!(sanitycheck)) return 0;</code> The local variable <code>var</code> will contain the C value if specified.</li>
<li>"setaction" is C code to execute when the parameter is being set. It will define an OSSL_PARAM pointer p to set.</li>
<li>"code" set to "no" skips code generation for this parameter, it defaults to "yes" which generates handlers. This is useful when a parameter is duplicated with differenting types (e.g. utf8 string and integer).</li>
<li>"published" set to "yes" includes the parameter in the gettable/settable lists. Set to "no" and it isn't included (but will still be processed). It defaults to "yes".</li>
<li>Flags include:<ul>
<li>nostatic: do not make the function static</li>
<li>nocode: do not generate code for this parameter<ul>
<li>This allows, e.g., two different types for a parameter (int &amp; string)</li>
</ul>
</li>
<li>unpublished: do not generate this parameter in the gettable/settable list<ul>
<li>"engine" is the only one like this</li>
</ul>
</li>
<li>readonly: create a getter but not a setter</li>
<li>writeonly: create a setting but not a getter</li>
</ul>
</li>
</ul>
<p>The idea is that the gettable and get functions will be simultaneously generated along with fast decoder to look up parameter names quickly.</p>
<p>The getter and setter functions will be pre-populated with some local variable:</p>
<div class="fragment"><div class="line">OSSL_PARAM *p; <span class="comment">/* The matching parameter */</span></div>
<div class="line">type val;      <span class="comment">/* The value of the parameter after a get/set call */</span></div>
<div class="line">               <span class="comment">/* (for C types) */</span></div>
</div><!-- fragment --><p>A worked example for scrypt:</p>
<p>Would generate something along the lines of:</p>
<div class="fragment"><div class="line"><span class="keyword">enum</span> kdf_scrypt_ctx_param_e {</div>
<div class="line">    kdf_scrypt_ctx_param_INVALID,</div>
<div class="line">    kdf_scrypt_ctx_param_OSSL_KDF_PARAM_PASSWORD,</div>
<div class="line">    kdf_scrypt_ctx_param_OSSL_KDF_PARAM_PROPERTIES,</div>
<div class="line">    kdf_scrypt_ctx_param_OSSL_KDF_PARAM_SALT,</div>
<div class="line">    kdf_scrypt_ctx_param_OSSL_KDF_PARAM_SCRYPT_MAXMEM,</div>
<div class="line">    kdf_scrypt_ctx_param_OSSL_KDF_PARAM_SCRYPT_N,</div>
<div class="line">    kdf_scrypt_ctx_param_OSSL_KDF_PARAM_SCRYPT_P,</div>
<div class="line">    kdf_scrypt_ctx_param_OSSL_KDF_PARAM_SCRYPT_R,</div>
<div class="line">    kdf_scrypt_ctx_param_OSSL_KDF_PARAM_SIZE</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">enum</span> kdf_scrypt_ctx_param_e kdf_scrypt_ctx_lookup(<span class="keyword">const</span> OSSL_PARAM *p) {</div>
<div class="line">    <span class="comment">/* magic decoder */</span></div>
<div class="line">    <span class="keywordflow">return</span> kdf_scrypt_ctx_param_INVALID;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> kdf_scrypt_set_ctx_params(<span class="keywordtype">void</span> *vctx, <span class="keyword">const</span> OSSL_PARAM params[])</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> OSSL_PARAM *p;</div>
<div class="line">    <a class="code hl_struct" href="struct_k_d_f___s_c_r_y_p_t.html">KDF_SCRYPT</a> *ctx = vctx;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (params == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (p = params; p-&gt;key != NULL; p++) {</div>
<div class="line">        <span class="keywordflow">switch</span> (kdf_scrypt_ctx_lookup(p)) {</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> kdf_scrypt_ctx_param_OSSL_KDF_PARAM_PASSWORD:</div>
<div class="line">            <span class="keywordflow">if</span> (!scrypt_set_membuf(&amp;ctx-&gt;pass, &amp;ctx-&gt;pass_len, p))</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> kdf_scrypt_ctx_param_OSSL_KDF_PARAM_SALT:</div>
<div class="line">            <span class="keywordflow">if</span> (!scrypt_set_membuf(&amp;ctx-&gt;salt, &amp;ctx-&gt;salt_len, p))</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> kdf_scrypt_ctx_param_OSSL_KDF_PARAM_SCRYPT_N: {</div>
<div class="line">            uint64_t value;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (!OSSL_PARAM_get_uint64(p, &amp;value) {</div>
<div class="line">                <span class="keywordflow">if</span> (!(value &gt; 1 &amp;&amp; is_power_of_two(u64_value)))</div>
<div class="line">                    <span class="keywordflow">return</span> 0;</div>
<div class="line">                ctx-&gt;N = value;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> kdf_scrypt_ctx_param_OSSL_KDF_PARAM_SCRYPT_R: {</div>
<div class="line">            uint64_t value;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (!OSSL_PARAM_get_uint64(p, &amp;value) {</div>
<div class="line">                <span class="keywordflow">if</span> (!(value &gt;= 1))</div>
<div class="line">                    <span class="keywordflow">return</span> 0;</div>
<div class="line">                ctx-&gt;r = value;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> kdf_scrypt_ctx_param_OSSL_KDF_PARAM_SCRYPT_P: {</div>
<div class="line">            uint64_t value;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (!OSSL_PARAM_get_uint64(p, &amp;value) {</div>
<div class="line">                <span class="keywordflow">if</span> (!(value &gt;= 1))</div>
<div class="line">                    <span class="keywordflow">return</span> 0;</div>
<div class="line">                ctx-&gt;p = value;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> kdf_scrypt_ctx_param_OSSL_KDF_PARAM_SCRYPT_MAXMEM: {</div>
<div class="line">            uint64_t value;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (!OSSL_PARAM_get_uint64(p, &amp;value) {</div>
<div class="line">                <span class="keywordflow">if</span> (!(value &gt;= 1))</div>
<div class="line">                    <span class="keywordflow">return</span> 0;</div>
<div class="line">                ctx-&gt;p = value;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> kdf_scrypt_ctx_param_OSSL_KDF_PARAM_PROPERTIES:</div>
<div class="line">            <span class="keywordflow">if</span> (p != NULL) {</div>
<div class="line">                <span class="keywordflow">if</span> (p-&gt;data_type != OSSL_PARAM_UTF8_STRING) {</div>
<div class="line">                    if (!set_property_query(ctx, p-&gt;data) || !set_digest(ctx))</div>
<div class="line">                        return 0;</div>
<div class="line">                    }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> OSSL_PARAM *kdf_scrypt_settable_ctx_params(ossl_unused <span class="keywordtype">void</span> *ctx,</div>
<div class="line">                                                        ossl_unused <span class="keywordtype">void</span> *p_ctx)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> OSSL_PARAM known_settable_ctx_params[] = {</div>
<div class="line">        OSSL_PARAM_octet_string(OSSL_KDF_PARAM_PASSWORD, NULL, 0),</div>
<div class="line">        OSSL_PARAM_octet_string(OSSL_KDF_PARAM_SALT, NULL, 0),</div>
<div class="line">        OSSL_PARAM_uint64(OSSL_KDF_PARAM_SCRYPT_N, NULL),</div>
<div class="line">        OSSL_PARAM_uint32(OSSL_KDF_PARAM_SCRYPT_R, NULL),</div>
<div class="line">        OSSL_PARAM_uint32(OSSL_KDF_PARAM_SCRYPT_P, NULL),</div>
<div class="line">        OSSL_PARAM_uint64(OSSL_KDF_PARAM_SCRYPT_MAXMEM, NULL),</div>
<div class="line">        OSSL_PARAM_utf8_string(OSSL_KDF_PARAM_PROPERTIES, NULL, 0),</div>
<div class="line">        OSSL_PARAM_END</div>
<div class="line">    };</div>
<div class="line">    <span class="keywordflow">return</span> known_settable_ctx_params;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> kdf_scrypt_get_ctx_params(<span class="keywordtype">void</span> *vctx, OSSL_PARAM params[])</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> OSSL_PARAM *p;</div>
<div class="line">    <a class="code hl_struct" href="struct_k_d_f___s_c_r_y_p_t.html">KDF_SCRYPT</a> *ctx = vctx;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (params == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (p = params; p-&gt;key != NULL; p++) {</div>
<div class="line">        <span class="keywordflow">switch</span> (kdf_scrypt_ctx_lookup(p)) {</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> kdf_scrypt_ctx_param_OSSL_KDF_PARAM_PASSWORD:</div>
<div class="line">            <span class="keywordflow">if</span> (!scrypt_set_membuf(&amp;ctx-&gt;pass, &amp;ctx-&gt;pass_len, p))</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> kdf_scrypt_ctx_param_OSSL_KDF_PARAM_SALT:</div>
<div class="line">            p-&gt;return_size = ctx-&gt;salt_len;</div>
<div class="line">            <span class="keywordflow">if</span> (p-&gt;data_size &gt;= ctx-&gt;salt_len)</div>
<div class="line">                memcpy(p-&gt;data, ctx-&gt;salt, ctx-&gt;salt_len);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> kdf_scrypt_ctx_param_OSSL_KDF_PARAM_SCRYPT_N: {</div>
<div class="line">            <span class="keywordflow">if</span> (!OSSL_PARAM_set_uint64(p, &amp;ctx-&gt;N)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> kdf_scrypt_ctx_param_OSSL_KDF_PARAM_SCRYPT_R: {</div>
<div class="line">            <span class="keywordflow">if</span> (!OSSL_PARAM_set_uint64(p, &amp;ctx-&gt;r)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> kdf_scrypt_ctx_param_OSSL_KDF_PARAM_SCRYPT_P: {</div>
<div class="line">            <span class="keywordflow">if</span> (!OSSL_PARAM_set_uint64(p, &amp;ctx-&gt;p)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> kdf_scrypt_ctx_param_OSSL_KDF_PARAM_SCRYPT_MAXMEM: {</div>
<div class="line">            <span class="keywordflow">if</span> (!OSSL_PARAM_set_uint64(p, &amp;ctx-&gt;maxmem)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> kdf_scrypt_ctx_param_OSSL_KDF_PARAM_PROPERTIES:</div>
<div class="line">            <span class="keywordflow">if</span> (p-&gt;data_type != OSSL_PARAM_UTF8_STRING) {</div>
<div class="line">                <span class="keywordflow">if</span> (!set_property_query(ctx, p-&gt;data) || !set_digest(ctx))</div>
<div class="line">                    <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> kdf_scrypt_ctx_param_KDF_PARAM_SIZE:</div>
<div class="line">            <span class="keywordflow">if</span> (!OSSL_PARAM_set_size_t(p, SIZE_MAX))</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> OSSL_PARAM *kdf_scrypt_gettable_ctx_params(ossl_unused <span class="keywordtype">void</span> *ctx,</div>
<div class="line">                                                        ossl_unused <span class="keywordtype">void</span> *p_ctx)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> OSSL_PARAM known_gettable_ctx_params[] = {</div>
<div class="line">        OSSL_PARAM_size_t(OSSL_KDF_PARAM_SIZE, NULL),</div>
<div class="line">        OSSL_PARAM_END</div>
<div class="line">    };</div>
<div class="line">    <span class="keywordflow">return</span> known_gettable_ctx_params;</div>
<div class="line">}</div>
<div class="ttc" id="astruct_k_d_f___s_c_r_y_p_t_html"><div class="ttname"><a href="struct_k_d_f___s_c_r_y_p_t.html">KDF_SCRYPT</a></div><div class="ttdef"><b>Definition</b> scrypt.c:43</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
