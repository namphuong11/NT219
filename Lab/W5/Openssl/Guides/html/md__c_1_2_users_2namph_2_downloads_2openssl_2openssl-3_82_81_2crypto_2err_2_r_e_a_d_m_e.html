<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Openssl Guides: Adding new libraries</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Openssl Guides
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Adding new libraries</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>When adding a new sub-library to OpenSSL, assign it a library number <code>ERR_LIB_XXX</code>, define a macro <code>XXXerr()</code> (both in <code>err.h</code>), add its name to <code>ERR_str_libraries[]</code> (in <code>crypto/err/err.c</code>), and add <code>ERR_load_XXX_strings()</code> to the <code>ERR_load_crypto_strings()</code> function (in <code>crypto/err/err_all.c</code>). Finally, add an entry: </p><pre class="fragment">L      XXX     xxx.h   xxx_err.c
</pre><p> to <code>crypto/err/openssl.ec</code>, and add <code>xxx_err.c</code> to the <code>Makefile</code>. Running make errors will then generate a file <code>xxx_err.c</code>, and add all error codes used in the library to <code>xxx.h</code>.</p>
<p>Additionally the library include file must have a certain form. Typically it will initially look like this: </p><pre class="fragment">#ifndef HEADER_XXX_H
#define HEADER_XXX_H

#ifdef __cplusplus
extern "C" {
#endif

/* Include files */

#include &lt;openssl/bio.h&gt;
#include &lt;openssl/x509.h&gt;

/* Macros, structures and function prototypes */


/* BEGIN ERROR CODES */
</pre><p> The <code>BEGIN ERROR CODES</code> sequence is used by the error code generation script as the point to place new error codes, any text after this point will be overwritten when make errors is run. The closing <code>#endif</code> etc will be automatically added by the script.</p>
<p>The generated C error code file <code>xxx_err.c</code> will load the header files <code>stdio.h</code>, <code><a class="el" href="openssl_2err_8h_source.html">openssl/err.h</a></code> and <code>openssl/xxx.h</code> so the header file must load any additional header files containing any definitions it uses.</p>
<h1><a class="anchor" id="autotoc_md181"></a>
Adding new error codes</h1>
<p>Instead of manually adding error codes into <code>crypto/err/openssl.txt</code>, it is recommended to leverage <code>make update</code> for error code generation. The target will process relevant sources and generate error codes for any <em>used</em> error codes.</p>
<p>If an error code is added manually into <code>crypto/err/openssl.txt</code>, subsequent <code>make update</code> has no effect. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
