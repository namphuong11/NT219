<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Openssl Guides: Demo-Driven Design</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Openssl Guides
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Demo-Driven Design</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The OpenSSL project from time to time must evolve its public API surface in order to support new functionality and deprecate old functionality. When this occurs, the changes to OpenSSL's public API must be planned, discussed and agreed. One significant dimension which must be considered when considering any proposed API change is how a broad spectrum of real-world OpenSSL applications uses the APIs which exist today, as this determines the ways in which those applications will be affected by any proposed changes, the extent to which they will be affected, and the extent of any changes which will need to be made by codebases using OpenSSL to remain current with best practices for OpenSSL API usage.</p>
<p>As such, it is useful for the OpenSSL project to have a good understanding of the usage patterns common in codebases which use OpenSSL, so that it can anticipate the impact of any evolution of its API on those codebases. This directory seeks to maintain a set of <b>API usage demos</b> which demonstrate a full spectrum of ways in which real-world applications use the OpenSSL APIs. This allows the project to discuss any proposed API changes in terms of the changes that would need to be made to each demo. Since the demos are representative of a broad spectrum of real-world OpenSSL-based applications, this ensures that API evolution is made both with reference to real-world API usage patterns and with reference to the impact on existing applications.</p>
<p>As such, these demos are maintained in the OpenSSL repository because they are useful both to current and any future proposed API changes. The set of demos may be expanded over time, and the demos in this directory at any one time constitute a present body of understanding of API usage patterns, which can be used to plan API changes.</p>
<p>For further background information on the premise of this approach, see <a href="https://github.com/openssl/openssl/issues/17939">API long-term evolution</a>.</p>
<h1><a class="anchor" id="autotoc_md188"></a>
Scope</h1>
<p>The current emphasis is on client demos. Server support for QUIC is deferred to subsequent OpenSSL releases, and therefore is (currently) out of scope for this design exercise.</p>
<p>The demos also deliberately focus on aspects of libssl usage which are likely to be relevant to QUIC and require changes; for example, how varied applications have libssl perform network I/O, and how varied applications create sockets and connections for use with libssl. The libssl API as a whole has a much larger scope and includes numerous functions and features; the intention is not to demonstrate all of these, because most of them will not be touched by QUIC. For example, while many users of OpenSSL may make use of APIs for client certificates or other TLS functionality, the use of QUIC is unlikely to have implications for these APIs and demos demonstrating such functionality are therefore out of scope.</p>
<p><a class="el" href="md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2doc_2designs_2ddd_2_r_e_p_o_r_t.html">A report is available</a> on the results of the DDD process following the completion of the development of the QUIC MVP (minimum viable product).</p>
<h1><a class="anchor" id="autotoc_md189"></a>
Background</h1>
<p>These demos were developed after analysis of the following open source applications to determine libssl API usage patterns. The commonly occurring usage patterns were determined and used to determine categories into which to classify the applications:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone">Blk?   </th><th class="markdownTableHeadNone">FD    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">mutt   </td><td class="markdownTableBodyNone">S   </td><td class="markdownTableBodyNone">AOSF    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">vsftpd   </td><td class="markdownTableBodyNone">S   </td><td class="markdownTableBodyNone">AOSF    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">exim   </td><td class="markdownTableBodyNone">S   </td><td class="markdownTableBodyNone">AOSFx    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">wget   </td><td class="markdownTableBodyNone">S   </td><td class="markdownTableBodyNone">AOSF    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Fossil   </td><td class="markdownTableBodyNone">S   </td><td class="markdownTableBodyNone">BIOc    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">librabbitmq   </td><td class="markdownTableBodyNone">A   </td><td class="markdownTableBodyNone">BIOx    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ngircd   </td><td class="markdownTableBodyNone">A   </td><td class="markdownTableBodyNone">AOSF    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">stunnel   </td><td class="markdownTableBodyNone">A   </td><td class="markdownTableBodyNone">AOSFx    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Postfix   </td><td class="markdownTableBodyNone">A   </td><td class="markdownTableBodyNone">AOSF    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">socat   </td><td class="markdownTableBodyNone">A   </td><td class="markdownTableBodyNone">AOSF    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">HAProxy   </td><td class="markdownTableBodyNone">A   </td><td class="markdownTableBodyNone">BIOx    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Dovecot   </td><td class="markdownTableBodyNone">A   </td><td class="markdownTableBodyNone">BIOm    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Apache httpd   </td><td class="markdownTableBodyNone">A   </td><td class="markdownTableBodyNone">BIOx    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">UnrealIRCd   </td><td class="markdownTableBodyNone">A   </td><td class="markdownTableBodyNone">AOSF    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">wpa_supplicant   </td><td class="markdownTableBodyNone">A   </td><td class="markdownTableBodyNone">BIOm    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">icecast   </td><td class="markdownTableBodyNone">A   </td><td class="markdownTableBodyNone">AOSF    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">nginx   </td><td class="markdownTableBodyNone">A   </td><td class="markdownTableBodyNone">AOSF    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">curl   </td><td class="markdownTableBodyNone">A   </td><td class="markdownTableBodyNone">AOSF    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Asterisk   </td><td class="markdownTableBodyNone">A   </td><td class="markdownTableBodyNone">AOSF    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Asterisk (DTLS)   </td><td class="markdownTableBodyNone">A   </td><td class="markdownTableBodyNone">BIOm/x    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">pgbouncer   </td><td class="markdownTableBodyNone">A   </td><td class="markdownTableBodyNone">AOSF, BIOc   </td></tr>
</table>
<ul>
<li>Blk: Whether the application uses blocking or non-blocking I/O.<ul>
<li>S: Blocking (Synchronous)</li>
<li>A: Nonblocking (Asynchronous)</li>
</ul>
</li>
<li>FD: Whether the application creates and owns its own FD.<ul>
<li>AOSF: Application owns, calls SSL_set_fd.</li>
<li>AOSFx: Application owns, calls SSL_set_[rw]fd, different FDs for read/write.</li>
<li>BIOs: Application creates a socket/FD BIO and calls SSL_set_bio. Application created the connection.</li>
<li>BIOx: Application creates a BIO with a custom BIO method and calls SSL_set_bio.</li>
<li>BIOm: Application creates a memory BIO and does its own pumping to/from actual socket, treating libssl as a pure state machine which does no I/O itself.</li>
<li>BIOc: Application uses BIO_s_connect-based methods such as BIO_new_ssl_connect and leaves connection establishment to OpenSSL.</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md190"></a>
Demos</h1>
<p>The demos found in this directory are:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="ddd-01-conn-blocking.c">ddd-01-conn-blocking</a>   </td><td class="markdownTableBodyNone">S-BIOc   </td><td class="markdownTableBodyNone">A <code>BIO_s_connect</code>-based blocking example demonstrating exemplary OpenSSL API usage    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="ddd-02-conn-nonblocking.c">ddd-02-conn-nonblocking</a>   </td><td class="markdownTableBodyNone">A-BIOc   </td><td class="markdownTableBodyNone">A <code>BIO_s_connect</code>-based nonblocking example demonstrating exemplary OpenSSL API usage, with use of a buffering BIO    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="ddd-03-fd-blocking.c">ddd-03-fd-blocking</a>   </td><td class="markdownTableBodyNone">S-AOSF   </td><td class="markdownTableBodyNone">A <code>SSL_set_fd</code>-based blocking example demonstrating real-world OpenSSL API usage (corresponding to S-AOSF applications above)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="ddd-04-fd-nonblocking.c">ddd-04-fd-nonblocking</a>   </td><td class="markdownTableBodyNone">A-AOSF   </td><td class="markdownTableBodyNone">A <code>SSL_set_fd</code>-based non-blocking example demonstrating real-world OpenSSL API usage (corresponding to A-AOSF applications above)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="ddd-05-mem-nonblocking.c">ddd-05-mem-nonblocking</a>   </td><td class="markdownTableBodyNone">A-BIOm   </td><td class="markdownTableBodyNone">A non-blocking example based on use of a memory buffer to feed OpenSSL encrypted data (corresponding to A-BIOm applications above)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="ddd-06-mem-uv.c">ddd-06-mem-uv</a>   </td><td class="markdownTableBodyNone">A-BIOm   </td><td class="markdownTableBodyNone">A non-blocking example based on use of a memory buffer to feed OpenSSL encrypted data; uses libuv, a real-world async I/O library   </td></tr>
</table>
<p>On Ubuntu, libuv can be obtained by installing the package "libuv1-dev".</p>
<p>Availability of a default certificate store is assumed. <code>SSL_CERT_DIR</code> may be set when running the demos if necessary. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
