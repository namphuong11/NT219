\doxysection{cipher\+\_\+aes\+\_\+cbc\+\_\+hmac\+\_\+sha.\+h}
\hypertarget{cipher__aes__cbc__hmac__sha_8h_source}{}\label{cipher__aes__cbc__hmac__sha_8h_source}\index{C:/Users/namph/Downloads/openssl/openssl-\/3.2.1/providers/implementations/ciphers/cipher\_aes\_cbc\_hmac\_sha.h@{C:/Users/namph/Downloads/openssl/openssl-\/3.2.1/providers/implementations/ciphers/cipher\_aes\_cbc\_hmac\_sha.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ *\ Copyright\ 2019-\/2020\ The\ OpenSSL\ Project\ Authors.\ All\ Rights\ Reserved.}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *\ Licensed\ under\ the\ Apache\ License\ 2.0\ (the\ "{}License"{}).\ \ You\ may\ not\ use}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ *\ this\ file\ except\ in\ compliance\ with\ the\ License.\ \ You\ can\ obtain\ a\ copy}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ *\ in\ the\ file\ LICENSE\ in\ the\ source\ distribution\ or\ at}}
\DoxyCodeLine{00007\ \textcolor{comment}{\ *\ https://www.openssl.org/source/license.html}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}prov/ciphercommon.h"{}}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ "{}crypto/aes\_platform.h"{}}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{keywordtype}{int}\ ossl\_cipher\_capable\_aes\_cbc\_hmac\_sha1(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00014\ \textcolor{keywordtype}{int}\ ossl\_cipher\_capable\_aes\_cbc\_hmac\_sha256(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structprov__cipher__hw__aes__hmac__sha__ctx__st}{prov\_cipher\_hw\_aes\_hmac\_sha\_ctx\_st}}\ \{}
\DoxyCodeLine{00017\ \ \ \ \ \mbox{\hyperlink{structprov__cipher__hw__st}{PROV\_CIPHER\_HW}}\ base;\ \textcolor{comment}{/*\ must\ be\ first\ */}}
\DoxyCodeLine{00018\ \ \ \ \ void\ (*init\_mac\_key)(\textcolor{keywordtype}{void}\ *ctx,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *inkey,\ \textcolor{keywordtype}{size\_t}\ inlen);}
\DoxyCodeLine{00019\ \ \ \ \ int\ (*set\_tls1\_aad)(\textcolor{keywordtype}{void}\ *ctx,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *aad\_rec,\ \textcolor{keywordtype}{int}\ aad\_len);}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#\ if\ !defined(OPENSSL\_NO\_MULTIBLOCK)}}
\DoxyCodeLine{00021\ \ \ \ \ int\ (*tls1\_multiblock\_max\_bufsize)(\textcolor{keywordtype}{void}\ *ctx);}
\DoxyCodeLine{00022\ \ \ \ \ int\ (*tls1\_multiblock\_aad)(}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *vctx,\ EVP\_CTRL\_TLS1\_1\_MULTIBLOCK\_PARAM\ *param);}
\DoxyCodeLine{00024\ \ \ \ \ int\ (*tls1\_multiblock\_encrypt)(}
\DoxyCodeLine{00025\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *ctx,\ EVP\_CTRL\_TLS1\_1\_MULTIBLOCK\_PARAM\ *param);}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#\ endif\ }\textcolor{comment}{/*\ OPENSSL\_NO\_MULTIBLOCK)\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{00027\ \}\ \mbox{\hyperlink{structprov__cipher__hw__aes__hmac__sha__ctx__st}{PROV\_CIPHER\_HW\_AES\_HMAC\_SHA}};}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structprov__cipher__hw__aes__hmac__sha__ctx__st}{PROV\_CIPHER\_HW\_AES\_HMAC\_SHA}}\ *ossl\_prov\_cipher\_hw\_aes\_cbc\_hmac\_sha1(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00030\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structprov__cipher__hw__aes__hmac__sha__ctx__st}{PROV\_CIPHER\_HW\_AES\_HMAC\_SHA}}\ *ossl\_prov\_cipher\_hw\_aes\_cbc\_hmac\_sha256(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#ifdef\ AES\_CBC\_HMAC\_SHA\_CAPABLE}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#\ include\ <openssl/aes.h>}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#\ include\ <openssl/sha.h>}}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }prov\_aes\_hmac\_sha\_ctx\_st\ \{}
\DoxyCodeLine{00037\ \ \ \ \ \mbox{\hyperlink{structprov__cipher__ctx__st}{PROV\_CIPHER\_CTX}}\ base;}
\DoxyCodeLine{00038\ \ \ \ \ AES\_KEY\ ks;}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ payload\_length;\ \ \ \ \ \ \textcolor{comment}{/*\ AAD\ length\ in\ decrypt\ case\ */}}
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ tls\_ver;}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tls\_aad[16];\ \textcolor{comment}{/*\ 13\ used\ */}}
\DoxyCodeLine{00043\ \ \ \ \ \}\ aux;}
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structprov__cipher__hw__aes__hmac__sha__ctx__st}{PROV\_CIPHER\_HW\_AES\_HMAC\_SHA}}\ *hw;}
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{comment}{/*\ some\ value\ that\ are\ setup\ by\ set\ methods\ -\/\ that\ can\ be\ retrieved\ */}}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ multiblock\_interleave;}
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ multiblock\_aad\_packlen;}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ multiblock\_max\_send\_fragment;}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ multiblock\_encrypt\_len;}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ tls\_aad\_pad;}
\DoxyCodeLine{00051\ \}\ PROV\_AES\_HMAC\_SHA\_CTX;}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }prov\_aes\_hmac\_sha1\_ctx\_st\ \{}
\DoxyCodeLine{00054\ \ \ \ \ PROV\_AES\_HMAC\_SHA\_CTX\ base\_ctx;}
\DoxyCodeLine{00055\ \ \ \ \ SHA\_CTX\ head,\ tail,\ md;}
\DoxyCodeLine{00056\ \}\ PROV\_AES\_HMAC\_SHA1\_CTX;}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }prov\_aes\_hmac\_sha256\_ctx\_st\ \{}
\DoxyCodeLine{00059\ \ \ \ \ PROV\_AES\_HMAC\_SHA\_CTX\ base\_ctx;}
\DoxyCodeLine{00060\ \ \ \ \ SHA256\_CTX\ head,\ tail,\ md;}
\DoxyCodeLine{00061\ \}\ PROV\_AES\_HMAC\_SHA256\_CTX;}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \textcolor{preprocessor}{\#\ define\ NO\_PAYLOAD\_LENGTH\ ((size\_t)-\/1)}}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ AES\_CBC\_HMAC\_SHA\_CAPABLE\ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
