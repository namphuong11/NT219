\chapter{Open\+SSL CHANGES}
\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s}{}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s}\index{OpenSSL CHANGES@{OpenSSL CHANGES}}
This is a detailed breakdown of significant changes. For a high-\/level overview of changes in each release, see \doxysectlink{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_n_e_w_s}{NEWS.md}{0}.

For a full list of changes, see the \href{https://github.com/openssl/openssl/commits/}{\texttt{ git commit log}} and pick the appropriate release branch.\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md2}{}\doxysection{\texorpdfstring{Open\+SSL Releases}{Open\+SSL Releases}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md2}

\begin{DoxyItemize}
\item Open\+SSL 3.2
\item Open\+SSL 3.1
\item Open\+SSL 3.0
\item Open\+SSL 1.1.1
\item Open\+SSL 1.1.0
\item Open\+SSL 1.0.2
\item Open\+SSL 1.0.1
\item Open\+SSL 1.0.0
\item Open\+SSL 0.9.x
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md3}{}\doxysection{\texorpdfstring{Open\+SSL 3.\+2}{Open\+SSL 3.\+2}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md3}
\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md4}{}\doxysubsection{\texorpdfstring{Changes between 3.\+2.\+0 and 3.\+2.\+1 \mbox{[}30 Jan 2024\mbox{]}}{Changes between 3.\+2.\+0 and 3.\+2.\+1 \mbox{[}30 Jan 2024\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md4}

\begin{DoxyItemize}
\item A file in PKCS12 format can contain certificates and keys and may come from an untrusted source. The PKCS12 specification allows certain fields to be NULL, but Open\+SSL did not correctly check for this case. A fix has been applied to prevent a NULL pointer dereference that results in Open\+SSL crashing. If an application processes PKCS12 files from an untrusted source using the Open\+SSL APIs then that application will be vulnerable to this issue prior to this fix.

Open\+SSL APIs that were vulnerable to this are\+: PKCS12\+\_\+parse(), PKCS12\+\_\+unpack\+\_\+p7data(), PKCS12\+\_\+unpack\+\_\+p7encdata(), PKCS12\+\_\+unpack\+\_\+authsafes() and PKCS12\+\_\+newpass().

We have also fixed a similar issue in SMIME\+\_\+write\+\_\+\+PKCS7(). However since this function is related to writing data we do not consider it security significant.

(\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2024-0727}{\texttt{ CVE-\/2024-\/0727}})

{\itshape Matt Caswell}
\item When function EVP\+\_\+\+PKEY\+\_\+public\+\_\+check() is called on RSA public keys, a computation is done to confirm that the RSA modulus, n, is composite. For valid RSA keys, n is a product of two or more large primes and this computation completes quickly. However, if n is an overly large prime, then this computation would take a long time.

An application that calls EVP\+\_\+\+PKEY\+\_\+public\+\_\+check() and supplies an RSA key obtained from an untrusted source could be vulnerable to a Denial of Service attack.

The function EVP\+\_\+\+PKEY\+\_\+public\+\_\+check() is not called from other Open\+SSL functions however it is called from the Open\+SSL pkey command line application. For that reason that application is also vulnerable if used with the "{}-\/pubin"{} and "{}-\/check"{} options on untrusted data.

To resolve this issue RSA keys larger than OPENSSL\+\_\+\+RSA\+\_\+\+MAX\+\_\+\+MODULUS\+\_\+\+BITS will now fail the check immediately with an RSA\+\_\+\+R\+\_\+\+MODULUS\+\_\+\+TOO\+\_\+\+LARGE error reason.

(\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2023-6237}{\texttt{ CVE-\/2023-\/6237}})

{\itshape Tomáš Mráz}
\item Restore the encoding of SM2 Private\+Key\+Info and Subject\+Public\+Key\+Info to have the contained Algorithm\+Identifier.\+algorithm set to id-\/ec\+Public\+Key rather than SM2.

{\itshape Richard Levitte}
\item The POLY1305 MAC (message authentication code) implementation in Open\+SSL for Power\+PC CPUs saves the contents of vector registers in different order than they are restored. Thus the contents of some of these vector registers is corrupted when returning to the caller. The vulnerable code is used only on newer Power\+PC processors supporting the Power\+ISA 2.\+07 instructions.

The consequences of this kind of internal application state corruption can be various -\/ from no consequences, if the calling application does not depend on the contents of non-\/volatile XMM registers at all, to the worst consequences, where the attacker could get complete control of the application process. However unless the compiler uses the vector registers for storing pointers, the most likely consequence, if any, would be an incorrect result of some application dependent calculations or a crash leading to a denial of service.

(\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2023-6129}{\texttt{ CVE-\/2023-\/6129}})

{\itshape Rohan Mc\+Lure}
\item Fix excessive time spent in DH check / generation with large Q parameter value.

Applications that use the functions DH\+\_\+generate\+\_\+key() to generate an X9.\+42 DH key may experience long delays. Likewise, applications that use DH\+\_\+check\+\_\+pub\+\_\+key(), DH\+\_\+check\+\_\+pub\+\_\+key\+\_\+ex() or EVP\+\_\+\+PKEY\+\_\+public\+\_\+check() to check an X9.\+42 DH key or X9.\+42 DH parameters may experience long delays. Where the key or parameters that are being checked have been obtained from an untrusted source this may lead to a Denial of Service.

(\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2023-5678}{\texttt{ CVE-\/2023-\/5678}})

{\itshape Richard Levitte}
\item Disable building QUIC server utility when Open\+SSL is configured with {\ttfamily no-\/apps}.

{\itshape Vitalii Koshura}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md5}{}\doxysubsection{\texorpdfstring{Changes between 3.\+1 and 3.\+2.\+0 \mbox{[}23 Nov 2023\mbox{]}}{Changes between 3.\+1 and 3.\+2.\+0 \mbox{[}23 Nov 2023\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md5}

\begin{DoxyItemize}
\item The BLAKE2b hash algorithm supports a configurable output length by setting the "{}size"{} parameter.

{\itshape Čestmír Kalina and Tomáš Mráz}
\item Enable extra Arm64 optimization on Windows for GHASH, RAND and AES.

{\itshape Evgeny Karpov}
\item Added a function to delete objects from store by URI -\/ OSSL\+\_\+\+STORE\+\_\+delete() and the corresponding provider-\/storemgmt API function OSSL\+\_\+\+FUNC\+\_\+store\+\_\+delete().

{\itshape Dmitry Belyavskiy}
\item Added OSSL\+\_\+\+FUNC\+\_\+store\+\_\+open\+\_\+ex() provider-\/storemgmt API function to pass a passphrase callback when opening a store.

{\itshape Simo Sorce}
\item Changed the default salt length used by PBES2 KDF\textquotesingle{}s (PBKDF2 and scrypt) from 8 bytes to 16 bytes. The PKCS5 (RFC 8018) standard uses a 64 bit salt length for PBE, and recommends a minimum of 64 bits for PBES2. For FIPS compliance PBKDF2 requires a salt length of 128 bits. This affects Open\+SSL command line applications such as "{}genrsa"{} and "{}pkcs8"{} and API\textquotesingle{}s such as PEM\+\_\+write\+\_\+bio\+\_\+\+Private\+Key() that are reliant on the default value. The additional commandline option \textquotesingle{}saltlen\textquotesingle{} has been added to the Open\+SSL command line applications for "{}pkcs8"{} and "{}enc"{} to allow the salt length to be set to a non default value.

{\itshape Shane Lontis}
\item Changed the default value of the {\ttfamily ess\+\_\+cert\+\_\+id\+\_\+alg} configuration option which is used to calculate the TSA\textquotesingle{}s public key certificate identifier. The default algorithm is updated to be sha256 instead of sha1.

{\itshape Małgorzata Olszówka}
\item Added optimization for SM2 algorithm on aarch64. It uses a huge precomputed table for point multiplication of the base point, which increases the size of libcrypto from 4.\+4 MB to 4.\+9 MB. A new configure option {\ttfamily no-\/sm2-\/precomp} has been added to disable the precomputed table.

{\itshape Xu Yizhou}
\item Added client side support for QUIC

{\itshape Hugo Landau, Matt Caswell, Paul Dale, Tomáš Mráz, Richard Levitte}
\item Added multiple tutorials on the Open\+SSL library and in particular on writing various clients (using TLS and QUIC protocols) with libssl.

{\itshape Matt Caswell}
\item Added secp384r1 implementation using Solinas\textquotesingle{} reduction to improve speed of the NIST P-\/384 elliptic curve. To enable the implementation the build option {\ttfamily enable-\/ec\+\_\+nistp\+\_\+64\+\_\+gcc\+\_\+128} must be used.

{\itshape Rohan Mc\+Lure}
\item Improved RFC7468 compliance of the asn1parse command.

{\itshape Matthias St. Pierre}
\item Added SHA256/192 algorithm support.

{\itshape Fergus Dall}
\item Added support for securely getting root CA certificate update in CMP.

{\itshape David von Oheimb}
\item Improved contention on global write locks by using more read locks where appropriate.

{\itshape Matt Caswell}
\item Improved performance of OSSL\+\_\+\+PARAM lookups in performance critical provider functions.

{\itshape Paul Dale}
\item Added the SSL\+\_\+get0\+\_\+group\+\_\+name() function to provide access to the name of the group used for the TLS key exchange.

{\itshape Alex Bozarth}
\item Provide a new configure option {\ttfamily no-\/http} that can be used to disable the HTTP support. Provide new configure options {\ttfamily no-\/apps} and {\ttfamily no-\/docs} to disable building the openssl command line application and the documentation.

{\itshape Vladimír Kotal}
\item Provide a new configure option {\ttfamily no-\/ecx} that can be used to disable the X25519, X448, and Ed\+DSA support.

{\itshape Yi Li}
\item When multiple OSSL\+\_\+\+KDF\+\_\+\+PARAM\+\_\+\+INFO parameters are passed to the EVP\+\_\+\+KDF\+\_\+\+CTX\+\_\+set\+\_\+params() function they are now concatenated not just for the HKDF algorithm but also for SSKDF and X9.\+63 KDF algorithms.

{\itshape Paul Dale}
\item Added OSSL\+\_\+\+FUNC\+\_\+keymgmt\+\_\+im/export\+\_\+types\+\_\+ex() provider functions that get the provider context as a parameter.

{\itshape Ingo Franzki}
\item TLS round-\/trip time calculation was added by a Brigham Young University Capstone team partnering with Sandia National Laboratories. A new function in ssl\+\_\+lib titled SSL\+\_\+get\+\_\+handshake\+\_\+rtt will calculate and retrieve this value.

{\itshape Jairus Christensen}
\item Added the "{}-\/quic"{} option to s\+\_\+client to enable connectivity to QUIC servers. QUIC requires the use of ALPN, so this must be specified via the "{}-\/alpn"{} option. Use of the "{}advanced"{} s\+\_\+client command command via the "{}-\/adv"{} option is recommended.

{\itshape Matt Caswell}
\item Added an "{}advanced"{} command mode to s\+\_\+client. Use this with the "{}-\/adv"{} option. The old "{}basic"{} command mode recognises certain letters that must always appear at the start of a line and cannot be escaped. The advanced command mode enables commands to be entered anywhere and there is an escaping mechanism. After starting s\+\_\+client with "{}-\/adv"{} type "{}\{help\}"{} to show a list of available commands.

{\itshape Matt Caswell}
\item Add Raw Public Key (RFC7250) support. Authentication is supported by matching keys against either local policy (TLSA records synthesised from the expected keys) or DANE (TLSA records obtained by the application from DNS). TLSA records will also match the same key in the server certificate, should RPK use not happen to be negotiated.

{\itshape Todd Short}
\item Added support for modular exponentiation and CRT offloading for the S390x architecture.

{\itshape Juergen Christ}
\item Added further assembler code for the RISC-\/V architecture.

{\itshape Christoph Müllner}
\item Added EC\+\_\+\+GROUP\+\_\+to\+\_\+params() which creates an OSSL\+\_\+\+PARAM array from a given EC\+\_\+\+GROUP.

{\itshape Oliver Mihatsch}
\item Improved support for non-\/default library contexts and property queries when parsing PKCS\#12 files.

{\itshape Shane Lontis}
\item Implemented support for all five instances of Ed\+DSA from RFC8032\+: Ed25519, Ed25519ctx, Ed25519ph, Ed448, and Ed448ph. The streaming is not yet supported for the Hash\+Ed\+DSA variants (Ed25519ph and Ed448ph).

{\itshape James Muir}
\item Added SM4 optimization for ARM processors using ASIMD and AES HW instructions.

{\itshape Xu Yizhou}
\item Implemented SM4-\/\+XTS support.

{\itshape Xu Yizhou}
\item Added platform-\/agnostic OSSL\+\_\+sleep() function.

{\itshape Richard Levitte}
\item Implemented deterministic ECDSA signatures (RFC6979) support.

{\itshape Shane Lontis}
\item Implemented AES-\/\+GCM-\/\+SIV (RFC8452) support.

{\itshape Todd Short}
\item Added support for pluggable (provider-\/based) TLS signature algorithms. This enables TLS 1.\+3 authentication operations with algorithms embedded in providers not included by default in Open\+SSL. In combination with the already available pluggable KEM and X.\+509 support, this enables for example suitable providers to deliver post-\/quantum or quantum-\/safe cryptography to Open\+SSL users.

{\itshape Michael Baentsch}
\item Added support for pluggable (provider-\/based) CMS signature algorithms. This enables CMS sign and verify operations with algorithms embedded in providers not included by default in Open\+SSL.

{\itshape Michael Baentsch}
\item Added support for Hybrid Public Key Encryption (HPKE) as defined in RFC9180. HPKE is required for TLS Encrypted Client\+Hello (ECH), Message Layer Security (MLS) and other IETF specifications. HPKE can also be used by other applications that require encrypting "{}to"{} an ECDH public key. External APIs are defined in \doxylink{hpke_8h_source}{include/openssl/hpke.\+h} and documented in doc/man3/\+OSSL\+\_\+\+HPKE\+\_\+\+CTX\+\_\+new.\+pod

{\itshape Stephen Farrell}
\item Implemented HPKE DHKEM support in providers used by HPKE (RFC9180) API.

{\itshape Shane Lontis}
\item Add support for certificate compression (RFC8879), including library support for Brotli and Zstandard compression.

{\itshape Todd Short}
\item Add the ability to add custom attributes to PKCS12 files. Add a new API PKCS12\+\_\+create\+\_\+ex2, identical to the existing PKCS12\+\_\+create\+\_\+ex but allows for a user specified callback and optional argument. Added a new PKCS12\+\_\+\+SAFEBAG\+\_\+set0\+\_\+attr, which allows for a new attr to be added to the existing STACK\+\_\+\+OF attrs.

{\itshape Graham Woodward}
\item Major refactor of the libssl record layer.

{\itshape Matt Caswell}
\item Add a mac salt length option for the pkcs12 command.

{\itshape Xinping Chen}
\item Add more SRTP protection profiles from RFC8723 and RFC8269.

{\itshape Kijin Kim}
\item Extended Kernel TLS (KTLS) to support TLS 1.\+3 receive offload.

{\itshape Daiki Ueno, John Baldwin and Dmitry Podgorny}
\item Add support for TCP Fast Open (RFC7413) to mac\+OS, Linux, and Free\+BSD where supported and enabled.

{\itshape Todd Short}
\item Add ciphersuites based on DHE\+\_\+\+PSK (RFC 4279) and ECDHE\+\_\+\+PSK (RFC 5489) to the list of ciphersuites providing Perfect Forward Secrecy as required by SECLEVEL \texorpdfstring{$>$}{>}= 3.

{\itshape Dmitry Belyavskiy, Nicola Tuveri}
\item Add new SSL APIs to aid in efficiently implementing TLS/\+SSL fingerprinting. The SSL\+\_\+\+CTRL\+\_\+\+GET\+\_\+\+IANA\+\_\+\+GROUPS control code, exposed as the SSL\+\_\+get0\+\_\+iana\+\_\+groups() function-\/like macro, retrieves the list of supported groups sent by the peer. The function SSL\+\_\+client\+\_\+hello\+\_\+get\+\_\+extension\+\_\+order() populates a caller-\/supplied array with the list of extension types present in the Client\+Hello, in order of appearance.

{\itshape Phus Lu}
\item Fixed PEM\+\_\+write\+\_\+bio\+\_\+\+PKCS8\+Private\+Key() and PEM\+\_\+write\+\_\+bio\+\_\+\+PKCS8\+Private\+Key\+\_\+nid() to make it possible to use empty passphrase strings.

{\itshape Darshan Sen}
\item The PKCS12\+\_\+parse() function now supports MAC-\/less PKCS12 files.

{\itshape Daniel Fiala}
\item Added ASYNC\+\_\+set\+\_\+mem\+\_\+functions() and ASYNC\+\_\+get\+\_\+mem\+\_\+functions() calls to be able to change functions used for allocating the memory of asynchronous call stack.

{\itshape Arran Cudbard-\/\+Bell}
\item Added support for signed BIGNUMs in the OSSL\+\_\+\+PARAM APIs.

{\itshape Richard Levitte}
\item A failure exit code is returned when using the openssl x509 command to check certificate attributes and the checks fail.

{\itshape Rami Khaldi}
\item The default SSL/\+TLS security level has been changed from 1 to 2. RSA, DSA and DH keys of 1024 bits and above and less than 2048 bits and ECC keys of 160 bits and above and less than 224 bits were previously accepted by default but are now no longer allowed. By default TLS compression was already disabled in previous Open\+SSL versions. At security level 2 it cannot be enabled.

{\itshape Matt Caswell}
\item The SSL\+\_\+\+CTX\+\_\+set\+\_\+cipher\+\_\+list family functions now accept ciphers using their IANA standard names.

{\itshape Erik Lax}
\item The PVK key derivation function has been moved from b2i\+\_\+\+PVK\+\_\+bio\+\_\+ex() into the legacy crypto provider as an EVP\+\_\+\+KDF. Applications requiring this KDF will need to load the legacy crypto provider.

{\itshape Paul Dale}
\item CCM8 cipher suites in TLS have been downgraded to security level zero because they use a short authentication tag which lowers their strength.

{\itshape Paul Dale}
\item Subject or issuer names in X.\+509 objects are now displayed as UTF-\/8 strings by default.

{\itshape Dmitry Belyavskiy}
\item Add X.\+509 certificate code\+Signing purpose and related checks on key usage and extended key usage of the leaf certificate according to the CA/\+Browser Forum.
\begin{DoxyItemize}
\item Lutz Jänicke\texorpdfstring{$\ast$}{*}
\end{DoxyItemize}
\item The {\ttfamily x509}, {\ttfamily ca}, and {\ttfamily req} apps now produce X.\+509 v3 certificates. The {\ttfamily -\/x509v1} option of {\ttfamily req} prefers generation of X.\+509 v1 certificates. {\ttfamily X509\+\_\+sign()} and {\ttfamily X509\+\_\+sign\+\_\+ctx()} make sure that the certificate has X.\+509 version 3 if the certificate information includes X.\+509 extensions.

{\itshape David von Oheimb}
\item Fix and extend certificate handling and the apps {\ttfamily x509}, {\ttfamily verify} etc. such as adding a trace facility for debugging certificate chain building.

{\itshape David von Oheimb}
\item Various fixes and extensions to the CMP+\+CRMF implementation and the {\ttfamily cmp} app in particular supporting requests for central key generation, generalized polling, and various types of genm/genp exchanges defined in CMP Updates.

{\itshape David von Oheimb}
\item Fixes and extensions to the HTTP client and to the HTTP server in {\ttfamily apps/} like correcting the TLS and proxy support and adding tracing for debugging.

{\itshape David von Oheimb}
\item Extended the CMS API for handling {\ttfamily CMS\+\_\+\+Signed\+Data} and {\ttfamily CMS\+\_\+\+Enveloped\+Data}.

{\itshape David von Oheimb}
\item {\ttfamily CMS\+\_\+add0\+\_\+cert()} and {\ttfamily CMS\+\_\+add1\+\_\+cert()} no longer throw an error if a certificate to be added is already present. {\ttfamily CMS\+\_\+sign\+\_\+ex()} and {\ttfamily CMS\+\_\+sign()} now ignore any duplicate certificates in their {\ttfamily certs} argument and no longer throw an error for them.

{\itshape David von Oheimb}
\item Fixed and extended {\ttfamily util/check-\/format.\+pl} for checking adherence to the coding style \href{https://www.openssl.org/policies/technical/coding-style.html}{\texttt{ https\+://www.\+openssl.\+org/policies/technical/coding-\/style.\+html}}. The checks are meanwhile more complete and yield fewer false positives.

{\itshape David von Oheimb}
\item Added BIO\+\_\+s\+\_\+dgram\+\_\+pair() and BIO\+\_\+s\+\_\+dgram\+\_\+mem() that provide memory-\/based BIOs with datagram semantics and support for BIO\+\_\+sendmmsg() and BIO\+\_\+recvmmsg() calls. They can be used as the transport BIOs for QUIC.

{\itshape Hugo Landau, Matt Caswell and Tomáš Mráz}
\item Add new BIO\+\_\+sendmmsg() and BIO\+\_\+recvmmsg() BIO methods which allow sending and receiving multiple messages in a single call. An implementation is provided for BIO\+\_\+dgram. For further details, see BIO\+\_\+sendmmsg(3).

{\itshape Hugo Landau}
\item Support for loading root certificates from the Windows certificate store has been added. The support is in the form of a store which recognises the URI string of {\ttfamily org.\+openssl.\+winstore\+://}. This URI scheme currently takes no arguments. This store is built by default and can be disabled using the new compile-\/time option {\ttfamily no-\/winstore}. This store is not currently used by default and must be loaded explicitly using the above store URI. It is expected to be loaded by default in the future.

{\itshape Hugo Landau}
\item Enable KTLS with the TLS 1.\+3 CCM mode ciphersuites. Note that some linux kernel versions that support KTLS have a known bug in CCM processing. That has been fixed in stable releases starting from 5.\+4.\+164, 5.\+10.\+84, 5.\+15.\+7, and all releases since 5.\+16. KTLS with CCM ciphersuites should be only used on these releases.

{\itshape Tianjia Zhang}
\item Added {\ttfamily -\/ktls} option to {\ttfamily s\+\_\+server} and {\ttfamily s\+\_\+client} commands to enable the KTLS support.

{\itshape Tianjia Zhang}
\item Zerocopy KTLS sendfile() support on Linux.

{\itshape Maxim Mikityanskiy}
\item The OBJ\+\_\+ calls are now thread safe using a global lock.

{\itshape Paul Dale}
\item New parameter {\ttfamily -\/digest} for openssl cms command allowing signing pre-\/computed digests and new CMS API functions supporting that functionality.

{\itshape Viktor Söderqvist}
\item OPENSSL\+\_\+malloc() and other allocation functions now raise errors on allocation failures. The callers do not need to explicitly raise errors unless they want to for tracing purposes.

{\itshape David von Oheimb}
\item Added and enabled by default implicit rejection in RSA PKCS\#1 v1.\+5 decryption as a protection against Bleichenbacher-\/like attacks. The RSA decryption API will now return a randomly generated deterministic message instead of an error in case it detects an error when checking padding during PKCS\#1 v1.\+5 decryption. This is a general protection against issues like CVE-\/2020-\/25659 and CVE-\/2020-\/25657. This protection can be disabled by calling {\ttfamily EVP\+\_\+\+PKEY\+\_\+\+CTX\+\_\+ctrl\+\_\+str(ctx, "{}rsa\+\_\+pkcs1\+\_\+implicit\+\_\+rejection"{}. "{}0"{})} on the RSA decryption context.

{\itshape Hubert Kario}
\item Added support for Brainpool curves in TLS-\/1.\+3.

{\itshape Bernd Edlinger and Matt Caswell}
\item Added Open\+BSD specific build targets.

{\itshape David Carlier}
\item Support for Argon2d, Argon2i, Argon2id KDFs has been added along with a basic thread pool implementation for select platforms.

{\itshape Čestmír Kalina}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md6}{}\doxysection{\texorpdfstring{Open\+SSL 3.\+1}{Open\+SSL 3.\+1}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md6}
\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md7}{}\doxysubsection{\texorpdfstring{Changes between 3.\+1.\+3 and 3.\+1.\+4 \mbox{[}24 Oct 2023\mbox{]}}{Changes between 3.\+1.\+3 and 3.\+1.\+4 \mbox{[}24 Oct 2023\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md7}

\begin{DoxyItemize}
\item Fix incorrect key and IV resizing issues when calling EVP\+\_\+\+Encrypt\+Init\+\_\+ex2(), EVP\+\_\+\+Decrypt\+Init\+\_\+ex2() or EVP\+\_\+\+Cipher\+Init\+\_\+ex2() with OSSL\+\_\+\+PARAM parameters that alter the key or IV length (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2023-5363}{\texttt{ CVE-\/2023-\/5363}}).

{\itshape Paul Dale}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md8}{}\doxysubsection{\texorpdfstring{Changes between 3.\+1.\+2 and 3.\+1.\+3 \mbox{[}19 Sep 2023\mbox{]}}{Changes between 3.\+1.\+2 and 3.\+1.\+3 \mbox{[}19 Sep 2023\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md8}

\begin{DoxyItemize}
\item Fix POLY1305 MAC implementation corrupting XMM registers on Windows.

The POLY1305 MAC (message authentication code) implementation in Open\+SSL does not save the contents of non-\/volatile XMM registers on Windows 64 platform when calculating the MAC of data larger than 64 bytes. Before returning to the caller all the XMM registers are set to zero rather than restoring their previous content. The vulnerable code is used only on newer x86\+\_\+64 processors supporting the AVX512-\/\+IFMA instructions.

The consequences of this kind of internal application state corruption can be various -\/ from no consequences, if the calling application does not depend on the contents of non-\/volatile XMM registers at all, to the worst consequences, where the attacker could get complete control of the application process. However given the contents of the registers are just zeroized so the attacker cannot put arbitrary values inside, the most likely consequence, if any, would be an incorrect result of some application dependent calculations or a crash leading to a denial of service.

(\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2023-4807}{\texttt{ CVE-\/2023-\/4807}})

{\itshape Bernd Edlinger}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md9}{}\doxysubsection{\texorpdfstring{Changes between 3.\+1.\+1 and 3.\+1.\+2 \mbox{[}1 Aug 2023\mbox{]}}{Changes between 3.\+1.\+1 and 3.\+1.\+2 \mbox{[}1 Aug 2023\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md9}

\begin{DoxyItemize}
\item Fix excessive time spent checking DH q parameter value.

The function DH\+\_\+check() performs various checks on DH parameters. After fixing CVE-\/2023-\/3446 it was discovered that a large q parameter value can also trigger an overly long computation during some of these checks. A correct q value, if present, cannot be larger than the modulus p parameter, thus it is unnecessary to perform these checks if q is larger than p.

If DH\+\_\+check() is called with such q parameter value, DH\+\_\+\+CHECK\+\_\+\+INVALID\+\_\+\+Q\+\_\+\+VALUE return flag is set and the computationally intensive checks are skipped.

(\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2023-3817}{\texttt{ CVE-\/2023-\/3817}})

{\itshape Tomáš Mráz}
\item Fix DH\+\_\+check() excessive time with over sized modulus.

The function DH\+\_\+check() performs various checks on DH parameters. One of those checks confirms that the modulus ("{}p"{} parameter) is not too large. Trying to use a very large modulus is slow and Open\+SSL will not normally use a modulus which is over 10,000 bits in length.

However the DH\+\_\+check() function checks numerous aspects of the key or parameters that have been supplied. Some of those checks use the supplied modulus value even if it has already been found to be too large.

A new limit has been added to DH\+\_\+check of 32,768 bits. Supplying a key/parameters with a modulus over this size will simply cause DH\+\_\+check() to fail.

(\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2023-3446}{\texttt{ CVE-\/2023-\/3446}})

{\itshape Matt Caswell}
\item Do not ignore empty associated data entries with AES-\/\+SIV.

The AES-\/\+SIV algorithm allows for authentication of multiple associated data entries along with the encryption. To authenticate empty data the application has to call {\ttfamily EVP\+\_\+\+Encrypt\+Update()} (or {\ttfamily EVP\+\_\+\+Cipher\+Update()}) with NULL pointer as the output buffer and 0 as the input buffer length. The AES-\/\+SIV implementation in Open\+SSL just returns success for such call instead of performing the associated data authentication operation. The empty data thus will not be authenticated. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2023-2975}{\texttt{ CVE-\/2023-\/2975}})

Thanks to Juerg Wullschleger (Google) for discovering the issue.

The fix changes the authentication tag value and the ciphertext for applications that use empty associated data entries with AES-\/\+SIV. To decrypt data encrypted with previous versions of Open\+SSL the application has to skip calls to {\ttfamily EVP\+\_\+\+Decrypt\+Update()} for empty associated data entries.

{\itshape Tomáš Mráz}
\item When building with the {\ttfamily enable-\/fips} option and using the resulting FIPS provider, TLS 1.\+2 will, by default, mandate the use of an extended master secret (FIPS 140-\/3 IG G.\+Q) and the Hash and HMAC DRBGs will not operate with truncated digests (FIPS 140-\/3 IG G.\+R).

{\itshape Paul Dale}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md10}{}\doxysubsection{\texorpdfstring{Changes between 3.\+1.\+0 and 3.\+1.\+1 \mbox{[}30 May 2023\mbox{]}}{Changes between 3.\+1.\+0 and 3.\+1.\+1 \mbox{[}30 May 2023\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md10}

\begin{DoxyItemize}
\item Mitigate for the time it takes for {\ttfamily OBJ\+\_\+obj2txt} to translate gigantic OBJECT IDENTIFIER sub-\/identifiers to canonical numeric text form.

OBJ\+\_\+obj2txt() would translate any size OBJECT IDENTIFIER to canonical numeric text form. For gigantic sub-\/identifiers, this would take a very long time, the time complexity being O(n\texorpdfstring{$^\wedge$}{\string^}2) where n is the size of that sub-\/identifier. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2023-2650}{\texttt{ CVE-\/2023-\/2650}})

To mitigitate this, {\ttfamily OBJ\+\_\+obj2txt()} will only translate an OBJECT IDENTIFIER to canonical numeric text form if the size of that OBJECT IDENTIFIER is 586 bytes or less, and fail otherwise.

The basis for this restriction is \href{https://datatracker.ietf.org/doc/html/rfc2578\#section-3.5}{\texttt{ RFC 2578 (STD 58), section 3.\+5}}. OBJECT IDENTIFIER values, which stipulates that OBJECT IDENTIFIERS may have at most 128 sub-\/identifiers, and that the maximum value that each sub-\/ identifier may have is 2\texorpdfstring{$^\wedge$}{\string^}32-\/1 (4294967295 decimal).

For each byte of every sub-\/identifier, only the 7 lower bits are part of the value, so the maximum amount of bytes that an OBJECT IDENTIFIER with these restrictions may occupy is 32 \texorpdfstring{$\ast$}{*} 128 / 7, which is approximately 586 bytes.

{\itshape Richard Levitte}
\item Multiple algorithm implementation fixes for ARM BE platforms.

{\itshape Liu-\/\+Er\+Meng}
\item Added a -\/pedantic option to fipsinstall that adjusts the various settings to ensure strict FIPS compliance rather than backwards compatibility.

{\itshape Paul Dale}
\item Fixed buffer overread in AES-\/\+XTS decryption on ARM 64 bit platforms which happens if the buffer size is 4 mod 5 in 16 byte AES blocks. This can trigger a crash of an application using AES-\/\+XTS decryption if the memory just after the buffer being decrypted is not mapped. Thanks to Anton Romanov (Amazon) for discovering the issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2023-1255}{\texttt{ CVE-\/2023-\/1255}})

{\itshape Nevine Ebeid}
\item Reworked the Fix for the Timing Oracle in RSA Decryption (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2022-4304}{\texttt{ CVE-\/2022-\/4304}}). The previous fix for this timing side channel turned out to cause a severe 2-\/3x performance regression in the typical use case compared to 3.\+0.\+7. The new fix uses existing constant time code paths, and restores the previous performance level while fully eliminating all existing timing side channels. The fix was developed by Bernd Edlinger with testing support by Hubert Kario.

{\itshape Bernd Edlinger}
\item Add FIPS provider configuration option to disallow the use of truncated digests with Hash and HMAC DRBGs (q.\+v. FIPS 140-\/3 IG D.\+R.). The option \textquotesingle{}-\/no\+\_\+drbg\+\_\+truncated\+\_\+digests\textquotesingle{} can optionally be supplied to \textquotesingle{}openssl fipsinstall\textquotesingle{}.

{\itshape Paul Dale}
\item Corrected documentation of X509\+\_\+\+VERIFY\+\_\+\+PARAM\+\_\+add0\+\_\+policy() to mention that it does not enable policy checking. Thanks to David Benjamin for discovering this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2023-0466}{\texttt{ CVE-\/2023-\/0466}})

{\itshape Tomáš Mráz}
\item Fixed an issue where invalid certificate policies in leaf certificates are silently ignored by Open\+SSL and other certificate policy checks are skipped for that certificate. A malicious CA could use this to deliberately assert invalid certificate policies in order to circumvent policy checking on the certificate altogether. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2023-0465}{\texttt{ CVE-\/2023-\/0465}})

{\itshape Matt Caswell}
\item Limited the number of nodes created in a policy tree to mitigate against CVE-\/2023-\/0464. The default limit is set to 1000 nodes, which should be sufficient for most installations. If required, the limit can be adjusted by setting the OPENSSL\+\_\+\+POLICY\+\_\+\+TREE\+\_\+\+NODES\+\_\+\+MAX build time define to a desired maximum number of nodes or zero to allow unlimited growth. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2023-0464}{\texttt{ CVE-\/2023-\/0464}})

{\itshape Paul Dale}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md11}{}\doxysubsection{\texorpdfstring{Changes between 3.\+0 and 3.\+1.\+0 \mbox{[}14 Mar 2023\mbox{]}}{Changes between 3.\+0 and 3.\+1.\+0 \mbox{[}14 Mar 2023\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md11}

\begin{DoxyItemize}
\item Add FIPS provider configuration option to enforce the Extended Master Secret (EMS) check during the \doxylink{struct_t_l_s1___p_r_f}{TLS1\+\_\+\+PRF} KDF. The option \textquotesingle{}-\/ems-\/check\textquotesingle{} can optionally be supplied to \textquotesingle{}openssl fipsinstall\textquotesingle{}.

{\itshape Shane Lontis}
\item The FIPS provider includes a few non-\/approved algorithms for backward compatibility purposes and the "{}fips=yes"{} property query must be used for all algorithm fetches to ensure FIPS compliance.

The algorithms that are included but not approved are Triple DES ECB, Triple DES CBC and Ed\+DSA.

{\itshape Paul Dale}
\item Added support for KMAC in \doxylink{struct_k_b_k_d_f}{KBKDF}.

{\itshape Shane Lontis}
\item RNDR and RNDRRS support in provider functions to provide random number generation for Arm CPUs (aarch64).

{\itshape Orr Toledano}
\item s\+\_\+client and s\+\_\+server apps now explicitly say when the TLS version does not include the renegotiation mechanism. This avoids confusion between that scenario versus when the TLS version includes secure renegotiation but the peer lacks support for it.

{\itshape Felipe Gasper}
\item AES-\/\+GCM enabled with AVX512 v\+AES and v\+PCLMULQDQ.

{\itshape Tomasz Kantecki, Andrey Matyukov}
\item The various OBJ\+\_\+\texorpdfstring{$\ast$}{*} functions have been made thread safe.

{\itshape Paul Dale}
\item Parallel dual-\/prime 1536/2048-\/bit modular exponentiation for AVX512\+\_\+\+IFMA capable processors.

{\itshape Sergey Kirillov, Andrey Matyukov (Intel Corp)}
\item The functions {\ttfamily OPENSSL\+\_\+\+LH\+\_\+stats}, {\ttfamily OPENSSL\+\_\+\+LH\+\_\+node\+\_\+stats}, {\ttfamily OPENSSL\+\_\+\+LH\+\_\+node\+\_\+usage\+\_\+stats}, {\ttfamily OPENSSL\+\_\+\+LH\+\_\+stats\+\_\+bio}, {\ttfamily OPENSSL\+\_\+\+LH\+\_\+node\+\_\+stats\+\_\+bio} and {\ttfamily OPENSSL\+\_\+\+LH\+\_\+node\+\_\+usage\+\_\+stats\+\_\+bio} are now marked deprecated from Open\+SSL 3.\+1 onwards and can be disabled by defining {\ttfamily OPENSSL\+\_\+\+NO\+\_\+\+DEPRECATED\+\_\+3\+\_\+1}.

The macro {\ttfamily DEFINE\+\_\+\+LHASH\+\_\+\+OF} is now deprecated in favour of the macro {\ttfamily DEFINE\+\_\+\+LHASH\+\_\+\+OF\+\_\+\+EX}, which omits the corresponding type-\/specific function definitions for these functions regardless of whether {\ttfamily OPENSSL\+\_\+\+NO\+\_\+\+DEPRECATED\+\_\+3\+\_\+1} is defined.

Users of {\ttfamily DEFINE\+\_\+\+LHASH\+\_\+\+OF} may start receiving deprecation warnings for these functions regardless of whether they are using them. It is recommended that users transition to the new macro, {\ttfamily DEFINE\+\_\+\+LHASH\+\_\+\+OF\+\_\+\+EX}.

{\itshape Hugo Landau}
\item When generating safe-\/prime DH parameters set the recommended private key length equivalent to minimum key lengths as in RFC 7919.

{\itshape Tomáš Mráz}
\item Change the default salt length for PKCS\#1 RSASSA-\/\+PSS signatures to the maximum size that is smaller or equal to the digest length to comply with FIPS 186-\/4 section 5. This is implemented by a new option {\ttfamily OSSL\+\_\+\+PKEY\+\_\+\+RSA\+\_\+\+PSS\+\_\+\+SALT\+\_\+\+LEN\+\_\+\+AUTO\+\_\+\+DIGEST\+\_\+\+MAX} ("{}auto-\/digestmax"{}) for the {\ttfamily rsa\+\_\+pss\+\_\+saltlen} parameter, which is now the default. Signature verification is not affected by this change and continues to work as before.

{\itshape Clemens Lang}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md12}{}\doxysection{\texorpdfstring{Open\+SSL 3.\+0}{Open\+SSL 3.\+0}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md12}
For Open\+SSL 3.\+0 a \href{https://github.com/openssl/openssl/tree/master/doc/man7/migration_guide.pod}{\texttt{ Migration guide}} has been added, so the CHANGES entries listed here are only a brief description. The migration guide contains more detailed information related to new features, breaking changes, and mappings for the large list of deprecated functions.\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md13}{}\doxysubsection{\texorpdfstring{Changes between 3.\+0.\+7 and 3.\+0.\+8 \mbox{[}7 Feb 2023\mbox{]}}{Changes between 3.\+0.\+7 and 3.\+0.\+8 \mbox{[}7 Feb 2023\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md13}

\begin{DoxyItemize}
\item Fixed NULL dereference during PKCS7 data verification.

A NULL pointer can be dereferenced when signatures are being verified on PKCS7 signed or signed\+And\+Enveloped data. In case the hash algorithm used for the signature is known to the Open\+SSL library but the implementation of the hash algorithm is not available the digest initialization will fail. There is a missing check for the return value from the initialization function which later leads to invalid usage of the digest API most likely leading to a crash. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2023-0401}{\texttt{ CVE-\/2023-\/0401}})

PKCS7 data is processed by the SMIME library calls and also by the time stamp (TS) library calls. The TLS implementation in Open\+SSL does not call these functions however third party applications would be affected if they call these functions to verify signatures on untrusted data.

{\itshape Tomáš Mráz}
\item Fixed X.\+400 address type confusion in X.\+509 General\+Name.

There is a type confusion vulnerability relating to X.\+400 address processing inside an X.\+509 General\+Name. X.\+400 addresses were parsed as an ASN1\+\_\+\+STRING but the public structure definition for GENERAL\+\_\+\+NAME incorrectly specified the type of the x400\+Address field as ASN1\+\_\+\+TYPE. This field is subsequently interpreted by the Open\+SSL function GENERAL\+\_\+\+NAME\+\_\+cmp as an ASN1\+\_\+\+TYPE rather than an ASN1\+\_\+\+STRING.

When CRL checking is enabled (i.\+e. the application sets the X509\+\_\+\+V\+\_\+\+FLAG\+\_\+\+CRL\+\_\+\+CHECK flag), this vulnerability may allow an attacker to pass arbitrary pointers to a memcmp call, enabling them to read memory contents or enact a denial of service. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2023-0286}{\texttt{ CVE-\/2023-\/0286}})

{\itshape Hugo Landau}
\item Fixed NULL dereference validating DSA public key.

An invalid pointer dereference on read can be triggered when an application tries to check a malformed DSA public key by the EVP\+\_\+\+PKEY\+\_\+public\+\_\+check() function. This will most likely lead to an application crash. This function can be called on public keys supplied from untrusted sources which could allow an attacker to cause a denial of service attack.

The TLS implementation in Open\+SSL does not call this function but applications might call the function if there are additional security requirements imposed by standards such as FIPS 140-\/3. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2023-0217}{\texttt{ CVE-\/2023-\/0217}})

{\itshape Shane Lontis, Tomáš Mráz}
\item Fixed Invalid pointer dereference in d2i\+\_\+\+PKCS7 functions.

An invalid pointer dereference on read can be triggered when an application tries to load malformed PKCS7 data with the d2i\+\_\+\+PKCS7(), d2i\+\_\+\+PKCS7\+\_\+bio() or d2i\+\_\+\+PKCS7\+\_\+fp() functions.

The result of the dereference is an application crash which could lead to a denial of service attack. The TLS implementation in Open\+SSL does not call this function however third party applications might call these functions on untrusted data. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2023-0216}{\texttt{ CVE-\/2023-\/0216}})

{\itshape Tomáš Mráz}
\item Fixed Use-\/after-\/free following BIO\+\_\+new\+\_\+\+NDEF.

The public API function BIO\+\_\+new\+\_\+\+NDEF is a helper function used for streaming ASN.\+1 data via a BIO. It is primarily used internally to Open\+SSL to support the SMIME, CMS and PKCS7 streaming capabilities, but may also be called directly by end user applications.

The function receives a BIO from the caller, prepends a new BIO\+\_\+f\+\_\+asn1 filter BIO onto the front of it to form a BIO chain, and then returns the new head of the BIO chain to the caller. Under certain conditions, for example if a CMS recipient public key is invalid, the new filter BIO is freed and the function returns a NULL result indicating a failure. However, in this case, the BIO chain is not properly cleaned up and the BIO passed by the caller still retains internal pointers to the previously freed filter BIO. If the caller then goes on to call BIO\+\_\+pop() on the BIO then a use-\/after-\/free will occur. This will most likely result in a crash. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2023-0215}{\texttt{ CVE-\/2023-\/0215}})

{\itshape Viktor Dukhovni, Matt Caswell}
\item Fixed Double free after calling PEM\+\_\+read\+\_\+bio\+\_\+ex.

The function PEM\+\_\+read\+\_\+bio\+\_\+ex() reads a PEM file from a BIO and parses and decodes the "{}name"{} (e.\+g. "{}\+CERTIFICATE"{}), any header data and the payload data. If the function succeeds then the "{}name\+\_\+out"{}, "{}header"{} and "{}data"{} arguments are populated with pointers to buffers containing the relevant decoded data. The caller is responsible for freeing those buffers. It is possible to construct a PEM file that results in 0 bytes of payload data. In this case PEM\+\_\+read\+\_\+bio\+\_\+ex() will return a failure code but will populate the header argument with a pointer to a buffer that has already been freed. If the caller also frees this buffer then a double free will occur. This will most likely lead to a crash.

The functions PEM\+\_\+read\+\_\+bio() and PEM\+\_\+read() are simple wrappers around PEM\+\_\+read\+\_\+bio\+\_\+ex() and therefore these functions are also directly affected.

These functions are also called indirectly by a number of other Open\+SSL functions including PEM\+\_\+\+X509\+\_\+\+INFO\+\_\+read\+\_\+bio\+\_\+ex() and SSL\+\_\+\+CTX\+\_\+use\+\_\+serverinfo\+\_\+file() which are also vulnerable. Some Open\+SSL internal uses of these functions are not vulnerable because the caller does not free the header argument if PEM\+\_\+read\+\_\+bio\+\_\+ex() returns a failure code. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2022-4450}{\texttt{ CVE-\/2022-\/4450}})

{\itshape Kurt Roeckx, Matt Caswell}
\item Fixed Timing Oracle in RSA Decryption.

A timing based side channel exists in the Open\+SSL RSA Decryption implementation which could be sufficient to recover a plaintext across a network in a Bleichenbacher style attack. To achieve a successful decryption an attacker would have to be able to send a very large number of trial messages for decryption. The vulnerability affects all RSA padding modes\+: PKCS\#1 v1.\+5, RSA-\/\+OEAP and RSASVE. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2022-4304}{\texttt{ CVE-\/2022-\/4304}})

{\itshape Dmitry Belyavsky, Hubert Kario}
\item Fixed X.\+509 Name Constraints Read Buffer Overflow.

A read buffer overrun can be triggered in X.\+509 certificate verification, specifically in name constraint checking. The read buffer overrun might result in a crash which could lead to a denial of service attack. In a TLS client, this can be triggered by connecting to a malicious server. In a TLS server, this can be triggered if the server requests client authentication and a malicious client connects. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2022-4203}{\texttt{ CVE-\/2022-\/4203}})

{\itshape Viktor Dukhovni}
\item Fixed X.\+509 Policy Constraints Double Locking security issue.

If an X.\+509 certificate contains a malformed policy constraint and policy processing is enabled, then a write lock will be taken twice recursively. On some operating systems (most widely\+: Windows) this results in a denial of service when the affected process hangs. Policy processing being enabled on a publicly facing server is not considered to be a common setup. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2022-3996}{\texttt{ CVE-\/2022-\/3996}})

{\itshape Paul Dale}
\item Our provider implementations of {\ttfamily OSSL\+\_\+\+FUNC\+\_\+\+KEYMGMT\+\_\+\+EXPORT} and {\ttfamily OSSL\+\_\+\+FUNC\+\_\+\+KEYMGMT\+\_\+\+GET\+\_\+\+PARAMS} for EC and SM2 keys now honor {\ttfamily OSSL\+\_\+\+PKEY\+\_\+\+PARAM\+\_\+\+EC\+\_\+\+POINT\+\_\+\+CONVERSION\+\_\+\+FORMAT} as set (and default to {\ttfamily POINT\+\_\+\+CONVERSION\+\_\+\+UNCOMPRESSED}) when exporting {\ttfamily OSSL\+\_\+\+PKEY\+\_\+\+PARAM\+\_\+\+PUB\+\_\+\+KEY}, instead of unconditionally using {\ttfamily POINT\+\_\+\+CONVERSION\+\_\+\+COMPRESSED} as in previous 3.\+x releases. For symmetry, our implementation of {\ttfamily EVP\+\_\+\+PKEY\+\_\+\+ASN1\+\_\+\+METHOD-\/\texorpdfstring{$>$}{>}export\+\_\+to} for legacy EC and SM2 keys is also changed similarly to honor the equivalent conversion format flag as specified in the underlying {\ttfamily EC\+\_\+\+KEY} object being exported to a provider, when this function is called through {\ttfamily EVP\+\_\+\+PKEY\+\_\+export()}.

{\itshape Nicola Tuveri}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md14}{}\doxysubsection{\texorpdfstring{Changes between 3.\+0.\+6 and 3.\+0.\+7 \mbox{[}1 Nov 2022\mbox{]}}{Changes between 3.\+0.\+6 and 3.\+0.\+7 \mbox{[}1 Nov 2022\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md14}

\begin{DoxyItemize}
\item Fixed two buffer overflows in punycode decoding functions.

A buffer overrun can be triggered in X.\+509 certificate verification, specifically in name constraint checking. Note that this occurs after certificate chain signature verification and requires either a CA to have signed the malicious certificate or for the application to continue certificate verification despite failure to construct a path to a trusted issuer.

In a TLS client, this can be triggered by connecting to a malicious server. In a TLS server, this can be triggered if the server requests client authentication and a malicious client connects.

An attacker can craft a malicious email address to overflow an arbitrary number of bytes containing the {\ttfamily .} character (decimal 46) on the stack. This buffer overflow could result in a crash (causing a denial of service). (\mbox{[}CVE-\/2022-\/3786\mbox{]})

An attacker can craft a malicious email address to overflow four attacker-\/controlled bytes on the stack. This buffer overflow could result in a crash (causing a denial of service) or potentially remote code execution depending on stack layout for any given platform/compiler. (\mbox{[}CVE-\/2022-\/3602\mbox{]})

{\itshape Paul Dale}
\item Removed all references to invalid OSSL\+\_\+\+PKEY\+\_\+\+PARAM\+\_\+\+RSA names for CRT parameters in Open\+SSL code. Applications should not use the names OSSL\+\_\+\+PKEY\+\_\+\+PARAM\+\_\+\+RSA\+\_\+\+FACTOR, OSSL\+\_\+\+PKEY\+\_\+\+PARAM\+\_\+\+RSA\+\_\+\+EXPONENT and OSSL\+\_\+\+PKEY\+\_\+\+PARAM\+\_\+\+RSA\+\_\+\+COEFFICIENT. Use the numbered names such as OSSL\+\_\+\+PKEY\+\_\+\+PARAM\+\_\+\+RSA\+\_\+\+FACTOR1 instead. Using these invalid names may cause algorithms to use slower methods that ignore the CRT parameters.

{\itshape Shane Lontis}
\item Fixed a regression introduced in 3.\+0.\+6 version raising errors on some stack operations.

{\itshape Tomáš Mráz}
\item Fixed a regression introduced in 3.\+0.\+6 version not refreshing the certificate data to be signed before signing the certificate.

{\itshape Gibeom Gwon}
\item Added RIPEMD160 to the default provider.

{\itshape Paul Dale}
\item Ensured that the key share group sent or accepted for the key exchange is allowed for the protocol version.

{\itshape Matt Caswell}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md15}{}\doxysubsection{\texorpdfstring{Changes between 3.\+0.\+5 and 3.\+0.\+6 \mbox{[}11 Oct 2022\mbox{]}}{Changes between 3.\+0.\+5 and 3.\+0.\+6 \mbox{[}11 Oct 2022\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md15}

\begin{DoxyItemize}
\item Open\+SSL supports creating a custom cipher via the legacy EVP\+\_\+\+CIPHER\+\_\+meth\+\_\+new() function and associated function calls. This function was deprecated in Open\+SSL 3.\+0 and application authors are instead encouraged to use the new provider mechanism in order to implement custom ciphers.

Open\+SSL versions 3.\+0.\+0 to 3.\+0.\+5 incorrectly handle legacy custom ciphers passed to the EVP\+\_\+\+Encrypt\+Init\+\_\+ex2(), EVP\+\_\+\+Decrypt\+Init\+\_\+ex2() and EVP\+\_\+\+Cipher\+Init\+\_\+ex2() functions (as well as other similarly named encryption and decryption initialisation functions). Instead of using the custom cipher directly it incorrectly tries to fetch an equivalent cipher from the available providers. An equivalent cipher is found based on the NID passed to EVP\+\_\+\+CIPHER\+\_\+meth\+\_\+new(). This NID is supposed to represent the unique NID for a given cipher. However it is possible for an application to incorrectly pass NID\+\_\+undef as this value in the call to EVP\+\_\+\+CIPHER\+\_\+meth\+\_\+new(). When NID\+\_\+undef is used in this way the Open\+SSL encryption/decryption initialisation function will match the NULL cipher as being equivalent and will fetch this from the available providers. This will succeed if the default provider has been loaded (or if a third party provider has been loaded that offers this cipher). Using the NULL cipher means that the plaintext is emitted as the ciphertext.

Applications are only affected by this issue if they call EVP\+\_\+\+CIPHER\+\_\+meth\+\_\+new() using NID\+\_\+undef and subsequently use it in a call to an encryption/decryption initialisation function. Applications that only use SSL/\+TLS are not impacted by this issue. (\mbox{[}CVE-\/2022-\/3358\mbox{]})

{\itshape Matt Caswell}
\item Fix LLVM vs Apple LLVM version numbering confusion that caused build failures on Mac\+OS 10.\+11

{\itshape Richard Levitte}
\item Fixed the linux-\/mips64 Configure target which was missing the SIXTY\+\_\+\+FOUR\+\_\+\+BIT bn\+\_\+ops flag. This was causing heap corruption on that platform.

{\itshape Adam Joseph}
\item Fix handling of a ticket key callback that returns 0 in TLSv1.\+3 to not send a ticket

{\itshape Matt Caswell}
\item Correctly handle a retransmitted Client\+Hello in DTLS

{\itshape Matt Caswell}
\item Fixed detection of ktls support in cross-\/compile environment on Linux

{\itshape Tomas Mraz}
\item Fixed some regressions and test failures when running the 3.\+0.\+0 FIPS provider against 3.\+0.\+x

{\itshape Paul Dale}
\item Fixed SSL\+\_\+pending() and SSL\+\_\+has\+\_\+pending() with DTLS which were failing to report correct results in some cases

{\itshape Matt Caswell}
\item Fix UWP builds by defining Virtual\+Lock

{\itshape Charles Milette}
\item For known safe primes use the minimum key length according to RFC 7919. Longer private key sizes unnecessarily raise the cycles needed to compute the shared secret without any increase of the real security. This fixes a regression from 1.\+1.\+1 where these shorter keys were generated for the known safe primes.

{\itshape Tomas Mraz}
\item Added the loongarch64 target

{\itshape Shi Pujin}
\item Fixed EC ASM flag passing. Flags for ASM implementations of EC curves were only passed to the FIPS provider and not to the default or legacy provider.

{\itshape Juergen Christ}
\item Fixed reported performance degradation on aarch64. Restored the implementation prior to commit 2621751 ("{}aes/asm/aesv8-\/armx.\+pl\+: avoid    32-\/bit lane assignment in CTR mode"{}) for 64bit targets only, since it is reportedly 2-\/17\% slower and the silicon errata only affects 32bit targets. The new algorithm is still used for 32 bit targets.

{\itshape Bernd Edlinger}
\item Added a missing header for memcmp that caused compilation failure on some platforms

{\itshape Gregor Jasny}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md16}{}\doxysubsection{\texorpdfstring{Changes between 3.\+0.\+4 and 3.\+0.\+5 \mbox{[}5 Jul 2022\mbox{]}}{Changes between 3.\+0.\+4 and 3.\+0.\+5 \mbox{[}5 Jul 2022\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md16}

\begin{DoxyItemize}
\item The Open\+SSL 3.\+0.\+4 release introduced a serious bug in the RSA implementation for X86\+\_\+64 CPUs supporting the AVX512\+IFMA instructions. This issue makes the RSA implementation with 2048 bit private keys incorrect on such machines and memory corruption will happen during the computation. As a consequence of the memory corruption an attacker may be able to trigger a remote code execution on the machine performing the computation.

SSL/\+TLS servers or other servers using 2048 bit RSA private keys running on machines supporting AVX512\+IFMA instructions of the X86\+\_\+64 architecture are affected by this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2022-2274}{\texttt{ CVE-\/2022-\/2274}})

{\itshape Xi Ruoyao}
\item AES OCB mode for 32-\/bit x86 platforms using the AES-\/\+NI assembly optimised implementation would not encrypt the entirety of the data under some circumstances. This could reveal sixteen bytes of data that was preexisting in the memory that wasn\textquotesingle{}t written. In the special case of "{}in place"{} encryption, sixteen bytes of the plaintext would be revealed.

Since Open\+SSL does not support OCB based cipher suites for TLS and DTLS, they are both unaffected. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2022-2097}{\texttt{ CVE-\/2022-\/2097}})

{\itshape Alex Chernyakhovsky, David Benjamin, Alejandro Sedeño}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md17}{}\doxysubsection{\texorpdfstring{Changes between 3.\+0.\+3 and 3.\+0.\+4 \mbox{[}21 Jun 2022\mbox{]}}{Changes between 3.\+0.\+3 and 3.\+0.\+4 \mbox{[}21 Jun 2022\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md17}

\begin{DoxyItemize}
\item In addition to the c\+\_\+rehash shell command injection identified in CVE-\/2022-\/1292, further bugs where the c\+\_\+rehash script does not properly sanitise shell metacharacters to prevent command injection have been fixed.

When the CVE-\/2022-\/1292 was fixed it was not discovered that there are other places in the script where the file names of certificates being hashed were possibly passed to a command executed through the shell.

This script is distributed by some operating systems in a manner where it is automatically executed. On such operating systems, an attacker could execute arbitrary commands with the privileges of the script.

Use of the c\+\_\+rehash script is considered obsolete and should be replaced by the Open\+SSL rehash command line tool. (CVE-\/2022-\/2068)

{\itshape Daniel Fiala, Tomáš Mráz}
\item Case insensitive string comparison no longer uses locales. It has instead been directly implemented.

{\itshape Paul Dale}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md18}{}\doxysubsection{\texorpdfstring{Changes between 3.\+0.\+2 and 3.\+0.\+3 \mbox{[}3 May 2022\mbox{]}}{Changes between 3.\+0.\+2 and 3.\+0.\+3 \mbox{[}3 May 2022\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md18}

\begin{DoxyItemize}
\item Case insensitive string comparison is reimplemented via new locale-\/agnostic comparison functions OPENSSL\+\_\+str\mbox{[}n\mbox{]}casecmp always using the POSIX locale for comparison. The previous implementation had problems when the Turkish locale was used.

{\itshape Dmitry Belyavskiy}
\item Fixed a bug in the c\+\_\+rehash script which was not properly sanitising shell metacharacters to prevent command injection. This script is distributed by some operating systems in a manner where it is automatically executed. On such operating systems, an attacker could execute arbitrary commands with the privileges of the script.

Use of the c\+\_\+rehash script is considered obsolete and should be replaced by the Open\+SSL rehash command line tool. (CVE-\/2022-\/1292)

{\itshape Tomáš Mráz}
\item Fixed a bug in the function {\ttfamily OCSP\+\_\+basic\+\_\+verify} that verifies the signer certificate on an OCSP response. The bug caused the function in the case where the (non-\/default) flag OCSP\+\_\+\+NOCHECKS is used to return a postivie response (meaning a successful verification) even in the case where the response signing certificate fails to verify.

It is anticipated that most users of {\ttfamily OCSP\+\_\+basic\+\_\+verify} will not use the OCSP\+\_\+\+NOCHECKS flag. In this case the {\ttfamily OCSP\+\_\+basic\+\_\+verify} function will return a negative value (indicating a fatal error) in the case of a certificate verification failure. The normal expected return value in this case would be 0.

This issue also impacts the command line Open\+SSL "{}ocsp"{} application. When verifying an ocsp response with the "{}-\/no\+\_\+cert\+\_\+checks"{} option the command line application will report that the verification is successful even though it has in fact failed. In this case the incorrect successful response will also be accompanied by error messages showing the failure and contradicting the apparently successful result. (\mbox{[}CVE-\/2022-\/1343\mbox{]})

{\itshape Matt Caswell}
\item Fixed a bug where the RC4-\/\+MD5 ciphersuite incorrectly used the AAD data as the MAC key. This made the MAC key trivially predictable.

An attacker could exploit this issue by performing a man-\/in-\/the-\/middle attack to modify data being sent from one endpoint to an Open\+SSL 3.\+0 recipient such that the modified data would still pass the MAC integrity check.

Note that data sent from an Open\+SSL 3.\+0 endpoint to a non-\/\+Open\+SSL 3.\+0 endpoint will always be rejected by the recipient and the connection will fail at that point. Many application protocols require data to be sent from the client to the server first. Therefore, in such a case, only an Open\+SSL 3.\+0 server would be impacted when talking to a non-\/\+Open\+SSL 3.\+0 client.

If both endpoints are Open\+SSL 3.\+0 then the attacker could modify data being sent in both directions. In this case both clients and servers could be affected, regardless of the application protocol.

Note that in the absence of an attacker this bug means that an Open\+SSL 3.\+0 endpoint communicating with a non-\/\+Open\+SSL 3.\+0 endpoint will fail to complete the handshake when using this ciphersuite.

The confidentiality of data is not impacted by this issue, i.\+e. an attacker cannot decrypt data that has been encrypted using this ciphersuite -\/ they can only modify it.

In order for this attack to work both endpoints must legitimately negotiate the RC4-\/\+MD5 ciphersuite. This ciphersuite is not compiled by default in Open\+SSL 3.\+0, and is not available within the default provider or the default ciphersuite list. This ciphersuite will never be used if TLSv1.\+3 has been negotiated. In order for an Open\+SSL 3.\+0 endpoint to use this ciphersuite the following must have occurred\+:

1) Open\+SSL must have been compiled with the (non-\/default) compile time option enable-\/weak-\/ssl-\/ciphers

2) Open\+SSL must have had the legacy provider explicitly loaded (either through application code or via configuration)

3) The ciphersuite must have been explicitly added to the ciphersuite list

4) The libssl security level must have been set to 0 (default is 1)

5) A version of SSL/\+TLS below TLSv1.\+3 must have been negotiated

6) Both endpoints must negotiate the RC4-\/\+MD5 ciphersuite in preference to any others that both endpoints have in common (CVE-\/2022-\/1434)

{\itshape Matt Caswell}
\item Fix a bug in the OPENSSL\+\_\+\+LH\+\_\+flush() function that breaks reuse of the memory occupied by the removed hash table entries.

This function is used when decoding certificates or keys. If a long lived process periodically decodes certificates or keys its memory usage will expand without bounds and the process might be terminated by the operating system causing a denial of service. Also traversing the empty hash table entries will take increasingly more time.

Typically such long lived processes might be TLS clients or TLS servers configured to accept client certificate authentication. (CVE-\/2022-\/1473)

{\itshape Hugo Landau, Aliaksei Levin}
\item The functions {\ttfamily OPENSSL\+\_\+\+LH\+\_\+stats} and {\ttfamily OPENSSL\+\_\+\+LH\+\_\+stats\+\_\+bio} now only report the {\ttfamily num\+\_\+items}, {\ttfamily num\+\_\+nodes} and {\ttfamily num\+\_\+alloc\+\_\+nodes} statistics. All other statistics are no longer supported. For compatibility, these statistics are still listed in the output but are now always reported as zero.

{\itshape Hugo Landau}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md19}{}\doxysubsection{\texorpdfstring{Changes between 3.\+0.\+1 and 3.\+0.\+2 \mbox{[}15 Mar 2022\mbox{]}}{Changes between 3.\+0.\+1 and 3.\+0.\+2 \mbox{[}15 Mar 2022\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md19}

\begin{DoxyItemize}
\item Fixed a bug in the BN\+\_\+mod\+\_\+sqrt() function that can cause it to loop forever for non-\/prime moduli.

Internally this function is used when parsing certificates that contain elliptic curve public keys in compressed form or explicit elliptic curve parameters with a base point encoded in compressed form.

It is possible to trigger the infinite loop by crafting a certificate that has invalid explicit curve parameters.

Since certificate parsing happens prior to verification of the certificate signature, any process that parses an externally supplied certificate may thus be subject to a denial of service attack. The infinite loop can also be reached when parsing crafted private keys as they can contain explicit elliptic curve parameters.

Thus vulnerable situations include\+:
\begin{DoxyItemize}
\item TLS clients consuming server certificates
\item TLS servers consuming client certificates
\item Hosting providers taking certificates or private keys from customers
\item Certificate authorities parsing certification requests from subscribers
\item Anything else which parses ASN.\+1 elliptic curve parameters
\end{DoxyItemize}

Also any other applications that use the BN\+\_\+mod\+\_\+sqrt() where the attacker can control the parameter values are vulnerable to this DoS issue. (\mbox{[}CVE-\/2022-\/0778\mbox{]})

{\itshape Tomáš Mráz}
\item Add ciphersuites based on DHE\+\_\+\+PSK (RFC 4279) and ECDHE\+\_\+\+PSK (RFC 5489) to the list of ciphersuites providing Perfect Forward Secrecy as required by SECLEVEL \texorpdfstring{$>$}{>}= 3.

{\itshape Dmitry Belyavskiy, Nicola Tuveri}
\item Made the AES constant time code for no-\/asm configurations optional due to the resulting 95\% performance degradation. The AES constant time code can be enabled, for no assembly builds, with\+: ./config no-\/asm -\/DOPENSSL\+\_\+\+AES\+\_\+\+CONST\+\_\+\+TIME

{\itshape Paul Dale}
\item Fixed PEM\+\_\+write\+\_\+bio\+\_\+\+PKCS8\+Private\+Key() to make it possible to use empty passphrase strings.

{\itshape Darshan Sen}
\item The negative return value handling of the certificate verification callback was reverted. The replacement is to set the verification retry state with the SSL\+\_\+set\+\_\+retry\+\_\+verify() function.

{\itshape Tomáš Mráz}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md20}{}\doxysubsection{\texorpdfstring{Changes between 3.\+0.\+0 and 3.\+0.\+1 \mbox{[}14 Dec 2021\mbox{]}}{Changes between 3.\+0.\+0 and 3.\+0.\+1 \mbox{[}14 Dec 2021\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md20}

\begin{DoxyItemize}
\item Fixed invalid handling of X509\+\_\+verify\+\_\+cert() internal errors in libssl Internally libssl in Open\+SSL calls X509\+\_\+verify\+\_\+cert() on the client side to verify a certificate supplied by a server. That function may return a negative return value to indicate an internal error (for example out of memory). Such a negative return value is mishandled by Open\+SSL and will cause an IO function (such as SSL\+\_\+connect() or SSL\+\_\+do\+\_\+handshake()) to not indicate success and a subsequent call to SSL\+\_\+get\+\_\+error() to return the value SSL\+\_\+\+ERROR\+\_\+\+WANT\+\_\+\+RETRY\+\_\+\+VERIFY. This return value is only supposed to be returned by Open\+SSL if the application has previously called SSL\+\_\+\+CTX\+\_\+set\+\_\+cert\+\_\+verify\+\_\+callback(). Since most applications do not do this the SSL\+\_\+\+ERROR\+\_\+\+WANT\+\_\+\+RETRY\+\_\+\+VERIFY return value from SSL\+\_\+get\+\_\+error() will be totally unexpected and applications may not behave correctly as a result. The exact behaviour will depend on the application but it could result in crashes, infinite loops or other similar incorrect responses.

This issue is made more serious in combination with a separate bug in Open\+SSL 3.\+0 that will cause X509\+\_\+verify\+\_\+cert() to indicate an internal error when processing a certificate chain. This will occur where a certificate does not include the Subject Alternative Name extension but where a Certificate Authority has enforced name constraints. This issue can occur even with valid chains. (\mbox{[}CVE-\/2021-\/4044\mbox{]})

{\itshape Matt Caswell}
\item Corrected a few file name and file reference bugs in the build, installation and setup scripts, which lead to installation verification failures. Slightly enhanced the installation verification script.

{\itshape Richard Levitte}
\item Fixed EVP\+\_\+\+PKEY\+\_\+eq() to make it possible to use it with strictly private keys.

{\itshape Richard Levitte}
\item Fixed PVK encoder to properly query for the passphrase.

{\itshape Tomáš Mráz}
\item Multiple fixes in the OSSL\+\_\+\+HTTP API functions.

{\itshape David von Oheimb}
\item Allow sign extension in OSSL\+\_\+\+PARAM\+\_\+allocate\+\_\+from\+\_\+text() for the OSSL\+\_\+\+PARAM\+\_\+\+INTEGER data type and return error on negative numbers used with the OSSL\+\_\+\+PARAM\+\_\+\+UNSIGNED\+\_\+\+INTEGER data type. Make OSSL\+\_\+\+PARAM\+\_\+\+BLD\+\_\+push\+\_\+\+BN\{,\+\_\+pad\}() return an error on negative numbers.

{\itshape Richard Levitte}
\item Allow copying uninitialized digest contexts with EVP\+\_\+\+MD\+\_\+\+CTX\+\_\+copy\+\_\+ex.

{\itshape Tomáš Mráz}
\item Fixed detection of ARMv7 and ARM64 CPU features on Free\+BSD.

{\itshape Allan Jude}
\item Multiple threading fixes.

{\itshape Matt Caswell}
\item Added NULL digest implementation to keep compatibility with 1.\+1.\+1 version.

{\itshape Tomáš Mráz}
\item Allow fetching an operation from the provider that owns an unexportable key as a fallback if that is still allowed by the property query.

{\itshape Richard Levitte}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md21}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+1 and 3.\+0.\+0 \mbox{[}7 Sep 2021\mbox{]}}{Changes between 1.\+1.\+1 and 3.\+0.\+0 \mbox{[}7 Sep 2021\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md21}

\begin{DoxyItemize}
\item TLS\+\_\+\+MAX\+\_\+\+VERSION, DTLS\+\_\+\+MAX\+\_\+\+VERSION and DTLS\+\_\+\+MIN\+\_\+\+VERSION constants are now deprecated.

{\itshape Matt Caswell}
\item The {\ttfamily OPENSSL\+\_\+s390xcap} environment variable can be used to set bits in the S390X capability vector to zero. This simplifies testing of different code paths on S390X architecture.

{\itshape Patrick Steuer}
\item Encrypting more than 2\texorpdfstring{$^\wedge$}{\string^}64 TLS records with AES-\/\+GCM is disallowed as per FIPS 140-\/2 IG A.\+5 "{}\+Key/\+IV Pair Uniqueness Requirements from    SP 800-\/38\+D"{}. The communication will fail at this point.

{\itshape Paul Dale}
\item The EC\+\_\+\+GROUP\+\_\+clear\+\_\+free() function is deprecated as there is nothing confidential in EC\+\_\+\+GROUP data.

{\itshape Nicola Tuveri}
\item The byte order mark (BOM) character is ignored if encountered at the beginning of a PEM-\/formatted file.

{\itshape Dmitry Belyavskiy}
\item Added CMS support for the Russian GOST algorithms.

{\itshape Dmitry Belyavskiy}
\item Due to move of the implementation of cryptographic operations to the providers, validation of various operation parameters can be postponed until the actual operation is executed where previously it happened immediately when an operation parameter was set.

For example when setting an unsupported curve with EVP\+\_\+\+PKEY\+\_\+\+CTX\+\_\+set\+\_\+ec\+\_\+paramgen\+\_\+curve\+\_\+nid() this function call will not fail but later keygen operations with the EVP\+\_\+\+PKEY\+\_\+\+CTX will fail.

{\itshape Open\+SSL team members and many third party contributors}
\item The EVP\+\_\+get\+\_\+cipherbyname() function will return NULL for algorithms such as "{}\+AES-\/128-\/\+SIV"{}, "{}\+AES-\/128-\/\+CBC-\/\+CTS"{} and "{}\+CAMELLIA-\/128-\/\+CBC-\/\+CTS"{} which were previously only accessible via low-\/level interfaces. Use EVP\+\_\+\+CIPHER\+\_\+fetch() instead to retrieve these algorithms from a provider.

{\itshape Shane Lontis}
\item On build targets where the multilib postfix is set in the build configuration the libdir directory was changing based on whether the lib directory with the multilib postfix exists on the system or not. This unpredictable behavior was removed and eventual multilib postfix is now always added to the default libdir. Use {\ttfamily -\/-\/libdir=lib} to override the libdir if adding the postfix is undesirable.

{\itshape Jan Lána}
\item The triple DES key wrap functionality now conforms to RFC 3217 but is no longer interoperable with Open\+SSL 1.\+1.\+1.

{\itshape Paul Dale}
\item The ERR\+\_\+\+GET\+\_\+\+FUNC() function was removed. With the loss of meaningful function codes, this function can only cause problems for calling applications.

{\itshape Paul Dale}
\item Add a configurable flag to output date formats as ISO 8601. Does not change the default date format.

{\itshape William Edmisten}
\item Version of MSVC earlier than 1300 could get link warnings, which could be suppressed if the undocumented -\/DI\+\_\+\+CAN\+\_\+\+LIVE\+\_\+\+WITH\+\_\+\+LNK4049 was set. Support for this flag has been removed.

{\itshape Rich Salz}
\item Rework and make DEBUG macros consistent. Remove unused -\/DCONF\+\_\+\+DEBUG, -\/DBN\+\_\+\+CTX\+\_\+\+DEBUG, and REF\+\_\+\+PRINT. Add a new tracing category and use it for printing reference counts. Rename -\/DDEBUG\+\_\+\+UNUSED to -\/DUNUSED\+\_\+\+RESULT\+\_\+\+DEBUG Fix BN\+\_\+\+DEBUG\+\_\+\+RAND so it compiles and, when set, force DEBUG\+\_\+\+RAND to be set also. Rename engine\+\_\+debug\+\_\+ref to be ENGINE\+\_\+\+REF\+\_\+\+PRINT also for consistency.

{\itshape Rich Salz}
\item The signatures of the functions to get and set options on SSL and SSL\+\_\+\+CTX objects changed from "{}unsigned long"{} to "{}uint64\+\_\+t"{} type. Some source code changes may be required.

{\itshape Rich Salz}
\item The public definitions of conf\+\_\+method\+\_\+st and conf\+\_\+st have been deprecated. They will be made opaque in a future release.

{\itshape Rich Salz and Tomáš Mráz}
\item Client-\/initiated renegotiation is disabled by default. To allow it, use the -\/client\+\_\+renegotiation option, the SSL\+\_\+\+OP\+\_\+\+ALLOW\+\_\+\+CLIENT\+\_\+\+RENEGOTIATION flag, or the "{}\+Client\+Renegotiation"{} config parameter as appropriate.

{\itshape Rich Salz}
\item Add "{}abspath"{} and "{}includedir"{} pragma\textquotesingle{}s to config files, to prevent, or modify relative pathname inclusion.

{\itshape Rich Salz}
\item Open\+SSL includes a cryptographic module that is intended to be FIPS 140-\/2 validated. Please consult the README-\/\+FIPS and README-\/\+PROVIDERS files, as well as the migration guide.

{\itshape Open\+SSL team members and many third party contributors}
\item For the key types DH and DHX the allowed settable parameters are now different.

{\itshape Shane Lontis}
\item The openssl commands that read keys, certificates, and CRLs now automatically detect the PEM or DER format of the input files.

{\itshape David von Oheimb, Richard Levitte, and Tomáš Mráz}
\item Added enhanced PKCS\#12 APIs which accept a library context.

{\itshape Jon Spillett}
\item The default manual page suffix (\$\+MANSUFFIX) has been changed to "{}ossl"{}

{\itshape Matt Caswell}
\item Added support for Kernel TLS (KTLS).

{\itshape Boris Pismenny, John Baldwin and Andrew Gallatin}
\item Support for RFC 5746 secure renegotiation is now required by default for SSL or TLS connections to succeed.

{\itshape Benjamin Kaduk}
\item The signature of the {\ttfamily copy} functional parameter of the EVP\+\_\+\+PKEY\+\_\+meth\+\_\+set\+\_\+copy() function has changed so its {\ttfamily src} argument is now {\ttfamily const EVP\+\_\+\+PKEY\+\_\+\+CTX \texorpdfstring{$\ast$}{*}} instead of {\ttfamily EVP\+\_\+\+PKEY\+\_\+\+CTX \texorpdfstring{$\ast$}{*}}. Similarly the signature of the {\ttfamily pub\+\_\+decode} functional parameter of the EVP\+\_\+\+PKEY\+\_\+asn1\+\_\+set\+\_\+public() function has changed so its {\ttfamily pub} argument is now {\ttfamily const X509\+\_\+\+PUBKEY \texorpdfstring{$\ast$}{*}} instead of {\ttfamily X509\+\_\+\+PUBKEY \texorpdfstring{$\ast$}{*}}.

{\itshape David von Oheimb}
\item The error return values from some control calls (ctrl) have changed.

{\itshape Paul Dale}
\item A public key check is now performed during EVP\+\_\+\+PKEY\+\_\+derive\+\_\+set\+\_\+peer().

{\itshape Shane Lontis}
\item Many functions in the EVP\+\_\+ namespace that are getters of values from implementations or contexts were renamed to include get or get0 in their names. Old names are provided as macro aliases for compatibility and are not deprecated.

{\itshape Tomáš Mráz}
\item The EVP\+\_\+\+PKEY\+\_\+\+CTRL\+\_\+\+PKCS7\+\_\+\+ENCRYPT, EVP\+\_\+\+PKEY\+\_\+\+CTRL\+\_\+\+PKCS7\+\_\+\+DECRYPT, EVP\+\_\+\+PKEY\+\_\+\+CTRL\+\_\+\+PKCS7\+\_\+\+SIGN, EVP\+\_\+\+PKEY\+\_\+\+CTRL\+\_\+\+CMS\+\_\+\+ENCRYPT, EVP\+\_\+\+PKEY\+\_\+\+CTRL\+\_\+\+CMS\+\_\+\+DECRYPT, and EVP\+\_\+\+PKEY\+\_\+\+CTRL\+\_\+\+CMS\+\_\+\+SIGN control operations are deprecated.

{\itshape Tomáš Mráz}
\item The EVP\+\_\+\+PKEY\+\_\+public\+\_\+check() and EVP\+\_\+\+PKEY\+\_\+param\+\_\+check() functions now work for more key types.
\item The output from the command line applications may have minor changes.

{\itshape Paul Dale}
\item The output from numerous "{}printing"{} may have minor changes.

{\itshape David von Oheimb}
\item Windows thread synchronization uses read/write primitives (SRWLock) when supported by the OS, otherwise Critical\+Section continues to be used.

{\itshape Vincent Drake}
\item Add filter BIO BIO\+\_\+f\+\_\+readbuffer() that allows BIO\+\_\+tell() and BIO\+\_\+seek() to work on read only BIO source/sinks that do not support these functions. This allows piping or redirection of a file BIO using stdin to be buffered into memory. This is used internally in OSSL\+\_\+\+DECODER\+\_\+from\+\_\+bio().

{\itshape Shane Lontis}
\item OSSL\+\_\+\+STORE\+\_\+\+INFO\+\_\+get\+\_\+type() may now return an additional value. In 1.\+1.\+1 this function would return one of the values OSSL\+\_\+\+STORE\+\_\+\+INFO\+\_\+\+NAME, OSSL\+\_\+\+STORE\+\_\+\+INFO\+\_\+\+PKEY, OSSL\+\_\+\+STORE\+\_\+\+INFO\+\_\+\+PARAMS, OSSL\+\_\+\+STORE\+\_\+\+INFO\+\_\+\+CERT or OSSL\+\_\+\+STORE\+\_\+\+INFO\+\_\+\+CRL. Decoded public keys would previously have been reported as type OSSL\+\_\+\+STORE\+\_\+\+INFO\+\_\+\+PKEY in 1.\+1.\+1. In 3.\+0 decoded public keys are now reported as having the new type OSSL\+\_\+\+STORE\+\_\+\+INFO\+\_\+\+PUBKEY. Applications using this function should be amended to handle the changed return value.

{\itshape Richard Levitte}
\item Improved adherence to Enhanced Security Services (ESS, RFC 2634 and RFC 5035) for the TSP and CMS Advanced Electronic Signatures (CAd\+ES) implementations. As required by RFC 5035 check both ESSCert\+ID and ESSCert\+IDv2 if both present. Correct the semantics of checking the validation chain in case ESSCert\+ID\{,v2\} contains more than one certificate identifier\+: This means that all certificates referenced there MUST be part of the validation chain.

{\itshape David von Oheimb}
\item The implementation of older EVP ciphers related to CAST, IDEA, SEED, RC2, RC4, RC5, DESX and DES have been moved to the legacy provider.

{\itshape Matt Caswell}
\item The implementation of the EVP digests MD2, MD4, MDC2, WHIRLPOOL and RIPEMD-\/160 have been moved to the legacy provider.

{\itshape Matt Caswell}
\item The deprecated function EVP\+\_\+\+PKEY\+\_\+get0() now returns NULL being called for a provided key.

{\itshape Dmitry Belyavskiy}
\item The deprecated functions EVP\+\_\+\+PKEY\+\_\+get0\+\_\+\+RSA(), EVP\+\_\+\+PKEY\+\_\+get0\+\_\+\+DSA(), EVP\+\_\+\+PKEY\+\_\+get0\+\_\+\+EC\+\_\+\+KEY(), EVP\+\_\+\+PKEY\+\_\+get0\+\_\+\+DH(), EVP\+\_\+\+PKEY\+\_\+get0\+\_\+hmac(), EVP\+\_\+\+PKEY\+\_\+get0\+\_\+poly1305() and EVP\+\_\+\+PKEY\+\_\+get0\+\_\+siphash() as well as the similarly named "{}get1"{} functions behave differently in Open\+SSL 3.\+0.

{\itshape Matt Caswell}
\item A number of functions handling low-\/level keys or engines were deprecated including EVP\+\_\+\+PKEY\+\_\+set1\+\_\+engine(), EVP\+\_\+\+PKEY\+\_\+get0\+\_\+engine(), EVP\+\_\+\+PKEY\+\_\+assign(), EVP\+\_\+\+PKEY\+\_\+get0(), EVP\+\_\+\+PKEY\+\_\+get0\+\_\+hmac(), EVP\+\_\+\+PKEY\+\_\+get0\+\_\+poly1305() and EVP\+\_\+\+PKEY\+\_\+get0\+\_\+siphash().

{\itshape Matt Caswell}
\item PKCS\#5 PBKDF1 key derivation has been moved from PKCS5\+\_\+\+PBE\+\_\+keyivgen() into the legacy crypto provider as an EVP\+\_\+\+KDF. Applications requiring this KDF will need to load the legacy crypto provider. This includes these PBE algorithms which use this KDF\+:
\begin{DoxyItemize}
\item NID\+\_\+pbe\+With\+MD2\+And\+DES\+\_\+\+CBC
\item NID\+\_\+pbe\+With\+MD5\+And\+DES\+\_\+\+CBC
\item NID\+\_\+pbe\+With\+SHA1\+And\+RC2\+\_\+\+CBC
\item NID\+\_\+pbe\+With\+MD2\+And\+RC2\+\_\+\+CBC
\item NID\+\_\+pbe\+With\+MD5\+And\+RC2\+\_\+\+CBC
\item NID\+\_\+pbe\+With\+SHA1\+And\+DES\+\_\+\+CBC
\end{DoxyItemize}

{\itshape Jon Spillett}
\item Deprecated obsolete BIO\+\_\+set\+\_\+callback(), BIO\+\_\+get\+\_\+callback(), and BIO\+\_\+debug\+\_\+callback() functions.

{\itshape Tomáš Mráz}
\item Deprecated obsolete EVP\+\_\+\+PKEY\+\_\+\+CTX\+\_\+get0\+\_\+dh\+\_\+kdf\+\_\+ukm() and EVP\+\_\+\+PKEY\+\_\+\+CTX\+\_\+get0\+\_\+ecdh\+\_\+kdf\+\_\+ukm() functions.

{\itshape Tomáš Mráz}
\item The RAND\+\_\+\+METHOD APIs have been deprecated.

{\itshape Paul Dale}
\item The SRP APIs have been deprecated.

{\itshape Matt Caswell}
\item Add a compile time option to prevent the caching of provider fetched algorithms. This is enabled by including the no-\/cached-\/fetch option at configuration time.

{\itshape Paul Dale}
\item pkcs12 now uses defaults of PBKDF2, AES and SHA-\/256, with a MAC iteration count of PKCS12\+\_\+\+DEFAULT\+\_\+\+ITER.

{\itshape Tomáš Mráz and Sahana Prasad}
\item The openssl speed command does not use low-\/level API calls anymore.

{\itshape Tomáš Mráz}
\item Parallel dual-\/prime 1024-\/bit modular exponentiation for AVX512\+\_\+\+IFMA capable processors.

{\itshape Ilya Albrekht, Sergey Kirillov, Andrey Matyukov (Intel Corp)}
\item Combining the Configure options no-\/ec and no-\/dh no longer disables TLSv1.\+3.

{\itshape Matt Caswell}
\item Implemented support for fully "{}pluggable"{} TLSv1.\+3 groups. This means that providers may supply their own group implementations (using either the "{}key    exchange"{} or the "{}key encapsulation"{} methods) which will automatically be detected and used by libssl.

{\itshape Matt Caswell, Nicola Tuveri}
\item The undocumented function X509\+\_\+certificate\+\_\+type() has been deprecated;

{\itshape Rich Salz}
\item Deprecated the obsolete BN\+\_\+pseudo\+\_\+rand() and BN\+\_\+pseudo\+\_\+rand\+\_\+range().

{\itshape Tomáš Mráz}
\item Removed RSA padding mode for SSLv23 (which was only used for SSLv2). This includes the functions RSA\+\_\+padding\+\_\+check\+\_\+\+SSLv23() and RSA\+\_\+padding\+\_\+add\+\_\+\+SSLv23() and the {\ttfamily -\/ssl} option in the deprecated {\ttfamily rsautl} command.

{\itshape Rich Salz}
\item Deprecated the obsolete X9.\+31 RSA key generation related functions.
\item While a callback function set via {\ttfamily SSL\+\_\+\+CTX\+\_\+set\+\_\+cert\+\_\+verify\+\_\+callback()} is not allowed to return a value \texorpdfstring{$>$}{>} 1, this is no more taken as failure.

{\itshape Viktor Dukhovni and David von Oheimb}
\item Deprecated the obsolete X9.\+31 RSA key generation related functions BN\+\_\+\+X931\+\_\+generate\+\_\+\+Xpq(), BN\+\_\+\+X931\+\_\+derive\+\_\+prime\+\_\+ex(), and BN\+\_\+\+X931\+\_\+generate\+\_\+prime\+\_\+ex().

{\itshape Tomáš Mráz}
\item The default key generation method for the regular 2-\/prime RSA keys was changed to the FIPS 186-\/4 B.\+3.\+6 method.

{\itshape Shane Lontis}
\item Deprecated the BN\+\_\+is\+\_\+prime\+\_\+ex() and BN\+\_\+is\+\_\+prime\+\_\+fasttest\+\_\+ex() functions.

{\itshape Kurt Roeckx}
\item Deprecated EVP\+\_\+\+MD\+\_\+\+CTX\+\_\+set\+\_\+update\+\_\+fn() and EVP\+\_\+\+MD\+\_\+\+CTX\+\_\+update\+\_\+fn().

{\itshape Rich Salz}
\item Deprecated the type OCSP\+\_\+\+REQ\+\_\+\+CTX and the functions OCSP\+\_\+\+REQ\+\_\+\+CTX\+\_\+\texorpdfstring{$\ast$}{*}() and replaced with OSSL\+\_\+\+HTTP\+\_\+\+REQ\+\_\+\+CTX and the functions OSSL\+\_\+\+HTTP\+\_\+\+REQ\+\_\+\+CTX\+\_\+\texorpdfstring{$\ast$}{*}().

{\itshape Rich Salz, Richard Levitte, and David von Oheimb}
\item Deprecated {\ttfamily X509\+\_\+http\+\_\+nbio()} and {\ttfamily X509\+\_\+\+CRL\+\_\+http\+\_\+nbio()}.

{\itshape David von Oheimb}
\item Deprecated {\ttfamily OCSP\+\_\+parse\+\_\+url()}.

{\itshape David von Oheimb}
\item Validation of SM2 keys has been separated from the validation of regular EC keys.

{\itshape Nicola Tuveri}
\item Behavior of the {\ttfamily pkey} app is changed, when using the {\ttfamily -\/check} or {\ttfamily -\/pubcheck} switches\+: a validation failure triggers an early exit, returning a failure exit status to the parent process.

{\itshape Nicola Tuveri}
\item Changed behavior of SSL\+\_\+\+CTX\+\_\+set\+\_\+ciphersuites() and SSL\+\_\+set\+\_\+ciphersuites() to ignore unknown ciphers.

{\itshape Otto Hollmann}
\item The {\ttfamily -\/cipher-\/commands} and {\ttfamily -\/digest-\/commands} options of the command line utility {\ttfamily list} have been deprecated. Instead use the {\ttfamily -\/cipher-\/algorithms} and {\ttfamily -\/digest-\/algorithms} options.

{\itshape Dmitry Belyavskiy}
\item Added convenience functions for generating asymmetric key pairs\+: The \textquotesingle{}quick\textquotesingle{} one-\/shot (yet somewhat limited) function L$<$\+EVP\+\_\+\+PKEY\+\_\+\+Q\+\_\+keygen(3)$>$ and macros for the most common cases\+: \texorpdfstring{$<$}{<}EVP\+\_\+\+RSA\+\_\+gen(3)\texorpdfstring{$>$}{>} and L$<$\+EVP\+\_\+\+EC\+\_\+gen(3)$>$.

{\itshape David von Oheimb}
\item All of the low-\/level EC\+\_\+\+KEY functions have been deprecated.

{\itshape Shane Lontis, Paul Dale, Richard Levitte, and Tomáš Mráz}
\item Deprecated all the libcrypto and libssl error string loading functions.

{\itshape Richard Levitte}
\item The functions SSL\+\_\+\+CTX\+\_\+set\+\_\+tmp\+\_\+dh\+\_\+callback and SSL\+\_\+set\+\_\+tmp\+\_\+dh\+\_\+callback, as well as the macros SSL\+\_\+\+CTX\+\_\+set\+\_\+tmp\+\_\+dh() and SSL\+\_\+set\+\_\+tmp\+\_\+dh() have been deprecated.

{\itshape Matt Caswell}
\item The {\ttfamily -\/crypt} option to the {\ttfamily passwd} command line tool has been removed.

{\itshape Paul Dale}
\item The -\/C option to the {\ttfamily x509}, {\ttfamily dhparam}, {\ttfamily dsaparam}, and {\ttfamily ecparam} commands were removed.

{\itshape Rich Salz}
\item Add support for AES Key Wrap inverse ciphers to the EVP layer.

{\itshape Shane Lontis}
\item Deprecated EVP\+\_\+\+PKEY\+\_\+set1\+\_\+tls\+\_\+encodedpoint() and EVP\+\_\+\+PKEY\+\_\+get1\+\_\+tls\+\_\+encodedpoint().

{\itshape Matt Caswell}
\item The security callback, which can be customised by application code, supports the security operation SSL\+\_\+\+SECOP\+\_\+\+TMP\+\_\+\+DH. One location of the "{}other"{} parameter was incorrectly passing a DH object. It now passed an EVP\+\_\+\+PKEY in all cases.

{\itshape Matt Caswell}
\item Add PKCS7\+\_\+get\+\_\+octet\+\_\+string() and PKCS7\+\_\+type\+\_\+is\+\_\+other() to the public interface. Their functionality remains unchanged.

{\itshape Jordan Montgomery}
\item Added new option for \textquotesingle{}openssl list\textquotesingle{}, \textquotesingle{}-\/providers\textquotesingle{}, which will display the list of loaded providers, their names, version and status. It optionally displays their gettable parameters.

{\itshape Paul Dale}
\item Removed EVP\+\_\+\+PKEY\+\_\+set\+\_\+alias\+\_\+type().

{\itshape Richard Levitte}
\item Deprecated {\ttfamily EVP\+\_\+\+PKEY\+\_\+\+CTX\+\_\+set\+\_\+rsa\+\_\+keygen\+\_\+pubexp()} and introduced {\ttfamily EVP\+\_\+\+PKEY\+\_\+\+CTX\+\_\+set1\+\_\+rsa\+\_\+keygen\+\_\+pubexp()}, which is now preferred.

{\itshape Jeremy Walch}
\item Changed all "{}\+STACK"{} functions to be macros instead of inline functions. Macro parameters are still checked for type safety at compile time via helper inline functions.

{\itshape Matt Caswell}
\item Remove the RAND\+\_\+\+DRBG API

{\itshape Paul Dale and Matthias St. Pierre}
\item Allow {\ttfamily SSL\+\_\+set1\+\_\+host()} and {\ttfamily SSL\+\_\+add1\+\_\+host()} to take IP literal addresses as well as actual hostnames.

{\itshape David Woodhouse}
\item The \textquotesingle{}Min\+Protocol\textquotesingle{} and \textquotesingle{}Max\+Protocol\textquotesingle{} configuration commands now silently ignore TLS protocol version bounds when configuring DTLS-\/based contexts, and conversely, silently ignore DTLS protocol version bounds when configuring TLS-\/based contexts. The commands can be repeated to set bounds of both types. The same applies with the corresponding "{}min\+\_\+protocol"{} and "{}max\+\_\+protocol"{} command-\/line switches, in case some application uses both TLS and DTLS.

SSL\+\_\+\+CTX instances that are created for a fixed protocol version (e.\+g. {\ttfamily TLSv1\+\_\+server\+\_\+method()}) also silently ignore version bounds. Previously attempts to apply bounds to these protocol versions would result in an error. Now only the "{}version-\/flexible"{} SSL\+\_\+\+CTX instances are subject to limits in configuration files in command-\/line options.

{\itshape Viktor Dukhovni}
\item Deprecated the {\ttfamily ENGINE} API. Engines should be replaced with providers going forward.

{\itshape Paul Dale}
\item Reworked the recorded ERR codes to make better space for system errors. To distinguish them, the macro {\ttfamily ERR\+\_\+\+SYSTEM\+\_\+\+ERROR()} indicates if the given code is a system error (true) or an Open\+SSL error (false).

{\itshape Richard Levitte}
\item Reworked the test perl framework to better allow parallel testing.

{\itshape Nicola Tuveri and David von Oheimb}
\item Added ciphertext stealing algorithms AES-\/128-\/\+CBC-\/\+CTS, AES-\/192-\/\+CBC-\/\+CTS and AES-\/256-\/\+CBC-\/\+CTS to the providers. CS1, CS2 and CS3 variants are supported.

{\itshape Shane Lontis}
\item \textquotesingle{}Configure\textquotesingle{} has been changed to figure out the configuration target if none is given on the command line. Consequently, the \textquotesingle{}config\textquotesingle{} script is now only a mere wrapper. All documentation is changed to only mention \textquotesingle{}Configure\textquotesingle{}.

{\itshape Rich Salz and Richard Levitte}
\item Added a library context {\ttfamily OSSL\+\_\+\+LIB\+\_\+\+CTX} that applications as well as other libraries can use to form a separate context within which libcrypto operations are performed.

{\itshape Richard Levitte}
\item Added various {\ttfamily \+\_\+ex} functions to the Open\+SSL API that support using a non-\/default {\ttfamily OSSL\+\_\+\+LIB\+\_\+\+CTX}.

{\itshape Open\+SSL team}
\item Handshake now fails if Extended Master Secret extension is dropped on renegotiation.

{\itshape Tomáš Mráz}
\item Dropped interactive mode from the {\ttfamily openssl} program.

{\itshape Richard Levitte}
\item Deprecated {\ttfamily EVP\+\_\+\+PKEY\+\_\+cmp()} and {\ttfamily EVP\+\_\+\+PKEY\+\_\+cmp\+\_\+parameters()}.

{\itshape David von Oheimb and Shane Lontis}
\item Deprecated {\ttfamily EC\+\_\+\+METHOD\+\_\+get\+\_\+field\+\_\+type()}.

{\itshape Billy Bob Brumley}
\item Deprecated EC\+\_\+\+GFp\+\_\+simple\+\_\+method(), EC\+\_\+\+GFp\+\_\+mont\+\_\+method(), EC\+\_\+\+GF2m\+\_\+simple\+\_\+method(), EC\+\_\+\+GFp\+\_\+nist\+\_\+method(), EC\+\_\+\+GFp\+\_\+nistp224\+\_\+method() EC\+\_\+\+GFp\+\_\+nistp256\+\_\+method(), and EC\+\_\+\+GFp\+\_\+nistp521\+\_\+method().

{\itshape Billy Bob Brumley}
\item Deprecated EC\+\_\+\+GROUP\+\_\+new(), EC\+\_\+\+GROUP\+\_\+method\+\_\+of(), and EC\+\_\+\+POINT\+\_\+method\+\_\+of().

{\itshape Billy Bob Brumley}
\item Add CAd\+ES-\/\+BES signature verification support, mostly derived from ESSCert\+IDv2 TS (RFC 5816) contribution by Marek Klein.

{\itshape Filipe Raimundo da Silva}
\item Add CAd\+ES-\/\+BES signature scheme and attributes support (RFC 5126) to CMS API.

{\itshape Antonio Iacono}
\item Added the Auth\+Enveloped\+Data content type structure (RFC 5083) with AES-\/\+GCM parameter (RFC 5084) for the Cryptographic Message Syntax (CMS).

{\itshape Jakub Zelenka}
\item Deprecated EC\+\_\+\+POINT\+\_\+make\+\_\+affine() and EC\+\_\+\+POINTs\+\_\+make\+\_\+affine().

{\itshape Billy Bob Brumley}
\item Deprecated EC\+\_\+\+GROUP\+\_\+precompute\+\_\+mult(), EC\+\_\+\+GROUP\+\_\+have\+\_\+precompute\+\_\+mult(), and EC\+\_\+\+KEY\+\_\+precompute\+\_\+mult().

{\itshape Billy Bob Brumley}
\item Deprecated EC\+\_\+\+POINTs\+\_\+mul().

{\itshape Billy Bob Brumley}
\item Removed FIPS\+\_\+mode() and FIPS\+\_\+mode\+\_\+set().

{\itshape Shane Lontis}
\item The SSL option SSL\+\_\+\+OP\+\_\+\+IGNORE\+\_\+\+UNEXPECTED\+\_\+\+EOF is introduced.

{\itshape Dmitry Belyavskiy}
\item Deprecated EC\+\_\+\+POINT\+\_\+set\+\_\+\+Jprojective\+\_\+coordinates\+\_\+\+GFp() and EC\+\_\+\+POINT\+\_\+get\+\_\+\+Jprojective\+\_\+coordinates\+\_\+\+GFp().

{\itshape Billy Bob Brumley}
\item Added OSSL\+\_\+\+PARAM\+\_\+\+BLD to the public interface. This allows OSSL\+\_\+\+PARAM arrays to be more easily constructed via a series of utility functions. Create a parameter builder using OSSL\+\_\+\+PARAM\+\_\+\+BLD\+\_\+new(), add parameters using the various push functions and finally convert to a passable OSSL\+\_\+\+PARAM array using OSSL\+\_\+\+PARAM\+\_\+\+BLD\+\_\+to\+\_\+param().

{\itshape Paul Dale}
\item The security strength of SHA1 and MD5 based signatures in TLS has been reduced.

{\itshape Kurt Roeckx}
\item Added EVP\+\_\+\+PKEY\+\_\+set\+\_\+type\+\_\+by\+\_\+keymgmt(), to initialise an EVP\+\_\+\+PKEY to contain a provider side internal key.

{\itshape Richard Levitte}
\item ASN1\+\_\+verify(), ASN1\+\_\+digest() and ASN1\+\_\+sign() have been deprecated.

{\itshape Richard Levitte}
\item Project text documents not yet having a proper file name extension ({\ttfamily HACKING}, {\ttfamily LICENSE}, {\ttfamily NOTES\texorpdfstring{$\ast$}{*}}, {\ttfamily README\texorpdfstring{$\ast$}{*}}, {\ttfamily VERSION}) have been renamed to {\ttfamily \texorpdfstring{$\ast$}{*}.md} as far as reasonable, else {\ttfamily \texorpdfstring{$\ast$}{*}.txt}, for better use with file managers.

{\itshape David von Oheimb}
\item The main project documents (README, NEWS, CHANGES, INSTALL, SUPPORT) have been converted to Markdown with the goal to produce documents which not only look pretty when viewed online in the browser, but remain well readable inside a plain text editor.

To achieve this goal, a \textquotesingle{}minimalistic\textquotesingle{} Markdown style has been applied which avoids formatting elements that interfere too much with the reading flow in the text file. For example, it
\begin{DoxyItemize}
\item avoids \href{https://github.github.com/gfm/\#atx-headings}{\texttt{ ATX headings}} and uses \href{https://github.github.com/gfm/\#setext-headings}{\texttt{ setext headings}} instead (which works for {\ttfamily \texorpdfstring{$<$}{<}h1\texorpdfstring{$>$}{>}} and {\ttfamily \texorpdfstring{$<$}{<}h2\texorpdfstring{$>$}{>}} headings only).
\item avoids \href{https://github.github.com/gfm/\#inline-link}{\texttt{ inline links}} and uses \href{https://github.github.com/gfm/\#reference-link}{\texttt{ reference links}} instead.
\item avoids \href{https://github.github.com/gfm/\#fenced-code-blocks}{\texttt{ fenced code blocks}} and uses \href{https://github.github.com/gfm/\#indented-code-blocks}{\texttt{ indented code blocks}} instead.
\end{DoxyItemize}

{\itshape Matthias St. Pierre}
\item The test suite is changed to preserve results of each test recipe. A new directory test-\/runs/ with subdirectories named like the test recipes are created in the build tree for this purpose.

{\itshape Richard Levitte}
\item Added an implementation of CMP and CRMF (RFC 4210, RFC 4211 RFC 6712). This adds {\ttfamily crypto/cmp/}, {\ttfamily crpyto/crmf/}, {\ttfamily apps/cmp.\+c}, and {\ttfamily test/cmp\+\_\+\texorpdfstring{$\ast$}{*}}. See L\texorpdfstring{$<$}{<}openssl-\/cmp(1)\texorpdfstring{$>$}{>} and L$<$\+OSSL\+\_\+\+CMP\+\_\+exec\+\_\+\+IR\+\_\+ses(3)$>$ as starting points.

{\itshape David von Oheimb, Martin Peylo}
\item Generalized the HTTP client code from {\ttfamily crypto/ocsp/} into {\ttfamily crpyto/http/}. It supports arbitrary request and response content types, GET redirection, TLS, connections via HTTP(\+S) proxies, connections and exchange via user-\/defined BIOs (allowing implicit connections), persistent connections, and timeout checks. See L$<$\+OSSL\+\_\+\+HTTP\+\_\+transfer(3)$>$ etc. for details. The legacy OCSP-\/focused (and only partly documented) API is retained for backward compatibility, while most of it is deprecated.

{\itshape David von Oheimb}
\item Added {\ttfamily util/check-\/format.\+pl}, a tool for checking adherence to the Open\+SSL coding style \href{https://www.openssl.org/policies/codingstyle.html}{\texttt{ https\+://www.\+openssl.\+org/policies/codingstyle.\+html}}. The checks performed are incomplete and yield some false positives. Still the tool should be useful for detecting most typical glitches.

{\itshape David von Oheimb}
\item {\ttfamily BIO\+\_\+do\+\_\+connect()} and {\ttfamily BIO\+\_\+do\+\_\+handshake()} have been extended\+: If domain name resolution yields multiple IP addresses all of them are tried after {\ttfamily connect()} failures.

{\itshape David von Oheimb}
\item All of the low-\/level RSA functions have been deprecated.

{\itshape Paul Dale}
\item X509 certificates signed using SHA1 are no longer allowed at security level 1 and above.

{\itshape Kurt Roeckx}
\item The command line utilities dhparam, dsa, gendsa and dsaparam have been modified to use PKEY APIs. These commands are now in maintenance mode and no new features will be added to them.

{\itshape Paul Dale}
\item The command line utility rsautl has been deprecated.

{\itshape Paul Dale}
\item The command line utilities genrsa and rsa have been modified to use PKEY APIs. They now write PKCS\#8 keys by default. These commands are now in maintenance mode and no new features will be added to them.

{\itshape Paul Dale}
\item All of the low-\/level DH functions have been deprecated.

{\itshape Paul Dale and Matt Caswell}
\item All of the low-\/level DSA functions have been deprecated.

{\itshape Paul Dale}
\item Reworked the treatment of EC EVP\+\_\+\+PKEYs with the SM2 curve to automatically become EVP\+\_\+\+PKEY\+\_\+\+SM2 rather than EVP\+\_\+\+PKEY\+\_\+\+EC.

{\itshape Richard Levitte}
\item Deprecated low-\/level ECDH and ECDSA functions.

{\itshape Paul Dale}
\item Deprecated EVP\+\_\+\+PKEY\+\_\+decrypt\+\_\+old() and EVP\+\_\+\+PKEY\+\_\+encrypt\+\_\+old().

{\itshape Richard Levitte}
\item Enhanced the documentation of EVP\+\_\+\+PKEY\+\_\+get\+\_\+size(), EVP\+\_\+\+PKEY\+\_\+get\+\_\+bits() and EVP\+\_\+\+PKEY\+\_\+get\+\_\+security\+\_\+bits(). Especially EVP\+\_\+\+PKEY\+\_\+get\+\_\+size() needed a new formulation to include all the things it can be used for, as well as words of caution.

{\itshape Richard Levitte}
\item The SSL\+\_\+\+CTX\+\_\+set\+\_\+tlsext\+\_\+ticket\+\_\+key\+\_\+cb(3) function has been deprecated.

{\itshape Paul Dale}
\item All of the low-\/level HMAC functions have been deprecated.

{\itshape Paul Dale and David von Oheimb}
\item Over two thousand fixes were made to the documentation, including\+:
\begin{DoxyItemize}
\item Common options (such as -\/rand/-\/writerand, TLS version control, etc) were refactored and point to newly-\/enhanced descriptions in openssl.\+pod.
\item Added style conformance for all options (with help from Richard Levitte), documented all reported missing options, added a CI build to check that all options are documented and that no unimplemented options are documented.
\item Documented some internals, such as all use of environment variables.
\item Addressed all internal broken L$<$$>$ references.
\end{DoxyItemize}

{\itshape Rich Salz}
\item All of the low-\/level CMAC functions have been deprecated.

{\itshape Paul Dale}
\item The low-\/level MD2, MD4, MD5, MDC2, RIPEMD160 and Whirlpool digest functions have been deprecated.

{\itshape Paul Dale and David von Oheimb}
\item Corrected the documentation of the return values from the {\ttfamily EVP\+\_\+\+Digest\+Sign\texorpdfstring{$\ast$}{*}} set of functions. The documentation mentioned negative values for some errors, but this was never the case, so the mention of negative values was removed.

Code that followed the documentation and thereby check with something like {\ttfamily EVP\+\_\+\+Digest\+Sign\+Init(...) \texorpdfstring{$<$}{<}= 0} will continue to work undisturbed.

{\itshape Richard Levitte}
\item All of the low-\/level cipher functions have been deprecated.

{\itshape Matt Caswell and Paul Dale}
\item Removed include/openssl/opensslconf.\+h.\+in and replaced it with include/openssl/configuration.\+h.\+in, which differs in not including \texorpdfstring{$<$}{<}\doxylink{macros_8h_source}{openssl/macros.\+h}\texorpdfstring{$>$}{>}. A short header \doxylink{opensslconf_8h_source}{include/openssl/opensslconf.\+h} was added to include both.

This allows internal hacks where one might need to modify the set of configured macros, for example this if deprecated symbols are still supposed to be available internally\+: \begin{DoxyVerb}#include <openssl/configuration.h>

#undef OPENSSL_NO_DEPRECATED
#define OPENSSL_SUPPRESS_DEPRECATED

#include <openssl/macros.h>
\end{DoxyVerb}
 This should not be used by applications that use the exported symbols, as that will lead to linking errors.

{\itshape Richard Levitte}
\item Fixed an overflow bug in the x64\+\_\+64 Montgomery squaring procedure used in exponentiation with 512-\/bit moduli. No EC algorithms are affected. Analysis suggests that attacks against 2-\/prime RSA1024, 3-\/prime RSA1536, and DSA1024 as a result of this defect would be very difficult to perform and are not believed likely. Attacks against DH512 are considered just feasible. However, for an attack the target would have to reuse the DH512 private key, which is not recommended anyway. Also applications directly using the low-\/level API BN\+\_\+mod\+\_\+exp may be affected if they use BN\+\_\+\+FLG\+\_\+\+CONSTTIME. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2019-1551}{\texttt{ CVE-\/2019-\/1551}})

{\itshape Andy Polyakov}
\item Most memory-\/debug features have been deprecated, and the functionality replaced with no-\/ops.

{\itshape Rich Salz}
\item Added documentation for the STACK API.

{\itshape Rich Salz}
\item Introduced a new method type and API, OSSL\+\_\+\+ENCODER, to represent generic encoders. These do the same sort of job that PEM writers and d2i functions do, but with support for methods supplied by providers, and the possibility for providers to support other formats as well.

{\itshape Richard Levitte}
\item Introduced a new method type and API, OSSL\+\_\+\+DECODER, to represent generic decoders. These do the same sort of job that PEM readers and i2d functions do, but with support for methods supplied by providers, and the possibility for providers to support other formats as well.

{\itshape Richard Levitte}
\item Added a .pragma directive to the syntax of configuration files, to allow varying behavior in a supported and predictable manner. Currently added pragma\+: \begin{DoxyVerb}    .pragma dollarid:on
\end{DoxyVerb}
 This allows dollar signs to be a keyword character unless it\textquotesingle{}s followed by a opening brace or parenthesis. This is useful for platforms where dollar signs are commonly used in names, such as volume names and system directory names on VMS.

{\itshape Richard Levitte}
\item Added functionality to create an EVP\+\_\+\+PKEY from user data.

{\itshape Richard Levitte}
\item Change the interpretation of the \textquotesingle{}--api\textquotesingle{} configuration option to mean that this is a desired API compatibility level with no further meaning. The previous interpretation, that this would also mean to remove all deprecated symbols up to and including the given version, no requires that \textquotesingle{}no-\/deprecated\textquotesingle{} is also used in the configuration.

When building applications, the desired API compatibility level can be set with the OPENSSL\+\_\+\+API\+\_\+\+COMPAT macro like before. For API compatibility version below 3.\+0, the old style numerical value is valid as before, such as -\/DOPENSSL\+\_\+\+API\+\_\+\+COMPAT=0x10100000L. For version 3.\+0 and on, the value is expected to be the decimal value calculated from the major and minor version like this\+: \begin{DoxyVerb}    MAJOR * 10000 + MINOR * 100
\end{DoxyVerb}
 Examples\+: \begin{DoxyVerb}    -DOPENSSL_API_COMPAT=30000             For 3.0
    -DOPENSSL_API_COMPAT=30200             For 3.2
\end{DoxyVerb}
 To hide declarations that are deprecated up to and including the given API compatibility level, -\/DOPENSSL\+\_\+\+NO\+\_\+\+DEPRECATED must be given when building the application as well.

{\itshape Richard Levitte}
\item Added the X509\+\_\+\+LOOKUP\+\_\+\+METHOD called X509\+\_\+\+LOOKUP\+\_\+store, to allow access to certificate and CRL stores via URIs and OSSL\+\_\+\+STORE loaders.

This adds the following functions\+:
\begin{DoxyItemize}
\item X509\+\_\+\+LOOKUP\+\_\+store()
\item X509\+\_\+\+STORE\+\_\+load\+\_\+file()
\item X509\+\_\+\+STORE\+\_\+load\+\_\+path()
\item X509\+\_\+\+STORE\+\_\+load\+\_\+store()
\item SSL\+\_\+add\+\_\+store\+\_\+cert\+\_\+subjects\+\_\+to\+\_\+stack()
\item SSL\+\_\+\+CTX\+\_\+set\+\_\+default\+\_\+verify\+\_\+store()
\item SSL\+\_\+\+CTX\+\_\+load\+\_\+verify\+\_\+file()
\item SSL\+\_\+\+CTX\+\_\+load\+\_\+verify\+\_\+dir()
\item SSL\+\_\+\+CTX\+\_\+load\+\_\+verify\+\_\+store()
\end{DoxyItemize}

{\itshape Richard Levitte}
\item Added a new method to gather entropy on VMS, based on SYS\$\+GET\+\_\+\+ENTROPY. The presence of this system service is determined at run-\/time.

{\itshape Richard Levitte}
\item Added functionality to create an EVP\+\_\+\+PKEY context based on data for methods from providers. This takes an algorithm name and a property query string and simply stores them, with the intent that any operation that uses this context will use those strings to fetch the needed methods implicitly, thereby making the port of application written for pre-\/3.\+0 Open\+SSL easier.

{\itshape Richard Levitte}
\item The undocumented function NCONF\+\_\+\+WIN32() has been deprecated; for conversion details see the HISTORY section of doc/man5/config.\+pod

{\itshape Rich Salz}
\item Introduced the new functions EVP\+\_\+\+Digest\+Sign\+Init\+\_\+ex() and EVP\+\_\+\+Digest\+Verify\+Init\+\_\+ex(). The macros EVP\+\_\+\+Digest\+Sign\+Update() and EVP\+\_\+\+Digest\+Verify\+Update() have been converted to functions. See the man pages for further details.

{\itshape Matt Caswell}
\item Over two thousand fixes were made to the documentation, including\+: adding missing command flags, better style conformance, documentation of internals, etc.

{\itshape Rich Salz, Richard Levitte}
\item s390x assembly pack\+: add hardware-\/support for P-\/256, P-\/384, P-\/521, X25519, X448, Ed25519 and Ed448.

{\itshape Patrick Steuer}
\item Print all values for a PKCS\#12 attribute with \textquotesingle{}openssl pkcs12\textquotesingle{}, not just the first value.

{\itshape Jon Spillett}
\item Deprecated the public definition of {\ttfamily ERR\+\_\+\+STATE} as well as the function {\ttfamily ERR\+\_\+get\+\_\+state()}. This is done in preparation of making {\ttfamily ERR\+\_\+\+STATE} an opaque type.

{\itshape Richard Levitte}
\item Added ERR functionality to give callers access to the stored function names that have replaced the older function code based functions.

New functions are ERR\+\_\+peek\+\_\+error\+\_\+func(), ERR\+\_\+peek\+\_\+last\+\_\+error\+\_\+func(), ERR\+\_\+peek\+\_\+error\+\_\+data(), ERR\+\_\+peek\+\_\+last\+\_\+error\+\_\+data(), ERR\+\_\+get\+\_\+error\+\_\+all(), ERR\+\_\+peek\+\_\+error\+\_\+all() and ERR\+\_\+peek\+\_\+last\+\_\+error\+\_\+all().

Deprecate ERR functions ERR\+\_\+get\+\_\+error\+\_\+line(), ERR\+\_\+get\+\_\+error\+\_\+line\+\_\+data(), ERR\+\_\+peek\+\_\+error\+\_\+line\+\_\+data(), ERR\+\_\+peek\+\_\+last\+\_\+error\+\_\+line\+\_\+data() and ERR\+\_\+func\+\_\+error\+\_\+string().

{\itshape Richard Levitte}
\item Extended testing to be verbose for failing tests only. The make variables VERBOSE\+\_\+\+FAILURE or VF can be used to enable this\+: \begin{DoxyVerb}    $ make VF=1 test                           # Unix
    $ mms /macro=(VF=1) test                   ! OpenVMS
    $ nmake VF=1 test                          # Windows
\end{DoxyVerb}
 {\itshape Richard Levitte}
\item Added the {\ttfamily -\/copy\+\_\+extensions} option to the {\ttfamily x509} command for use with {\ttfamily -\/req} and {\ttfamily -\/x509toreq}. When given with the {\ttfamily copy} or {\ttfamily copyall} argument, all extensions in the request are copied to the certificate or vice versa.

{\itshape David von Oheimb}, \texorpdfstring{$\ast$}{*}\+Kirill Stefanenkov \href{mailto:kirill_stefanenkov@rambler.ru}{\texttt{ kirill\+\_\+stefanenkov@rambler.\+ru}}\texorpdfstring{$\ast$}{*}
\item Added the {\ttfamily -\/copy\+\_\+extensions} option to the {\ttfamily req} command for use with {\ttfamily -\/x509}. When given with the {\ttfamily copy} or {\ttfamily copyall} argument, all extensions in the certification request are copied to the certificate.

{\itshape David von Oheimb}
\item The {\ttfamily x509}, {\ttfamily req}, and {\ttfamily ca} commands now make sure that X.\+509v3 certificates they generate are by default RFC 5280 compliant in the following sense\+: There is a subject\+Key\+Identifier extension with a hash value of the public key and for not self-\/signed certs there is an authority\+Key\+Identifier extension with a key\+Identifier field or issuer information identifying the signing key. This is done unless some configuration overrides the new default behavior, such as {\ttfamily subject\+Key\+Identifier = none} and {\ttfamily authority\+Key\+Identifier = none}.

{\itshape David von Oheimb}
\item Added several checks to {\ttfamily X509\+\_\+verify\+\_\+cert()} according to requirements in RFC 5280 in case {\ttfamily X509\+\_\+\+V\+\_\+\+FLAG\+\_\+\+X509\+\_\+\+STRICT} is set (which may be done by using the CLI option {\ttfamily -\/x509\+\_\+strict})\+:
\begin{DoxyItemize}
\item The basic\+Constraints of CA certificates must be marked critical.
\item CA certificates must explicitly include the key\+Usage extension.
\item If a pathlen\+Constraint is given the key usage key\+Cert\+Sign must be allowed.
\item The issuer name of any certificate must not be empty.
\item The subject name of CA certs, certs with key\+Usage crl\+Sign, and certs without subject\+Alternative\+Name must not be empty.
\item If a subject\+Alternative\+Name extension is given it must not be empty.
\item The signature\+Algorithm field and the cert signature must be consistent.
\item Any given authority\+Key\+Identifier and any given subject\+Key\+Identifier must not be marked critical.
\item The authority\+Key\+Identifier must be given for X.\+509v3 certs unless they are self-\/signed.
\item The subject\+Key\+Identifier must be given for all X.\+509v3 CA certs.
\end{DoxyItemize}

{\itshape David von Oheimb}
\item Certificate verification using {\ttfamily X509\+\_\+verify\+\_\+cert()} meanwhile rejects EC keys with explicit curve parameters (specified\+Curve) as required by RFC 5480.

{\itshape Tomáš Mráz}
\item For built-\/in EC curves, ensure an EC\+\_\+\+GROUP built from the curve name is used even when parsing explicit parameters, when loading a encoded key or calling {\ttfamily EC\+\_\+\+GROUP\+\_\+new\+\_\+from\+\_\+ecpkparameters()}/ {\ttfamily EC\+\_\+\+GROUP\+\_\+new\+\_\+from\+\_\+ecparameters()}. This prevents bypass of security hardening and performance gains, especially for curves with specialized EC\+\_\+\+METHODs. By default, if a key encoded with explicit parameters is loaded and later encoded, the output is still encoded with explicit parameters, even if internally a "{}named"{} EC\+\_\+\+GROUP is used for computation.

{\itshape Nicola Tuveri}
\item Compute ECC cofactors if not provided during EC\+\_\+\+GROUP construction. Before this change, EC\+\_\+\+GROUP\+\_\+set\+\_\+generator would accept order and/or cofactor as NULL. After this change, only the cofactor parameter can be NULL. It also does some minimal sanity checks on the passed order. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2019-1547}{\texttt{ CVE-\/2019-\/1547}})

{\itshape Billy Bob Brumley}
\item Fixed a padding oracle in PKCS7\+\_\+data\+Decode and CMS\+\_\+decrypt\+\_\+set1\+\_\+pkey. An attack is simple, if the first CMS\+\_\+recipient\+Info is valid but the second CMS\+\_\+recipient\+Info is chosen ciphertext. If the second recipient\+Info decodes to PKCS \#1 v1.\+5 form plaintext, the correct encryption key will be replaced by garbage, and the message cannot be decoded, but if the RSA decryption fails, the correct encryption key is used and the recipient will not notice the attack. As a work around for this potential attack the length of the decrypted key must be equal to the cipher default key length, in case the certificate is not given and all recipient\+Info are tried out. The old behaviour can be re-\/enabled in the CMS code by setting the CMS\+\_\+\+DEBUG\+\_\+\+DECRYPT flag.

{\itshape Bernd Edlinger}
\item Early start up entropy quality from the DEVRANDOM seed source has been improved for older Linux systems. The RAND subsystem will wait for /dev/random to be producing output before seeding from /dev/urandom. The seeded state is stored for future library initialisations using a system global shared memory segment. The shared memory identifier can be configured by defining OPENSSL\+\_\+\+RAND\+\_\+\+SEED\+\_\+\+DEVRANDOM\+\_\+\+SHM\+\_\+\+ID to the desired value. The default identifier is 114.

{\itshape Paul Dale}
\item Revised BN\+\_\+generate\+\_\+prime\+\_\+ex to not avoid factors 2..17863 in p-\/1 when primes for RSA keys are computed. Since we previously always generated primes == 2 (mod 3) for RSA keys, the 2-\/prime and 3-\/prime RSA modules were easy to distinguish, since {\ttfamily N = p\texorpdfstring{$\ast$}{*}q = 1 (mod 3)}, but {\ttfamily N = p\texorpdfstring{$\ast$}{*}q\texorpdfstring{$\ast$}{*}r = 2 (mod 3)}. Therefore, fingerprinting 2-\/prime vs. 3-\/prime RSA keys was possible by computing N mod 3. This avoids possible fingerprinting of newly generated RSA modules.

{\itshape Bernd Edlinger}
\item Correct the extended master secret constant on EBCDIC systems. Without this fix TLS connections between an EBCDIC system and a non-\/\+EBCDIC system that negotiate EMS will fail. Unfortunately this also means that TLS connections between EBCDIC systems with this fix, and EBCDIC systems without this fix will fail if they negotiate EMS.

{\itshape Matt Caswell}
\item Changed the library initialisation so that the config file is now loaded by default. This was already the case for libssl. It now occurs for both libcrypto and libssl. Use the OPENSSL\+\_\+\+INIT\+\_\+\+NO\+\_\+\+LOAD\+\_\+\+CONFIG option to {\ttfamily OPENSSL\+\_\+init\+\_\+crypto()} to suppress automatic loading of a config file.

{\itshape Matt Caswell}
\item Introduced new error raising macros, {\ttfamily ERR\+\_\+raise()} and {\ttfamily ERR\+\_\+raise\+\_\+data()}, where the former acts as a replacement for {\ttfamily ERR\+\_\+put\+\_\+error()}, and the latter replaces the combination {\ttfamily ERR\+\_\+put\+\_\+error()} + {\ttfamily ERR\+\_\+add\+\_\+error\+\_\+data()}. {\ttfamily ERR\+\_\+raise\+\_\+data()} adds more flexibility by taking a format string and an arbitrary number of arguments following it, to be processed with {\ttfamily BIO\+\_\+snprintf()}.

{\itshape Richard Levitte}
\item Introduced a new function, {\ttfamily OSSL\+\_\+\+PROVIDER\+\_\+available()}, which can be used to check if a named provider is loaded and available. When called, it will also activate all fallback providers if such are still present.

{\itshape Richard Levitte}
\item Enforce a minimum DH modulus size of 512 bits.

{\itshape Bernd Edlinger}
\item Changed DH parameters to generate the order q subgroup instead of 2q. Previously generated DH parameters are still accepted by DH\+\_\+check but DH\+\_\+generate\+\_\+key works around that by clearing bit 0 of the private key for those. This avoids leaking bit 0 of the private key.

{\itshape Bernd Edlinger}
\item Significantly reduce secure memory usage by the randomness pools.

{\itshape Paul Dale}
\item {\ttfamily \{CRYPTO,OPENSSL\}\+\_\+mem\+\_\+debug\+\_\+\{push,pop\}} are now no-\/ops and have been deprecated.

{\itshape Rich Salz}
\item A new type, EVP\+\_\+\+KEYEXCH, has been introduced to represent key exchange algorithms. An implementation of a key exchange algorithm can be obtained by using the function EVP\+\_\+\+KEYEXCH\+\_\+fetch(). An EVP\+\_\+\+KEYEXCH algorithm can be used in a call to EVP\+\_\+\+PKEY\+\_\+derive\+\_\+init\+\_\+ex() which works in a similar way to the older EVP\+\_\+\+PKEY\+\_\+derive\+\_\+init() function. See the man pages for the new functions for further details.

{\itshape Matt Caswell}
\item The EVP\+\_\+\+PKEY\+\_\+\+CTX\+\_\+set\+\_\+dh\+\_\+pad() macro has now been converted to a function.

{\itshape Matt Caswell}
\item Removed the function names from error messages and deprecated the xxx\+\_\+\+F\+\_\+xxx define\textquotesingle{}s.

{\itshape Richard Levitte}
\item Removed Next\+Step support and the macro OPENSSL\+\_\+\+UNISTD

{\itshape Rich Salz}
\item Removed DES\+\_\+check\+\_\+key. Also removed OPENSSL\+\_\+\+IMPLEMENT\+\_\+\+GLOBAL, OPENSSL\+\_\+\+GLOBAL\+\_\+\+REF, OPENSSL\+\_\+\+DECLARE\+\_\+\+GLOBAL. Also removed "{}export var as function"{} capability; we do not export variables, only functions.

{\itshape Rich Salz}
\item RC5\+\_\+32\+\_\+set\+\_\+key has been changed to return an int type, with 0 indicating an error and 1 indicating success. In previous versions of Open\+SSL this was a void type. If a key was set longer than the maximum possible this would crash.

{\itshape Matt Caswell}
\item Support SM2 signing and verification schemes with X509 certificate.

{\itshape Paul Yang}
\item Use SHA256 as the default digest for TS query in the {\ttfamily ts} app.

{\itshape Tomáš Mráz}
\item Change PBKDF2 to conform to SP800-\/132 instead of the older PKCS5 RFC2898.

{\itshape Shane Lontis}
\item Default cipher lists/suites are now available via a function, the defines are deprecated.

{\itshape Todd Short}
\item Add target VC-\/\+WIN32-\/\+UWP, VC-\/\+WIN64\+A-\/\+UWP, VC-\/\+WIN32-\/\+ARM-\/\+UWP and VC-\/\+WIN64-\/\+ARM-\/\+UWP in Windows One\+Core target for making building libraries for Windows Store apps easier. Also, the "{}no-\/uplink"{} option has been added.

{\itshape Kenji Mouri}
\item Join the directories crypto/x509 and crypto/x509v3

{\itshape Richard Levitte}
\item Added command \textquotesingle{}openssl kdf\textquotesingle{} that uses the EVP\+\_\+\+KDF API.

{\itshape Shane Lontis}
\item Added command \textquotesingle{}openssl mac\textquotesingle{} that uses the EVP\+\_\+\+MAC API.

{\itshape Shane Lontis}
\item Added OPENSSL\+\_\+info() to get diverse built-\/in Open\+SSL data, such as default directories. Also added the command \textquotesingle{}openssl info\textquotesingle{} for scripting purposes.

{\itshape Richard Levitte}
\item The functions AES\+\_\+ige\+\_\+encrypt() and AES\+\_\+bi\+\_\+ige\+\_\+encrypt() have been deprecated.

{\itshape Matt Caswell}
\item Add prediction resistance to the DRBG reseeding process.

{\itshape Paul Dale}
\item Limit the number of blocks in a data unit for AES-\/\+XTS to 2\texorpdfstring{$^\wedge$}{\string^}20 as mandated by IEEE Std 1619-\/2018.

{\itshape Paul Dale}
\item Added newline escaping functionality to a filename when using openssl dgst. This output format is to replicate the output format found in the {\ttfamily \texorpdfstring{$\ast$}{*}sum} checksum programs. This aims to preserve backward compatibility.

{\itshape Matt Eaton, Richard Levitte, and Paul Dale}
\item Removed the heartbeat message in DTLS feature, as it has very little usage and doesn\textquotesingle{}t seem to fulfill a valuable purpose. The configuration option is now deprecated.

{\itshape Richard Levitte}
\item Changed the output of \textquotesingle{}openssl \{digestname\} \texorpdfstring{$<$}{<} file\textquotesingle{} to display the digest name in its output.

{\itshape Richard Levitte}
\item Added a new generic trace API which provides support for enabling instrumentation through trace output.

{\itshape Richard Levitte \& Matthias St. Pierre}
\item Added build tests for C++. These are generated files that only do one thing, to include one public Open\+SSL head file each. This tests that the public header files can be usefully included in a C++ application.

This test isn\textquotesingle{}t enabled by default. It can be enabled with the option \textquotesingle{}enable-\/buildtest-\/c++\textquotesingle{}.

{\itshape Richard Levitte}
\item Added KB KDF (EVP\+\_\+\+KDF\+\_\+\+KB) to EVP\+\_\+\+KDF.

{\itshape Robbie Harwood}
\item Added SSH KDF (EVP\+\_\+\+KDF\+\_\+\+SSHKDF) and KRB5 KDF (EVP\+\_\+\+KDF\+\_\+\+KRB5\+KDF) to EVP\+\_\+\+KDF.

{\itshape Simo Sorce}
\item Added Single Step KDF (EVP\+\_\+\+KDF\+\_\+\+SS), X963 KDF, and X942 KDF to EVP\+\_\+\+KDF.

{\itshape Shane Lontis}
\item Added KMAC to EVP\+\_\+\+MAC.

{\itshape Shane Lontis}
\item Added property based algorithm implementation selection framework to the core.

{\itshape Paul Dale}
\item Added SCA hardening for modular field inversion in EC\+\_\+\+GROUP through a new dedicated field\+\_\+inv() pointer in EC\+\_\+\+METHOD. This also addresses a leakage affecting conversions from projective to affine coordinates.

{\itshape Billy Bob Brumley, Nicola Tuveri}
\item Added EVP\+\_\+\+KDF, an EVP layer KDF API, to simplify adding KDF and PRF implementations. This includes an EVP\+\_\+\+PKEY to EVP\+\_\+\+KDF bridge for those algorithms that were already supported through the EVP\+\_\+\+PKEY API (scrypt, TLS1 PRF and HKDF). The low-\/level KDF functions for PBKDF2 and scrypt are now wrappers that call EVP\+\_\+\+KDF.

{\itshape David Makepeace}
\item Build devcrypto engine as a dynamic engine.

{\itshape Eneas U de Queiroz}
\item Add keyed BLAKE2 to EVP\+\_\+\+MAC.

{\itshape Antoine Salon}
\item Fix a bug in the computation of the endpoint-\/pair shared secret used by DTLS over SCTP. This breaks interoperability with older versions of Open\+SSL like Open\+SSL 1.\+1.\+0 and Open\+SSL 1.\+0.\+2. There is a runtime switch SSL\+\_\+\+MODE\+\_\+\+DTLS\+\_\+\+SCTP\+\_\+\+LABEL\+\_\+\+LENGTH\+\_\+\+BUG (off by default) enabling interoperability with such broken implementations. However, enabling this switch breaks interoperability with correct implementations.
\item Fix a use after free bug in d2i\+\_\+\+X509\+\_\+\+PUBKEY when overwriting a re-\/used X509\+\_\+\+PUBKEY object if the second PUBKEY is malformed.

{\itshape Bernd Edlinger}
\item Move strictness check from EVP\+\_\+\+PKEY\+\_\+asn1\+\_\+new() to EVP\+\_\+\+PKEY\+\_\+asn1\+\_\+add0().

{\itshape Richard Levitte}
\item Changed the license to the Apache License v2.\+0.

{\itshape Richard Levitte}
\item Switch to a new version scheme using three numbers MAJOR.\+MINOR.\+PATCH.
\begin{DoxyItemize}
\item Major releases (indicated by incrementing the MAJOR release number) may introduce incompatible API/\+ABI changes.
\item Minor releases (indicated by incrementing the MINOR release number) may introduce new features but retain API/\+ABI compatibility.
\item Patch releases (indicated by incrementing the PATCH number) are intended for bug fixes and other improvements of existing features only (like improving performance or adding documentation) and retain API/\+ABI compatibility.
\end{DoxyItemize}

{\itshape Richard Levitte}
\item Add support for RFC5297 SIV mode (siv128), including AES-\/\+SIV.

{\itshape Todd Short}
\item Remove the \textquotesingle{}dist\textquotesingle{} target and add a tarball building script. The \textquotesingle{}dist\textquotesingle{} target has fallen out of use, and it shouldn\textquotesingle{}t be necessary to configure just to create a source distribution.

{\itshape Richard Levitte}
\item Recreate the OS390-\/\+Unix config target. It no longer relies on a special script like it did for Open\+SSL pre-\/1.\+1.\+0.

{\itshape Richard Levitte}
\item Instead of having the source directories listed in Configure, add a \textquotesingle{}build.\+info\textquotesingle{} keyword SUBDIRS to indicate what sub-\/directories to look into.

{\itshape Richard Levitte}
\item Add GMAC to EVP\+\_\+\+MAC.

{\itshape Paul Dale}
\item Ported the HMAC, CMAC and Sip\+Hash EVP\+\_\+\+PKEY\+\_\+\+METHODs to EVP\+\_\+\+MAC.

{\itshape Richard Levitte}
\item Added EVP\+\_\+\+MAC, an EVP layer MAC API, to simplify adding MAC implementations. This includes a generic EVP\+\_\+\+PKEY to EVP\+\_\+\+MAC bridge, to facilitate the continued use of MACs through raw private keys in functionality such as {\ttfamily EVP\+\_\+\+Digest\+Sign\texorpdfstring{$\ast$}{*}} and {\ttfamily EVP\+\_\+\+Digest\+Verify\texorpdfstring{$\ast$}{*}}.

{\itshape Richard Levitte}
\item Deprecate ECDH\+\_\+\+KDF\+\_\+\+X9\+\_\+62().

{\itshape Antoine Salon}
\item Added EVP\+\_\+\+PKEY\+\_\+\+ECDH\+\_\+\+KDF\+\_\+\+X9\+\_\+63 and ecdh\+\_\+\+KDF\+\_\+\+X9\+\_\+63() as replacements for the EVP\+\_\+\+PKEY\+\_\+\+ECDH\+\_\+\+KDF\+\_\+\+X9\+\_\+62 KDF type and ECDH\+\_\+\+KDF\+\_\+\+X9\+\_\+62(). The old names are retained for backwards compatibility.

{\itshape Antoine Salon}
\item AES-\/\+XTS mode now enforces that its two keys are different to mitigate the attacked described in "{}\+Efficient Instantiations of Tweakable    Blockciphers and Refinements to Modes OCB and PMAC"{} by Phillip Rogaway. Details of this attack can be obtained from\+: \href{http://web.cs.ucdavis.edu/\%7Erogaway/papers/offsets.pdf}{\texttt{ http\+://web.\+cs.\+ucdavis.\+edu/\%7\+Erogaway/papers/offsets.\+pdf}}

{\itshape Paul Dale}
\item Rename the object files, i.\+e. give them other names than in previous versions. Their names now include the name of the final product, as well as its type mnemonic (bin, lib, shlib).

{\itshape Richard Levitte}
\item Added new option for \textquotesingle{}openssl list\textquotesingle{}, \textquotesingle{}-\/objects\textquotesingle{}, which will display the list of built in objects, i.\+e. OIDs with names.

{\itshape Richard Levitte}
\item Added the options {\ttfamily -\/crl\+\_\+lastupdate} and {\ttfamily -\/crl\+\_\+nextupdate} to {\ttfamily openssl ca}, allowing the {\ttfamily last\+Update} and {\ttfamily next\+Update} fields in the generated CRL to be set explicitly.

{\itshape Chris Novakovic}
\item Added support for Linux Kernel TLS data-\/path. The Linux Kernel data-\/path improves application performance by removing data copies and providing applications with zero-\/copy system calls such as sendfile and splice.

{\itshape Boris Pismenny}
\item The SSL option SSL\+\_\+\+OP\+\_\+\+CLEANSE\+\_\+\+PLAINTEXT is introduced.

{\itshape Martin Elshuber}
\item {\ttfamily PKCS12\+\_\+parse} now maintains the order of the parsed certificates when outputting them via {\ttfamily \texorpdfstring{$\ast$}{*}ca} (rather than reversing it).

{\itshape David von Oheimb}
\item Deprecated pthread fork support methods.

{\itshape Randall S. Becker}
\item Added support for FFDHE key exchange in TLS 1.\+3.

{\itshape Raja Ashok}
\item Added a new concept for Open\+SSL plugability\+: providers. This functionality is designed to replace the ENGINE API and ENGINE implementations, and to be much more dynamic, allowing provider authors to introduce new algorithms among other things, as long as there\textquotesingle{}s an API that supports the algorithm type.

With this concept comes a new core API for interaction between libcrypto and provider implementations. Public libcrypto functions that want to use providers do so through this core API.

The main documentation for this core API is found in doc/man7/provider.\+pod, doc/man7/provider-\/base.\+pod, and they in turn refer to other manuals describing the API specific for supported algorithm types (also called operations).

{\itshape The Open\+SSL team}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md22}{}\doxysection{\texorpdfstring{Open\+SSL 1.\+1.\+1}{Open\+SSL 1.\+1.\+1}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md22}
\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md23}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+1m and 1.\+1.\+1n \mbox{[}xx XXX xxxx\mbox{]}}{Changes between 1.\+1.\+1m and 1.\+1.\+1n \mbox{[}xx XXX xxxx\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md23}
\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md24}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+1l and 1.\+1.\+1m \mbox{[}14 Dec 2021\mbox{]}}{Changes between 1.\+1.\+1l and 1.\+1.\+1m \mbox{[}14 Dec 2021\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md24}

\begin{DoxyItemize}
\item Avoid loading of a dynamic engine twice.

{\itshape Bernd Edlinger}
\item Prioritise DANE TLSA issuer certs over peer certs

{\itshape Viktor Dukhovni}
\item Fixed random API for Mac\+OS prior to 10.\+12

These Mac\+OS versions don\textquotesingle{}t support the Common\+Crypto APIs

{\itshape Lenny Primak}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md25}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+1k and 1.\+1.\+1l \mbox{[}24 Aug 2021\mbox{]}}{Changes between 1.\+1.\+1k and 1.\+1.\+1l \mbox{[}24 Aug 2021\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md25}

\begin{DoxyItemize}
\item Fixed an SM2 Decryption Buffer Overflow.

In order to decrypt SM2 encrypted data an application is expected to call the API function EVP\+\_\+\+PKEY\+\_\+decrypt(). Typically an application will call this function twice. The first time, on entry, the "{}out"{} parameter can be NULL and, on exit, the "{}outlen"{} parameter is populated with the buffer size required to hold the decrypted plaintext. The application can then allocate a sufficiently sized buffer and call EVP\+\_\+\+PKEY\+\_\+decrypt() again, but this time passing a non-\/\+NULL value for the "{}out"{} parameter.

A bug in the implementation of the SM2 decryption code means that the calculation of the buffer size required to hold the plaintext returned by the first call to EVP\+\_\+\+PKEY\+\_\+decrypt() can be smaller than the actual size required by the second call. This can lead to a buffer overflow when EVP\+\_\+\+PKEY\+\_\+decrypt() is called by the application a second time with a buffer that is too small.

A malicious attacker who is able present SM2 content for decryption to an application could cause attacker chosen data to overflow the buffer by up to a maximum of 62 bytes altering the contents of other data held after the buffer, possibly changing application behaviour or causing the application to crash. The location of the buffer is application dependent but is typically heap allocated. (\mbox{[}CVE-\/2021-\/3711\mbox{]})

{\itshape Matt Caswell}
\item Fixed various read buffer overruns processing ASN.\+1 strings

ASN.\+1 strings are represented internally within Open\+SSL as an ASN1\+\_\+\+STRING structure which contains a buffer holding the string data and a field holding the buffer length. This contrasts with normal C strings which are represented as a buffer for the string data which is terminated with a NUL (0) byte.

Although not a strict requirement, ASN.\+1 strings that are parsed using Open\+SSL\textquotesingle{}s own "{}d2i"{} functions (and other similar parsing functions) as well as any string whose value has been set with the ASN1\+\_\+\+STRING\+\_\+set() function will additionally NUL terminate the byte array in the ASN1\+\_\+\+STRING structure.

However, it is possible for applications to directly construct valid ASN1\+\_\+\+STRING structures which do not NUL terminate the byte array by directly setting the "{}data"{} and "{}length"{} fields in the ASN1\+\_\+\+STRING array. This can also happen by using the ASN1\+\_\+\+STRING\+\_\+set0() function.

Numerous Open\+SSL functions that print ASN.\+1 data have been found to assume that the ASN1\+\_\+\+STRING byte array will be NUL terminated, even though this is not guaranteed for strings that have been directly constructed. Where an application requests an ASN.\+1 structure to be printed, and where that ASN.\+1 structure contains ASN1\+\_\+\+STRINGs that have been directly constructed by the application without NUL terminating the "{}data"{} field, then a read buffer overrun can occur.

The same thing can also occur during name constraints processing of certificates (for example if a certificate has been directly constructed by the application instead of loading it via the Open\+SSL parsing functions, and the certificate contains non NUL terminated ASN1\+\_\+\+STRING structures). It can also occur in the X509\+\_\+get1\+\_\+email(), X509\+\_\+\+REQ\+\_\+get1\+\_\+email() and X509\+\_\+get1\+\_\+ocsp() functions.

If a malicious actor can cause an application to directly construct an ASN1\+\_\+\+STRING and then process it through one of the affected Open\+SSL functions then this issue could be hit. This might result in a crash (causing a Denial of Service attack). It could also result in the disclosure of private memory contents (such as private keys, or sensitive plaintext). (\mbox{[}CVE-\/2021-\/3712\mbox{]})

{\itshape Matt Caswell}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md26}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+1j and 1.\+1.\+1k \mbox{[}25 Mar 2021\mbox{]}}{Changes between 1.\+1.\+1j and 1.\+1.\+1k \mbox{[}25 Mar 2021\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md26}

\begin{DoxyItemize}
\item Fixed a problem with verifying a certificate chain when using the X509\+\_\+\+V\+\_\+\+FLAG\+\_\+\+X509\+\_\+\+STRICT flag. This flag enables additional security checks of the certificates present in a certificate chain. It is not set by default.

Starting from Open\+SSL version 1.\+1.\+1h a check to disallow certificates in the chain that have explicitly encoded elliptic curve parameters was added as an additional strict check.

An error in the implementation of this check meant that the result of a previous check to confirm that certificates in the chain are valid CA certificates was overwritten. This effectively bypasses the check that non-\/\+CA certificates must not be able to issue other certificates.

If a "{}purpose"{} has been configured then there is a subsequent opportunity for checks that the certificate is a valid CA. All of the named "{}purpose"{} values implemented in libcrypto perform this check. Therefore, where a purpose is set the certificate chain will still be rejected even when the strict flag has been used. A purpose is set by default in libssl client and server certificate verification routines, but it can be overridden or removed by an application.

In order to be affected, an application must explicitly set the X509\+\_\+\+V\+\_\+\+FLAG\+\_\+\+X509\+\_\+\+STRICT verification flag and either not set a purpose for the certificate verification or, in the case of TLS client or server applications, override the default purpose. (\mbox{[}CVE-\/2021-\/3450\mbox{]})

{\itshape Tomáš Mráz}
\item Fixed an issue where an Open\+SSL TLS server may crash if sent a maliciously crafted renegotiation Client\+Hello message from a client. If a TLSv1.\+2 renegotiation Client\+Hello omits the signature\+\_\+algorithms extension (where it was present in the initial Client\+Hello), but includes a signature\+\_\+algorithms\+\_\+cert extension then a NULL pointer dereference will result, leading to a crash and a denial of service attack.

A server is only vulnerable if it has TLSv1.\+2 and renegotiation enabled (which is the default configuration). Open\+SSL TLS clients are not impacted by this issue. (\mbox{[}CVE-\/2021-\/3449\mbox{]})

{\itshape Peter Kästle and Samuel Sapalski}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md27}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+1i and 1.\+1.\+1j \mbox{[}16 Feb 2021\mbox{]}}{Changes between 1.\+1.\+1i and 1.\+1.\+1j \mbox{[}16 Feb 2021\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md27}

\begin{DoxyItemize}
\item Fixed the X509\+\_\+issuer\+\_\+and\+\_\+serial\+\_\+hash() function. It attempts to create a unique hash value based on the issuer and serial number data contained within an X509 certificate. However, it was failing to correctly handle any errors that may occur while parsing the issuer field (which might occur if the issuer field is maliciously constructed). This may subsequently result in a NULL pointer deref and a crash leading to a potential denial of service attack. (\mbox{[}CVE-\/2021-\/23841\mbox{]})

{\itshape Matt Caswell}
\item Fixed the RSA\+\_\+padding\+\_\+check\+\_\+\+SSLv23() function and the RSA\+\_\+\+SSLV23\+\_\+\+PADDING padding mode to correctly check for rollback attacks. This is considered a bug in Open\+SSL 1.\+1.\+1 because it does not support SSLv2. In 1.\+0.\+2 this is CVE-\/2021-\/23839.

{\itshape Matt Caswell}

Fixed the EVP\+\_\+\+Cipher\+Update, EVP\+\_\+\+Encrypt\+Update and EVP\+\_\+\+Decrypt\+Update functions. Previously they could overflow the output length argument in some cases where the input length is close to the maximum permissible length for an integer on the platform. In such cases the return value from the function call would be 1 (indicating success), but the output length value would be negative. This could cause applications to behave incorrectly or crash. (\mbox{[}CVE-\/2021-\/23840\mbox{]})

{\itshape Matt Caswell}
\item Fixed SRP\+\_\+\+Calc\+\_\+client\+\_\+key so that it runs in constant time. The previous implementation called BN\+\_\+mod\+\_\+exp without setting BN\+\_\+\+FLG\+\_\+\+CONSTTIME. This could be exploited in a side channel attack to recover the password. Since the attack is local host only this is outside of the current Open\+SSL threat model and therefore no CVE is assigned.

Thanks to Mohammed Sabt and Daniel De Almeida Braga for reporting this issue.

{\itshape Matt Caswell}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md28}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+1h and 1.\+1.\+1i \mbox{[}8 Dec 2020\mbox{]}}{Changes between 1.\+1.\+1h and 1.\+1.\+1i \mbox{[}8 Dec 2020\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md28}

\begin{DoxyItemize}
\item Fixed NULL pointer deref in the GENERAL\+\_\+\+NAME\+\_\+cmp function This function could crash if both GENERAL\+\_\+\+NAMEs contain an EDIPARTYNAME. If an attacker can control both items being compared then this could lead to a possible denial of service attack. Open\+SSL itself uses the GENERAL\+\_\+\+NAME\+\_\+cmp function for two purposes\+: 1) Comparing CRL distribution point names between an available CRL and a CRL distribution point embedded in an X509 certificate 2) When verifying that a timestamp response token signer matches the timestamp authority name (exposed via the API functions TS\+\_\+\+RESP\+\_\+verify\+\_\+response and TS\+\_\+\+RESP\+\_\+verify\+\_\+token) (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2020-1971}{\texttt{ CVE-\/2020-\/1971}})

{\itshape Matt Caswell}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md29}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+1g and 1.\+1.\+1h \mbox{[}22 Sep 2020\mbox{]}}{Changes between 1.\+1.\+1g and 1.\+1.\+1h \mbox{[}22 Sep 2020\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md29}

\begin{DoxyItemize}
\item Certificates with explicit curve parameters are now disallowed in verification chains if the X509\+\_\+\+V\+\_\+\+FLAG\+\_\+\+X509\+\_\+\+STRICT flag is used.

{\itshape Tomáš Mráz}
\item The \textquotesingle{}Min\+Protocol\textquotesingle{} and \textquotesingle{}Max\+Protocol\textquotesingle{} configuration commands now silently ignore TLS protocol version bounds when configuring DTLS-\/based contexts, and conversely, silently ignore DTLS protocol version bounds when configuring TLS-\/based contexts. The commands can be repeated to set bounds of both types. The same applies with the corresponding "{}min\+\_\+protocol"{} and "{}max\+\_\+protocol"{} command-\/line switches, in case some application uses both TLS and DTLS.

SSL\+\_\+\+CTX instances that are created for a fixed protocol version (e.\+g. TLSv1\+\_\+server\+\_\+method()) also silently ignore version bounds. Previously attempts to apply bounds to these protocol versions would result in an error. Now only the "{}version-\/flexible"{} SSL\+\_\+\+CTX instances are subject to limits in configuration files in command-\/line options.

{\itshape Viktor Dukhovni}
\item Handshake now fails if Extended Master Secret extension is dropped on renegotiation.

{\itshape Tomáš Mráz}
\item The Oracle Developer Studio compiler will start reporting deprecated APIs
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md30}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+1f and 1.\+1.\+1g \mbox{[}21 Apr 2020\mbox{]}}{Changes between 1.\+1.\+1f and 1.\+1.\+1g \mbox{[}21 Apr 2020\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md30}

\begin{DoxyItemize}
\item Fixed segmentation fault in SSL\+\_\+check\+\_\+chain() Server or client applications that call the SSL\+\_\+check\+\_\+chain() function during or after a TLS 1.\+3 handshake may crash due to a NULL pointer dereference as a result of incorrect handling of the "{}signature\+\_\+algorithms\+\_\+cert"{} TLS extension. The crash occurs if an invalid or unrecognised signature algorithm is received from the peer. This could be exploited by a malicious peer in a Denial of Service attack. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2020-1967}{\texttt{ CVE-\/2020-\/1967}})

{\itshape Benjamin Kaduk}
\item Added AES consttime code for no-\/asm configurations an optional constant time support for AES was added when building openssl for no-\/asm. Enable with\+: ./config no-\/asm -\/DOPENSSL\+\_\+\+AES\+\_\+\+CONST\+\_\+\+TIME Disable with\+: ./config no-\/asm -\/DOPENSSL\+\_\+\+NO\+\_\+\+AES\+\_\+\+CONST\+\_\+\+TIME At this time this feature is by default disabled. It will be enabled by default in 3.\+0.

{\itshape Bernd Edlinger}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md31}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+1e and 1.\+1.\+1f \mbox{[}31 Mar 2020\mbox{]}}{Changes between 1.\+1.\+1e and 1.\+1.\+1f \mbox{[}31 Mar 2020\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md31}

\begin{DoxyItemize}
\item Revert the change of EOF detection while reading in libssl to avoid regressions in applications depending on the current way of reporting the EOF. As the existing method is not fully accurate the change to reporting the EOF via SSL\+\_\+\+ERROR\+\_\+\+SSL is kept on the current development branch and will be present in the 3.\+0 release.

{\itshape Tomáš Mráz}
\item Revised BN\+\_\+generate\+\_\+prime\+\_\+ex to not avoid factors 3..17863 in p-\/1 when primes for RSA keys are computed. Since we previously always generated primes == 2 (mod 3) for RSA keys, the 2-\/prime and 3-\/prime RSA modules were easy to distinguish, since N = p\texorpdfstring{$\ast$}{*}q = 1 (mod 3), but N = p\texorpdfstring{$\ast$}{*}q\texorpdfstring{$\ast$}{*}r = 2 (mod 3). Therefore, fingerprinting 2-\/prime vs. 3-\/prime RSA keys was possible by computing N mod 3. This avoids possible fingerprinting of newly generated RSA modules.

{\itshape Bernd Edlinger}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md32}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+1d and 1.\+1.\+1e \mbox{[}17 Mar 2020\mbox{]}}{Changes between 1.\+1.\+1d and 1.\+1.\+1e \mbox{[}17 Mar 2020\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md32}

\begin{DoxyItemize}
\item Properly detect EOF while reading in libssl. Previously if we hit an EOF while reading in libssl then we would report an error back to the application (SSL\+\_\+\+ERROR\+\_\+\+SYSCALL) but errno would be 0. We now add an error to the stack (which means we instead return SSL\+\_\+\+ERROR\+\_\+\+SSL) and therefore give a hint as to what went wrong.

{\itshape Matt Caswell}
\item Check that ed25519 and ed448 are allowed by the security level. Previously signature algorithms not using an MD were not being checked that they were allowed by the security level.

{\itshape Kurt Roeckx}
\item Fixed SSL\+\_\+get\+\_\+servername() behaviour. The behaviour of SSL\+\_\+get\+\_\+servername() was not quite right. The behaviour was not consistent between resumption and normal handshakes, and also not quite consistent with historical behaviour. The behaviour in various scenarios has been clarified and it has been updated to make it match historical behaviour as closely as possible.

{\itshape Matt Caswell}
\item {\itshape \mbox{[}VMS only\mbox{]}} The header files that the VMS compilers include automatically, {\ttfamily \+\_\+\+\_\+\+DECC\+\_\+\+INCLUDE\+\_\+\+PROLOGUE.\+H} and {\ttfamily \+\_\+\+\_\+\+DECC\+\_\+\+INCLUDE\+\_\+\+EPILOGUE.\+H}, use pragmas that the C++ compiler doesn\textquotesingle{}t understand. This is a shortcoming in the compiler, but can be worked around with {\ttfamily \+\_\+\+\_\+cplusplus} guards.

C++ applications that use Open\+SSL libraries must be compiled using the qualifier {\ttfamily /\+NAMES=(AS\+\_\+\+IS,SHORTENED)} to be able to use all the Open\+SSL functions. Otherwise, only functions with symbols of less than 31 characters can be used, as the linker will not be able to successfully resolve symbols with longer names.

{\itshape Richard Levitte}
\item Added a new method to gather entropy on VMS, based on SYS\$\+GET\+\_\+\+ENTROPY. The presence of this system service is determined at run-\/time.

{\itshape Richard Levitte}
\item Print all values for a PKCS\#12 attribute with \textquotesingle{}openssl pkcs12\textquotesingle{}, not just the first value.

{\itshape Jon Spillett}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md33}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+1c and 1.\+1.\+1d \mbox{[}10 Sep 2019\mbox{]}}{Changes between 1.\+1.\+1c and 1.\+1.\+1d \mbox{[}10 Sep 2019\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md33}

\begin{DoxyItemize}
\item Fixed a fork protection issue. Open\+SSL 1.\+1.\+1 introduced a rewritten random number generator (RNG). This was intended to include protection in the event of a fork() system call in order to ensure that the parent and child processes did not share the same RNG state. However, this protection was not being used in the default case.

A partial mitigation for this issue is that the output from a high precision timer is mixed into the RNG state so the likelihood of a parent and child process sharing state is significantly reduced.

If an application already calls OPENSSL\+\_\+init\+\_\+crypto() explicitly using OPENSSL\+\_\+\+INIT\+\_\+\+ATFORK then this problem does not occur at all. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2019-1549}{\texttt{ CVE-\/2019-\/1549}})

{\itshape Matthias St. Pierre}
\item For built-\/in EC curves, ensure an EC\+\_\+\+GROUP built from the curve name is used even when parsing explicit parameters, when loading a encoded key or calling {\ttfamily EC\+\_\+\+GROUP\+\_\+new\+\_\+from\+\_\+ecpkparameters()}/ {\ttfamily EC\+\_\+\+GROUP\+\_\+new\+\_\+from\+\_\+ecparameters()}. This prevents bypass of security hardening and performance gains, especially for curves with specialized EC\+\_\+\+METHODs. By default, if a key encoded with explicit parameters is loaded and later encoded, the output is still encoded with explicit parameters, even if internally a "{}named"{} EC\+\_\+\+GROUP is used for computation.

{\itshape Nicola Tuveri}
\item Compute ECC cofactors if not provided during EC\+\_\+\+GROUP construction. Before this change, EC\+\_\+\+GROUP\+\_\+set\+\_\+generator would accept order and/or cofactor as NULL. After this change, only the cofactor parameter can be NULL. It also does some minimal sanity checks on the passed order. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2019-1547}{\texttt{ CVE-\/2019-\/1547}})

{\itshape Billy Bob Brumley}
\item Fixed a padding oracle in PKCS7\+\_\+data\+Decode and CMS\+\_\+decrypt\+\_\+set1\+\_\+pkey. An attack is simple, if the first CMS\+\_\+recipient\+Info is valid but the second CMS\+\_\+recipient\+Info is chosen ciphertext. If the second recipient\+Info decodes to PKCS \#1 v1.\+5 form plaintext, the correct encryption key will be replaced by garbage, and the message cannot be decoded, but if the RSA decryption fails, the correct encryption key is used and the recipient will not notice the attack. As a work around for this potential attack the length of the decrypted key must be equal to the cipher default key length, in case the certificate is not given and all recipient\+Info are tried out. The old behaviour can be re-\/enabled in the CMS code by setting the CMS\+\_\+\+DEBUG\+\_\+\+DECRYPT flag. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2019-1563}{\texttt{ CVE-\/2019-\/1563}})

{\itshape Bernd Edlinger}
\item Early start up entropy quality from the DEVRANDOM seed source has been improved for older Linux systems. The RAND subsystem will wait for /dev/random to be producing output before seeding from /dev/urandom. The seeded state is stored for future library initialisations using a system global shared memory segment. The shared memory identifier can be configured by defining OPENSSL\+\_\+\+RAND\+\_\+\+SEED\+\_\+\+DEVRANDOM\+\_\+\+SHM\+\_\+\+ID to the desired value. The default identifier is 114.

{\itshape Paul Dale}
\item Correct the extended master secret constant on EBCDIC systems. Without this fix TLS connections between an EBCDIC system and a non-\/\+EBCDIC system that negotiate EMS will fail. Unfortunately this also means that TLS connections between EBCDIC systems with this fix, and EBCDIC systems without this fix will fail if they negotiate EMS.

{\itshape Matt Caswell}
\item Use Windows installation paths in the mingw builds

Mingw isn\textquotesingle{}t a POSIX environment per se, which means that Windows paths should be used for installation. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2019-1552}{\texttt{ CVE-\/2019-\/1552}})

{\itshape Richard Levitte}
\item Changed DH\+\_\+check to accept parameters with order q and 2q subgroups. With order 2q subgroups the bit 0 of the private key is not secret but DH\+\_\+generate\+\_\+key works around that by clearing bit 0 of the private key for those. This avoids leaking bit 0 of the private key.

{\itshape Bernd Edlinger}
\item Significantly reduce secure memory usage by the randomness pools.

{\itshape Paul Dale}
\item Revert the DEVRANDOM\+\_\+\+WAIT feature for Linux systems

The DEVRANDOM\+\_\+\+WAIT feature added a select() call to wait for the /dev/random device to become readable before reading from the /dev/urandom device.

It turned out that this change had negative side effects on performance which were not acceptable. After some discussion it was decided to revert this feature and leave it up to the OS resp. the platform maintainer to ensure a proper initialization during early boot time.

{\itshape Matthias St. Pierre}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md34}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+1b and 1.\+1.\+1c \mbox{[}28 May 2019\mbox{]}}{Changes between 1.\+1.\+1b and 1.\+1.\+1c \mbox{[}28 May 2019\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md34}

\begin{DoxyItemize}
\item Add build tests for C++. These are generated files that only do one thing, to include one public Open\+SSL head file each. This tests that the public header files can be usefully included in a C++ application.

This test isn\textquotesingle{}t enabled by default. It can be enabled with the option \textquotesingle{}enable-\/buildtest-\/c++\textquotesingle{}.

{\itshape Richard Levitte}
\item Enable SHA3 pre-\/hashing for ECDSA and DSA.

{\itshape Patrick Steuer}
\item Change the default RSA, DSA and DH size to 2048 bit instead of 1024. This changes the size when using the {\ttfamily genpkey} command when no size is given. It fixes an omission in earlier changes that changed all RSA, DSA and DH generation commands to use 2048 bits by default.

{\itshape Kurt Roeckx}
\item Reorganize the manual pages to consistently have RETURN VALUES, EXAMPLES, SEE ALSO and HISTORY come in that order, and adjust util/fix-\/doc-\/nits accordingly.

{\itshape Paul Yang, Joshua Lock}
\item Add the missing accessor EVP\+\_\+\+PKEY\+\_\+get0\+\_\+engine()

{\itshape Matt Caswell}
\item Have commands like {\ttfamily s\+\_\+client} and {\ttfamily s\+\_\+server} output the signature scheme along with other cipher suite parameters when debugging.

{\itshape Lorinczy Zsigmond}
\item Make OPENSSL\+\_\+config() error agnostic again.

{\itshape Richard Levitte}
\item Do the error handling in RSA decryption constant time.

{\itshape Bernd Edlinger}
\item Prevent over long nonces in Cha\+Cha20-\/\+Poly1305.

Cha\+Cha20-\/\+Poly1305 is an AEAD cipher, and requires a unique nonce input for every encryption operation. RFC 7539 specifies that the nonce value (IV) should be 96 bits (12 bytes). Open\+SSL allows a variable nonce length and front pads the nonce with 0 bytes if it is less than 12 bytes. However it also incorrectly allows a nonce to be set of up to 16 bytes. In this case only the last 12 bytes are significant and any additional leading bytes are ignored.

It is a requirement of using this cipher that nonce values are unique. Messages encrypted using a reused nonce value are susceptible to serious confidentiality and integrity attacks. If an application changes the default nonce length to be longer than 12 bytes and then makes a change to the leading bytes of the nonce expecting the new value to be a new unique nonce then such an application could inadvertently encrypt messages with a reused nonce.

Additionally the ignored bytes in a long nonce are not covered by the integrity guarantee of this cipher. Any application that relies on the integrity of these ignored leading bytes of a long nonce may be further affected. Any Open\+SSL internal use of this cipher, including in SSL/\+TLS, is safe because no such use sets such a long nonce value. However user applications that use this cipher directly and set a non-\/default nonce length to be longer than 12 bytes may be vulnerable.

This issue was reported to Open\+SSL on 16th of March 2019 by Joran Dirk Greef of Ronomon. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2019-1543}{\texttt{ CVE-\/2019-\/1543}})

{\itshape Matt Caswell}
\item Add DEVRANDOM\+\_\+\+WAIT feature for Linux systems

On older Linux systems where the getrandom() system call is not available, Open\+SSL normally uses the /dev/urandom device for seeding its CSPRNG. Contrary to getrandom(), the /dev/urandom device will not block during early boot when the kernel CSPRNG has not been seeded yet.

To mitigate this known weakness, use select() to wait for /dev/random to become readable before reading from /dev/urandom.
\item Ensure that SM2 only uses SM3 as digest algorithm

{\itshape Paul Yang}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md35}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+1a and 1.\+1.\+1b \mbox{[}26 Feb 2019\mbox{]}}{Changes between 1.\+1.\+1a and 1.\+1.\+1b \mbox{[}26 Feb 2019\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md35}

\begin{DoxyItemize}
\item Change the info callback signals for the start and end of a post-\/handshake message exchange in TLSv1.\+3. In 1.\+1.\+1/1.1.\+1a we used SSL\+\_\+\+CB\+\_\+\+HANDSHAKE\+\_\+\+START and SSL\+\_\+\+CB\+\_\+\+HANDSHAKE\+\_\+\+DONE. Experience has shown that many applications get confused by this and assume that a TLSv1.\+2 renegotiation has started. This can break Key\+Update handling. Instead we no longer signal the start and end of a post handshake message exchange (although the messages themselves are still signalled). This could break some applications that were expecting the old signals. However without this Key\+Update is not usable for many applications.

{\itshape Matt Caswell}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md36}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+1 and 1.\+1.\+1a \mbox{[}20 Nov 2018\mbox{]}}{Changes between 1.\+1.\+1 and 1.\+1.\+1a \mbox{[}20 Nov 2018\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md36}

\begin{DoxyItemize}
\item Timing vulnerability in DSA signature generation

The Open\+SSL DSA signature algorithm has been shown to be vulnerable to a timing side channel attack. An attacker could use variations in the signing algorithm to recover the private key.

This issue was reported to Open\+SSL on 16th October 2018 by Samuel Weiser. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2018-0734}{\texttt{ CVE-\/2018-\/0734}})

{\itshape Paul Dale}
\item Timing vulnerability in ECDSA signature generation

The Open\+SSL ECDSA signature algorithm has been shown to be vulnerable to a timing side channel attack. An attacker could use variations in the signing algorithm to recover the private key.

This issue was reported to Open\+SSL on 25th October 2018 by Samuel Weiser. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2018-0735}{\texttt{ CVE-\/2018-\/0735}})

{\itshape Paul Dale}
\item Fixed the issue that RAND\+\_\+add()/\+RAND\+\_\+seed() silently discards random input if its length exceeds 4096 bytes. The limit has been raised to a buffer size of two gigabytes and the error handling improved.

This issue was reported to Open\+SSL by Dr. Falko Strenzke. It has been categorized as a normal bug, not a security issue, because the DRBG reseeds automatically and is fully functional even without additional randomness provided by the application.
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md37}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+0i and 1.\+1.\+1 \mbox{[}11 Sep 2018\mbox{]}}{Changes between 1.\+1.\+0i and 1.\+1.\+1 \mbox{[}11 Sep 2018\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md37}

\begin{DoxyItemize}
\item Add a new Client\+Hello callback. Provides a callback interface that gives the application the ability to adjust the nascent SSL object at the earliest stage of Client\+Hello processing, immediately after extensions have been collected but before they have been processed. In particular, this callback can adjust the supported TLS versions in response to the contents of the Client\+Hello

{\itshape Benjamin Kaduk}
\item Add SM2 base algorithm support.

{\itshape Jack Lloyd}
\item s390x assembly pack\+: add (improved) hardware-\/support for the following cryptographic primitives\+: sha3, shake, aes-\/gcm, aes-\/ccm, aes-\/ctr, aes-\/ofb, aes-\/cfb/cfb8, aes-\/ecb.

{\itshape Patrick Steuer}
\item Make EVP\+\_\+\+PKEY\+\_\+asn1\+\_\+new() a bit stricter about its input. A NULL pem\+\_\+str parameter is no longer accepted, as it leads to a corrupt table. NULL pem\+\_\+str is reserved for alias entries only.

{\itshape Richard Levitte}
\item Use the new ec\+\_\+scalar\+\_\+mul\+\_\+ladder scaffold to implement a specialized ladder step for prime curves. The new implementation is based on formulae from differential addition-\/and-\/doubling in homogeneous projective coordinates from Izu-\/\+Takagi "{}\+A fast parallel elliptic curve multiplication resistant    against side channel attacks"{} and Brier-\/\+Joye "{}\+Weierstrass Elliptic Curves    and Side-\/\+Channel Attacks"{} Eq. (8) for y-\/coordinate recovery, modified to work in projective coordinates.

{\itshape Billy Bob Brumley, Nicola Tuveri}
\item Change generating and checking of primes so that the error rate of not being prime depends on the intended use based on the size of the input. For larger primes this will result in more rounds of Miller-\/\+Rabin. The maximal error rate for primes with more than 1080 bits is lowered to 2\texorpdfstring{$^\wedge$}{\string^}-\/128.

{\itshape Kurt Roeckx, Annie Yousar}
\item Increase the number of Miller-\/\+Rabin rounds for DSA key generating to 64.

{\itshape Kurt Roeckx}
\item The \textquotesingle{}tsget\textquotesingle{} script is renamed to \textquotesingle{}tsget.\+pl\textquotesingle{}, to avoid confusion when moving between systems, and to avoid confusion when a Windows build is done with mingw vs with MSVC. For POSIX installs, there\textquotesingle{}s still a symlink or copy named \textquotesingle{}tsget\textquotesingle{} to avoid that confusion as well.

{\itshape Richard Levitte}
\item Revert blinding in ECDSA sign and instead make problematic addition length-\/invariant. Switch even to fixed-\/length Montgomery multiplication.

{\itshape Andy Polyakov}
\item Use the new ec\+\_\+scalar\+\_\+mul\+\_\+ladder scaffold to implement a specialized ladder step for binary curves. The new implementation is based on formulae from differential addition-\/and-\/doubling in mixed Lopez-\/\+Dahab projective coordinates, modified to independently blind the operands.

{\itshape Billy Bob Brumley, Sohaib ul Hassan, Nicola Tuveri}
\item Add a scaffold to optionally enhance the Montgomery ladder implementation for {\ttfamily ec\+\_\+scalar\+\_\+mul\+\_\+ladder} (formerly {\ttfamily ec\+\_\+mul\+\_\+consttime}) allowing EC\+\_\+\+METHODs to implement their own specialized "{}ladder step"{}, to take advantage of more favorable coordinate systems or more efficient differential addition-\/and-\/doubling algorithms.

{\itshape Billy Bob Brumley, Sohaib ul Hassan, Nicola Tuveri}
\item Modified the random device based seed sources to keep the relevant file descriptors open rather than reopening them on each access. This allows such sources to operate in a chroot() jail without the associated device nodes being available. This behaviour can be controlled using RAND\+\_\+keep\+\_\+random\+\_\+devices\+\_\+open().

{\itshape Paul Dale}
\item Numerous side-\/channel attack mitigations have been applied. This may have performance impacts for some algorithms for the benefit of improved security. Specific changes are noted in this change log by their respective authors.

{\itshape Matt Caswell}
\item AIX shared library support overhaul. Switch to AIX "{}natural"{} way of handling shared libraries, which means collecting shared objects of different versions and bitnesses in one common archive. This allows to mitigate conflict between 1.\+0 and 1.\+1 side-\/by-\/side installations. It doesn\textquotesingle{}t affect the way 3rd party applications are linked, only how multi-\/version installation is managed.

{\itshape Andy Polyakov}
\item Make ec\+\_\+group\+\_\+do\+\_\+inverse\+\_\+ord() more robust and available to other EC cryptosystems, so that irrespective of BN\+\_\+\+FLG\+\_\+\+CONSTTIME, SCA mitigations are applied to the fallback BN\+\_\+mod\+\_\+inverse(). When using this function rather than BN\+\_\+mod\+\_\+inverse() directly, new EC cryptosystem implementations are then safer-\/by-\/default.

{\itshape Billy Bob Brumley}
\item Add coordinate blinding for EC\+\_\+\+POINT and implement projective coordinate blinding for generic prime curves as a countermeasure to chosen point SCA attacks.

{\itshape Sohaib ul Hassan, Nicola Tuveri, Billy Bob Brumley}
\item Add blinding to ECDSA and DSA signatures to protect against side channel attacks discovered by Keegan Ryan (NCC Group).

{\itshape Matt Caswell}
\item Enforce checking in the {\ttfamily pkeyutl} command to ensure that the input length does not exceed the maximum supported digest length when performing a sign, verify or verifyrecover operation.

{\itshape Matt Caswell}
\item SSL\+\_\+\+MODE\+\_\+\+AUTO\+\_\+\+RETRY is enabled by default. Applications that use blocking I/O in combination with something like select() or poll() will hang. This can be turned off again using SSL\+\_\+\+CTX\+\_\+clear\+\_\+mode(). Many applications do not properly handle non-\/application data records, and TLS 1.\+3 sends more of such records. Setting SSL\+\_\+\+MODE\+\_\+\+AUTO\+\_\+\+RETRY works around the problems in those applications, but can also break some. It\textquotesingle{}s recommended to read the manpages about SSL\+\_\+read(), SSL\+\_\+write(), SSL\+\_\+get\+\_\+error(), SSL\+\_\+shutdown(), SSL\+\_\+\+CTX\+\_\+set\+\_\+mode() and SSL\+\_\+\+CTX\+\_\+set\+\_\+read\+\_\+ahead() again.

{\itshape Kurt Roeckx}
\item When unlocking a pass phrase protected PEM file or PKCS\#8 container, we now allow empty (zero character) pass phrases.

{\itshape Richard Levitte}
\item Apply blinding to binary field modular inversion and remove patent pending (OPENSSL\+\_\+\+SUN\+\_\+\+GF2\+M\+\_\+\+DIV) BN\+\_\+\+GF2m\+\_\+mod\+\_\+div implementation.

{\itshape Billy Bob Brumley}
\item Deprecate ec2\+\_\+mult.\+c and unify scalar multiplication code paths for binary and prime elliptic curves.

{\itshape Billy Bob Brumley}
\item Remove ECDSA nonce padding\+: EC\+\_\+\+POINT\+\_\+mul is now responsible for constant time fixed point multiplication.

{\itshape Billy Bob Brumley}
\item Revise elliptic curve scalar multiplication with timing attack defenses\+: ec\+\_\+w\+NAF\+\_\+mul redirects to a constant time implementation when computing fixed point and variable point multiplication (which in Open\+SSL are mostly used with secret scalars in keygen, sign, ECDH derive operations). {\itshape Billy Bob Brumley, Nicola Tuveri, Cesar Pereida García, Sohaib ul Hassan}
\item Updated CONTRIBUTING

{\itshape Rich Salz}
\item Updated DRBG / RAND to request nonce and additional low entropy randomness from the system.

{\itshape Matthias St. Pierre}
\item Updated \textquotesingle{}openssl rehash\textquotesingle{} to use Open\+SSL consistent default.

{\itshape Richard Levitte}
\item Moved the load of the ssl\+\_\+conf module to libcrypto, which helps loading engines that libssl uses before libssl is initialised.

{\itshape Matt Caswell}
\item Added EVP\+\_\+\+PKEY\+\_\+sign() and EVP\+\_\+\+PKEY\+\_\+verify() for Ed\+DSA

{\itshape Matt Caswell}
\item Fixed X509\+\_\+\+NAME\+\_\+\+ENTRY\+\_\+set to get multi-\/valued RDNs right in all cases.

{\itshape Ingo Schwarze, Rich Salz}
\item Added output of accepting IP address and port for \textquotesingle{}openssl s\+\_\+server\textquotesingle{}

{\itshape Richard Levitte}
\item Added a new API for TLSv1.\+3 ciphersuites\+: SSL\+\_\+\+CTX\+\_\+set\+\_\+ciphersuites() SSL\+\_\+set\+\_\+ciphersuites()

{\itshape Matt Caswell}
\item Memory allocation failures consistently add an error to the error stack.

{\itshape Rich Salz}
\item Don\textquotesingle{}t use OPENSSL\+\_\+\+ENGINES and OPENSSL\+\_\+\+CONF environment values in libcrypto when run as setuid/setgid.

{\itshape Bernd Edlinger}
\item Load any config file by default when libssl is used.

{\itshape Matt Caswell}
\item Added new public header file \texorpdfstring{$<$}{<}openssl/rand\+\_\+drbg.\+h\texorpdfstring{$>$}{>} and documentation for the RAND\+\_\+\+DRBG API. See manual page RAND\+\_\+\+DRBG(7) for an overview.

{\itshape Matthias St. Pierre}
\item QNX support removed (cannot find contributors to get their approval for the license change).

{\itshape Rich Salz}
\item TLSv1.\+3 replay protection for early data has been implemented. See the SSL\+\_\+read\+\_\+early\+\_\+data() man page for further details.

{\itshape Matt Caswell}
\item Separated TLSv1.\+3 ciphersuite configuration out from TLSv1.\+2 ciphersuite configuration. TLSv1.\+3 ciphersuites are not compatible with TLSv1.\+2 and below. Similarly TLSv1.\+2 ciphersuites are not compatible with TLSv1.\+3. In order to avoid issues where legacy TLSv1.\+2 ciphersuite configuration would otherwise inadvertently disable all TLSv1.\+3 ciphersuites the configuration has been separated out. See the ciphers man page or the SSL\+\_\+\+CTX\+\_\+set\+\_\+ciphersuites() man page for more information.

{\itshape Matt Caswell}
\item On POSIX (BSD, Linux, ...) systems the ocsp(1) command running in responder mode now supports the new "{}-\/multi"{} option, which spawns the specified number of child processes to handle OCSP requests. The "{}-\/timeout"{} option now also limits the OCSP responder\textquotesingle{}s patience to wait to receive the full client request on a newly accepted connection. Child processes are respawned as needed, and the CA index file is automatically reloaded when changed. This makes it possible to run the "{}ocsp"{} responder as a long-\/running service, making the Open\+SSL CA somewhat more feature-\/complete. In this mode, most diagnostic messages logged after entering the event loop are logged via syslog(3) rather than written to stderr.

{\itshape Viktor Dukhovni}
\item Added support for X448 and Ed448. Heavily based on original work by Mike Hamburg.

{\itshape Matt Caswell}
\item Extend OSSL\+\_\+\+STORE with capabilities to search and to narrow the set of objects loaded. This adds the functions OSSL\+\_\+\+STORE\+\_\+expect() and OSSL\+\_\+\+STORE\+\_\+find() as well as needed tools to construct searches and get the search data out of them.

{\itshape Richard Levitte}
\item Support for TLSv1.\+3 added. Note that users upgrading from an earlier version of Open\+SSL should review their configuration settings to ensure that they are still appropriate for TLSv1.\+3. For further information see\+: \href{https://wiki.openssl.org/index.php/TLS1.3}{\texttt{ https\+://wiki.\+openssl.\+org/index.\+php/\+TLS1.\+3}}

{\itshape Matt Caswell}
\item Grand redesign of the Open\+SSL random generator

The default RAND method now utilizes an AES-\/\+CTR DRBG according to NIST standard SP 800-\/90Ar1. The new random generator is essentially a port of the default random generator from the Open\+SSL FIPS 2.\+0 object module. It is a hybrid deterministic random bit generator using an AES-\/\+CTR bit stream and which seeds and reseeds itself automatically using trusted system entropy sources.

Some of its new features are\+:
\begin{DoxyItemize}
\item Support for multiple DRBG instances with seed chaining.
\item The default RAND method makes use of a DRBG.
\item There is a public and private DRBG instance.
\item The DRBG instances are fork-\/safe.
\item Keep all global DRBG instances on the secure heap if it is enabled.
\item The public and private DRBG instance are per thread for lock free operation
\end{DoxyItemize}

{\itshape Paul Dale, Benjamin Kaduk, Kurt Roeckx, Rich Salz, Matthias St. Pierre}
\item Changed Configure so it only says what it does and doesn\textquotesingle{}t dump so much data. Instead, ./configdata.pm should be used as a script to display all sorts of configuration data.

{\itshape Richard Levitte}
\item Added processing of "{}make variables"{} to Configure.

{\itshape Richard Levitte}
\item Added SHA512/224 and SHA512/256 algorithm support.

{\itshape Paul Dale}
\item The last traces of Netware support, first removed in 1.\+1.\+0, have now been removed.

{\itshape Rich Salz}
\item Get rid of Makefile.\+shared, and in the process, make the processing of certain files (rc.\+obj, or the .def/.map/.opt files produced from the ordinal files) more visible and hopefully easier to trace and debug (or make silent).

{\itshape Richard Levitte}
\item Make it possible to have environment variable assignments as arguments to config / Configure.

{\itshape Richard Levitte}
\item Add multi-\/prime RSA (RFC 8017) support.

{\itshape Paul Yang}
\item Add SM3 implemented according to GB/T 32905-\/2016 \texorpdfstring{$\ast$}{*}\+Jack Lloyd \href{mailto:jack.lloyd@ribose.com}{\texttt{ jack.\+lloyd@ribose.\+com}},\texorpdfstring{$\ast$}{*} \texorpdfstring{$\ast$}{*}\+Ronald Tse \href{mailto:ronald.tse@ribose.com}{\texttt{ ronald.\+tse@ribose.\+com}},\texorpdfstring{$\ast$}{*} \texorpdfstring{$\ast$}{*}\+Erick Borsboom \href{mailto:erick.borsboom@ribose.com}{\texttt{ erick.\+borsboom@ribose.\+com}}\texorpdfstring{$\ast$}{*}
\item Add \textquotesingle{}Maximum Fragment Length\textquotesingle{} TLS extension negotiation and support as documented in RFC6066. Based on a patch from Tomasz Moń

{\itshape Filipe Raimundo da Silva}
\item Add SM4 implemented according to GB/T 32907-\/2016. \texorpdfstring{$\ast$}{*}\+Jack Lloyd \href{mailto:jack.lloyd@ribose.com}{\texttt{ jack.\+lloyd@ribose.\+com}},\texorpdfstring{$\ast$}{*} \texorpdfstring{$\ast$}{*}\+Ronald Tse \href{mailto:ronald.tse@ribose.com}{\texttt{ ronald.\+tse@ribose.\+com}},\texorpdfstring{$\ast$}{*} \texorpdfstring{$\ast$}{*}\+Erick Borsboom \href{mailto:erick.borsboom@ribose.com}{\texttt{ erick.\+borsboom@ribose.\+com}}\texorpdfstring{$\ast$}{*}
\item Reimplement -\/newreq-\/nodes and ERR\+\_\+error\+\_\+string\+\_\+n; the original author does not agree with the license change.

{\itshape Rich Salz}
\item Add ARIA AEAD TLS support.

{\itshape Jon Spillett}
\item Some macro definitions to support VS6 have been removed. Visual Studio 6 has not worked since 1.\+1.\+0

{\itshape Rich Salz}
\item Add ERR\+\_\+clear\+\_\+last\+\_\+mark(), to allow callers to clear the last mark without clearing the errors.

{\itshape Richard Levitte}
\item Add "{}atfork"{} functions. If building on a system that without pthreads, see doc/man3/\+OPENSSL\+\_\+fork\+\_\+prepare.\+pod for application requirements. The RAND facility now uses/requires this.

{\itshape Rich Salz}
\item Add SHA3.

{\itshape Andy Polyakov}
\item The UI API becomes a permanent and integral part of libcrypto, i.\+e. not possible to disable entirely. However, it\textquotesingle{}s still possible to disable the console reading UI method, UI\+\_\+\+Open\+SSL() (use UI\+\_\+null() as a fallback).

To disable, configure with \textquotesingle{}no-\/ui-\/console\textquotesingle{}. \textquotesingle{}no-\/ui\textquotesingle{} is still possible to use as an alias. Check at compile time with the macro OPENSSL\+\_\+\+NO\+\_\+\+UI\+\_\+\+CONSOLE. The macro OPENSSL\+\_\+\+NO\+\_\+\+UI is still possible to check and is an alias for OPENSSL\+\_\+\+NO\+\_\+\+UI\+\_\+\+CONSOLE.

{\itshape Richard Levitte}
\item Add a STORE module, which implements a uniform and URI based reader of stores that can contain keys, certificates, CRLs and numerous other objects. The main API is loosely based on a few stdio functions, and includes OSSL\+\_\+\+STORE\+\_\+open, OSSL\+\_\+\+STORE\+\_\+load, OSSL\+\_\+\+STORE\+\_\+eof, OSSL\+\_\+\+STORE\+\_\+error and OSSL\+\_\+\+STORE\+\_\+close. The implementation uses backends called "{}loaders"{} to implement arbitrary URI schemes. There is one built in "{}loader"{} for the \textquotesingle{}file\textquotesingle{} scheme.

{\itshape Richard Levitte}
\item Add devcrypto engine. This has been implemented against cryptodev-\/linux, then adjusted to work on Free\+BSD 8.\+4 as well. Enable by configuring with \textquotesingle{}enable-\/devcryptoeng\textquotesingle{}. This is done by default on BSD implementations, as cryptodev.\+h is assumed to exist on all of them.

{\itshape Richard Levitte}
\item Module names can prefixed with OSSL\+\_\+ or OPENSSL\+\_\+. This affects util/mkerr.\+pl, which is adapted to allow those prefixes, leading to error code calls like this\+: \begin{DoxyVerb}    OSSL_FOOerr(OSSL_FOO_F_SOMETHING, OSSL_FOO_R_WHATEVER);
\end{DoxyVerb}
 With this change, we claim the namespaces OSSL and OPENSSL in a manner that can be encoded in C. For the foreseeable future, this will only affect new modules.

{\itshape Richard Levitte and Tim Hudson}
\item Removed BSD cryptodev engine.

{\itshape Rich Salz}
\item Add a build target \textquotesingle{}build\+\_\+all\+\_\+generated\textquotesingle{}, to build all generated files and only that. This can be used to prepare everything that requires things like perl for a system that lacks perl and then move everything to that system and do the rest of the build there.

{\itshape Richard Levitte}
\item In the UI interface, make it possible to duplicate the user data. This can be used by engines that need to retain the data for a longer time than just the call where this user data is passed.

{\itshape Richard Levitte}
\item Ignore the \textquotesingle{}-\/named\+\_\+curve auto\textquotesingle{} value for compatibility of applications with Open\+SSL 1.\+0.\+2.

\texorpdfstring{$\ast$}{*}\+Tomáš Mráz \href{mailto:tmraz@fedoraproject.org}{\texttt{ tmraz@fedoraproject.\+org}}\texorpdfstring{$\ast$}{*}
\item Fragmented SSL/\+TLS alerts are no longer accepted. An alert message is 2 bytes long. In theory it is permissible in SSLv3 -\/ TLSv1.\+2 to fragment such alerts across multiple records (some of which could be empty). In practice it make no sense to send an empty alert record, or to fragment one. TLSv1.\+3 prohibits this altogether and other libraries (Boring\+SSL, NSS) do not support this at all. Supporting it adds significant complexity to the record layer, and its removal is unlikely to cause interoperability issues.

{\itshape Matt Caswell}
\item Add the ASN.\+1 types INT32, UINT32, INT64, UINT64 and variants prefixed with Z. These are meant to replace LONG and ZLONG and to be size safe. The use of LONG and ZLONG is discouraged and scheduled for deprecation in Open\+SSL 1.\+2.\+0.

{\itshape Richard Levitte}
\item Add the \textquotesingle{}z\textquotesingle{} and \textquotesingle{}j\textquotesingle{} modifiers to BIO\+\_\+printf() et al formatting string, \textquotesingle{}z\textquotesingle{} is to be used for \mbox{[}s\mbox{]}size\+\_\+t, and \textquotesingle{}j\textquotesingle{} -\/ with \mbox{[}u\mbox{]}int64\+\_\+t.

{\itshape Richard Levitte, Andy Polyakov}
\item Add EC\+\_\+\+KEY\+\_\+get0\+\_\+engine(), which does for EC\+\_\+\+KEY what RSA\+\_\+get0\+\_\+engine() does for RSA, etc.

{\itshape Richard Levitte}
\item Have \textquotesingle{}config\textquotesingle{} recognise 64-\/bit mingw and choose \textquotesingle{}mingw64\textquotesingle{} as the target platform rather than \textquotesingle{}mingw\textquotesingle{}.

{\itshape Richard Levitte}
\item The functions X509\+\_\+\+STORE\+\_\+add\+\_\+cert and X509\+\_\+\+STORE\+\_\+add\+\_\+crl return success if they are asked to add an object which already exists in the store. This change cascades to other functions which load certificates and CRLs.

{\itshape Paul Dale}
\item x86\+\_\+64 assembly pack\+: annotate code with DWARF CFI directives to facilitate stack unwinding even from assembly subroutines.

{\itshape Andy Polyakov}
\item Remove VAX C specific definitions of OPENSSL\+\_\+\+EXPORT, OPENSSL\+\_\+\+EXTERN. Also remove OPENSSL\+\_\+\+GLOBAL entirely, as it became a no-\/op.

{\itshape Richard Levitte}
\item Remove the VMS-\/specific reimplementation of gmtime from crypto/o\+\_\+times.\+c. VMS C\textquotesingle{}s RTL has a fully up to date gmtime() and gmtime\+\_\+r() since V7.\+1, which is the minimum version we support.

{\itshape Richard Levitte}
\item Certificate time validation (X509\+\_\+cmp\+\_\+time) enforces stricter compliance with RFC 5280. Fractional seconds and timezone offsets are no longer allowed.

{\itshape Emilia Käsper}
\item Add support for ARIA

{\itshape Paul Dale}
\item s\+\_\+client will now send the Server Name Indication (SNI) extension by default unless the new "{}-\/noservername"{} option is used. The server name is based on the host provided to the "{}-\/connect"{} option unless overridden by using "{}-\/servername"{}.

{\itshape Matt Caswell}
\item Add support for Sip\+Hash

{\itshape Todd Short}
\item Open\+SSL now fails if it receives an unrecognised record type in TLS1.\+0 or TLS1.\+1. Previously this only happened in SSLv3 and TLS1.\+2. This is to prevent issues where no progress is being made and the peer continually sends unrecognised record types, using up resources processing them.

{\itshape Matt Caswell}
\item \textquotesingle{}openssl passwd\textquotesingle{} can now produce SHA256 and SHA512 based output, using the algorithm defined in \href{https://www.akkadia.org/drepper/SHA-crypt.txt}{\texttt{ https\+://www.\+akkadia.\+org/drepper/\+SHA-\/crypt.\+txt}}

{\itshape Richard Levitte}
\item Heartbeat support has been removed; the ABI is changed for now.

{\itshape Richard Levitte, Rich Salz}
\item Support for SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+ENCRYPT\+\_\+\+THEN\+\_\+\+MAC in SSL\+\_\+\+CONF\+\_\+cmd.

{\itshape Emilia Käsper}
\item The RSA "{}null"{} method, which was partially supported to avoid patent issues, has been replaced to always returns NULL.

{\itshape Rich Salz}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md38}{}\doxysection{\texorpdfstring{Open\+SSL 1.\+1.\+0}{Open\+SSL 1.\+1.\+0}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md38}
\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md39}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+0k and 1.\+1.\+0l \mbox{[}10 Sep 2019\mbox{]}}{Changes between 1.\+1.\+0k and 1.\+1.\+0l \mbox{[}10 Sep 2019\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md39}

\begin{DoxyItemize}
\item For built-\/in EC curves, ensure an EC\+\_\+\+GROUP built from the curve name is used even when parsing explicit parameters, when loading a encoded key or calling {\ttfamily EC\+\_\+\+GROUP\+\_\+new\+\_\+from\+\_\+ecpkparameters()}/ {\ttfamily EC\+\_\+\+GROUP\+\_\+new\+\_\+from\+\_\+ecparameters()}. This prevents bypass of security hardening and performance gains, especially for curves with specialized EC\+\_\+\+METHODs. By default, if a key encoded with explicit parameters is loaded and later encoded, the output is still encoded with explicit parameters, even if internally a "{}named"{} EC\+\_\+\+GROUP is used for computation.

{\itshape Nicola Tuveri}
\item Compute ECC cofactors if not provided during EC\+\_\+\+GROUP construction. Before this change, EC\+\_\+\+GROUP\+\_\+set\+\_\+generator would accept order and/or cofactor as NULL. After this change, only the cofactor parameter can be NULL. It also does some minimal sanity checks on the passed order. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2019-1547}{\texttt{ CVE-\/2019-\/1547}})

{\itshape Billy Bob Brumley}
\item Fixed a padding oracle in PKCS7\+\_\+data\+Decode and CMS\+\_\+decrypt\+\_\+set1\+\_\+pkey. An attack is simple, if the first CMS\+\_\+recipient\+Info is valid but the second CMS\+\_\+recipient\+Info is chosen ciphertext. If the second recipient\+Info decodes to PKCS \#1 v1.\+5 form plaintext, the correct encryption key will be replaced by garbage, and the message cannot be decoded, but if the RSA decryption fails, the correct encryption key is used and the recipient will not notice the attack. As a work around for this potential attack the length of the decrypted key must be equal to the cipher default key length, in case the certificate is not given and all recipient\+Info are tried out. The old behaviour can be re-\/enabled in the CMS code by setting the CMS\+\_\+\+DEBUG\+\_\+\+DECRYPT flag. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2019-1563}{\texttt{ CVE-\/2019-\/1563}})

{\itshape Bernd Edlinger}
\item Use Windows installation paths in the mingw builds

Mingw isn\textquotesingle{}t a POSIX environment per se, which means that Windows paths should be used for installation. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2019-1552}{\texttt{ CVE-\/2019-\/1552}})

{\itshape Richard Levitte}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md40}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+0j and 1.\+1.\+0k \mbox{[}28 May 2019\mbox{]}}{Changes between 1.\+1.\+0j and 1.\+1.\+0k \mbox{[}28 May 2019\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md40}

\begin{DoxyItemize}
\item Change the default RSA, DSA and DH size to 2048 bit instead of 1024. This changes the size when using the {\ttfamily genpkey} command when no size is given. It fixes an omission in earlier changes that changed all RSA, DSA and DH generation commands to use 2048 bits by default.

{\itshape Kurt Roeckx}
\item Prevent over long nonces in Cha\+Cha20-\/\+Poly1305.

Cha\+Cha20-\/\+Poly1305 is an AEAD cipher, and requires a unique nonce input for every encryption operation. RFC 7539 specifies that the nonce value (IV) should be 96 bits (12 bytes). Open\+SSL allows a variable nonce length and front pads the nonce with 0 bytes if it is less than 12 bytes. However it also incorrectly allows a nonce to be set of up to 16 bytes. In this case only the last 12 bytes are significant and any additional leading bytes are ignored.

It is a requirement of using this cipher that nonce values are unique. Messages encrypted using a reused nonce value are susceptible to serious confidentiality and integrity attacks. If an application changes the default nonce length to be longer than 12 bytes and then makes a change to the leading bytes of the nonce expecting the new value to be a new unique nonce then such an application could inadvertently encrypt messages with a reused nonce.

Additionally the ignored bytes in a long nonce are not covered by the integrity guarantee of this cipher. Any application that relies on the integrity of these ignored leading bytes of a long nonce may be further affected. Any Open\+SSL internal use of this cipher, including in SSL/\+TLS, is safe because no such use sets such a long nonce value. However user applications that use this cipher directly and set a non-\/default nonce length to be longer than 12 bytes may be vulnerable.

This issue was reported to Open\+SSL on 16th of March 2019 by Joran Dirk Greef of Ronomon. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2019-1543}{\texttt{ CVE-\/2019-\/1543}})

{\itshape Matt Caswell}
\item Added SCA hardening for modular field inversion in EC\+\_\+\+GROUP through a new dedicated field\+\_\+inv() pointer in EC\+\_\+\+METHOD. This also addresses a leakage affecting conversions from projective to affine coordinates.

{\itshape Billy Bob Brumley, Nicola Tuveri}
\item Fix a use after free bug in d2i\+\_\+\+X509\+\_\+\+PUBKEY when overwriting a re-\/used X509\+\_\+\+PUBKEY object if the second PUBKEY is malformed.

{\itshape Bernd Edlinger}
\item Move strictness check from EVP\+\_\+\+PKEY\+\_\+asn1\+\_\+new() to EVP\+\_\+\+PKEY\+\_\+asn1\+\_\+add0().

{\itshape Richard Levitte}
\item Remove the \textquotesingle{}dist\textquotesingle{} target and add a tarball building script. The \textquotesingle{}dist\textquotesingle{} target has fallen out of use, and it shouldn\textquotesingle{}t be necessary to configure just to create a source distribution.

{\itshape Richard Levitte}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md41}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+0i and 1.\+1.\+0j \mbox{[}20 Nov 2018\mbox{]}}{Changes between 1.\+1.\+0i and 1.\+1.\+0j \mbox{[}20 Nov 2018\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md41}

\begin{DoxyItemize}
\item Timing vulnerability in DSA signature generation

The Open\+SSL DSA signature algorithm has been shown to be vulnerable to a timing side channel attack. An attacker could use variations in the signing algorithm to recover the private key.

This issue was reported to Open\+SSL on 16th October 2018 by Samuel Weiser. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2018-0734}{\texttt{ CVE-\/2018-\/0734}})

{\itshape Paul Dale}
\item Timing vulnerability in ECDSA signature generation

The Open\+SSL ECDSA signature algorithm has been shown to be vulnerable to a timing side channel attack. An attacker could use variations in the signing algorithm to recover the private key.

This issue was reported to Open\+SSL on 25th October 2018 by Samuel Weiser. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2018-0735}{\texttt{ CVE-\/2018-\/0735}})

{\itshape Paul Dale}
\item Add coordinate blinding for EC\+\_\+\+POINT and implement projective coordinate blinding for generic prime curves as a countermeasure to chosen point SCA attacks.

{\itshape Sohaib ul Hassan, Nicola Tuveri, Billy Bob Brumley}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md42}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+0h and 1.\+1.\+0i \mbox{[}14 Aug 2018\mbox{]}}{Changes between 1.\+1.\+0h and 1.\+1.\+0i \mbox{[}14 Aug 2018\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md42}

\begin{DoxyItemize}
\item Client DoS due to large DH parameter

During key agreement in a TLS handshake using a DH(\+E) based ciphersuite a malicious server can send a very large prime value to the client. This will cause the client to spend an unreasonably long period of time generating a key for this prime resulting in a hang until the client has finished. This could be exploited in a Denial Of Service attack.

This issue was reported to Open\+SSL on 5th June 2018 by Guido Vranken (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2018-0732}{\texttt{ CVE-\/2018-\/0732}})

{\itshape Guido Vranken}
\item Cache timing vulnerability in RSA Key Generation

The Open\+SSL RSA Key generation algorithm has been shown to be vulnerable to a cache timing side channel attack. An attacker with sufficient access to mount cache timing attacks during the RSA key generation process could recover the private key.

This issue was reported to Open\+SSL on 4th April 2018 by Alejandro Cabrera Aldaya, Billy Brumley, Cesar Pereida Garcia and Luis Manuel Alvarez Tapia. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2018-0737}{\texttt{ CVE-\/2018-\/0737}})

{\itshape Billy Brumley}
\item Make EVP\+\_\+\+PKEY\+\_\+asn1\+\_\+new() a bit stricter about its input. A NULL pem\+\_\+str parameter is no longer accepted, as it leads to a corrupt table. NULL pem\+\_\+str is reserved for alias entries only.

{\itshape Richard Levitte}
\item Revert blinding in ECDSA sign and instead make problematic addition length-\/invariant. Switch even to fixed-\/length Montgomery multiplication.

{\itshape Andy Polyakov}
\item Change generating and checking of primes so that the error rate of not being prime depends on the intended use based on the size of the input. For larger primes this will result in more rounds of Miller-\/\+Rabin. The maximal error rate for primes with more than 1080 bits is lowered to 2\texorpdfstring{$^\wedge$}{\string^}-\/128.

{\itshape Kurt Roeckx, Annie Yousar}
\item Increase the number of Miller-\/\+Rabin rounds for DSA key generating to 64.

{\itshape Kurt Roeckx}
\item Add blinding to ECDSA and DSA signatures to protect against side channel attacks discovered by Keegan Ryan (NCC Group).

{\itshape Matt Caswell}
\item When unlocking a pass phrase protected PEM file or PKCS\#8 container, we now allow empty (zero character) pass phrases.

{\itshape Richard Levitte}
\item Certificate time validation (X509\+\_\+cmp\+\_\+time) enforces stricter compliance with RFC 5280. Fractional seconds and timezone offsets are no longer allowed.

{\itshape Emilia Käsper}
\item Fixed a text canonicalisation bug in CMS

Where a CMS detached signature is used with text content the text goes through a canonicalisation process first prior to signing or verifying a signature. This process strips trailing space at the end of lines, converts line terminators to CRLF and removes additional trailing line terminators at the end of a file. A bug in the canonicalisation process meant that some characters, such as form-\/feed, were incorrectly treated as whitespace and removed. This is contrary to the specification (RFC5485). This fix could mean that detached text data signed with an earlier version of Open\+SSL 1.\+1.\+0 may fail to verify using the fixed version, or text data signed with a fixed Open\+SSL may fail to verify with an earlier version of Open\+SSL 1.\+1.\+0. A workaround is to only verify the canonicalised text data and use the "{}-\/binary"{} flag (for the "{}cms"{} command line application) or set the SMIME\+\_\+\+BINARY/\+PKCS7\+\_\+\+BINARY/\+CMS\+\_\+\+BINARY flags (if using CMS\+\_\+verify()).

{\itshape Matt Caswell}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md43}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+0g and 1.\+1.\+0h \mbox{[}27 Mar 2018\mbox{]}}{Changes between 1.\+1.\+0g and 1.\+1.\+0h \mbox{[}27 Mar 2018\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md43}

\begin{DoxyItemize}
\item Constructed ASN.\+1 types with a recursive definition could exceed the stack

Constructed ASN.\+1 types with a recursive definition (such as can be found in PKCS7) could eventually exceed the stack given malicious input with excessive recursion. This could result in a Denial Of Service attack. There are no such structures used within SSL/\+TLS that come from untrusted sources so this is considered safe.

This issue was reported to Open\+SSL on 4th January 2018 by the OSS-\/fuzz project. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2018-0739}{\texttt{ CVE-\/2018-\/0739}})

{\itshape Matt Caswell}
\item Incorrect CRYPTO\+\_\+memcmp on HP-\/\+UX PA-\/\+RISC

Because of an implementation bug the PA-\/\+RISC CRYPTO\+\_\+memcmp function is effectively reduced to only comparing the least significant bit of each byte. This allows an attacker to forge messages that would be considered as authenticated in an amount of tries lower than that guaranteed by the security claims of the scheme. The module can only be compiled by the HP-\/\+UX assembler, so that only HP-\/\+UX PA-\/\+RISC targets are affected.

This issue was reported to Open\+SSL on 2nd March 2018 by Peter Waltenberg (IBM). (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2018-0733}{\texttt{ CVE-\/2018-\/0733}})

{\itshape Andy Polyakov}
\item Add a build target \textquotesingle{}build\+\_\+all\+\_\+generated\textquotesingle{}, to build all generated files and only that. This can be used to prepare everything that requires things like perl for a system that lacks perl and then move everything to that system and do the rest of the build there.

{\itshape Richard Levitte}
\item Backport SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+RENGOTIATION

Open\+SSL 1.\+0.\+2 and below had the ability to disable renegotiation using the (undocumented) SSL3\+\_\+\+FLAGS\+\_\+\+NO\+\_\+\+RENEGOTIATE\+\_\+\+CIPHERS flag. Due to the opacity changes this is no longer possible in 1.\+1.\+0. Therefore, the new SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+RENEGOTIATION option from 1.\+1.\+1-\/dev has been backported to 1.\+1.\+0 to provide equivalent functionality.

Note that if an application built against 1.\+1.\+0h headers (or above) is run using an older version of 1.\+1.\+0 (prior to 1.\+1.\+0h) then the option will be accepted but nothing will happen, i.\+e. renegotiation will not be prevented.

{\itshape Matt Caswell}
\item Removed the OS390-\/\+Unix config target. It relied on a script that doesn\textquotesingle{}t exist.

{\itshape Rich Salz}
\item rsaz\+\_\+1024\+\_\+mul\+\_\+avx2 overflow bug on x86\+\_\+64

There is an overflow bug in the AVX2 Montgomery multiplication procedure used in exponentiation with 1024-\/bit moduli. No EC algorithms are affected. Analysis suggests that attacks against RSA and DSA as a result of this defect would be very difficult to perform and are not believed likely. Attacks against DH1024 are considered just feasible, because most of the work necessary to deduce information about a private key may be performed offline. The amount of resources required for such an attack would be significant. However, for an attack on TLS to be meaningful, the server would have to share the DH1024 private key among multiple clients, which is no longer an option since CVE-\/2016-\/0701.

This only affects processors that support the AVX2 but not ADX extensions like Intel Haswell (4th generation).

This issue was reported to Open\+SSL by David Benjamin (Google). The issue was originally found via the OSS-\/\+Fuzz project. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2017-3738}{\texttt{ CVE-\/2017-\/3738}})

{\itshape Andy Polyakov}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md44}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+0f and 1.\+1.\+0g \mbox{[}2 Nov 2017\mbox{]}}{Changes between 1.\+1.\+0f and 1.\+1.\+0g \mbox{[}2 Nov 2017\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md44}

\begin{DoxyItemize}
\item bn\+\_\+sqrx8x\+\_\+internal carry bug on x86\+\_\+64

There is a carry propagating bug in the x86\+\_\+64 Montgomery squaring procedure. No EC algorithms are affected. Analysis suggests that attacks against RSA and DSA as a result of this defect would be very difficult to perform and are not believed likely. Attacks against DH are considered just feasible (although very difficult) because most of the work necessary to deduce information about a private key may be performed offline. The amount of resources required for such an attack would be very significant and likely only accessible to a limited number of attackers. An attacker would additionally need online access to an unpatched system using the target private key in a scenario with persistent DH parameters and a private key that is shared between multiple clients.

This only affects processors that support the BMI1, BMI2 and ADX extensions like Intel Broadwell (5th generation) and later or AMD Ryzen.

This issue was reported to Open\+SSL by the OSS-\/\+Fuzz project. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2017-3736}{\texttt{ CVE-\/2017-\/3736}})

{\itshape Andy Polyakov}
\item Malformed X.\+509 IPAddress\+Family could cause OOB read

If an X.\+509 certificate has a malformed IPAddress\+Family extension, Open\+SSL could do a one-\/byte buffer overread. The most likely result would be an erroneous display of the certificate in text format.

This issue was reported to Open\+SSL by the OSS-\/\+Fuzz project. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2017-3735}{\texttt{ CVE-\/2017-\/3735}})

{\itshape Rich Salz}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md45}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+0e and 1.\+1.\+0f \mbox{[}25 May 2017\mbox{]}}{Changes between 1.\+1.\+0e and 1.\+1.\+0f \mbox{[}25 May 2017\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md45}

\begin{DoxyItemize}
\item Have \textquotesingle{}config\textquotesingle{} recognise 64-\/bit mingw and choose \textquotesingle{}mingw64\textquotesingle{} as the target platform rather than \textquotesingle{}mingw\textquotesingle{}.

{\itshape Richard Levitte}
\item Remove the VMS-\/specific reimplementation of gmtime from crypto/o\+\_\+times.\+c. VMS C\textquotesingle{}s RTL has a fully up to date gmtime() and gmtime\+\_\+r() since V7.\+1, which is the minimum version we support.

{\itshape Richard Levitte}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md46}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+0d and 1.\+1.\+0e \mbox{[}16 Feb 2017\mbox{]}}{Changes between 1.\+1.\+0d and 1.\+1.\+0e \mbox{[}16 Feb 2017\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md46}

\begin{DoxyItemize}
\item Encrypt-\/\+Then-\/\+Mac renegotiation crash

During a renegotiation handshake if the Encrypt-\/\+Then-\/\+Mac extension is negotiated where it was not in the original handshake (or vice-\/versa) then this can cause Open\+SSL to crash (dependent on ciphersuite). Both clients and servers are affected.

This issue was reported to Open\+SSL by Joe Orton (Red Hat). (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2017-3733}{\texttt{ CVE-\/2017-\/3733}})

{\itshape Matt Caswell}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md47}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+0c and 1.\+1.\+0d \mbox{[}26 Jan 2017\mbox{]}}{Changes between 1.\+1.\+0c and 1.\+1.\+0d \mbox{[}26 Jan 2017\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md47}

\begin{DoxyItemize}
\item Truncated packet could crash via OOB read

If one side of an SSL/\+TLS path is running on a 32-\/bit host and a specific cipher is being used, then a truncated packet can cause that host to perform an out-\/of-\/bounds read, usually resulting in a crash.

This issue was reported to Open\+SSL by Robert Święcki of Google. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2017-3731}{\texttt{ CVE-\/2017-\/3731}})

{\itshape Andy Polyakov}
\item Bad (EC)DHE parameters cause a client crash

If a malicious server supplies bad parameters for a DHE or ECDHE key exchange then this can result in the client attempting to dereference a NULL pointer leading to a client crash. This could be exploited in a Denial of Service attack.

This issue was reported to Open\+SSL by Guido Vranken. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2017-3730}{\texttt{ CVE-\/2017-\/3730}})

{\itshape Matt Caswell}
\item BN\+\_\+mod\+\_\+exp may produce incorrect results on x86\+\_\+64

There is a carry propagating bug in the x86\+\_\+64 Montgomery squaring procedure. No EC algorithms are affected. Analysis suggests that attacks against RSA and DSA as a result of this defect would be very difficult to perform and are not believed likely. Attacks against DH are considered just feasible (although very difficult) because most of the work necessary to deduce information about a private key may be performed offline. The amount of resources required for such an attack would be very significant and likely only accessible to a limited number of attackers. An attacker would additionally need online access to an unpatched system using the target private key in a scenario with persistent DH parameters and a private key that is shared between multiple clients. For example this can occur by default in Open\+SSL DHE based SSL/\+TLS ciphersuites. Note\+: This issue is very similar to CVE-\/2015-\/3193 but must be treated as a separate problem.

This issue was reported to Open\+SSL by the OSS-\/\+Fuzz project. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2017-3732}{\texttt{ CVE-\/2017-\/3732}})

{\itshape Andy Polyakov}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md48}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+0b and 1.\+1.\+0c \mbox{[}10 Nov 2016\mbox{]}}{Changes between 1.\+1.\+0b and 1.\+1.\+0c \mbox{[}10 Nov 2016\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md48}

\begin{DoxyItemize}
\item Cha\+Cha20/\+Poly1305 heap-\/buffer-\/overflow

TLS connections using {\ttfamily \texorpdfstring{$\ast$}{*}-\/\+CHACHA20-\/\+POLY1305} ciphersuites are susceptible to a DoS attack by corrupting larger payloads. This can result in an Open\+SSL crash. This issue is not considered to be exploitable beyond a DoS.

This issue was reported to Open\+SSL by Robert Święcki (Google Security Team) (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-7054}{\texttt{ CVE-\/2016-\/7054}})

{\itshape Richard Levitte}
\item CMS Null dereference

Applications parsing invalid CMS structures can crash with a NULL pointer dereference. This is caused by a bug in the handling of the ASN.\+1 CHOICE type in Open\+SSL 1.\+1.\+0 which can result in a NULL value being passed to the structure callback if an attempt is made to free certain invalid encodings. Only CHOICE structures using a callback which do not handle NULL value are affected.

This issue was reported to Open\+SSL by Tyler Nighswander of For\+All\+Secure. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-7053}{\texttt{ CVE-\/2016-\/7053}})

{\itshape Stephen Henson}
\item Montgomery multiplication may produce incorrect results

There is a carry propagating bug in the Broadwell-\/specific Montgomery multiplication procedure that handles input lengths divisible by, but longer than 256 bits. Analysis suggests that attacks against RSA, DSA and DH private keys are impossible. This is because the subroutine in question is not used in operations with the private key itself and an input of the attacker\textquotesingle{}s direct choice. Otherwise the bug can manifest itself as transient authentication and key negotiation failures or reproducible erroneous outcome of public-\/key operations with specially crafted input. Among EC algorithms only Brainpool P-\/512 curves are affected and one presumably can attack ECDH key negotiation. Impact was not analyzed in detail, because pre-\/requisites for attack are considered unlikely. Namely multiple clients have to choose the curve in question and the server has to share the private key among them, neither of which is default behaviour. Even then only clients that chose the curve will be affected.

This issue was publicly reported as transient failures and was not initially recognized as a security issue. Thanks to Richard Morgan for providing reproducible case. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-7055}{\texttt{ CVE-\/2016-\/7055}})

{\itshape Andy Polyakov}
\item Removed automatic addition of RPATH in shared libraries and executables, as this was a remainder from Open\+SSL 1.\+0.\+x and isn\textquotesingle{}t needed any more.

{\itshape Richard Levitte}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md49}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+0a and 1.\+1.\+0b \mbox{[}26 Sep 2016\mbox{]}}{Changes between 1.\+1.\+0a and 1.\+1.\+0b \mbox{[}26 Sep 2016\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md49}

\begin{DoxyItemize}
\item Fix Use After Free for large message sizes

The patch applied to address CVE-\/2016-\/6307 resulted in an issue where if a message larger than approx 16k is received then the underlying buffer to store the incoming message is reallocated and moved. Unfortunately a dangling pointer to the old location is left which results in an attempt to write to the previously freed location. This is likely to result in a crash, however it could potentially lead to execution of arbitrary code.

This issue only affects Open\+SSL 1.\+1.\+0a.

This issue was reported to Open\+SSL by Robert Święcki. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-6309}{\texttt{ CVE-\/2016-\/6309}})

{\itshape Matt Caswell}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md50}{}\doxysubsection{\texorpdfstring{Changes between 1.\+1.\+0 and 1.\+1.\+0a \mbox{[}22 Sep 2016\mbox{]}}{Changes between 1.\+1.\+0 and 1.\+1.\+0a \mbox{[}22 Sep 2016\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md50}

\begin{DoxyItemize}
\item OCSP Status Request extension unbounded memory growth

A malicious client can send an excessively large OCSP Status Request extension. If that client continually requests renegotiation, sending a large OCSP Status Request extension each time, then there will be unbounded memory growth on the server. This will eventually lead to a Denial Of Service attack through memory exhaustion. Servers with a default configuration are vulnerable even if they do not support OCSP. Builds using the "{}no-\/ocsp"{} build time option are not affected.

This issue was reported to Open\+SSL by Shi Lei (Gear Team, Qihoo 360 Inc.) (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-6304}{\texttt{ CVE-\/2016-\/6304}})

{\itshape Matt Caswell}
\item SSL\+\_\+peek() hang on empty record

Open\+SSL 1.\+1.\+0 SSL/\+TLS will hang during a call to SSL\+\_\+peek() if the peer sends an empty record. This could be exploited by a malicious peer in a Denial Of Service attack.

This issue was reported to Open\+SSL by Alex Gaynor. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-6305}{\texttt{ CVE-\/2016-\/6305}})

{\itshape Matt Caswell}
\item Excessive allocation of memory in tls\+\_\+get\+\_\+message\+\_\+header() and dtls1\+\_\+preprocess\+\_\+fragment()

A (D)TLS message includes 3 bytes for its length in the header for the message. This would allow for messages up to 16Mb in length. Messages of this length are excessive and Open\+SSL includes a check to ensure that a peer is sending reasonably sized messages in order to avoid too much memory being consumed to service a connection. A flaw in the logic of version 1.\+1.\+0 means that memory for the message is allocated too early, prior to the excessive message length check. Due to way memory is allocated in Open\+SSL this could mean an attacker could force up to 21Mb to be allocated to service a connection. This could lead to a Denial of Service through memory exhaustion. However, the excessive message length check still takes place, and this would cause the connection to immediately fail. Assuming that the application calls SSL\+\_\+free() on the failed connection in a timely manner then the 21Mb of allocated memory will then be immediately freed again. Therefore, the excessive memory allocation will be transitory in nature. This then means that there is only a security impact if\+:

1) The application does not call SSL\+\_\+free() in a timely manner in the event that the connection fails or 2) The application is working in a constrained environment where there is very little free memory or 3) The attacker initiates multiple connection attempts such that there are multiple connections in a state where memory has been allocated for the connection; SSL\+\_\+free() has not yet been called; and there is insufficient memory to service the multiple requests.

Except in the instance of (1) above any Denial Of Service is likely to be transitory because as soon as the connection fails the memory is subsequently freed again in the SSL\+\_\+free() call. However there is an increased risk during this period of application crashes due to the lack of memory -\/ which would then mean a more serious Denial of Service.

This issue was reported to Open\+SSL by Shi Lei (Gear Team, Qihoo 360 Inc.) (CVE-\/2016-\/6307 and CVE-\/2016-\/6308)

{\itshape Matt Caswell}
\item solaris-\/x86-\/cc, i.\+e. 32-\/bit configuration with vendor compiler, had to be removed. Primary reason is that vendor assembler can\textquotesingle{}t assemble our modules with -\/KPIC flag. As result it, assembly support, was not even available as option. But its lack means lack of side-\/channel resistant code, which is incompatible with security by todays standards. Fortunately gcc is readily available prepackaged option, which we firmly point at...

{\itshape Andy Polyakov}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md51}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+2h and 1.\+1.\+0 \mbox{[}25 Aug 2016\mbox{]}}{Changes between 1.\+0.\+2h and 1.\+1.\+0 \mbox{[}25 Aug 2016\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md51}

\begin{DoxyItemize}
\item Windows command-\/line tool supports UTF-\/8 opt-\/in option for arguments and console input. Setting OPENSSL\+\_\+\+WIN32\+\_\+\+UTF8 environment variable (to any value) allows Windows user to access PKCS\#12 file generated with Windows Crypto\+API and protected with non-\/\+ASCII password, as well as files generated under UTF-\/8 locale on Linux also protected with non-\/\+ASCII password.

{\itshape Andy Polyakov}
\item To mitigate the SWEET32 attack (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-2183}{\texttt{ CVE-\/2016-\/2183}}), 3DES cipher suites have been disabled by default and removed from DEFAULT, just like RC4. See the RC4 item below to re-\/enable both.

{\itshape Rich Salz}
\item The method for finding the storage location for the Windows RAND seed file has changed. First we check RANDFILE\%. If that is not set then we check the directories HOME\%, USERPROFILE\% and SYSTEMROOT\% in that order. If all else fails we fall back to C\+:.

{\itshape Matt Caswell}
\item The EVP\+\_\+\+Encrypt\+Update() function has had its return type changed from void to int. A return of 0 indicates and error while a return of 1 indicates success.

{\itshape Matt Caswell}
\item The flags RSA\+\_\+\+FLAG\+\_\+\+NO\+\_\+\+CONSTTIME, DSA\+\_\+\+FLAG\+\_\+\+NO\+\_\+\+EXP\+\_\+\+CONSTTIME and DH\+\_\+\+FLAG\+\_\+\+NO\+\_\+\+EXP\+\_\+\+CONSTTIME which previously provided the ability to switch off the constant time implementation for RSA, DSA and DH have been made no-\/ops and deprecated.

{\itshape Matt Caswell}
\item Windows RAND implementation was simplified to only get entropy by calling Crypt\+Gen\+Random(). Various other RAND-\/related tickets were also closed.

{\itshape Joseph Wylie Yandle, Rich Salz}
\item The stack and lhash API\textquotesingle{}s were renamed to start with {\ttfamily OPENSSL\+\_\+\+SK\+\_\+} and {\ttfamily OPENSSL\+\_\+\+LH\+\_\+}, respectively. The old names are available with API compatibility. They new names are now completely documented.

{\itshape Rich Salz}
\item Unify TYPE\+\_\+up\+\_\+ref(obj) methods signature. SSL\+\_\+\+CTX\+\_\+up\+\_\+ref(), SSL\+\_\+up\+\_\+ref(), X509\+\_\+up\+\_\+ref(), EVP\+\_\+\+PKEY\+\_\+up\+\_\+ref(), X509\+\_\+\+CRL\+\_\+up\+\_\+ref(), X509\+\_\+\+OBJECT\+\_\+up\+\_\+ref\+\_\+count() methods are now returning an int (instead of void) like all others TYPE\+\_\+up\+\_\+ref() methods. So now these methods also check the return value of CRYPTO\+\_\+atomic\+\_\+add(), and the validity of object reference counter.

\texorpdfstring{$\ast$}{*}fdasilvayy@gmail.com\texorpdfstring{$\ast$}{*}
\item With Windows Visual Studio builds, the .pdb files are installed alongside the installed libraries and executables. For a static library installation, ossl\+\_\+static.\+pdb is the associate compiler generated .pdb file to be used when linking programs.

{\itshape Richard Levitte}
\item Remove openssl.\+spec. Packaging files belong with the packagers.

{\itshape Richard Levitte}
\item Automatic Darwin/\+OSX configuration has had a refresh, it will now recognise x86\+\_\+64 architectures automatically. You can still decide to build for a different bitness with the environment variable KERNEL\+\_\+\+BITS (can be 32 or 64), for example\+: \begin{DoxyVerb}    KERNEL_BITS=32 ./config
\end{DoxyVerb}
 {\itshape Richard Levitte}
\item Change default algorithms in pkcs8 utility to use PKCS\#5 v2.\+0, 256 bit AES and HMAC with SHA256.

{\itshape Steve Henson}
\item Remove support for MIPS o32 ABI on IRIX (and IRIX only).

{\itshape Andy Polyakov}
\item Triple-\/\+DES ciphers have been moved from HIGH to MEDIUM.

{\itshape Rich Salz}
\item To enable users to have their own config files and build file templates, Configure looks in the directory indicated by the environment variable OPENSSL\+\_\+\+LOCAL\+\_\+\+CONFIG\+\_\+\+DIR as well as the in-\/source Configurations/ directory. On VMS, OPENSSL\+\_\+\+LOCAL\+\_\+\+CONFIG\+\_\+\+DIR is expected to be a logical name and is used as is.

{\itshape Richard Levitte}
\item The following datatypes were made opaque\+: X509\+\_\+\+OBJECT, X509\+\_\+\+STORE\+\_\+\+CTX, X509\+\_\+\+STORE, X509\+\_\+\+LOOKUP, and X509\+\_\+\+LOOKUP\+\_\+\+METHOD. The unused type X509\+\_\+\+CERT\+\_\+\+FILE\+\_\+\+CTX was removed.

{\itshape Rich Salz}
\item "{}shared"{} builds are now the default. To create only static libraries use the "{}no-\/shared"{} Configure option.

{\itshape Matt Caswell}
\item Remove the no-\/aes, no-\/hmac, no-\/rsa, no-\/sha and no-\/md5 Configure options. All of these option have not worked for some while and are fundamental algorithms.

{\itshape Matt Caswell}
\item Make various cleanup routines no-\/ops and mark them as deprecated. Most global cleanup functions are no longer required because they are handled via auto-\/deinit (see OPENSSL\+\_\+init\+\_\+crypto and OPENSSL\+\_\+init\+\_\+ssl man pages). Explicitly de-\/initing can cause problems (e.\+g. where a library that uses Open\+SSL de-\/inits, but an application is still using it). The affected functions are CONF\+\_\+modules\+\_\+free(), ENGINE\+\_\+cleanup(), OBJ\+\_\+cleanup(), EVP\+\_\+cleanup(), BIO\+\_\+sock\+\_\+cleanup(), CRYPTO\+\_\+cleanup\+\_\+all\+\_\+ex\+\_\+data(), RAND\+\_\+cleanup(), SSL\+\_\+\+COMP\+\_\+free\+\_\+compression\+\_\+methods(), ERR\+\_\+free\+\_\+strings() and COMP\+\_\+zlib\+\_\+cleanup().

{\itshape Matt Caswell}
\item --strict-\/warnings no longer enables runtime debugging options such as REF\+\_\+\+DEBUG. Instead, debug options are automatically enabled with \textquotesingle{}--debug\textquotesingle{} builds.

{\itshape Andy Polyakov, Emilia Käsper}
\item Made DH and DH\+\_\+\+METHOD opaque. The structures for managing DH objects have been moved out of the public header files. New functions for managing these have been added.

{\itshape Matt Caswell}
\item Made RSA and RSA\+\_\+\+METHOD opaque. The structures for managing RSA objects have been moved out of the public header files. New functions for managing these have been added.

{\itshape Richard Levitte}
\item Made DSA and DSA\+\_\+\+METHOD opaque. The structures for managing DSA objects have been moved out of the public header files. New functions for managing these have been added.

{\itshape Matt Caswell}
\item Made BIO and BIO\+\_\+\+METHOD opaque. The structures for managing BIOs have been moved out of the public header files. New functions for managing these have been added.

{\itshape Matt Caswell}
\item Removed no-\/rijndael as a config option. Rijndael is an old name for AES.

{\itshape Matt Caswell}
\item Removed the mk1mf build scripts.

{\itshape Richard Levitte}
\item Headers are now wrapped, if necessary, with OPENSSL\+\_\+\+NO\+\_\+xxx, so it is always safe to include a header now.

{\itshape Rich Salz}
\item Removed the aged BC-\/32 config and all its supporting scripts

{\itshape Richard Levitte}
\item Removed support for Ultrix, Netware, and OS/2.

{\itshape Rich Salz}
\item Add support for HKDF.

{\itshape Alessandro Ghedini}
\item Add support for blake2b and blake2s

{\itshape Bill Cox}
\item Added support for "{}pipelining"{}. Ciphers that have the EVP\+\_\+\+CIPH\+\_\+\+FLAG\+\_\+\+PIPELINE flag set have a capability to process multiple encryptions/decryptions simultaneously. There are currently no built-\/in ciphers with this property but the expectation is that engines will be able to offer it to significantly improve throughput. Support has been extended into libssl so that multiple records for a single connection can be processed in one go (for \texorpdfstring{$>$}{>}=TLS 1.\+1).

{\itshape Matt Caswell}
\item Added the AFALG engine. This is an async capable engine which is able to offload work to the Linux kernel. In this initial version it only supports AES128-\/\+CBC. The kernel must be version 4.\+1.\+0 or greater.

{\itshape Catriona Lucey}
\item Open\+SSL now uses a new threading API. It is no longer necessary to set locking callbacks to use Open\+SSL in a multi-\/threaded environment. There are two supported threading models\+: pthreads and windows threads. It is also possible to configure Open\+SSL at compile time for "{}no-\/threads"{}. The old threading API should no longer be used. The functions have been replaced with "{}no-\/op"{} compatibility macros.

{\itshape Alessandro Ghedini, Matt Caswell}
\item Modify behavior of ALPN to invoke callback after SNI/servername callback, such that updates to the SSL\+\_\+\+CTX affect ALPN.

{\itshape Todd Short}
\item Add SSL\+\_\+\+CIPHER queries for authentication and key-\/exchange.

{\itshape Todd Short}
\item Changes to the DEFAULT cipherlist\+:
\begin{DoxyItemize}
\item Prefer (EC)DHE handshakes over plain RSA.
\item Prefer AEAD ciphers over legacy ciphers.
\item Prefer ECDSA over RSA when both certificates are available.
\item Prefer TLSv1.\+2 ciphers/\+PRF.
\item Remove DSS, SEED, IDEA, CAMELLIA, and AES-\/\+CCM from the default cipherlist.
\end{DoxyItemize}

{\itshape Emilia Käsper}
\item Change the ECC default curve list to be this, in order\+: x25519, secp256r1, secp521r1, secp384r1.

{\itshape Rich Salz}
\item RC4 based libssl ciphersuites are now classed as "{}weak"{} ciphers and are disabled by default. They can be re-\/enabled using the enable-\/weak-\/ssl-\/ciphers option to Configure.

{\itshape Matt Caswell}
\item If the server has ALPN configured, but supports no protocols that the client advertises, send a fatal "{}no\+\_\+application\+\_\+protocol"{} alert. This behaviour is SHALL in RFC 7301, though it isn\textquotesingle{}t universally implemented by other servers.

{\itshape Emilia Käsper}
\item Add X25519 support. Add ASN.\+1 and EVP\+\_\+\+PKEY methods for X25519. This includes support for public and private key encoding using the format documented in draft-\/ietf-\/curdle-\/pkix-\/02. The corresponding EVP\+\_\+\+PKEY method supports key generation and key derivation.

TLS support complies with draft-\/ietf-\/tls-\/rfc4492bis-\/08 and uses X25519(29).

{\itshape Steve Henson}
\item Deprecate SRP\+\_\+\+VBASE\+\_\+get\+\_\+by\+\_\+user. SRP\+\_\+\+VBASE\+\_\+get\+\_\+by\+\_\+user had inconsistent memory management behaviour. In order to fix an unavoidable memory leak (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-0798}{\texttt{ CVE-\/2016-\/0798}}), SRP\+\_\+\+VBASE\+\_\+get\+\_\+by\+\_\+user was changed to ignore the "{}fake user"{} SRP seed, even if the seed is configured.

Users should use SRP\+\_\+\+VBASE\+\_\+get1\+\_\+by\+\_\+user instead. Note that in SRP\+\_\+\+VBASE\+\_\+get1\+\_\+by\+\_\+user, caller must free the returned value. Note also that even though configuring the SRP seed attempts to hide invalid usernames by continuing the handshake with fake credentials, this behaviour is not constant time and no strong guarantees are made that the handshake is indistinguishable from that of a valid user.

{\itshape Emilia Käsper}
\item Configuration change; it\textquotesingle{}s now possible to build dynamic engines without having to build shared libraries and vice versa. This only applies to the engines in {\ttfamily engines/}, those in {\ttfamily crypto/engine/} will always be built into libcrypto (i.\+e. "{}static"{}).

Building dynamic engines is enabled by default; to disable, use the configuration option "{}disable-\/dynamic-\/engine"{}.

The only requirements for building dynamic engines are the presence of the DSO module and building with position independent code, so they will also automatically be disabled if configuring with "{}disable-\/dso"{} or "{}disable-\/pic"{}.

The macros OPENSSL\+\_\+\+NO\+\_\+\+STATIC\+\_\+\+ENGINE and OPENSSL\+\_\+\+NO\+\_\+\+DYNAMIC\+\_\+\+ENGINE are also taken away from \doxylink{opensslconf_8h_source}{openssl/opensslconf.\+h}, as they are irrelevant.

{\itshape Richard Levitte}
\item Configuration change; if there is a known flag to compile position independent code, it will always be applied on the libcrypto and libssl object files, and never on the application object files. This means other libraries that use routines from libcrypto / libssl can be made into shared libraries regardless of how Open\+SSL was configured.

If this isn\textquotesingle{}t desirable, the configuration options "{}disable-\/pic"{} or "{}no-\/pic"{} can be used to disable the use of PIC. This will also disable building shared libraries and dynamic engines.

{\itshape Richard Levitte}
\item Removed JPAKE code. It was experimental and has no wide use.

{\itshape Rich Salz}
\item The INSTALL\+\_\+\+PREFIX Makefile variable has been renamed to DESTDIR. That makes for less confusion on what this variable is for. Also, the configuration option --install\+\_\+prefix is removed.

{\itshape Richard Levitte}
\item Heartbeat for TLS has been removed and is disabled by default for DTLS; configure with enable-\/heartbeats. Code that uses the old define\textquotesingle{}s might need to be updated.

{\itshape Emilia Käsper, Rich Salz}
\item Rename REF\+\_\+\+CHECK to REF\+\_\+\+DEBUG.

{\itshape Rich Salz}
\item New "{}unified"{} build system

The "{}unified"{} build system is aimed to be a common system for all platforms we support. With it comes new support for VMS.

This system builds supports building in a different directory tree than the source tree. It produces one Makefile (for unix family or lookalikes), or one descrip.\+mms (for VMS).

The source of information to make the Makefile / descrip.\+mms is small files called \textquotesingle{}build.\+info\textquotesingle{}, holding the necessary information for each directory with source to compile, and a template in Configurations, like unix-\/\+Makefile.\+tmpl or descrip.\+mms.\+tmpl.

With this change, the library names were also renamed on Windows and on VMS. They now have names that are closer to the standard on Unix, and include the major version number, and in certain cases, the architecture they are built for. See "{}\+Notes on shared    libraries"{} in INSTALL.

We rely heavily on the perl module Text\+::\+Template.

{\itshape Richard Levitte}
\item Added support for auto-\/initialisation and de-\/initialisation of the library. Open\+SSL no longer requires explicit init or deinit routines to be called, except in certain circumstances. See the OPENSSL\+\_\+init\+\_\+crypto() and OPENSSL\+\_\+init\+\_\+ssl() man pages for further information.

{\itshape Matt Caswell}
\item The arguments to the DTLSv1\+\_\+listen function have changed. Specifically the "{}peer"{} argument is now expected to be a BIO\+\_\+\+ADDR object.
\item Rewrite of BIO networking library. The BIO library lacked consistent support of IPv6, and adding it required some more extensive modifications. This introduces the BIO\+\_\+\+ADDR and BIO\+\_\+\+ADDRINFO types, which hold all types of addresses and chains of address information. It also introduces a new API, with functions like BIO\+\_\+socket, BIO\+\_\+connect, BIO\+\_\+listen, BIO\+\_\+lookup and a rewrite of BIO\+\_\+accept. The source/sink BIOs BIO\+\_\+s\+\_\+connect, BIO\+\_\+s\+\_\+accept and BIO\+\_\+s\+\_\+datagram have been adapted accordingly.

{\itshape Richard Levitte}
\item RSA\+\_\+padding\+\_\+check\+\_\+\+PKCS1\+\_\+type\+\_\+1 now accepts inputs with and without the leading 0-\/byte.

{\itshape Emilia Käsper}
\item CRIME protection\+: disable compression by default, even if Open\+SSL is compiled with zlib enabled. Applications can still enable compression by calling SSL\+\_\+\+CTX\+\_\+clear\+\_\+options(ctx, SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+COMPRESSION), or by using the SSL\+\_\+\+CONF library to configure compression.

{\itshape Emilia Käsper}
\item The signature of the session callback configured with SSL\+\_\+\+CTX\+\_\+sess\+\_\+set\+\_\+get\+\_\+cb was changed. The read-\/only input buffer was explicitly marked as {\ttfamily const unsigned char\texorpdfstring{$\ast$}{*}} instead of {\ttfamily unsigned char\texorpdfstring{$\ast$}{*}}.

{\itshape Emilia Käsper}
\item Always DPURIFY. Remove the use of uninitialized memory in the RNG, and other conditional uses of DPURIFY. This makes -\/DPURIFY a no-\/op.

{\itshape Emilia Käsper}
\item Removed many obsolete configuration items, including DES\+\_\+\+PTR, DES\+\_\+\+RISC1, DES\+\_\+\+RISC2, DES\+\_\+\+INT MD2\+\_\+\+CHAR, MD2\+\_\+\+INT, MD2\+\_\+\+LONG BF\+\_\+\+PTR, BF\+\_\+\+PTR2 IDEA\+\_\+\+SHORT, IDEA\+\_\+\+LONG RC2\+\_\+\+SHORT, RC2\+\_\+\+LONG, RC4\+\_\+\+LONG, RC4\+\_\+\+CHUNK, RC4\+\_\+\+INDEX

{\itshape Rich Salz, with advice from Andy Polyakov}
\item Many BN internals have been moved to an internal header file.

{\itshape Rich Salz with help from Andy Polyakov}
\item Configuration and writing out the results from it has changed. Files such as Makefile \doxylink{opensslconf_8h_source}{include/openssl/opensslconf.\+h} and are now produced through general templates, such as Makefile.\+in and crypto/opensslconf.\+h.\+in and some help from the perl module Text\+::\+Template.

Also, the center of configuration information is no longer Makefile. Instead, Configure produces a perl module in configdata.\+pm which holds most of the config data (in the hash table config), the target data that comes from the target configuration in one of the {\ttfamily Configurations/\texorpdfstring{$\ast$}{*}.conf} files (in target).

{\itshape Richard Levitte}
\item To clarify their intended purposes, the Configure options --prefix and --openssldir change their semantics, and become more straightforward and less interdependent.

--prefix shall be used exclusively to give the location INSTALLTOP where programs, scripts, libraries, include files and manuals are going to be installed. The default is now /usr/local.

--openssldir shall be used exclusively to give the default location OPENSSLDIR where certificates, private keys, CRLs are managed. This is also where the default openssl.\+cnf gets installed. If the directory given with this option is a relative path, the values of both the --prefix value and the --openssldir value will be combined to become OPENSSLDIR. The default for --openssldir is INSTALLTOP/ssl.

Anyone who uses --openssldir to specify where Open\+SSL is to be installed MUST change to use --prefix instead.

{\itshape Richard Levitte}
\item The GOST engine was out of date and therefore it has been removed. An up to date GOST engine is now being maintained in an external repository. See\+: \href{https://wiki.openssl.org/index.php/Binaries}{\texttt{ https\+://wiki.\+openssl.\+org/index.\+php/\+Binaries}}. Libssl still retains support for GOST ciphersuites (these are only activated if a GOST engine is present).

{\itshape Matt Caswell}
\item EGD is no longer supported by default; use enable-\/egd when configuring.

{\itshape Ben Kaduk and Rich Salz}
\item The distribution now has Makefile.\+in files, which are used to create Makefile\textquotesingle{}s when Configure is run. {\itshape Configure must be run before trying to build now.}

{\itshape Rich Salz}
\item The return value for SSL\+\_\+\+CIPHER\+\_\+description() for error conditions has changed.

{\itshape Rich Salz}
\item Support for RFC6698/\+RFC7671 DANE TLSA peer authentication.

Obtaining and performing DNSSEC validation of TLSA records is the application\textquotesingle{}s responsibility. The application provides the TLSA records of its choice to Open\+SSL, and these are then used to authenticate the peer.

The TLSA records need not even come from DNS. They can, for example, be used to implement local end-\/entity certificate or trust-\/anchor "{}pinning"{}, where the "{}pin"{} data takes the form of TLSA records, which can augment or replace verification based on the usual Web\+PKI public certification authorities.

{\itshape Viktor Dukhovni}
\item Revert default OPENSSL\+\_\+\+NO\+\_\+\+DEPRECATED setting. Instead Open\+SSL continues to support deprecated interfaces in default builds. However, applications are strongly advised to compile their source files with -\/DOPENSSL\+\_\+\+API\+\_\+\+COMPAT=0x10100000L, which hides the declarations of all interfaces deprecated in 0.\+9.\+8, 1.\+0.\+0 or the 1.\+1.\+0 releases.

In environments in which all applications have been ported to not use any deprecated interfaces Open\+SSL\textquotesingle{}s Configure script should be used with the --api=1.\+1.\+0 option to entirely remove support for the deprecated features from the library and unconditionally disable them in the installed headers. Essentially the same effect can be achieved with the "{}no-\/deprecated"{} argument to Configure, except that this will always restrict the build to just the latest API, rather than a fixed API version.

As applications are ported to future revisions of the API, they should update their compile-\/time OPENSSL\+\_\+\+API\+\_\+\+COMPAT define accordingly, but in most cases should be able to continue to compile with later releases.

The OPENSSL\+\_\+\+API\+\_\+\+COMPAT versions for 1.\+0.\+0, and 0.\+9.\+8 are 0x10000000L and 0x00908000L, respectively. However those versions did not support the OPENSSL\+\_\+\+API\+\_\+\+COMPAT feature, and so applications are not typically tested for explicit support of just the undeprecated features of either release.

{\itshape Viktor Dukhovni}
\item Add support for setting the minimum and maximum supported protocol. It can bet set via the SSL\+\_\+set\+\_\+min\+\_\+proto\+\_\+version() and SSL\+\_\+set\+\_\+max\+\_\+proto\+\_\+version(), or via the SSL\+\_\+\+CONF\textquotesingle{}s Min\+Protocol and Max\+Protocol. It\textquotesingle{}s recommended to use the new APIs to disable protocols instead of disabling individual protocols using SSL\+\_\+set\+\_\+options() or SSL\+\_\+\+CONF\textquotesingle{}s Protocol. This change also removes support for disabling TLS 1.\+2 in the Open\+SSL TLS client at compile time by defining OPENSSL\+\_\+\+NO\+\_\+\+TLS1\+\_\+2\+\_\+\+CLIENT.

{\itshape Kurt Roeckx}
\item Support for Cha\+Cha20 and Poly1305 added to libcrypto and libssl.

{\itshape Andy Polyakov}
\item New EC\+\_\+\+KEY\+\_\+\+METHOD, this replaces the older ECDSA\+\_\+\+METHOD and ECDH\+\_\+\+METHOD and integrates ECDSA and ECDH functionality into EC. Implementations can now redirect key generation and no longer need to convert to or from ECDSA\+\_\+\+SIG format.

Note\+: the \doxylink{ecdsa_8h_source}{ecdsa.\+h} and \doxylink{ecdh_8h_source}{ecdh.\+h} headers are now no longer needed and just include the ec.\+h header file instead.

{\itshape Steve Henson}
\item Remove support for all 40 and 56 bit ciphers. This includes all the export ciphers who are no longer supported and drops support the ephemeral RSA key exchange. The LOW ciphers currently doesn\textquotesingle{}t have any ciphers in it.

{\itshape Kurt Roeckx}
\item Made EVP\+\_\+\+MD\+\_\+\+CTX, EVP\+\_\+\+MD, EVP\+\_\+\+CIPHER\+\_\+\+CTX, EVP\+\_\+\+CIPHER and HMAC\+\_\+\+CTX opaque. For HMAC\+\_\+\+CTX, the following constructors and destructors were added\+: \begin{DoxyVerb}HMAC_CTX *HMAC_CTX_new(void);
void HMAC_CTX_free(HMAC_CTX *ctx);
\end{DoxyVerb}
 For EVP\+\_\+\+MD and EVP\+\_\+\+CIPHER, complete APIs to create, fill and destroy such methods has been added. See EVP\+\_\+\+MD\+\_\+meth\+\_\+new(3) and EVP\+\_\+\+CIPHER\+\_\+meth\+\_\+new(3) for documentation.

Additional changes\+: 1) {\ttfamily EVP\+\_\+\+MD\+\_\+\+CTX\+\_\+cleanup()}, {\ttfamily EVP\+\_\+\+CIPHER\+\_\+\+CTX\+\_\+cleanup()} and {\ttfamily HMAC\+\_\+\+CTX\+\_\+cleanup()} were removed. {\ttfamily HMAC\+\_\+\+CTX\+\_\+reset()} and {\ttfamily EVP\+\_\+\+MD\+\_\+\+CTX\+\_\+reset()} should be called instead to reinitialise an already created structure. 2) For consistency with the majority of our object creators and destructors, {\ttfamily EVP\+\_\+\+MD\+\_\+\+CTX\+\_\+(create\texorpdfstring{$\vert$}{|}destroy)} were renamed to {\ttfamily EVP\+\_\+\+MD\+\_\+\+CTX\+\_\+(new\texorpdfstring{$\vert$}{|}free)}. The old names are retained as macros for deprecated builds.

{\itshape Richard Levitte}
\item Added ASYNC support. Libcrypto now includes the async sub-\/library to enable cryptographic operations to be performed asynchronously as long as an asynchronous capable engine is used. See the ASYNC\+\_\+start\+\_\+job() man page for further details. Libssl has also had this capability integrated with the introduction of the new mode SSL\+\_\+\+MODE\+\_\+\+ASYNC and associated error SSL\+\_\+\+ERROR\+\_\+\+WANT\+\_\+\+ASYNC. See the SSL\+\_\+\+CTX\+\_\+set\+\_\+mode() and SSL\+\_\+get\+\_\+error() man pages. This work was developed in partnership with Intel Corp.

{\itshape Matt Caswell}
\item SSL\+\_\+\{CTX\+\_\+\}set\+\_\+ecdh\+\_\+auto() has been removed and ECDH is support is always enabled now. If you want to disable the support you should exclude it using the list of supported ciphers. This also means that the "{}-\/no\+\_\+ecdhe"{} option has been removed from s\+\_\+server.

{\itshape Kurt Roeckx}
\item SSL\+\_\+\{CTX\}\+\_\+set\+\_\+tmp\+\_\+ecdh() which can set 1 EC curve now internally calls SSL\+\_\+\{CTX\+\_\+\}set1\+\_\+curves() which can set a list.

{\itshape Kurt Roeckx}
\item Remove support for SSL\+\_\+\{CTX\+\_\+\}set\+\_\+tmp\+\_\+ecdh\+\_\+callback(). You should set the curve you want to support using SSL\+\_\+\{CTX\+\_\+\}set1\+\_\+curves().

{\itshape Kurt Roeckx}
\item State machine rewrite. The state machine code has been significantly refactored in order to remove much duplication of code and solve issues with the old code (see \doxysectlink{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2ssl_2statem_2_r_e_a_d_m_e}{ssl/statem/\+README.md}{0} for further details). This change does have some associated API changes. Notably the SSL\+\_\+state() function has been removed and replaced by SSL\+\_\+get\+\_\+state which now returns an "{}\+OSSL\+\_\+\+HANDSHAKE\+\_\+\+STATE"{} instead of an int. SSL\+\_\+set\+\_\+state() has been removed altogether. The previous handshake states defined in ssl.\+h and \doxylink{ssl3_8h_source}{ssl3.\+h} have also been removed.

{\itshape Matt Caswell}
\item All instances of the string "{}ssleay"{} in the public API were replaced with Open\+SSL (case-\/matching; e.\+g., OPENSSL\+\_\+\+VERSION for define\textquotesingle{}s) Some error codes related to internal RSA\+\_\+eay API\textquotesingle{}s were renamed.

{\itshape Rich Salz}
\item The demo files in crypto/threads were moved to demo/threads.

{\itshape Rich Salz}
\item Removed obsolete engines\+: 4758cca, aep, atalla, cswift, nuron, gmp, sureware and ubsec.

{\itshape Matt Caswell, Rich Salz}
\item New ASN.\+1 embed macro.

New ASN.\+1 macro ASN1\+\_\+\+EMBED. This is the same as ASN1\+\_\+\+SIMPLE except the structure is not allocated\+: it is part of the parent. That is instead of \begin{DoxyVerb}    FOO *x;
\end{DoxyVerb}
 it must be\+: \begin{DoxyVerb}    FOO x;
\end{DoxyVerb}
 This reduces memory fragmentation and make it impossible to accidentally set a mandatory field to NULL.

This currently only works for some fields specifically a SEQUENCE, CHOICE, or ASN1\+\_\+\+STRING type which is part of a parent SEQUENCE. Since it is equivalent to ASN1\+\_\+\+SIMPLE it cannot be tagged, OPTIONAL, SET OF or SEQUENCE OF.

{\itshape Steve Henson}
\item Remove EVP\+\_\+\+CHECK\+\_\+\+DES\+\_\+\+KEY, a compile-\/time option that never compiled.

{\itshape Emilia Käsper}
\item Removed DES and RC4 ciphersuites from DEFAULT. Also removed RC2 although in 1.\+0.\+2 EXPORT was already removed and the only RC2 ciphersuite is also an EXPORT one. COMPLEMENTOFDEFAULT has been updated accordingly to add DES and RC4 ciphersuites.

{\itshape Matt Caswell}
\item Rewrite EVP\+\_\+\+Decode\+Update (base64 decoding) to fix several bugs. This changes the decoding behaviour for some invalid messages, though the change is mostly in the more lenient direction, and legacy behaviour is preserved as much as possible.

{\itshape Emilia Käsper}
\item Fix no-\/stdio build. \texorpdfstring{$\ast$}{*}\+David Woodhouse \href{mailto:David.Woodhouse@intel.com}{\texttt{ David.\+Woodhouse@intel.\+com}} and also\texorpdfstring{$\ast$}{*} \texorpdfstring{$\ast$}{*}\+Ivan Nestlerode \href{mailto:ivan.nestlerode@sonos.com}{\texttt{ ivan.\+nestlerode@sonos.\+com}}\texorpdfstring{$\ast$}{*}
\item New testing framework The testing framework has been largely rewritten and is now using perl and the perl modules Test\+::\+Harness and an extended variant of Test\+::\+More called Open\+SSL\+::\+Test to do its work. All test scripts in test/ have been rewritten into test recipes, and all direct calls to executables in test/\+Makefile have become individual recipes using the simplified testing Open\+SSL\+::\+Test\+::\+Simple.

For documentation on our testing modules, do\+: \begin{DoxyVerb}    perldoc test/testlib/OpenSSL/Test/Simple.pm
    perldoc test/testlib/OpenSSL/Test.pm
\end{DoxyVerb}
 {\itshape Richard Levitte}
\item Revamped memory debug; only -\/DCRYPTO\+\_\+\+MDEBUG and -\/DCRYPTO\+\_\+\+MDEBUG\+\_\+\+ABORT are used; the latter aborts on memory leaks (usually checked on exit). Some undocumented "{}set malloc, etc., hooks"{} functions were removed and others were changed. All are now documented.

{\itshape Rich Salz}
\item In DSA\+\_\+generate\+\_\+parameters\+\_\+ex, if the provided seed is too short, return an error

\texorpdfstring{$\ast$}{*}\+Rich Salz and Ismo Puustinen \href{mailto:ismo.puustinen@intel.com}{\texttt{ ismo.\+puustinen@intel.\+com}}\texorpdfstring{$\ast$}{*}
\item Rewrite PSK to support ECDHE\+\_\+\+PSK, DHE\+\_\+\+PSK and RSA\+\_\+\+PSK. Add ciphersuites from RFC4279, RFC4785, RFC5487, RFC5489.

Thanks to Christian J. Dietrich and Giuseppe D\textquotesingle{}Angelo for the original RSA\+\_\+\+PSK patch.

{\itshape Steve Henson}
\item Dropped support for the SSL3\+\_\+\+FLAGS\+\_\+\+DELAY\+\_\+\+CLIENT\+\_\+\+FINISHED flag. This SSLeay era flag was never set throughout the codebase (only read). Also removed SSL3\+\_\+\+FLAGS\+\_\+\+POP\+\_\+\+BUFFER which was only used if SSL3\+\_\+\+FLAGS\+\_\+\+DELAY\+\_\+\+CLIENT\+\_\+\+FINISHED was also set.

{\itshape Matt Caswell}
\item Changed the default name options in the "{}ca"{}, "{}crl"{}, "{}req"{} and "{}x509"{} to be "{}oneline"{} instead of "{}compat"{}.

{\itshape Richard Levitte}
\item Remove SSL\+\_\+\+OP\+\_\+\+TLS\+\_\+\+BLOCK\+\_\+\+PADDING\+\_\+\+BUG. This is SSLeay legacy, we\textquotesingle{}re not aware of clients that still exhibit this bug, and the workaround hasn\textquotesingle{}t been working properly for a while.

{\itshape Emilia Käsper}
\item The return type of BIO\+\_\+number\+\_\+read() and BIO\+\_\+number\+\_\+written() as well as the corresponding num\+\_\+read and num\+\_\+write members in the BIO structure has changed from unsigned long to uint64\+\_\+t. On platforms where an unsigned long is 32 bits (e.\+g. Windows) these counters could overflow if \texorpdfstring{$>$}{>}4Gb is transferred.

{\itshape Matt Caswell}
\item Given the pervasive nature of TLS extensions it is inadvisable to run Open\+SSL without support for them. It also means that maintaining the OPENSSL\+\_\+\+NO\+\_\+\+TLSEXT option within the code is very invasive (and probably not well tested). Therefore, the OPENSSL\+\_\+\+NO\+\_\+\+TLSEXT option has been removed.

{\itshape Matt Caswell}
\item Removed support for the two export grade static DH ciphersuites EXP-\/\+DH-\/\+RSA-\/\+DES-\/\+CBC-\/\+SHA and EXP-\/\+DH-\/\+DSS-\/\+DES-\/\+CBC-\/\+SHA. These two ciphersuites were newly added (along with a number of other static DH ciphersuites) to 1.\+0.\+2. However the two export ones have {\itshape never} worked since they were introduced. It seems strange in any case to be adding new export ciphersuites, and given "{}logjam"{} it also does not seem correct to fix them.

{\itshape Matt Caswell}
\item Version negotiation has been rewritten. In particular SSLv23\+\_\+method(), SSLv23\+\_\+client\+\_\+method() and SSLv23\+\_\+server\+\_\+method() have been deprecated, and turned into macros which simply call the new preferred function names TLS\+\_\+method(), TLS\+\_\+client\+\_\+method() and TLS\+\_\+server\+\_\+method(). All new code should use the new names instead. Also as part of this change the ssl23.\+h header file has been removed.

{\itshape Matt Caswell}
\item Support for Kerberos ciphersuites in TLS (RFC2712) has been removed. This code and the associated standard is no longer considered fit-\/for-\/purpose.

{\itshape Matt Caswell}
\item RT2547 was closed. When generating a private key, try to make the output file readable only by the owner. This behavior change might be noticeable when interacting with other software.
\item Documented all exdata functions. Added CRYPTO\+\_\+free\+\_\+ex\+\_\+index. Added a test.

{\itshape Rich Salz}
\item Added HTTP GET support to the ocsp command.

{\itshape Rich Salz}
\item Changed default digest for the dgst and enc commands from MD5 to sha256

{\itshape Rich Salz}
\item RAND\+\_\+pseudo\+\_\+bytes has been deprecated. Users should use RAND\+\_\+bytes instead.

{\itshape Matt Caswell}
\item Added support for TLS extended master secret from draft-\/ietf-\/tls-\/session-\/hash-\/03.\+txt. Thanks for Alfredo Pironti for an initial patch which was a great help during development.

{\itshape Steve Henson}
\item All libssl internal structures have been removed from the public header files, and the OPENSSL\+\_\+\+NO\+\_\+\+SSL\+\_\+\+INTERN option has been removed (since it is now redundant). Users should not attempt to access internal structures directly. Instead they should use the provided API functions.

{\itshape Matt Caswell}
\item config has been changed so that by default OPENSSL\+\_\+\+NO\+\_\+\+DEPRECATED is used. Access to deprecated functions can be re-\/enabled by running config with "{}enable-\/deprecated"{}. In addition applications wishing to use deprecated functions must define OPENSSL\+\_\+\+USE\+\_\+\+DEPRECATED. Note that this new behaviour will, by default, disable some transitive includes that previously existed in the header files (e.\+g. ec.\+h will no longer, by default, include bn.\+h)

{\itshape Matt Caswell}
\item Added support for OCB mode. Open\+SSL has been granted a patent license compatible with the Open\+SSL license for use of OCB. Details are available at \href{https://www.openssl.org/source/OCB-patent-grant-OpenSSL.pdf}{\texttt{ https\+://www.\+openssl.\+org/source/\+OCB-\/patent-\/grant-\/\+Open\+SSL.\+pdf}}. Support for OCB can be removed by calling config with no-\/ocb.

{\itshape Matt Caswell}
\item SSLv2 support has been removed. It still supports receiving an SSLv2 compatible client hello.

{\itshape Kurt Roeckx}
\item Increased the minimal RSA keysize from 256 to 512 bits \mbox{[}Rich Salz\mbox{]}, done while fixing the error code for the key-\/too-\/small case.

\texorpdfstring{$\ast$}{*}\+Annie Yousar \href{mailto:a.yousar@informatik.hu-berlin.de}{\texttt{ a.\+yousar@informatik.\+hu-\/berlin.\+de}}\texorpdfstring{$\ast$}{*}
\item CA.\+sh has been removed; use CA.\+pl instead.

{\itshape Rich Salz}
\item Removed old DES API.

{\itshape Rich Salz}
\item Remove various unsupported platforms\+: Sony NEWS4 BEOS and BEOS\+\_\+\+R5 Ne\+XT SUNOS MPE/iX Sinix/\+Reliant\+UNIX RM400 DGUX NCR Tandem Cray 16-\/bit platforms such as WIN16

{\itshape Rich Salz}
\item Clean up OPENSSL\+\_\+\+NO\+\_\+xxx define\textquotesingle{}s
\begin{DoxyItemize}
\item Use setbuf() and remove OPENSSL\+\_\+\+NO\+\_\+\+SETVBUF\+\_\+\+IONBF
\item Rename OPENSSL\+\_\+\+SYSNAME\+\_\+xxx to OPENSSL\+\_\+\+SYS\+\_\+xxx
\item OPENSSL\+\_\+\+NO\+\_\+\+EC\{DH,DSA\} merged into OPENSSL\+\_\+\+NO\+\_\+\+EC
\item OPENSSL\+\_\+\+NO\+\_\+\+RIPEMD160, OPENSSL\+\_\+\+NO\+\_\+\+RIPEMD merged into OPENSSL\+\_\+\+NO\+\_\+\+RMD160
\item OPENSSL\+\_\+\+NO\+\_\+\+FP\+\_\+\+API merged into OPENSSL\+\_\+\+NO\+\_\+\+STDIO
\item Remove OPENSSL\+\_\+\+NO\+\_\+\+BIO OPENSSL\+\_\+\+NO\+\_\+\+BUFFER OPENSSL\+\_\+\+NO\+\_\+\+CHAIN\+\_\+\+VERIFY OPENSSL\+\_\+\+NO\+\_\+\+EVP OPENSSL\+\_\+\+NO\+\_\+\+FIPS\+\_\+\+ERR OPENSSL\+\_\+\+NO\+\_\+\+HASH\+\_\+\+COMP OPENSSL\+\_\+\+NO\+\_\+\+LHASH OPENSSL\+\_\+\+NO\+\_\+\+OBJECT OPENSSL\+\_\+\+NO\+\_\+\+SPEED OPENSSL\+\_\+\+NO\+\_\+\+STACK OPENSSL\+\_\+\+NO\+\_\+\+X509 OPENSSL\+\_\+\+NO\+\_\+\+X509\+\_\+\+VERIFY
\item Remove MS\+\_\+\+STATIC; it\textquotesingle{}s a relic from platforms \texorpdfstring{$<$}{<}32 bits.
\end{DoxyItemize}

\texorpdfstring{$\ast$}{*}\+Rich Salz\texorpdfstring{$\ast$}{*}
\item Cleaned up dead code Remove all but one \textquotesingle{}ifdef undef\textquotesingle{} which is to be looked at.

\texorpdfstring{$\ast$}{*}\+Rich Salz\texorpdfstring{$\ast$}{*}
\item Clean up calling of xxx\+\_\+free routines. Just like free(), fix most of the xxx\+\_\+free routines to accept NULL. Remove the non-\/null checks from callers. Save much code.

\texorpdfstring{$\ast$}{*}\+Rich Salz\texorpdfstring{$\ast$}{*}
\item Add secure heap for storage of private keys (when possible). Add BIO\+\_\+s\+\_\+secmem(), CBIGNUM, etc. Contributed by Akamai Technologies under our Corporate CLA.

\texorpdfstring{$\ast$}{*}\+Rich Salz\texorpdfstring{$\ast$}{*}
\item Experimental support for a new, fast, unbiased prime candidate generator, bn\+\_\+probable\+\_\+prime\+\_\+dh\+\_\+coprime(). Not currently used by any prime generator.

\texorpdfstring{$\ast$}{*}\+Felix Laurie von Massenbach \href{mailto:felix@erbridge.co.uk}{\texttt{ felix@erbridge.\+co.\+uk}}\texorpdfstring{$\ast$}{*}
\item New output format NSS in the sess\+\_\+id command line tool. This allows exporting the session id and the master key in NSS keylog format.

\texorpdfstring{$\ast$}{*}\+Martin Kaiser \href{mailto:martin@kaiser.cx}{\texttt{ martin@kaiser.\+cx}}\texorpdfstring{$\ast$}{*}
\item Harmonize version and its documentation. -\/f flag is used to display compilation flags.

\texorpdfstring{$\ast$}{*}mancha \href{mailto:mancha1@zoho.com}{\texttt{ mancha1@zoho.\+com}}\texorpdfstring{$\ast$}{*}
\item Fix eckey\+\_\+priv\+\_\+encode so it immediately returns an error upon a failure in i2d\+\_\+\+ECPrivate\+Key. Thanks to Ted Unangst for feedback on this issue.

\texorpdfstring{$\ast$}{*}mancha \href{mailto:mancha1@zoho.com}{\texttt{ mancha1@zoho.\+com}}\texorpdfstring{$\ast$}{*}
\item Fix some double frees. These are not thought to be exploitable.

\texorpdfstring{$\ast$}{*}mancha \href{mailto:mancha1@zoho.com}{\texttt{ mancha1@zoho.\+com}}\texorpdfstring{$\ast$}{*}
\item A missing bounds check in the handling of the TLS heartbeat extension can be used to reveal up to 64k of memory to a connected client or server.

Thanks for Neel Mehta of Google Security for discovering this bug and to Adam Langley \href{mailto:agl@chromium.org}{\texttt{ agl@chromium.\+org}} and Bodo Moeller \href{mailto:bmoeller@acm.org}{\texttt{ bmoeller@acm.\+org}} for preparing the fix (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-0160}{\texttt{ CVE-\/2014-\/0160}})

{\itshape Adam Langley, Bodo Moeller}
\item Fix for the attack described in the paper "{}\+Recovering Open\+SSL    ECDSA Nonces Using the FLUSH+\+RELOAD Cache Side-\/channel Attack"{} by Yuval Yarom and Naomi Benger. Details can be obtained from\+: \href{http://eprint.iacr.org/2014/140}{\texttt{ http\+://eprint.\+iacr.\+org/2014/140}}

Thanks to Yuval Yarom and Naomi Benger for discovering this flaw and to Yuval Yarom for supplying a fix (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-0076}{\texttt{ CVE-\/2014-\/0076}})

{\itshape Yuval Yarom and Naomi Benger}
\item Use algorithm specific chains in SSL\+\_\+\+CTX\+\_\+use\+\_\+certificate\+\_\+chain\+\_\+file()\+: this fixes a limitation in previous versions of Open\+SSL.

{\itshape Steve Henson}
\item Experimental encrypt-\/then-\/mac support.

Experimental support for encrypt then mac from draft-\/gutmann-\/tls-\/encrypt-\/then-\/mac-\/02.\+txt

To enable it set the appropriate extension number (0x42 for the test server) using e.\+g. -\/DTLSEXT\+\_\+\+TYPE\+\_\+encrypt\+\_\+then\+\_\+mac=0x42

For non-\/compliant peers (i.\+e. just about everything) this should have no effect.

WARNING\+: EXPERIMENTAL, SUBJECT TO CHANGE.

{\itshape Steve Henson}
\item Add EVP support for key wrapping algorithms, to avoid problems with existing code the flag EVP\+\_\+\+CIPHER\+\_\+\+CTX\+\_\+\+WRAP\+\_\+\+ALLOW has to be set in the EVP\+\_\+\+CIPHER\+\_\+\+CTX or an error is returned. Add AES and DES3 wrap algorithms and include tests cases.

{\itshape Steve Henson}
\item Extend CMS code to support RSA-\/\+PSS signatures and RSA-\/\+OAEP for enveloped data.

{\itshape Steve Henson}
\item Extended RSA OAEP support via EVP\+\_\+\+PKEY API. Options to specify digest, MGF1 digest and OAEP label.

{\itshape Steve Henson}
\item Make openssl verify return errors.

\texorpdfstring{$\ast$}{*}\+Chris Palmer \href{mailto:palmer@google.com}{\texttt{ palmer@google.\+com}} and Ben Laurie\texorpdfstring{$\ast$}{*}
\item New function ASN1\+\_\+\+TIME\+\_\+diff to calculate the difference between two ASN1\+\_\+\+TIME structures or one structure and the current time.

{\itshape Steve Henson}
\item Update fips\+\_\+test\+\_\+suite to support multiple command line options. New test to induce all self test errors in sequence and check expected failures.

{\itshape Steve Henson}
\item Add FIPS\+\_\+\{rsa,dsa,ecdsa\}\+\_\+\{sign,verify\} functions which digest and sign or verify all in one operation.

{\itshape Steve Henson}
\item Add fips\+\_\+algvs\+: a multicall fips utility incorporating all the algorithm test programs and fips\+\_\+test\+\_\+suite. Includes functionality to parse the minimal script output of fipsalgest.\+pl directly.

{\itshape Steve Henson}
\item Add authorisation parameter to FIPS\+\_\+module\+\_\+mode\+\_\+set().

{\itshape Steve Henson}
\item Add FIPS selftest for ECDH algorithm using P-\/224 and B-\/233 curves.

{\itshape Steve Henson}
\item Use separate DRBG fields for internal and external flags. New function FIPS\+\_\+drbg\+\_\+health\+\_\+check() to perform on demand health checking. Add generation tests to fips\+\_\+test\+\_\+suite with reduced health check interval to demonstrate periodic health checking. Add "{}nodh"{} option to fips\+\_\+test\+\_\+suite to skip very slow DH test.

{\itshape Steve Henson}
\item New function FIPS\+\_\+get\+\_\+cipherbynid() to lookup FIPS supported ciphers based on NID.

{\itshape Steve Henson}
\item More extensive health check for DRBG checking many more failure modes. New function FIPS\+\_\+selftest\+\_\+drbg\+\_\+all() to handle every possible DRBG combination\+: call this in fips\+\_\+test\+\_\+suite.

{\itshape Steve Henson}
\item Add support for canonical generation of DSA parameter \textquotesingle{}g\textquotesingle{}. See FIPS 186-\/3 A.\+2.\+3.
\item Add support for HMAC DRBG from SP800-\/90. Update DRBG algorithm test and POST to handle HMAC cases.

{\itshape Steve Henson}
\item Add functions FIPS\+\_\+module\+\_\+version() and FIPS\+\_\+module\+\_\+version\+\_\+text() to return numerical and string versions of the FIPS module number.

{\itshape Steve Henson}
\item Rename FIPS\+\_\+mode\+\_\+set and FIPS\+\_\+mode to FIPS\+\_\+module\+\_\+mode\+\_\+set and FIPS\+\_\+module\+\_\+mode. FIPS\+\_\+mode and FIPS\+\_\+mode\+\_\+set will be implemented outside the validated module in the FIPS capable Open\+SSL.

{\itshape Steve Henson}
\item Minor change to DRBG entropy callback semantics. In some cases there is no multiple of the block length between min\+\_\+len and max\+\_\+len. Allow the callback to return more than max\+\_\+len bytes of entropy but discard any extra\+: it is the callback\textquotesingle{}s responsibility to ensure that the extra data discarded does not impact the requested amount of entropy.

{\itshape Steve Henson}
\item Add PRNG security strength checks to RSA, DSA and ECDSA using information in FIPS186-\/3, SP800-\/57 and SP800-\/131A.

{\itshape Steve Henson}
\item CCM support via EVP. Interface is very similar to GCM case except we must supply all data in one chunk (i.\+e. no update, final) and the message length must be supplied if AAD is used. Add algorithm test support.

{\itshape Steve Henson}
\item Initial version of POST overhaul. Add POST callback to allow the status of POST to be monitored and/or failures induced. Modify fips\+\_\+test\+\_\+suite to use callback. Always run all selftests even if one fails.

{\itshape Steve Henson}
\item XTS support including algorithm test driver in the fips\+\_\+gcmtest program. Note\+: this does increase the maximum key length from 32 to 64 bytes but there should be no binary compatibility issues as existing applications will never use XTS mode.

{\itshape Steve Henson}
\item Extensive reorganisation of FIPS PRNG behaviour. Remove all dependencies to Open\+SSL RAND code and replace with a tiny FIPS RAND API which also performs algorithm blocking for unapproved PRNG types. Also do not set PRNG type in FIPS\+\_\+mode\+\_\+set()\+: leave this to the application. Add default Open\+SSL DRBG handling\+: sets up FIPS PRNG and seeds with the standard Open\+SSL PRNG\+: set additional data to a date time vector.

{\itshape Steve Henson}
\item Rename old X9.\+31 PRNG functions of the form {\ttfamily FIPS\+\_\+rand\texorpdfstring{$\ast$}{*}} to {\ttfamily FIPS\+\_\+x931\texorpdfstring{$\ast$}{*}}. This shouldn\textquotesingle{}t present any incompatibility problems because applications shouldn\textquotesingle{}t be using these directly and any that are will need to rethink anyway as the X9.\+31 PRNG is now deprecated by FIPS 140-\/2

{\itshape Steve Henson}
\item Extensive self tests and health checking required by SP800-\/90 DRBG. Remove strength parameter from FIPS\+\_\+drbg\+\_\+instantiate and always instantiate at maximum supported strength.

{\itshape Steve Henson}
\item Add ECDH code to fips module and fips\+\_\+ecdhvs for primitives only testing.

{\itshape Steve Henson}
\item New algorithm test program fips\+\_\+dhvs to handle DH primitives only testing.

{\itshape Steve Henson}
\item New function DH\+\_\+compute\+\_\+key\+\_\+padded() to compute a DH key and pad with leading zeroes if needed\+: this complies with SP800-\/56A et al.

{\itshape Steve Henson}
\item Initial implementation of SP800-\/90 DRBGs for Hash and CTR. Not used by anything, incomplete, subject to change and largely untested at present.

{\itshape Steve Henson}
\item Modify fipscanisteronly build option to only build the necessary object files by filtering FIPS\+\_\+\+EX\+\_\+\+OBJ through a perl script in crypto/\+Makefile.

{\itshape Steve Henson}
\item Add experimental option FIPSSYMS to give all symbols in fipscanister.\+o and FIPS or fips prefix. This will avoid conflicts with future versions of Open\+SSL. Add perl script util/fipsas.\+pl to preprocess assembly language source files and rename any affected symbols.

{\itshape Steve Henson}
\item Add selftest checks and algorithm block of non-\/fips algorithms in FIPS mode. Remove DES2 from selftests.

{\itshape Steve Henson}
\item Add ECDSA code to fips module. Add tiny fips\+\_\+ecdsa\+\_\+check to just return internal method without any ENGINE dependencies. Add new tiny fips sign and verify functions.

{\itshape Steve Henson}
\item New build option no-\/ec2m to disable characteristic 2 code.

{\itshape Steve Henson}
\item New build option "{}fipscanisteronly"{}. This only builds fipscanister.\+o and (currently) associated fips utilities. Uses the file Makefile.\+fips instead of Makefile.\+org as the prototype.

{\itshape Steve Henson}
\item Add some FIPS mode restrictions to GCM. Add internal IV generator. Update fips\+\_\+gcmtest to use IV generator.

{\itshape Steve Henson}
\item Initial, experimental EVP support for AES-\/\+GCM. AAD can be input by setting output buffer to NULL. The {\ttfamily \texorpdfstring{$\ast$}{*}\+Final} function must be called although it will not retrieve any additional data. The tag can be set or retrieved with a ctrl. The IV length is by default 12 bytes (96 bits) but can be set to an alternative value. If the IV length exceeds the maximum IV length (currently 16 bytes) it cannot be set before the key.

{\itshape Steve Henson}
\item New flag in ciphers\+: EVP\+\_\+\+CIPH\+\_\+\+FLAG\+\_\+\+CUSTOM\+\_\+\+CIPHER. This means the underlying do\+\_\+cipher function handles all cipher semantics itself including padding and finalisation. This is useful if (for example) an ENGINE cipher handles block padding itself. The behaviour of do\+\_\+cipher is subtly changed if this flag is set\+: the return value is the number of characters written to the output buffer (zero is no longer an error code) or a negative error code. Also if the input buffer is NULL and length 0 finalisation should be performed.

{\itshape Steve Henson}
\item If a candidate issuer certificate is already part of the constructed path ignore it\+: new debug notification X509\+\_\+\+V\+\_\+\+ERR\+\_\+\+PATH\+\_\+\+LOOP for this case.

{\itshape Steve Henson}
\item Improve forward-\/security support\+: add functions \begin{DoxyVerb}    void SSL_CTX_set_not_resumable_session_callback(
             SSL_CTX *ctx, int (*cb)(SSL *ssl, int is_forward_secure))
    void SSL_set_not_resumable_session_callback(
             SSL *ssl, int (*cb)(SSL *ssl, int is_forward_secure))
\end{DoxyVerb}
 for use by SSL/\+TLS servers; the callback function will be called whenever a new session is created, and gets to decide whether the session may be cached to make it resumable (return 0) or not (return 1). (As by the SSL/\+TLS protocol specifications, the session\+\_\+id sent by the server will be empty to indicate that the session is not resumable; also, the server will not generate RFC 4507 (RFC 5077) session tickets.)

A simple reasonable callback implementation is to return is\+\_\+forward\+\_\+secure. This parameter will be set to 1 or 0 depending on the ciphersuite selected by the SSL/\+TLS server library, indicating whether it can provide forward security.

\texorpdfstring{$\ast$}{*}\+Emilia Käsper \href{mailto:emilia.kasper@esat.kuleuven.be}{\texttt{ emilia.\+kasper@esat.\+kuleuven.\+be}} (Google)\texorpdfstring{$\ast$}{*}
\item New -\/verify\+\_\+name option in command line utilities to set verification parameters by name.

{\itshape Steve Henson}
\item Initial CMAC implementation. WARNING\+: EXPERIMENTAL, API MAY CHANGE. Add CMAC pkey methods.

{\itshape Steve Henson}
\item Experimental renegotiation in s\+\_\+server -\/www mode. If the client browses /reneg connection is renegotiated. If /renegcert it is renegotiated requesting a certificate.

{\itshape Steve Henson}
\item Add an "{}external"{} session cache for debugging purposes to s\+\_\+server. This should help trace issues which normally are only apparent in deployed multi-\/process servers.

{\itshape Steve Henson}
\item Extensive audit of libcrypto with DEBUG\+\_\+\+UNUSED. Fix many cases where return value is ignored. NB. The functions RAND\+\_\+add(), RAND\+\_\+seed(), BIO\+\_\+set\+\_\+cipher() and some obscure PEM functions were changed so they can now return an error. The RAND changes required a change to the RAND\+\_\+\+METHOD structure.

{\itshape Steve Henson}
\item New macro {\ttfamily \+\_\+\+\_\+owur} for "{}\+Open\+SSL Warn Unused Result"{}. This makes use of a gcc attribute to warn if the result of a function is ignored. This is enable if DEBUG\+\_\+\+UNUSED is set. Add to several functions in evp.\+h whose return value is often ignored.

{\itshape Steve Henson}
\item New -\/noct, -\/requestct, -\/requirect and -\/ctlogfile options for s\+\_\+client. These allow SCTs (signed certificate timestamps) to be requested and validated when establishing a connection.

\texorpdfstring{$\ast$}{*}\+Rob Percival \href{mailto:robpercival@google.com}{\texttt{ robpercival@google.\+com}}\texorpdfstring{$\ast$}{*}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md52}{}\doxysection{\texorpdfstring{Open\+SSL 1.\+0.\+2}{Open\+SSL 1.\+0.\+2}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md52}
\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md53}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+2s and 1.\+0.\+2t \mbox{[}10 Sep 2019\mbox{]}}{Changes between 1.\+0.\+2s and 1.\+0.\+2t \mbox{[}10 Sep 2019\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md53}

\begin{DoxyItemize}
\item For built-\/in EC curves, ensure an EC\+\_\+\+GROUP built from the curve name is used even when parsing explicit parameters, when loading a encoded key or calling {\ttfamily EC\+\_\+\+GROUP\+\_\+new\+\_\+from\+\_\+ecpkparameters()}/ {\ttfamily EC\+\_\+\+GROUP\+\_\+new\+\_\+from\+\_\+ecparameters()}. This prevents bypass of security hardening and performance gains, especially for curves with specialized EC\+\_\+\+METHODs. By default, if a key encoded with explicit parameters is loaded and later encoded, the output is still encoded with explicit parameters, even if internally a "{}named"{} EC\+\_\+\+GROUP is used for computation.

{\itshape Nicola Tuveri}
\item Compute ECC cofactors if not provided during EC\+\_\+\+GROUP construction. Before this change, EC\+\_\+\+GROUP\+\_\+set\+\_\+generator would accept order and/or cofactor as NULL. After this change, only the cofactor parameter can be NULL. It also does some minimal sanity checks on the passed order. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2019-1547}{\texttt{ CVE-\/2019-\/1547}})

{\itshape Billy Bob Brumley}
\item Fixed a padding oracle in PKCS7\+\_\+data\+Decode and CMS\+\_\+decrypt\+\_\+set1\+\_\+pkey. An attack is simple, if the first CMS\+\_\+recipient\+Info is valid but the second CMS\+\_\+recipient\+Info is chosen ciphertext. If the second recipient\+Info decodes to PKCS \#1 v1.\+5 form plaintext, the correct encryption key will be replaced by garbage, and the message cannot be decoded, but if the RSA decryption fails, the correct encryption key is used and the recipient will not notice the attack. As a work around for this potential attack the length of the decrypted key must be equal to the cipher default key length, in case the certificate is not given and all recipient\+Info are tried out. The old behaviour can be re-\/enabled in the CMS code by setting the CMS\+\_\+\+DEBUG\+\_\+\+DECRYPT flag. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2019-1563}{\texttt{ CVE-\/2019-\/1563}})

{\itshape Bernd Edlinger}
\item Document issue with installation paths in diverse Windows builds

\textquotesingle{}/usr/local/ssl\textquotesingle{} is an unsafe prefix for location to install Open\+SSL binaries and run-\/time config file. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2019-1552}{\texttt{ CVE-\/2019-\/1552}})

{\itshape Richard Levitte}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md54}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+2r and 1.\+0.\+2s \mbox{[}28 May 2019\mbox{]}}{Changes between 1.\+0.\+2r and 1.\+0.\+2s \mbox{[}28 May 2019\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md54}

\begin{DoxyItemize}
\item Change the default RSA, DSA and DH size to 2048 bit instead of 1024. This changes the size when using the {\ttfamily genpkey} command when no size is given. It fixes an omission in earlier changes that changed all RSA, DSA and DH generation commands to use 2048 bits by default.

{\itshape Kurt Roeckx}
\item Add FIPS support for Android Arm 64-\/bit

Support for Android Arm 64-\/bit was added to the Open\+SSL FIPS Object Module in Version 2.\+0.\+10. For some reason, the corresponding target \textquotesingle{}android64-\/aarch64\textquotesingle{} was missing Open\+SSL 1.\+0.\+2, whence it could not be built with FIPS support on Android Arm 64-\/bit. This omission has been fixed.

{\itshape Matthias St. Pierre}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md55}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+2q and 1.\+0.\+2r \mbox{[}26 Feb 2019\mbox{]}}{Changes between 1.\+0.\+2q and 1.\+0.\+2r \mbox{[}26 Feb 2019\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md55}

\begin{DoxyItemize}
\item 0-\/byte record padding oracle

If an application encounters a fatal protocol error and then calls SSL\+\_\+shutdown() twice (once to send a close\+\_\+notify, and once to receive one) then Open\+SSL can respond differently to the calling application if a 0 byte record is received with invalid padding compared to if a 0 byte record is received with an invalid MAC. If the application then behaves differently based on that in a way that is detectable to the remote peer, then this amounts to a padding oracle that could be used to decrypt data.

In order for this to be exploitable "{}non-\/stitched"{} ciphersuites must be in use. Stitched ciphersuites are optimised implementations of certain commonly used ciphersuites. Also the application must call SSL\+\_\+shutdown() twice even if a protocol error has occurred (applications should not do this but some do anyway).

This issue was discovered by Juraj Somorovsky, Robert Merget and Nimrod Aviram, with additional investigation by Steven Collison and Andrew Hourselt. It was reported to Open\+SSL on 10th December 2018. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2019-1559}{\texttt{ CVE-\/2019-\/1559}})

{\itshape Matt Caswell}
\item Move strictness check from EVP\+\_\+\+PKEY\+\_\+asn1\+\_\+new() to EVP\+\_\+\+PKEY\+\_\+asn1\+\_\+add0().

{\itshape Richard Levitte}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md56}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+2p and 1.\+0.\+2q \mbox{[}20 Nov 2018\mbox{]}}{Changes between 1.\+0.\+2p and 1.\+0.\+2q \mbox{[}20 Nov 2018\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md56}

\begin{DoxyItemize}
\item Microarchitecture timing vulnerability in ECC scalar multiplication

Open\+SSL ECC scalar multiplication, used in e.\+g. ECDSA and ECDH, has been shown to be vulnerable to a microarchitecture timing side channel attack. An attacker with sufficient access to mount local timing attacks during ECDSA signature generation could recover the private key.

This issue was reported to Open\+SSL on 26th October 2018 by Alejandro Cabrera Aldaya, Billy Brumley, Sohaib ul Hassan, Cesar Pereida Garcia and Nicola Tuveri. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2018-5407}{\texttt{ CVE-\/2018-\/5407}})

{\itshape Billy Brumley}
\item Timing vulnerability in DSA signature generation

The Open\+SSL DSA signature algorithm has been shown to be vulnerable to a timing side channel attack. An attacker could use variations in the signing algorithm to recover the private key.

This issue was reported to Open\+SSL on 16th October 2018 by Samuel Weiser. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2018-0734}{\texttt{ CVE-\/2018-\/0734}})

{\itshape Paul Dale}
\item Resolve a compatibility issue in EC\+\_\+\+GROUP handling with the FIPS Object Module, accidentally introduced while backporting security fixes from the development branch and hindering the use of ECC in FIPS mode.

{\itshape Nicola Tuveri}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md57}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+2o and 1.\+0.\+2p \mbox{[}14 Aug 2018\mbox{]}}{Changes between 1.\+0.\+2o and 1.\+0.\+2p \mbox{[}14 Aug 2018\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md57}

\begin{DoxyItemize}
\item Client DoS due to large DH parameter

During key agreement in a TLS handshake using a DH(\+E) based ciphersuite a malicious server can send a very large prime value to the client. This will cause the client to spend an unreasonably long period of time generating a key for this prime resulting in a hang until the client has finished. This could be exploited in a Denial Of Service attack.

This issue was reported to Open\+SSL on 5th June 2018 by Guido Vranken (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2018-0732}{\texttt{ CVE-\/2018-\/0732}})

{\itshape Guido Vranken}
\item Cache timing vulnerability in RSA Key Generation

The Open\+SSL RSA Key generation algorithm has been shown to be vulnerable to a cache timing side channel attack. An attacker with sufficient access to mount cache timing attacks during the RSA key generation process could recover the private key.

This issue was reported to Open\+SSL on 4th April 2018 by Alejandro Cabrera Aldaya, Billy Brumley, Cesar Pereida Garcia and Luis Manuel Alvarez Tapia. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2018-0737}{\texttt{ CVE-\/2018-\/0737}})

{\itshape Billy Brumley}
\item Make EVP\+\_\+\+PKEY\+\_\+asn1\+\_\+new() a bit stricter about its input. A NULL pem\+\_\+str parameter is no longer accepted, as it leads to a corrupt table. NULL pem\+\_\+str is reserved for alias entries only.

{\itshape Richard Levitte}
\item Revert blinding in ECDSA sign and instead make problematic addition length-\/invariant. Switch even to fixed-\/length Montgomery multiplication.

{\itshape Andy Polyakov}
\item Change generating and checking of primes so that the error rate of not being prime depends on the intended use based on the size of the input. For larger primes this will result in more rounds of Miller-\/\+Rabin. The maximal error rate for primes with more than 1080 bits is lowered to 2\texorpdfstring{$^\wedge$}{\string^}-\/128.

{\itshape Kurt Roeckx, Annie Yousar}
\item Increase the number of Miller-\/\+Rabin rounds for DSA key generating to 64.

{\itshape Kurt Roeckx}
\item Add blinding to ECDSA and DSA signatures to protect against side channel attacks discovered by Keegan Ryan (NCC Group).

{\itshape Matt Caswell}
\item When unlocking a pass phrase protected PEM file or PKCS\#8 container, we now allow empty (zero character) pass phrases.

{\itshape Richard Levitte}
\item Certificate time validation (X509\+\_\+cmp\+\_\+time) enforces stricter compliance with RFC 5280. Fractional seconds and timezone offsets are no longer allowed.

{\itshape Emilia Käsper}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md58}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+2n and 1.\+0.\+2o \mbox{[}27 Mar 2018\mbox{]}}{Changes between 1.\+0.\+2n and 1.\+0.\+2o \mbox{[}27 Mar 2018\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md58}

\begin{DoxyItemize}
\item Constructed ASN.\+1 types with a recursive definition could exceed the stack

Constructed ASN.\+1 types with a recursive definition (such as can be found in PKCS7) could eventually exceed the stack given malicious input with excessive recursion. This could result in a Denial Of Service attack. There are no such structures used within SSL/\+TLS that come from untrusted sources so this is considered safe.

This issue was reported to Open\+SSL on 4th January 2018 by the OSS-\/fuzz project. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2018-0739}{\texttt{ CVE-\/2018-\/0739}})

{\itshape Matt Caswell}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md59}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+2m and 1.\+0.\+2n \mbox{[}7 Dec 2017\mbox{]}}{Changes between 1.\+0.\+2m and 1.\+0.\+2n \mbox{[}7 Dec 2017\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md59}

\begin{DoxyItemize}
\item Read/write after SSL object in error state

Open\+SSL 1.\+0.\+2 (starting from version 1.\+0.\+2b) introduced an "{}error state"{} mechanism. The intent was that if a fatal error occurred during a handshake then Open\+SSL would move into the error state and would immediately fail if you attempted to continue the handshake. This works as designed for the explicit handshake functions (SSL\+\_\+do\+\_\+handshake(), SSL\+\_\+accept() and SSL\+\_\+connect()), however due to a bug it does not work correctly if SSL\+\_\+read() or SSL\+\_\+write() is called directly. In that scenario, if the handshake fails then a fatal error will be returned in the initial function call. If SSL\+\_\+read()/\+SSL\+\_\+write() is subsequently called by the application for the same SSL object then it will succeed and the data is passed without being decrypted/encrypted directly from the SSL/\+TLS record layer.

In order to exploit this issue an application bug would have to be present that resulted in a call to SSL\+\_\+read()/\+SSL\+\_\+write() being issued after having already received a fatal error.

This issue was reported to Open\+SSL by David Benjamin (Google). (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2017-3737}{\texttt{ CVE-\/2017-\/3737}})

{\itshape Matt Caswell}
\item rsaz\+\_\+1024\+\_\+mul\+\_\+avx2 overflow bug on x86\+\_\+64

There is an overflow bug in the AVX2 Montgomery multiplication procedure used in exponentiation with 1024-\/bit moduli. No EC algorithms are affected. Analysis suggests that attacks against RSA and DSA as a result of this defect would be very difficult to perform and are not believed likely. Attacks against DH1024 are considered just feasible, because most of the work necessary to deduce information about a private key may be performed offline. The amount of resources required for such an attack would be significant. However, for an attack on TLS to be meaningful, the server would have to share the DH1024 private key among multiple clients, which is no longer an option since CVE-\/2016-\/0701.

This only affects processors that support the AVX2 but not ADX extensions like Intel Haswell (4th generation).

This issue was reported to Open\+SSL by David Benjamin (Google). The issue was originally found via the OSS-\/\+Fuzz project. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2017-3738}{\texttt{ CVE-\/2017-\/3738}})

{\itshape Andy Polyakov}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md60}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+2l and 1.\+0.\+2m \mbox{[}2 Nov 2017\mbox{]}}{Changes between 1.\+0.\+2l and 1.\+0.\+2m \mbox{[}2 Nov 2017\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md60}

\begin{DoxyItemize}
\item bn\+\_\+sqrx8x\+\_\+internal carry bug on x86\+\_\+64

There is a carry propagating bug in the x86\+\_\+64 Montgomery squaring procedure. No EC algorithms are affected. Analysis suggests that attacks against RSA and DSA as a result of this defect would be very difficult to perform and are not believed likely. Attacks against DH are considered just feasible (although very difficult) because most of the work necessary to deduce information about a private key may be performed offline. The amount of resources required for such an attack would be very significant and likely only accessible to a limited number of attackers. An attacker would additionally need online access to an unpatched system using the target private key in a scenario with persistent DH parameters and a private key that is shared between multiple clients.

This only affects processors that support the BMI1, BMI2 and ADX extensions like Intel Broadwell (5th generation) and later or AMD Ryzen.

This issue was reported to Open\+SSL by the OSS-\/\+Fuzz project. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2017-3736}{\texttt{ CVE-\/2017-\/3736}})

{\itshape Andy Polyakov}
\item Malformed X.\+509 IPAddress\+Family could cause OOB read

If an X.\+509 certificate has a malformed IPAddress\+Family extension, Open\+SSL could do a one-\/byte buffer overread. The most likely result would be an erroneous display of the certificate in text format.

This issue was reported to Open\+SSL by the OSS-\/\+Fuzz project.

{\itshape Rich Salz}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md61}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+2k and 1.\+0.\+2l \mbox{[}25 May 2017\mbox{]}}{Changes between 1.\+0.\+2k and 1.\+0.\+2l \mbox{[}25 May 2017\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md61}

\begin{DoxyItemize}
\item Have \textquotesingle{}config\textquotesingle{} recognise 64-\/bit mingw and choose \textquotesingle{}mingw64\textquotesingle{} as the target platform rather than \textquotesingle{}mingw\textquotesingle{}.

{\itshape Richard Levitte}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md62}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+2j and 1.\+0.\+2k \mbox{[}26 Jan 2017\mbox{]}}{Changes between 1.\+0.\+2j and 1.\+0.\+2k \mbox{[}26 Jan 2017\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md62}

\begin{DoxyItemize}
\item Truncated packet could crash via OOB read

If one side of an SSL/\+TLS path is running on a 32-\/bit host and a specific cipher is being used, then a truncated packet can cause that host to perform an out-\/of-\/bounds read, usually resulting in a crash.

This issue was reported to Open\+SSL by Robert Święcki of Google. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2017-3731}{\texttt{ CVE-\/2017-\/3731}})

{\itshape Andy Polyakov}
\item BN\+\_\+mod\+\_\+exp may produce incorrect results on x86\+\_\+64

There is a carry propagating bug in the x86\+\_\+64 Montgomery squaring procedure. No EC algorithms are affected. Analysis suggests that attacks against RSA and DSA as a result of this defect would be very difficult to perform and are not believed likely. Attacks against DH are considered just feasible (although very difficult) because most of the work necessary to deduce information about a private key may be performed offline. The amount of resources required for such an attack would be very significant and likely only accessible to a limited number of attackers. An attacker would additionally need online access to an unpatched system using the target private key in a scenario with persistent DH parameters and a private key that is shared between multiple clients. For example this can occur by default in Open\+SSL DHE based SSL/\+TLS ciphersuites. Note\+: This issue is very similar to CVE-\/2015-\/3193 but must be treated as a separate problem.

This issue was reported to Open\+SSL by the OSS-\/\+Fuzz project. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2017-3732}{\texttt{ CVE-\/2017-\/3732}})

{\itshape Andy Polyakov}
\item Montgomery multiplication may produce incorrect results

There is a carry propagating bug in the Broadwell-\/specific Montgomery multiplication procedure that handles input lengths divisible by, but longer than 256 bits. Analysis suggests that attacks against RSA, DSA and DH private keys are impossible. This is because the subroutine in question is not used in operations with the private key itself and an input of the attacker\textquotesingle{}s direct choice. Otherwise the bug can manifest itself as transient authentication and key negotiation failures or reproducible erroneous outcome of public-\/key operations with specially crafted input. Among EC algorithms only Brainpool P-\/512 curves are affected and one presumably can attack ECDH key negotiation. Impact was not analyzed in detail, because pre-\/requisites for attack are considered unlikely. Namely multiple clients have to choose the curve in question and the server has to share the private key among them, neither of which is default behaviour. Even then only clients that chose the curve will be affected.

This issue was publicly reported as transient failures and was not initially recognized as a security issue. Thanks to Richard Morgan for providing reproducible case. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-7055}{\texttt{ CVE-\/2016-\/7055}})

{\itshape Andy Polyakov}
\item Open\+SSL now fails if it receives an unrecognised record type in TLS1.\+0 or TLS1.\+1. Previously this only happened in SSLv3 and TLS1.\+2. This is to prevent issues where no progress is being made and the peer continually sends unrecognised record types, using up resources processing them.

{\itshape Matt Caswell}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md63}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+2i and 1.\+0.\+2j \mbox{[}26 Sep 2016\mbox{]}}{Changes between 1.\+0.\+2i and 1.\+0.\+2j \mbox{[}26 Sep 2016\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md63}

\begin{DoxyItemize}
\item Missing CRL sanity check

A bug fix which included a CRL sanity check was added to Open\+SSL 1.\+1.\+0 but was omitted from Open\+SSL 1.\+0.\+2i. As a result any attempt to use CRLs in Open\+SSL 1.\+0.\+2i will crash with a null pointer exception.

This issue only affects the Open\+SSL 1.\+0.\+2i (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-7052}{\texttt{ CVE-\/2016-\/7052}})

{\itshape Matt Caswell}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md64}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+2h and 1.\+0.\+2i \mbox{[}22 Sep 2016\mbox{]}}{Changes between 1.\+0.\+2h and 1.\+0.\+2i \mbox{[}22 Sep 2016\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md64}

\begin{DoxyItemize}
\item OCSP Status Request extension unbounded memory growth

A malicious client can send an excessively large OCSP Status Request extension. If that client continually requests renegotiation, sending a large OCSP Status Request extension each time, then there will be unbounded memory growth on the server. This will eventually lead to a Denial Of Service attack through memory exhaustion. Servers with a default configuration are vulnerable even if they do not support OCSP. Builds using the "{}no-\/ocsp"{} build time option are not affected.

This issue was reported to Open\+SSL by Shi Lei (Gear Team, Qihoo 360 Inc.) (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-6304}{\texttt{ CVE-\/2016-\/6304}})

{\itshape Matt Caswell}
\item In order to mitigate the SWEET32 attack, the DES ciphers were moved from HIGH to MEDIUM.

This issue was reported to Open\+SSL Karthikeyan Bhargavan and Gaetan Leurent (INRIA) (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-2183}{\texttt{ CVE-\/2016-\/2183}})

{\itshape Rich Salz}
\item OOB write in MDC2\+\_\+\+Update()

An overflow can occur in MDC2\+\_\+\+Update() either if called directly or through the EVP\+\_\+\+Digest\+Update() function using MDC2. If an attacker is able to supply very large amounts of input data after a previous call to EVP\+\_\+\+Encrypt\+Update() with a partial block then a length check can overflow resulting in a heap corruption.

The amount of data needed is comparable to SIZE\+\_\+\+MAX which is impractical on most platforms.

This issue was reported to Open\+SSL by Shi Lei (Gear Team, Qihoo 360 Inc.) (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-6303}{\texttt{ CVE-\/2016-\/6303}})

{\itshape Stephen Henson}
\item Malformed SHA512 ticket DoS

If a server uses SHA512 for TLS session ticket HMAC it is vulnerable to a DoS attack where a malformed ticket will result in an OOB read which will ultimately crash.

The use of SHA512 in TLS session tickets is comparatively rare as it requires a custom server callback and ticket lookup mechanism.

This issue was reported to Open\+SSL by Shi Lei (Gear Team, Qihoo 360 Inc.) (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-6302}{\texttt{ CVE-\/2016-\/6302}})

{\itshape Stephen Henson}
\item OOB write in BN\+\_\+bn2dec()

The function BN\+\_\+bn2dec() does not check the return value of BN\+\_\+div\+\_\+word(). This can cause an OOB write if an application uses this function with an overly large BIGNUM. This could be a problem if an overly large certificate or CRL is printed out from an untrusted source. TLS is not affected because record limits will reject an oversized certificate before it is parsed.

This issue was reported to Open\+SSL by Shi Lei (Gear Team, Qihoo 360 Inc.) (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-2182}{\texttt{ CVE-\/2016-\/2182}})

{\itshape Stephen Henson}
\item OOB read in TS\+\_\+\+OBJ\+\_\+print\+\_\+bio()

The function TS\+\_\+\+OBJ\+\_\+print\+\_\+bio() misuses OBJ\+\_\+obj2txt()\+: the return value is the total length the OID text representation would use and not the amount of data written. This will result in OOB reads when large OIDs are presented.

This issue was reported to Open\+SSL by Shi Lei (Gear Team, Qihoo 360 Inc.) (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-2180}{\texttt{ CVE-\/2016-\/2180}})

{\itshape Stephen Henson}
\item Pointer arithmetic undefined behaviour

Avoid some undefined pointer arithmetic

A common idiom in the codebase is to check limits in the following manner\+: "{}p + len $>$ limit"{}

Where "{}p"{} points to some malloc\textquotesingle{}d data of SIZE bytes and limit == p + SIZE

"{}len"{} here could be from some externally supplied data (e.\+g. from a TLS message).

The rules of C pointer arithmetic are such that "{}p + len"{} is only well defined where len \texorpdfstring{$<$}{<}= SIZE. Therefore the above idiom is actually undefined behaviour.

For example this could cause problems if some malloc implementation provides an address for "{}p"{} such that "{}p + len"{} actually overflows for values of len that are too big and therefore p + len \texorpdfstring{$<$}{<} limit.

This issue was reported to Open\+SSL by Guido Vranken (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-2177}{\texttt{ CVE-\/2016-\/2177}})

{\itshape Matt Caswell}
\item Constant time flag not preserved in DSA signing

Operations in the DSA signing algorithm should run in constant time in order to avoid side channel attacks. A flaw in the Open\+SSL DSA implementation means that a non-\/constant time codepath is followed for certain operations. This has been demonstrated through a cache-\/timing attack to be sufficient for an attacker to recover the private DSA key.

This issue was reported by César Pereida (Aalto University), Billy Brumley (Tampere University of Technology), and Yuval Yarom (The University of Adelaide and NICTA). (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-2178}{\texttt{ CVE-\/2016-\/2178}})

{\itshape César Pereida}
\item DTLS buffered message DoS

In a DTLS connection where handshake messages are delivered out-\/of-\/order those messages that Open\+SSL is not yet ready to process will be buffered for later use. Under certain circumstances, a flaw in the logic means that those messages do not get removed from the buffer even though the handshake has been completed. An attacker could force up to approx. 15 messages to remain in the buffer when they are no longer required. These messages will be cleared when the DTLS connection is closed. The default maximum size for a message is 100k. Therefore, the attacker could force an additional 1500k to be consumed per connection. By opening many simultaneous connections an attacker could cause a DoS attack through memory exhaustion.

This issue was reported to Open\+SSL by Quan Luo. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-2179}{\texttt{ CVE-\/2016-\/2179}})

{\itshape Matt Caswell}
\item DTLS replay protection DoS

A flaw in the DTLS replay attack protection mechanism means that records that arrive for future epochs update the replay protection "{}window"{} before the MAC for the record has been validated. This could be exploited by an attacker by sending a record for the next epoch (which does not have to decrypt or have a valid MAC), with a very large sequence number. This means that all subsequent legitimate packets are dropped causing a denial of service for a specific DTLS connection.

This issue was reported to Open\+SSL by the OCAP audit team. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-2181}{\texttt{ CVE-\/2016-\/2181}})

{\itshape Matt Caswell}
\item Certificate message OOB reads

In Open\+SSL 1.\+0.\+2 and earlier some missing message length checks can result in OOB reads of up to 2 bytes beyond an allocated buffer. There is a theoretical DoS risk but this has not been observed in practice on common platforms.

The messages affected are client certificate, client certificate request and server certificate. As a result the attack can only be performed against a client or a server which enables client authentication.

This issue was reported to Open\+SSL by Shi Lei (Gear Team, Qihoo 360 Inc.) (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-6306}{\texttt{ CVE-\/2016-\/6306}})

{\itshape Stephen Henson}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md65}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+2g and 1.\+0.\+2h \mbox{[}3 May 2016\mbox{]}}{Changes between 1.\+0.\+2g and 1.\+0.\+2h \mbox{[}3 May 2016\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md65}

\begin{DoxyItemize}
\item Prevent padding oracle in AES-\/\+NI CBC MAC check

A MITM attacker can use a padding oracle attack to decrypt traffic when the connection uses an AES CBC cipher and the server support AES-\/\+NI.

This issue was introduced as part of the fix for Lucky 13 padding attack (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2013-0169}{\texttt{ CVE-\/2013-\/0169}}). The padding check was rewritten to be in constant time by making sure that always the same bytes are read and compared against either the MAC or padding bytes. But it no longer checked that there was enough data to have both the MAC and padding bytes.

This issue was reported by Juraj Somorovsky using TLS-\/\+Attacker.

{\itshape Kurt Roeckx}
\item Fix EVP\+\_\+\+Encode\+Update overflow

An overflow can occur in the EVP\+\_\+\+Encode\+Update() function which is used for Base64 encoding of binary data. If an attacker is able to supply very large amounts of input data then a length check can overflow resulting in a heap corruption.

Internally to Open\+SSL the EVP\+\_\+\+Encode\+Update() function is primarily used by the {\ttfamily PEM\+\_\+write\+\_\+bio\texorpdfstring{$\ast$}{*}} family of functions. These are mainly used within the Open\+SSL command line applications, so any application which processes data from an untrusted source and outputs it as a PEM file should be considered vulnerable to this issue. User applications that call these APIs directly with large amounts of untrusted data may also be vulnerable.

This issue was reported by Guido Vranken. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-2105}{\texttt{ CVE-\/2016-\/2105}})

{\itshape Matt Caswell}
\item Fix EVP\+\_\+\+Encrypt\+Update overflow

An overflow can occur in the EVP\+\_\+\+Encrypt\+Update() function. If an attacker is able to supply very large amounts of input data after a previous call to EVP\+\_\+\+Encrypt\+Update() with a partial block then a length check can overflow resulting in a heap corruption. Following an analysis of all Open\+SSL internal usage of the EVP\+\_\+\+Encrypt\+Update() function all usage is one of two forms. The first form is where the EVP\+\_\+\+Encrypt\+Update() call is known to be the first called function after an EVP\+\_\+\+Encrypt\+Init(), and therefore that specific call must be safe. The second form is where the length passed to EVP\+\_\+\+Encrypt\+Update() can be seen from the code to be some small value and therefore there is no possibility of an overflow. Since all instances are one of these two forms, it is believed that there can be no overflows in internal code due to this problem. It should be noted that EVP\+\_\+\+Decrypt\+Update() can call EVP\+\_\+\+Encrypt\+Update() in certain code paths. Also EVP\+\_\+\+Cipher\+Update() is a synonym for EVP\+\_\+\+Encrypt\+Update(). All instances of these calls have also been analysed too and it is believed there are no instances in internal usage where an overflow could occur.

This issue was reported by Guido Vranken. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-2106}{\texttt{ CVE-\/2016-\/2106}})

{\itshape Matt Caswell}
\item Prevent ASN.\+1 BIO excessive memory allocation

When ASN.\+1 data is read from a BIO using functions such as d2i\+\_\+\+CMS\+\_\+bio() a short invalid encoding can cause allocation of large amounts of memory potentially consuming excessive resources or exhausting memory.

Any application parsing untrusted data through d2i BIO functions is affected. The memory based functions such as d2i\+\_\+\+X509() are {\itshape not} affected. Since the memory based functions are used by the TLS library, TLS applications are not affected.

This issue was reported by Brian Carpenter. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-2109}{\texttt{ CVE-\/2016-\/2109}})

{\itshape Stephen Henson}
\item EBCDIC overread

ASN1 Strings that are over 1024 bytes can cause an overread in applications using the X509\+\_\+\+NAME\+\_\+oneline() function on EBCDIC systems. This could result in arbitrary stack data being returned in the buffer.

This issue was reported by Guido Vranken. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-2176}{\texttt{ CVE-\/2016-\/2176}})

{\itshape Matt Caswell}
\item Modify behavior of ALPN to invoke callback after SNI/servername callback, such that updates to the SSL\+\_\+\+CTX affect ALPN.

{\itshape Todd Short}
\item Remove LOW from the DEFAULT cipher list. This removes singles DES from the default.

{\itshape Kurt Roeckx}
\item Only remove the SSLv2 methods with the no-\/ssl2-\/method option. When the methods are enabled and ssl2 is disabled the methods return NULL.

{\itshape Kurt Roeckx}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md66}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+2f and 1.\+0.\+2g \mbox{[}1 Mar 2016\mbox{]}}{Changes between 1.\+0.\+2f and 1.\+0.\+2g \mbox{[}1 Mar 2016\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md66}

\begin{DoxyItemize}
\item Disable weak ciphers in SSLv3 and up in default builds of Open\+SSL. Builds that are not configured with "{}enable-\/weak-\/ssl-\/ciphers"{} will not provide any "{}\+EXPORT"{} or "{}\+LOW"{} strength ciphers.

{\itshape Viktor Dukhovni}
\item Disable SSLv2 default build, default negotiation and weak ciphers. SSLv2 is by default disabled at build-\/time. Builds that are not configured with "{}enable-\/ssl2"{} will not support SSLv2. Even if "{}enable-\/ssl2"{} is used, users who want to negotiate SSLv2 via the version-\/flexible SSLv23\+\_\+method() will need to explicitly call either of\+: \begin{DoxyVerb}SSL_CTX_clear_options(ctx, SSL_OP_NO_SSLv2);
\end{DoxyVerb}
 or SSL\+\_\+clear\+\_\+options(ssl, SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+SSLv2);

as appropriate. Even if either of those is used, or the application explicitly uses the version-\/specific SSLv2\+\_\+method() or its client and server variants, SSLv2 ciphers vulnerable to exhaustive search key recovery have been removed. Specifically, the SSLv2 40-\/bit EXPORT ciphers, and SSLv2 56-\/bit DES are no longer available. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-0800}{\texttt{ CVE-\/2016-\/0800}})

{\itshape Viktor Dukhovni}
\begin{DoxyItemize}
\item Fix a double-\/free in DSA code

A double free bug was discovered when Open\+SSL parses malformed DSA private keys and could lead to a DoS attack or memory corruption for applications that receive DSA private keys from untrusted sources. This scenario is considered rare.

This issue was reported to Open\+SSL by Adam Langley(Google/\+Boring\+SSL) using lib\+Fuzzer. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-0705}{\texttt{ CVE-\/2016-\/0705}})

{\itshape Stephen Henson}
\item Disable SRP fake user seed to address a server memory leak.

Add a new method SRP\+\_\+\+VBASE\+\_\+get1\+\_\+by\+\_\+user that handles the seed properly.

SRP\+\_\+\+VBASE\+\_\+get\+\_\+by\+\_\+user had inconsistent memory management behaviour. In order to fix an unavoidable memory leak, SRP\+\_\+\+VBASE\+\_\+get\+\_\+by\+\_\+user was changed to ignore the "{}fake user"{} SRP seed, even if the seed is configured.

Users should use SRP\+\_\+\+VBASE\+\_\+get1\+\_\+by\+\_\+user instead. Note that in SRP\+\_\+\+VBASE\+\_\+get1\+\_\+by\+\_\+user, caller must free the returned value. Note also that even though configuring the SRP seed attempts to hide invalid usernames by continuing the handshake with fake credentials, this behaviour is not constant time and no strong guarantees are made that the handshake is indistinguishable from that of a valid user. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-0798}{\texttt{ CVE-\/2016-\/0798}})

{\itshape Emilia Käsper}
\item Fix BN\+\_\+hex2bn/\+BN\+\_\+dec2bn NULL pointer deref/heap corruption

In the BN\+\_\+hex2bn function the number of hex digits is calculated using an int value {\ttfamily i}. Later {\ttfamily bn\+\_\+expand} is called with a value of {\ttfamily i \texorpdfstring{$\ast$}{*} 4}. For large values of {\ttfamily i} this can result in {\ttfamily bn\+\_\+expand} not allocating any memory because {\ttfamily i \texorpdfstring{$\ast$}{*} 4} is negative. This can leave the internal BIGNUM data field as NULL leading to a subsequent NULL ptr deref. For very large values of {\ttfamily i}, the calculation {\ttfamily i \texorpdfstring{$\ast$}{*} 4} could be a positive value smaller than {\ttfamily i}. In this case memory is allocated to the internal BIGNUM data field, but it is insufficiently sized leading to heap corruption. A similar issue exists in BN\+\_\+dec2bn. This could have security consequences if BN\+\_\+hex2bn/\+BN\+\_\+dec2bn is ever called by user applications with very large untrusted hex/dec data. This is anticipated to be a rare occurrence.

All Open\+SSL internal usage of these functions use data that is not expected to be untrusted, e.\+g. config file data or application command line arguments. If user developed applications generate config file data based on untrusted data then it is possible that this could also lead to security consequences. This is also anticipated to be rare.

This issue was reported to Open\+SSL by Guido Vranken. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-0797}{\texttt{ CVE-\/2016-\/0797}})

{\itshape Matt Caswell}
\item Fix memory issues in {\ttfamily BIO\+\_\+\texorpdfstring{$\ast$}{*}printf} functions

The internal {\ttfamily fmtstr} function used in processing a "{}\%s"{} format string in the {\ttfamily BIO\+\_\+\texorpdfstring{$\ast$}{*}printf} functions could overflow while calculating the length of a string and cause an OOB read when printing very long strings.

Additionally the internal {\ttfamily doapr\+\_\+outch} function can attempt to write to an OOB memory location (at an offset from the NULL pointer) in the event of a memory allocation failure. In 1.\+0.\+2 and below this could be caused where the size of a buffer to be allocated is greater than INT\+\_\+\+MAX. E.\+g. this could be in processing a very long "{}\%s"{} format string. Memory leaks can also occur.

The first issue may mask the second issue dependent on compiler behaviour. These problems could enable attacks where large amounts of untrusted data is passed to the {\ttfamily BIO\+\_\+\texorpdfstring{$\ast$}{*}printf} functions. If applications use these functions in this way then they could be vulnerable. Open\+SSL itself uses these functions when printing out human-\/readable dumps of ASN.\+1 data. Therefore applications that print this data could be vulnerable if the data is from untrusted sources. Open\+SSL command line applications could also be vulnerable where they print out ASN.\+1 data, or if untrusted data is passed as command line arguments.

Libssl is not considered directly vulnerable. Additionally certificates etc received via remote connections via libssl are also unlikely to be able to trigger these issues because of message size limits enforced within libssl.

This issue was reported to Open\+SSL Guido Vranken. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-0799}{\texttt{ CVE-\/2016-\/0799}})

{\itshape Matt Caswell}
\item Side channel attack on modular exponentiation

A side-\/channel attack was found which makes use of cache-\/bank conflicts on the Intel Sandy-\/\+Bridge microarchitecture which could lead to the recovery of RSA keys. The ability to exploit this issue is limited as it relies on an attacker who has control of code in a thread running on the same hyper-\/threaded core as the victim thread which is performing decryptions.

This issue was reported to Open\+SSL by Yuval Yarom, The University of Adelaide and NICTA, Daniel Genkin, Technion and Tel Aviv University, and Nadia Heninger, University of Pennsylvania with more information at \href{http://cachebleed.info}{\texttt{ http\+://cachebleed.\+info}}. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-0702}{\texttt{ CVE-\/2016-\/0702}})

{\itshape Andy Polyakov}
\item Change the {\ttfamily req} command to generate a 2048-\/bit RSA/\+DSA key by default, if no keysize is specified with default\+\_\+bits. This fixes an omission in an earlier change that changed all RSA/\+DSA key generation commands to use 2048 bits by default.

{\itshape Emilia Käsper}
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md67}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+2e and 1.\+0.\+2f \mbox{[}28 Jan 2016\mbox{]}}{Changes between 1.\+0.\+2e and 1.\+0.\+2f \mbox{[}28 Jan 2016\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md67}

\begin{DoxyItemize}
\item DH small subgroups

Historically Open\+SSL only ever generated DH parameters based on "{}safe"{} primes. More recently (in version 1.\+0.\+2) support was provided for generating X9.\+42 style parameter files such as those required for RFC 5114 support. The primes used in such files may not be "{}safe"{}. Where an application is using DH configured with parameters based on primes that are not "{}safe"{} then an attacker could use this fact to find a peer\textquotesingle{}s private DH exponent. This attack requires that the attacker complete multiple handshakes in which the peer uses the same private DH exponent. For example this could be used to discover a TLS server\textquotesingle{}s private DH exponent if it\textquotesingle{}s reusing the private DH exponent or it\textquotesingle{}s using a static DH ciphersuite.

Open\+SSL provides the option SSL\+\_\+\+OP\+\_\+\+SINGLE\+\_\+\+DH\+\_\+\+USE for ephemeral DH (DHE) in TLS. It is not on by default. If the option is not set then the server reuses the same private DH exponent for the life of the server process and would be vulnerable to this attack. It is believed that many popular applications do set this option and would therefore not be at risk.

The fix for this issue adds an additional check where a "{}q"{} parameter is available (as is the case in X9.\+42 based parameters). This detects the only known attack, and is the only possible defense for static DH ciphersuites. This could have some performance impact.

Additionally the SSL\+\_\+\+OP\+\_\+\+SINGLE\+\_\+\+DH\+\_\+\+USE option has been switched on by default and cannot be disabled. This could have some performance impact.

This issue was reported to Open\+SSL by Antonio Sanso (Adobe). (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-0701}{\texttt{ CVE-\/2016-\/0701}})

{\itshape Matt Caswell}
\item SSLv2 doesn\textquotesingle{}t block disabled ciphers

A malicious client can negotiate SSLv2 ciphers that have been disabled on the server and complete SSLv2 handshakes even if all SSLv2 ciphers have been disabled, provided that the SSLv2 protocol was not also disabled via SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+SSLv2.

This issue was reported to Open\+SSL on 26th December 2015 by Nimrod Aviram and Sebastian Schinzel. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-3197}{\texttt{ CVE-\/2015-\/3197}})

{\itshape Viktor Dukhovni}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md68}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+2d and 1.\+0.\+2e \mbox{[}3 Dec 2015\mbox{]}}{Changes between 1.\+0.\+2d and 1.\+0.\+2e \mbox{[}3 Dec 2015\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md68}

\begin{DoxyItemize}
\item BN\+\_\+mod\+\_\+exp may produce incorrect results on x86\+\_\+64

There is a carry propagating bug in the x86\+\_\+64 Montgomery squaring procedure. No EC algorithms are affected. Analysis suggests that attacks against RSA and DSA as a result of this defect would be very difficult to perform and are not believed likely. Attacks against DH are considered just feasible (although very difficult) because most of the work necessary to deduce information about a private key may be performed offline. The amount of resources required for such an attack would be very significant and likely only accessible to a limited number of attackers. An attacker would additionally need online access to an unpatched system using the target private key in a scenario with persistent DH parameters and a private key that is shared between multiple clients. For example this can occur by default in Open\+SSL DHE based SSL/\+TLS ciphersuites.

This issue was reported to Open\+SSL by Hanno Böck. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-3193}{\texttt{ CVE-\/2015-\/3193}})

{\itshape Andy Polyakov}
\item Certificate verify crash with missing PSS parameter

The signature verification routines will crash with a NULL pointer dereference if presented with an ASN.\+1 signature using the RSA PSS algorithm and absent mask generation function parameter. Since these routines are used to verify certificate signature algorithms this can be used to crash any certificate verification operation and exploited in a DoS attack. Any application which performs certificate verification is vulnerable including Open\+SSL clients and servers which enable client authentication.

This issue was reported to Open\+SSL by Loïc Jonas Etienne (Qnective AG). (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-3194}{\texttt{ CVE-\/2015-\/3194}})

{\itshape Stephen Henson}
\item X509\+\_\+\+ATTRIBUTE memory leak

When presented with a malformed X509\+\_\+\+ATTRIBUTE structure Open\+SSL will leak memory. This structure is used by the PKCS\#7 and CMS routines so any application which reads PKCS\#7 or CMS data from untrusted sources is affected. SSL/\+TLS is not affected.

This issue was reported to Open\+SSL by Adam Langley (Google/\+Boring\+SSL) using lib\+Fuzzer. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-3195}{\texttt{ CVE-\/2015-\/3195}})

{\itshape Stephen Henson}
\item Rewrite EVP\+\_\+\+Decode\+Update (base64 decoding) to fix several bugs. This changes the decoding behaviour for some invalid messages, though the change is mostly in the more lenient direction, and legacy behaviour is preserved as much as possible.

{\itshape Emilia Käsper}
\item In DSA\+\_\+generate\+\_\+parameters\+\_\+ex, if the provided seed is too short, return an error

\texorpdfstring{$\ast$}{*}\+Rich Salz and Ismo Puustinen \href{mailto:ismo.puustinen@intel.com}{\texttt{ ismo.\+puustinen@intel.\+com}}\texorpdfstring{$\ast$}{*}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md69}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+2c and 1.\+0.\+2d \mbox{[}9 Jul 2015\mbox{]}}{Changes between 1.\+0.\+2c and 1.\+0.\+2d \mbox{[}9 Jul 2015\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md69}

\begin{DoxyItemize}
\item Alternate chains certificate forgery

During certificate verification, Open\+SSL will attempt to find an alternative certificate chain if the first attempt to build such a chain fails. An error in the implementation of this logic can mean that an attacker could cause certain checks on untrusted certificates to be bypassed, such as the CA flag, enabling them to use a valid leaf certificate to act as a CA and "{}issue"{} an invalid certificate.

This issue was reported to Open\+SSL by Adam Langley/\+David Benjamin (Google/\+Boring\+SSL).

{\itshape Matt Caswell}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md70}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+2b and 1.\+0.\+2c \mbox{[}12 Jun 2015\mbox{]}}{Changes between 1.\+0.\+2b and 1.\+0.\+2c \mbox{[}12 Jun 2015\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md70}

\begin{DoxyItemize}
\item Fix HMAC ABI incompatibility. The previous version introduced an ABI incompatibility in the handling of HMAC. The previous ABI has now been restored.

{\itshape Matt Caswell}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md71}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+2a and 1.\+0.\+2b \mbox{[}11 Jun 2015\mbox{]}}{Changes between 1.\+0.\+2a and 1.\+0.\+2b \mbox{[}11 Jun 2015\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md71}

\begin{DoxyItemize}
\item Malformed ECParameters causes infinite loop

When processing an ECParameters structure Open\+SSL enters an infinite loop if the curve specified is over a specially malformed binary polynomial field.

This can be used to perform denial of service against any system which processes public keys, certificate requests or certificates. This includes TLS clients and TLS servers with client authentication enabled.

This issue was reported to Open\+SSL by Joseph Barr-\/\+Pixton. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-1788}{\texttt{ CVE-\/2015-\/1788}})

{\itshape Andy Polyakov}
\item Exploitable out-\/of-\/bounds read in X509\+\_\+cmp\+\_\+time

X509\+\_\+cmp\+\_\+time does not properly check the length of the ASN1\+\_\+\+TIME string and can read a few bytes out of bounds. In addition, X509\+\_\+cmp\+\_\+time accepts an arbitrary number of fractional seconds in the time string.

An attacker can use this to craft malformed certificates and CRLs of various sizes and potentially cause a segmentation fault, resulting in a DoS on applications that verify certificates or CRLs. TLS clients that verify CRLs are affected. TLS clients and servers with client authentication enabled may be affected if they use custom verification callbacks.

This issue was reported to Open\+SSL by Robert Swiecki (Google), and independently by Hanno Böck. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-1789}{\texttt{ CVE-\/2015-\/1789}})

{\itshape Emilia Käsper}
\item PKCS7 crash with missing Enveloped\+Content

The PKCS\#7 parsing code does not handle missing inner Encrypted\+Content correctly. An attacker can craft malformed ASN.\+1-\/encoded PKCS\#7 blobs with missing content and trigger a NULL pointer dereference on parsing.

Applications that decrypt PKCS\#7 data or otherwise parse PKCS\#7 structures from untrusted sources are affected. Open\+SSL clients and servers are not affected.

This issue was reported to Open\+SSL by Michal Zalewski (Google). (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-1790}{\texttt{ CVE-\/2015-\/1790}})

{\itshape Emilia Käsper}
\item CMS verify infinite loop with unknown hash function

When verifying a signed\+Data message the CMS code can enter an infinite loop if presented with an unknown hash function OID. This can be used to perform denial of service against any system which verifies signed\+Data messages using the CMS code. This issue was reported to Open\+SSL by Johannes Bauer. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-1792}{\texttt{ CVE-\/2015-\/1792}})

{\itshape Stephen Henson}
\item Race condition handling New\+Session\+Ticket

If a New\+Session\+Ticket is received by a multi-\/threaded client when attempting to reuse a previous ticket then a race condition can occur potentially leading to a double free of the ticket data. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-1791}{\texttt{ CVE-\/2015-\/1791}})

{\itshape Matt Caswell}
\item Only support 256-\/bit or stronger elliptic curves with the \textquotesingle{}ecdh\+\_\+auto\textquotesingle{} setting (server) or by default (client). Of supported curves, prefer P-\/256 (both).

{\itshape Emilia Kasper}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md72}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+2 and 1.\+0.\+2a \mbox{[}19 Mar 2015\mbox{]}}{Changes between 1.\+0.\+2 and 1.\+0.\+2a \mbox{[}19 Mar 2015\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md72}

\begin{DoxyItemize}
\item Client\+Hello sigalgs DoS fix

If a client connects to an Open\+SSL 1.\+0.\+2 server and renegotiates with an invalid signature algorithms extension a NULL pointer dereference will occur. This can be exploited in a DoS attack against the server.

This issue was was reported to Open\+SSL by David Ramos of Stanford University. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0291}{\texttt{ CVE-\/2015-\/0291}})

{\itshape Stephen Henson and Matt Caswell}
\item Multiblock corrupted pointer fix

Open\+SSL 1.\+0.\+2 introduced the "{}multiblock"{} performance improvement. This feature only applies on 64 bit x86 architecture platforms that support AES NI instructions. A defect in the implementation of "{}multiblock"{} can cause Open\+SSL\textquotesingle{}s internal write buffer to become incorrectly set to NULL when using non-\/blocking IO. Typically, when the user application is using a socket BIO for writing, this will only result in a failed connection. However if some other BIO is used then it is likely that a segmentation fault will be triggered, thus enabling a potential DoS attack.

This issue was reported to Open\+SSL by Daniel Danner and Rainer Mueller. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0290}{\texttt{ CVE-\/2015-\/0290}})

{\itshape Matt Caswell}
\item Segmentation fault in DTLSv1\+\_\+listen fix

The DTLSv1\+\_\+listen function is intended to be stateless and processes the initial Client\+Hello from many peers. It is common for user code to loop over the call to DTLSv1\+\_\+listen until a valid Client\+Hello is received with an associated cookie. A defect in the implementation of DTLSv1\+\_\+listen means that state is preserved in the SSL object from one invocation to the next that can lead to a segmentation fault. Errors processing the initial Client\+Hello can trigger this scenario. An example of such an error could be that a DTLS1.\+0 only client is attempting to connect to a DTLS1.\+2 only server.

This issue was reported to Open\+SSL by Per Allansson. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0207}{\texttt{ CVE-\/2015-\/0207}})

{\itshape Matt Caswell}
\item Segmentation fault in ASN1\+\_\+\+TYPE\+\_\+cmp fix

The function ASN1\+\_\+\+TYPE\+\_\+cmp will crash with an invalid read if an attempt is made to compare ASN.\+1 boolean types. Since ASN1\+\_\+\+TYPE\+\_\+cmp is used to check certificate signature algorithm consistency this can be used to crash any certificate verification operation and exploited in a DoS attack. Any application which performs certificate verification is vulnerable including Open\+SSL clients and servers which enable client authentication. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0286}{\texttt{ CVE-\/2015-\/0286}})

{\itshape Stephen Henson}
\item Segmentation fault for invalid PSS parameters fix

The signature verification routines will crash with a NULL pointer dereference if presented with an ASN.\+1 signature using the RSA PSS algorithm and invalid parameters. Since these routines are used to verify certificate signature algorithms this can be used to crash any certificate verification operation and exploited in a DoS attack. Any application which performs certificate verification is vulnerable including Open\+SSL clients and servers which enable client authentication.

This issue was was reported to Open\+SSL by Brian Carpenter. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0208}{\texttt{ CVE-\/2015-\/0208}})

{\itshape Stephen Henson}
\item ASN.\+1 structure reuse memory corruption fix

Reusing a structure in ASN.\+1 parsing may allow an attacker to cause memory corruption via an invalid write. Such reuse is and has been strongly discouraged and is believed to be rare.

Applications that parse structures containing CHOICE or ANY DEFINED BY components may be affected. Certificate parsing (d2i\+\_\+\+X509 and related functions) are however not affected. Open\+SSL clients and servers are not affected. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0287}{\texttt{ CVE-\/2015-\/0287}})

{\itshape Stephen Henson}
\item PKCS7 NULL pointer dereferences fix

The PKCS\#7 parsing code does not handle missing outer Content\+Info correctly. An attacker can craft malformed ASN.\+1-\/encoded PKCS\#7 blobs with missing content and trigger a NULL pointer dereference on parsing.

Applications that verify PKCS\#7 signatures, decrypt PKCS\#7 data or otherwise parse PKCS\#7 structures from untrusted sources are affected. Open\+SSL clients and servers are not affected.

This issue was reported to Open\+SSL by Michal Zalewski (Google). (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0289}{\texttt{ CVE-\/2015-\/0289}})

{\itshape Emilia Käsper}
\item DoS via reachable assert in SSLv2 servers fix

A malicious client can trigger an OPENSSL\+\_\+assert (i.\+e., an abort) in servers that both support SSLv2 and enable export cipher suites by sending a specially crafted SSLv2 CLIENT-\/\+MASTER-\/\+KEY message.

This issue was discovered by Sean Burford (Google) and Emilia Käsper (Open\+SSL development team). (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0293}{\texttt{ CVE-\/2015-\/0293}})

{\itshape Emilia Käsper}
\item Empty CKE with client auth and DHE fix

If client auth is used then a server can seg fault in the event of a DHE ciphersuite being selected and a zero length Client\+Key\+Exchange message being sent by the client. This could be exploited in a DoS attack. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-1787}{\texttt{ CVE-\/2015-\/1787}})

{\itshape Matt Caswell}
\item Handshake with unseeded PRNG fix

Under certain conditions an Open\+SSL 1.\+0.\+2 client can complete a handshake with an unseeded PRNG. The conditions are\+:
\begin{DoxyItemize}
\item The client is on a platform where the PRNG has not been seeded automatically, and the user has not seeded manually
\item A protocol specific client method version has been used (i.\+e. not SSL\+\_\+client\+\_\+methodv23)
\item A ciphersuite is used that does not require additional random data from the PRNG beyond the initial Client\+Hello client random (e.\+g. PSK-\/\+RC4-\/\+SHA).
\end{DoxyItemize}

If the handshake succeeds then the client random that has been used will have been generated from a PRNG with insufficient entropy and therefore the output may be predictable.

For example using the following command with an unseeded openssl will succeed on an unpatched platform\+:

openssl s\+\_\+client -\/psk 1a2b3c4d -\/tls1\+\_\+2 -\/cipher PSK-\/\+RC4-\/\+SHA (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0285}{\texttt{ CVE-\/2015-\/0285}})

{\itshape Matt Caswell}
\item Use After Free following d2i\+\_\+\+ECPrivatekey error fix

A malformed EC private key file consumed via the d2i\+\_\+\+ECPrivate\+Key function could cause a use after free condition. This, in turn, could cause a double free in several private key parsing functions (such as d2i\+\_\+\+Private\+Key or EVP\+\_\+\+PKCS82\+PKEY) and could lead to a DoS attack or memory corruption for applications that receive EC private keys from untrusted sources. This scenario is considered rare.

This issue was discovered by the Boring\+SSL project and fixed in their commit 517073cd4b. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0209}{\texttt{ CVE-\/2015-\/0209}})

{\itshape Matt Caswell}
\item X509\+\_\+to\+\_\+\+X509\+\_\+\+REQ NULL pointer deref fix

The function X509\+\_\+to\+\_\+\+X509\+\_\+\+REQ will crash with a NULL pointer dereference if the certificate key is invalid. This function is rarely used in practice.

This issue was discovered by Brian Carpenter. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0288}{\texttt{ CVE-\/2015-\/0288}})

{\itshape Stephen Henson}
\item Removed the export ciphers from the DEFAULT ciphers

{\itshape Kurt Roeckx}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md73}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+1l and 1.\+0.\+2 \mbox{[}22 Jan 2015\mbox{]}}{Changes between 1.\+0.\+1l and 1.\+0.\+2 \mbox{[}22 Jan 2015\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md73}

\begin{DoxyItemize}
\item Facilitate "{}universal"{} ARM builds targeting range of ARM ISAs, e.\+g. ARMv5 through ARMv8, as opposite to "{}locking"{} it to single one. So far those who have to target multiple platforms would compromise and argue that binary targeting say ARMv5 would still execute on ARMv8. "{}\+Universal"{} build resolves this compromise by providing near-\/optimal performance even on newer platforms.

{\itshape Andy Polyakov}
\item Accelerated NIST P-\/256 elliptic curve implementation for x86\+\_\+64 (other platforms pending).

{\itshape Shay Gueron \& Vlad Krasnov (Intel Corp), Andy Polyakov}
\item Add support for the Signed\+Certificate\+Timestamp\+List certificate and OCSP response extensions from RFC6962.

{\itshape Rob Stradling}
\item Fix ec\+\_\+\+GFp\+\_\+simple\+\_\+points\+\_\+make\+\_\+affine (thus, EC\+\_\+\+POINTs\+\_\+mul etc.) for corner cases. (Certain input points at infinity could lead to bogus results, with non-\/infinity inputs mapped to infinity too.)

{\itshape Bodo Moeller}
\item Initial support for Power\+ISA 2.\+0.\+7, first implemented in POWER8. This covers AES, SHA256/512 and GHASH. "{}\+Initial"{} means that most common cases are optimized and there still is room for further improvements. Vector Permutation AES for Altivec is also added.

{\itshape Andy Polyakov}
\item Add support for little-\/endian ppc64 Linux target.

{\itshape Marcelo Cerri (IBM)}
\item Initial support for AMRv8 ISA crypto extensions. This covers AES, SHA1, SHA256 and GHASH. "{}\+Initial"{} means that most common cases are optimized and there still is room for further improvements. Both 32-\/ and 64-\/bit modes are supported.

{\itshape Andy Polyakov, Ard Biesheuvel (Linaro)}
\item Improved ARMv7 NEON support.

{\itshape Andy Polyakov}
\item Support for SPARC Architecture 2011 crypto extensions, first implemented in SPARC T4. This covers AES, DES, Camellia, SHA1, SHA256/512, MD5, GHASH and modular exponentiation.

{\itshape Andy Polyakov, David Miller}
\item Accelerated modular exponentiation for Intel processors, a.\+k.\+a. RSAZ.

{\itshape Shay Gueron \& Vlad Krasnov (Intel Corp)}
\item Support for new and upcoming Intel processors, including AVX2, BMI and SHA ISA extensions. This includes additional "{}stitched"{} implementations, AESNI-\/\+SHA256 and GCM, and multi-\/buffer support for TLS encrypt.

This work was sponsored by Intel Corp.

{\itshape Andy Polyakov}
\item Support for DTLS 1.\+2. This adds two sets of DTLS methods\+: DTLS\+\_\+\texorpdfstring{$\ast$}{*}\+\_\+method() supports both DTLS 1.\+2 and 1.\+0 and should use whatever version the peer supports and DTLSv1\+\_\+2\+\_\+\texorpdfstring{$\ast$}{*}\+\_\+method() which supports DTLS 1.\+2 only.

{\itshape Steve Henson}
\item Use algorithm specific chains in SSL\+\_\+\+CTX\+\_\+use\+\_\+certificate\+\_\+chain\+\_\+file()\+: this fixes a limitation in previous versions of Open\+SSL.

{\itshape Steve Henson}
\item Extended RSA OAEP support via EVP\+\_\+\+PKEY API. Options to specify digest, MGF1 digest and OAEP label.

{\itshape Steve Henson}
\item Add EVP support for key wrapping algorithms, to avoid problems with existing code the flag EVP\+\_\+\+CIPHER\+\_\+\+CTX\+\_\+\+WRAP\+\_\+\+ALLOW has to be set in the EVP\+\_\+\+CIPHER\+\_\+\+CTX or an error is returned. Add AES and DES3 wrap algorithms and include tests cases.

{\itshape Steve Henson}
\item Add functions to allocate and set the fields of an ECDSA\+\_\+\+METHOD structure.

{\itshape Douglas E. Engert, Steve Henson}
\item New functions OPENSSL\+\_\+gmtime\+\_\+diff and ASN1\+\_\+\+TIME\+\_\+diff to find the difference in days and seconds between two tm or ASN1\+\_\+\+TIME structures.

{\itshape Steve Henson}
\item Add -\/rev test option to s\+\_\+server to just reverse order of characters received by client and send back to server. Also prints an abbreviated summary of the connection parameters.

{\itshape Steve Henson}
\item New option -\/brief for s\+\_\+client and s\+\_\+server to print out a brief summary of connection parameters.

{\itshape Steve Henson}
\item Add callbacks for arbitrary TLS extensions.

\texorpdfstring{$\ast$}{*}\+Trevor Perrin \href{mailto:trevp@trevp.net}{\texttt{ trevp@trevp.\+net}} and Ben Laurie\texorpdfstring{$\ast$}{*}
\item New option -\/crl\+\_\+download in several openssl utilities to download CRLs from CRLDP extension in certificates.

{\itshape Steve Henson}
\item New options -\/CRL and -\/CRLform for s\+\_\+client and s\+\_\+server for CRLs.

{\itshape Steve Henson}
\item New function X509\+\_\+\+CRL\+\_\+diff to generate a delta CRL from the difference of two full CRLs. Add support to "{}crl"{} utility.

{\itshape Steve Henson}
\item New functions to set lookup\+\_\+crls function and to retrieve X509\+\_\+\+STORE from X509\+\_\+\+STORE\+\_\+\+CTX.

{\itshape Steve Henson}
\item Print out deprecated issuer and subject unique ID fields in certificates.

{\itshape Steve Henson}
\item Extend OCSP I/O functions so they can be used for simple general purpose HTTP as well as OCSP. New wrapper function which can be used to download CRLs using the OCSP API.

{\itshape Steve Henson}
\item Delegate command line handling in s\+\_\+client/s\+\_\+server to SSL\+\_\+\+CONF APIs.

{\itshape Steve Henson}
\item {\ttfamily SSL\+\_\+\+CONF\texorpdfstring{$\ast$}{*}} functions. These provide a common framework for application configuration using configuration files or command lines.

{\itshape Steve Henson}
\item SSL/\+TLS tracing code. This parses out SSL/\+TLS records using the message callback and prints the results. Needs compile time option "{}enable-\/ssl-\/trace"{}. New options to s\+\_\+client and s\+\_\+server to enable tracing.

{\itshape Steve Henson}
\item New ctrl and macro to retrieve supported points extensions. Print out extension in s\+\_\+server and s\+\_\+client.

{\itshape Steve Henson}
\item New functions to retrieve certificate signature and signature OID NID.

{\itshape Steve Henson}
\item Add functions to retrieve and manipulate the raw cipherlist sent by a client to Open\+SSL.

{\itshape Steve Henson}
\item New Suite B modes for TLS code. These use and enforce the requirements of RFC6460\+: restrict ciphersuites, only permit Suite B algorithms and only use Suite B curves. The Suite B modes can be set by using the strings "{}\+SUITEB128"{}, "{}\+SUITEB192"{} or "{}\+SUITEB128\+ONLY"{} for the cipherstring.

{\itshape Steve Henson}
\item New chain verification flags for Suite B levels of security. Check algorithms are acceptable when flags are set in X509\+\_\+verify\+\_\+cert.

{\itshape Steve Henson}
\item Make tls1\+\_\+check\+\_\+chain return a set of flags indicating checks passed by a certificate chain. Add additional tests to handle client certificates\+: checks for matching certificate type and issuer name comparison.

{\itshape Steve Henson}
\item If an attempt is made to use a signature algorithm not in the peer preference list abort the handshake. If client has no suitable signature algorithms in response to a certificate request do not use the certificate.

{\itshape Steve Henson}
\item If server EC tmp key is not in client preference list abort handshake.

{\itshape Steve Henson}
\item Add support for certificate stores in CERT structure. This makes it possible to have different stores per SSL structure or one store in the parent SSL\+\_\+\+CTX. Include distinct stores for certificate chain verification and chain building. New ctrl SSL\+\_\+\+CTRL\+\_\+\+BUILD\+\_\+\+CERT\+\_\+\+CHAIN to build and store a certificate chain in CERT structure\+: returning an error if the chain cannot be built\+: this will allow applications to test if a chain is correctly configured.

Note\+: if the CERT based stores are not set then the parent SSL\+\_\+\+CTX store is used to retain compatibility with existing behaviour.

{\itshape Steve Henson}
\item New function ssl\+\_\+set\+\_\+client\+\_\+disabled to set a ciphersuite disabled mask based on the current session, check mask when sending client hello and checking the requested ciphersuite.

{\itshape Steve Henson}
\item New ctrls to retrieve and set certificate types in a certificate request message. Print out received values in s\+\_\+client. If certificate types is not set with custom values set sensible values based on supported signature algorithms.

{\itshape Steve Henson}
\item Support for distinct client and server supported signature algorithms.

{\itshape Steve Henson}
\item Add certificate callback. If set this is called whenever a certificate is required by client or server. An application can decide which certificate chain to present based on arbitrary criteria\+: for example supported signature algorithms. Add very simple example to s\+\_\+server. This fixes many of the problems and restrictions of the existing client certificate callback\+: for example you can now clear an existing certificate and specify the whole chain.

{\itshape Steve Henson}
\item Add new "{}valid\+\_\+flags"{} field to CERT\+\_\+\+PKEY structure which determines what the certificate can be used for (if anything). Set valid\+\_\+flags field in new tls1\+\_\+check\+\_\+chain function. Simplify ssl\+\_\+set\+\_\+cert\+\_\+masks which used to have similar checks in it.

Add new "{}cert\+\_\+flags"{} field to CERT structure and include a "{}strict mode"{}. This enforces some TLS certificate requirements (such as only permitting certificate signature algorithms contained in the supported algorithms extension) which some implementations ignore\+: this option should be used with caution as it could cause interoperability issues.

{\itshape Steve Henson}
\item Update and tidy signature algorithm extension processing. Work out shared signature algorithms based on preferences and peer algorithms and print them out in s\+\_\+client and s\+\_\+server. Abort handshake if no shared signature algorithms.

{\itshape Steve Henson}
\item Add new functions to allow customised supported signature algorithms for SSL and SSL\+\_\+\+CTX structures. Add options to s\+\_\+client and s\+\_\+server to support them.

{\itshape Steve Henson}
\item New function SSL\+\_\+certs\+\_\+clear() to delete all references to certificates from an SSL structure. Before this once a certificate had been added it couldn\textquotesingle{}t be removed.

{\itshape Steve Henson}
\item Integrate hostname, email address and IP address checking with certificate verification. New verify options supporting checking in openssl utility.

{\itshape Steve Henson}
\item Fixes and wildcard matching support to hostname and email checking functions. Add manual page.

{\itshape Florian Weimer (Red Hat Product Security Team)}
\item New functions to check a hostname email or IP address against a certificate. Add options x509 utility to print results of checks against a certificate.

{\itshape Steve Henson}
\item Fix OCSP checking.

\texorpdfstring{$\ast$}{*}\+Rob Stradling \href{mailto:rob.stradling@comodo.com}{\texttt{ rob.\+stradling@comodo.\+com}} and Ben Laurie\texorpdfstring{$\ast$}{*}
\item Initial experimental support for explicitly trusted non-\/root CAs. Open\+SSL still tries to build a complete chain to a root but if an intermediate CA has a trust setting included that is used. The first setting is used\+: whether to trust (e.\+g., -\/addtrust option to the x509 utility) or reject.

{\itshape Steve Henson}
\item Add -\/trusted\+\_\+first option which attempts to find certificates in the trusted store even if an untrusted chain is also supplied.

{\itshape Steve Henson}
\item MIPS assembly pack updates\+: support for MIPS32r2 and Smart\+MIPS ASE, platform support for Linux and Android.

{\itshape Andy Polyakov}
\item Support for linux-\/x32, ILP32 environment in x86\+\_\+64 framework.

{\itshape Andy Polyakov}
\item Experimental multi-\/implementation support for FIPS capable Open\+SSL. When in FIPS mode the approved implementations are used as normal, when not in FIPS mode the internal unapproved versions are used instead. This means that the FIPS capable Open\+SSL isn\textquotesingle{}t forced to use the (often lower performance) FIPS implementations outside FIPS mode.

{\itshape Steve Henson}
\item Transparently support X9.\+42 DH parameters when calling PEM\+\_\+read\+\_\+bio\+\_\+\+DHparameters. This means existing applications can handle the new parameter format automatically.

{\itshape Steve Henson}
\item Initial experimental support for X9.\+42 DH parameter format\+: mainly to support use of \textquotesingle{}q\textquotesingle{} parameter for RFC5114 parameters.

{\itshape Steve Henson}
\item Add DH parameters from RFC5114 including test data to dhtest.

{\itshape Steve Henson}
\item Support for automatic EC temporary key parameter selection. If enabled the most preferred EC parameters are automatically used instead of hardcoded fixed parameters. Now a server just has to call\+: SSL\+\_\+\+CTX\+\_\+set\+\_\+ecdh\+\_\+auto(ctx, 1) and the server will automatically support ECDH and use the most appropriate parameters.

{\itshape Steve Henson}
\item Enhance and tidy EC curve and point format TLS extension code. Use static structures instead of allocation if default values are used. New ctrls to set curves we wish to support and to retrieve shared curves. Print out shared curves in s\+\_\+server. New options to s\+\_\+server and s\+\_\+client to set list of supported curves.

{\itshape Steve Henson}
\item New ctrls to retrieve supported signature algorithms and supported curve values as an array of NIDs. Extend openssl utility to print out received values.

{\itshape Steve Henson}
\item Add new APIs EC\+\_\+curve\+\_\+nist2nid and EC\+\_\+curve\+\_\+nid2nist which convert between NIDs and the more common NIST names such as "{}\+P-\/256"{}. Enhance ecparam utility and ECC method to recognise the NIST names for curves.

{\itshape Steve Henson}
\item Enhance SSL/\+TLS certificate chain handling to support different chains for each certificate instead of one chain in the parent SSL\+\_\+\+CTX.

{\itshape Steve Henson}
\item Support for fixed DH ciphersuite client authentication\+: where both server and client use DH certificates with common parameters.

{\itshape Steve Henson}
\item Support for fixed DH ciphersuites\+: those requiring DH server certificates.

{\itshape Steve Henson}
\item New function i2d\+\_\+re\+\_\+\+X509\+\_\+tbs for re-\/encoding the TBS portion of the certificate. Note\+: Related 1.\+0.\+2-\/beta specific macros X509\+\_\+get\+\_\+cert\+\_\+info, X509\+\_\+\+CINF\+\_\+set\+\_\+modified, X509\+\_\+\+CINF\+\_\+get\+\_\+issuer, X509\+\_\+\+CINF\+\_\+get\+\_\+extensions and X509\+\_\+\+CINF\+\_\+get\+\_\+signature were reverted post internal team review.
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md74}{}\doxysection{\texorpdfstring{Open\+SSL 1.\+0.\+1}{Open\+SSL 1.\+0.\+1}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md74}
\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md75}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+1t and 1.\+0.\+1u \mbox{[}22 Sep 2016\mbox{]}}{Changes between 1.\+0.\+1t and 1.\+0.\+1u \mbox{[}22 Sep 2016\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md75}

\begin{DoxyItemize}
\item OCSP Status Request extension unbounded memory growth

A malicious client can send an excessively large OCSP Status Request extension. If that client continually requests renegotiation, sending a large OCSP Status Request extension each time, then there will be unbounded memory growth on the server. This will eventually lead to a Denial Of Service attack through memory exhaustion. Servers with a default configuration are vulnerable even if they do not support OCSP. Builds using the "{}no-\/ocsp"{} build time option are not affected.

This issue was reported to Open\+SSL by Shi Lei (Gear Team, Qihoo 360 Inc.) (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-6304}{\texttt{ CVE-\/2016-\/6304}})

{\itshape Matt Caswell}
\item In order to mitigate the SWEET32 attack, the DES ciphers were moved from HIGH to MEDIUM.

This issue was reported to Open\+SSL Karthikeyan Bhargavan and Gaetan Leurent (INRIA) (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-2183}{\texttt{ CVE-\/2016-\/2183}})

{\itshape Rich Salz}
\item OOB write in MDC2\+\_\+\+Update()

An overflow can occur in MDC2\+\_\+\+Update() either if called directly or through the EVP\+\_\+\+Digest\+Update() function using MDC2. If an attacker is able to supply very large amounts of input data after a previous call to EVP\+\_\+\+Encrypt\+Update() with a partial block then a length check can overflow resulting in a heap corruption.

The amount of data needed is comparable to SIZE\+\_\+\+MAX which is impractical on most platforms.

This issue was reported to Open\+SSL by Shi Lei (Gear Team, Qihoo 360 Inc.) (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-6303}{\texttt{ CVE-\/2016-\/6303}})

{\itshape Stephen Henson}
\item Malformed SHA512 ticket DoS

If a server uses SHA512 for TLS session ticket HMAC it is vulnerable to a DoS attack where a malformed ticket will result in an OOB read which will ultimately crash.

The use of SHA512 in TLS session tickets is comparatively rare as it requires a custom server callback and ticket lookup mechanism.

This issue was reported to Open\+SSL by Shi Lei (Gear Team, Qihoo 360 Inc.) (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-6302}{\texttt{ CVE-\/2016-\/6302}})

{\itshape Stephen Henson}
\item OOB write in BN\+\_\+bn2dec()

The function BN\+\_\+bn2dec() does not check the return value of BN\+\_\+div\+\_\+word(). This can cause an OOB write if an application uses this function with an overly large BIGNUM. This could be a problem if an overly large certificate or CRL is printed out from an untrusted source. TLS is not affected because record limits will reject an oversized certificate before it is parsed.

This issue was reported to Open\+SSL by Shi Lei (Gear Team, Qihoo 360 Inc.) (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-2182}{\texttt{ CVE-\/2016-\/2182}})

{\itshape Stephen Henson}
\item OOB read in TS\+\_\+\+OBJ\+\_\+print\+\_\+bio()

The function TS\+\_\+\+OBJ\+\_\+print\+\_\+bio() misuses OBJ\+\_\+obj2txt()\+: the return value is the total length the OID text representation would use and not the amount of data written. This will result in OOB reads when large OIDs are presented.

This issue was reported to Open\+SSL by Shi Lei (Gear Team, Qihoo 360 Inc.) (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-2180}{\texttt{ CVE-\/2016-\/2180}})

{\itshape Stephen Henson}
\item Pointer arithmetic undefined behaviour

Avoid some undefined pointer arithmetic

A common idiom in the codebase is to check limits in the following manner\+: "{}p + len $>$ limit"{}

Where "{}p"{} points to some malloc\textquotesingle{}d data of SIZE bytes and limit == p + SIZE

"{}len"{} here could be from some externally supplied data (e.\+g. from a TLS message).

The rules of C pointer arithmetic are such that "{}p + len"{} is only well defined where len \texorpdfstring{$<$}{<}= SIZE. Therefore, the above idiom is actually undefined behaviour.

For example this could cause problems if some malloc implementation provides an address for "{}p"{} such that "{}p + len"{} actually overflows for values of len that are too big and therefore p + len \texorpdfstring{$<$}{<} limit.

This issue was reported to Open\+SSL by Guido Vranken (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-2177}{\texttt{ CVE-\/2016-\/2177}})

{\itshape Matt Caswell}
\item Constant time flag not preserved in DSA signing

Operations in the DSA signing algorithm should run in constant time in order to avoid side channel attacks. A flaw in the Open\+SSL DSA implementation means that a non-\/constant time codepath is followed for certain operations. This has been demonstrated through a cache-\/timing attack to be sufficient for an attacker to recover the private DSA key.

This issue was reported by César Pereida (Aalto University), Billy Brumley (Tampere University of Technology), and Yuval Yarom (The University of Adelaide and NICTA). (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-2178}{\texttt{ CVE-\/2016-\/2178}})

{\itshape César Pereida}
\item DTLS buffered message DoS

In a DTLS connection where handshake messages are delivered out-\/of-\/order those messages that Open\+SSL is not yet ready to process will be buffered for later use. Under certain circumstances, a flaw in the logic means that those messages do not get removed from the buffer even though the handshake has been completed. An attacker could force up to approx. 15 messages to remain in the buffer when they are no longer required. These messages will be cleared when the DTLS connection is closed. The default maximum size for a message is 100k. Therefore, the attacker could force an additional 1500k to be consumed per connection. By opening many simultaneous connections an attacker could cause a DoS attack through memory exhaustion.

This issue was reported to Open\+SSL by Quan Luo. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-2179}{\texttt{ CVE-\/2016-\/2179}})

{\itshape Matt Caswell}
\item DTLS replay protection DoS

A flaw in the DTLS replay attack protection mechanism means that records that arrive for future epochs update the replay protection "{}window"{} before the MAC for the record has been validated. This could be exploited by an attacker by sending a record for the next epoch (which does not have to decrypt or have a valid MAC), with a very large sequence number. This means that all subsequent legitimate packets are dropped causing a denial of service for a specific DTLS connection.

This issue was reported to Open\+SSL by the OCAP audit team. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-2181}{\texttt{ CVE-\/2016-\/2181}})

{\itshape Matt Caswell}
\item Certificate message OOB reads

In Open\+SSL 1.\+0.\+2 and earlier some missing message length checks can result in OOB reads of up to 2 bytes beyond an allocated buffer. There is a theoretical DoS risk but this has not been observed in practice on common platforms.

The messages affected are client certificate, client certificate request and server certificate. As a result the attack can only be performed against a client or a server which enables client authentication.

This issue was reported to Open\+SSL by Shi Lei (Gear Team, Qihoo 360 Inc.) (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-6306}{\texttt{ CVE-\/2016-\/6306}})

{\itshape Stephen Henson}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md76}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+1s and 1.\+0.\+1t \mbox{[}3 May 2016\mbox{]}}{Changes between 1.\+0.\+1s and 1.\+0.\+1t \mbox{[}3 May 2016\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md76}

\begin{DoxyItemize}
\item Prevent padding oracle in AES-\/\+NI CBC MAC check

A MITM attacker can use a padding oracle attack to decrypt traffic when the connection uses an AES CBC cipher and the server support AES-\/\+NI.

This issue was introduced as part of the fix for Lucky 13 padding attack (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2013-0169}{\texttt{ CVE-\/2013-\/0169}}). The padding check was rewritten to be in constant time by making sure that always the same bytes are read and compared against either the MAC or padding bytes. But it no longer checked that there was enough data to have both the MAC and padding bytes.

This issue was reported by Juraj Somorovsky using TLS-\/\+Attacker. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-2107}{\texttt{ CVE-\/2016-\/2107}})

{\itshape Kurt Roeckx}
\item Fix EVP\+\_\+\+Encode\+Update overflow

An overflow can occur in the EVP\+\_\+\+Encode\+Update() function which is used for Base64 encoding of binary data. If an attacker is able to supply very large amounts of input data then a length check can overflow resulting in a heap corruption.

Internally to Open\+SSL the EVP\+\_\+\+Encode\+Update() function is primarily used by the {\ttfamily PEM\+\_\+write\+\_\+bio\texorpdfstring{$\ast$}{*}} family of functions. These are mainly used within the Open\+SSL command line applications, so any application which processes data from an untrusted source and outputs it as a PEM file should be considered vulnerable to this issue. User applications that call these APIs directly with large amounts of untrusted data may also be vulnerable.

This issue was reported by Guido Vranken. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-2105}{\texttt{ CVE-\/2016-\/2105}})

{\itshape Matt Caswell}
\item Fix EVP\+\_\+\+Encrypt\+Update overflow

An overflow can occur in the EVP\+\_\+\+Encrypt\+Update() function. If an attacker is able to supply very large amounts of input data after a previous call to EVP\+\_\+\+Encrypt\+Update() with a partial block then a length check can overflow resulting in a heap corruption. Following an analysis of all Open\+SSL internal usage of the EVP\+\_\+\+Encrypt\+Update() function all usage is one of two forms. The first form is where the EVP\+\_\+\+Encrypt\+Update() call is known to be the first called function after an EVP\+\_\+\+Encrypt\+Init(), and therefore that specific call must be safe. The second form is where the length passed to EVP\+\_\+\+Encrypt\+Update() can be seen from the code to be some small value and therefore there is no possibility of an overflow. Since all instances are one of these two forms, it is believed that there can be no overflows in internal code due to this problem. It should be noted that EVP\+\_\+\+Decrypt\+Update() can call EVP\+\_\+\+Encrypt\+Update() in certain code paths. Also EVP\+\_\+\+Cipher\+Update() is a synonym for EVP\+\_\+\+Encrypt\+Update(). All instances of these calls have also been analysed too and it is believed there are no instances in internal usage where an overflow could occur.

This issue was reported by Guido Vranken. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-2106}{\texttt{ CVE-\/2016-\/2106}})

{\itshape Matt Caswell}
\item Prevent ASN.\+1 BIO excessive memory allocation

When ASN.\+1 data is read from a BIO using functions such as d2i\+\_\+\+CMS\+\_\+bio() a short invalid encoding can casuse allocation of large amounts of memory potentially consuming excessive resources or exhausting memory.

Any application parsing untrusted data through d2i BIO functions is affected. The memory based functions such as d2i\+\_\+\+X509() are {\itshape not} affected. Since the memory based functions are used by the TLS library, TLS applications are not affected.

This issue was reported by Brian Carpenter. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-2109}{\texttt{ CVE-\/2016-\/2109}})

{\itshape Stephen Henson}
\item EBCDIC overread

ASN1 Strings that are over 1024 bytes can cause an overread in applications using the X509\+\_\+\+NAME\+\_\+oneline() function on EBCDIC systems. This could result in arbitrary stack data being returned in the buffer.

This issue was reported by Guido Vranken. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-2176}{\texttt{ CVE-\/2016-\/2176}})

{\itshape Matt Caswell}
\item Modify behavior of ALPN to invoke callback after SNI/servername callback, such that updates to the SSL\+\_\+\+CTX affect ALPN.

{\itshape Todd Short}
\item Remove LOW from the DEFAULT cipher list. This removes singles DES from the default.

{\itshape Kurt Roeckx}
\item Only remove the SSLv2 methods with the no-\/ssl2-\/method option. When the methods are enabled and ssl2 is disabled the methods return NULL.

{\itshape Kurt Roeckx}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md77}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+1r and 1.\+0.\+1s \mbox{[}1 Mar 2016\mbox{]}}{Changes between 1.\+0.\+1r and 1.\+0.\+1s \mbox{[}1 Mar 2016\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md77}

\begin{DoxyItemize}
\item Disable weak ciphers in SSLv3 and up in default builds of Open\+SSL. Builds that are not configured with "{}enable-\/weak-\/ssl-\/ciphers"{} will not provide any "{}\+EXPORT"{} or "{}\+LOW"{} strength ciphers.

{\itshape Viktor Dukhovni}
\item Disable SSLv2 default build, default negotiation and weak ciphers. SSLv2 is by default disabled at build-\/time. Builds that are not configured with "{}enable-\/ssl2"{} will not support SSLv2. Even if "{}enable-\/ssl2"{} is used, users who want to negotiate SSLv2 via the version-\/flexible SSLv23\+\_\+method() will need to explicitly call either of\+: \begin{DoxyVerb}SSL_CTX_clear_options(ctx, SSL_OP_NO_SSLv2);
\end{DoxyVerb}
 or SSL\+\_\+clear\+\_\+options(ssl, SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+SSLv2);

as appropriate. Even if either of those is used, or the application explicitly uses the version-\/specific SSLv2\+\_\+method() or its client and server variants, SSLv2 ciphers vulnerable to exhaustive search key recovery have been removed. Specifically, the SSLv2 40-\/bit EXPORT ciphers, and SSLv2 56-\/bit DES are no longer available. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-0800}{\texttt{ CVE-\/2016-\/0800}})

{\itshape Viktor Dukhovni}
\begin{DoxyItemize}
\item Fix a double-\/free in DSA code

A double free bug was discovered when Open\+SSL parses malformed DSA private keys and could lead to a DoS attack or memory corruption for applications that receive DSA private keys from untrusted sources. This scenario is considered rare.

This issue was reported to Open\+SSL by Adam Langley(Google/\+Boring\+SSL) using lib\+Fuzzer. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-0705}{\texttt{ CVE-\/2016-\/0705}})

{\itshape Stephen Henson}
\item Disable SRP fake user seed to address a server memory leak.

Add a new method SRP\+\_\+\+VBASE\+\_\+get1\+\_\+by\+\_\+user that handles the seed properly.

SRP\+\_\+\+VBASE\+\_\+get\+\_\+by\+\_\+user had inconsistent memory management behaviour. In order to fix an unavoidable memory leak, SRP\+\_\+\+VBASE\+\_\+get\+\_\+by\+\_\+user was changed to ignore the "{}fake user"{} SRP seed, even if the seed is configured.

Users should use SRP\+\_\+\+VBASE\+\_\+get1\+\_\+by\+\_\+user instead. Note that in SRP\+\_\+\+VBASE\+\_\+get1\+\_\+by\+\_\+user, caller must free the returned value. Note also that even though configuring the SRP seed attempts to hide invalid usernames by continuing the handshake with fake credentials, this behaviour is not constant time and no strong guarantees are made that the handshake is indistinguishable from that of a valid user. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-0798}{\texttt{ CVE-\/2016-\/0798}})

{\itshape Emilia Käsper}
\item Fix BN\+\_\+hex2bn/\+BN\+\_\+dec2bn NULL pointer deref/heap corruption

In the BN\+\_\+hex2bn function the number of hex digits is calculated using an int value {\ttfamily i}. Later {\ttfamily bn\+\_\+expand} is called with a value of {\ttfamily i \texorpdfstring{$\ast$}{*} 4}. For large values of {\ttfamily i} this can result in {\ttfamily bn\+\_\+expand} not allocating any memory because {\ttfamily i \texorpdfstring{$\ast$}{*} 4} is negative. This can leave the internal BIGNUM data field as NULL leading to a subsequent NULL ptr deref. For very large values of {\ttfamily i}, the calculation {\ttfamily i \texorpdfstring{$\ast$}{*} 4} could be a positive value smaller than {\ttfamily i}. In this case memory is allocated to the internal BIGNUM data field, but it is insufficiently sized leading to heap corruption. A similar issue exists in BN\+\_\+dec2bn. This could have security consequences if BN\+\_\+hex2bn/\+BN\+\_\+dec2bn is ever called by user applications with very large untrusted hex/dec data. This is anticipated to be a rare occurrence.

All Open\+SSL internal usage of these functions use data that is not expected to be untrusted, e.\+g. config file data or application command line arguments. If user developed applications generate config file data based on untrusted data then it is possible that this could also lead to security consequences. This is also anticipated to be rare.

This issue was reported to Open\+SSL by Guido Vranken. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-0797}{\texttt{ CVE-\/2016-\/0797}})

{\itshape Matt Caswell}
\item Fix memory issues in {\ttfamily BIO\+\_\+\texorpdfstring{$\ast$}{*}printf} functions

The internal {\ttfamily fmtstr} function used in processing a "{}\%s"{} format string in the {\ttfamily BIO\+\_\+\texorpdfstring{$\ast$}{*}printf} functions could overflow while calculating the length of a string and cause an OOB read when printing very long strings.

Additionally the internal {\ttfamily doapr\+\_\+outch} function can attempt to write to an OOB memory location (at an offset from the NULL pointer) in the event of a memory allocation failure. In 1.\+0.\+2 and below this could be caused where the size of a buffer to be allocated is greater than INT\+\_\+\+MAX. E.\+g. this could be in processing a very long "{}\%s"{} format string. Memory leaks can also occur.

The first issue may mask the second issue dependent on compiler behaviour. These problems could enable attacks where large amounts of untrusted data is passed to the {\ttfamily BIO\+\_\+\texorpdfstring{$\ast$}{*}printf} functions. If applications use these functions in this way then they could be vulnerable. Open\+SSL itself uses these functions when printing out human-\/readable dumps of ASN.\+1 data. Therefore applications that print this data could be vulnerable if the data is from untrusted sources. Open\+SSL command line applications could also be vulnerable where they print out ASN.\+1 data, or if untrusted data is passed as command line arguments.

Libssl is not considered directly vulnerable. Additionally certificates etc received via remote connections via libssl are also unlikely to be able to trigger these issues because of message size limits enforced within libssl.

This issue was reported to Open\+SSL Guido Vranken. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-0799}{\texttt{ CVE-\/2016-\/0799}})

{\itshape Matt Caswell}
\item Side channel attack on modular exponentiation

A side-\/channel attack was found which makes use of cache-\/bank conflicts on the Intel Sandy-\/\+Bridge microarchitecture which could lead to the recovery of RSA keys. The ability to exploit this issue is limited as it relies on an attacker who has control of code in a thread running on the same hyper-\/threaded core as the victim thread which is performing decryptions.

This issue was reported to Open\+SSL by Yuval Yarom, The University of Adelaide and NICTA, Daniel Genkin, Technion and Tel Aviv University, and Nadia Heninger, University of Pennsylvania with more information at \href{http://cachebleed.info}{\texttt{ http\+://cachebleed.\+info}}. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2016-0702}{\texttt{ CVE-\/2016-\/0702}})

{\itshape Andy Polyakov}
\item Change the req command to generate a 2048-\/bit RSA/\+DSA key by default, if no keysize is specified with default\+\_\+bits. This fixes an omission in an earlier change that changed all RSA/\+DSA key generation commands to use 2048 bits by default.

{\itshape Emilia Käsper}
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md78}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+1q and 1.\+0.\+1r \mbox{[}28 Jan 2016\mbox{]}}{Changes between 1.\+0.\+1q and 1.\+0.\+1r \mbox{[}28 Jan 2016\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md78}

\begin{DoxyItemize}
\item Protection for DH small subgroup attacks

As a precautionary measure the SSL\+\_\+\+OP\+\_\+\+SINGLE\+\_\+\+DH\+\_\+\+USE option has been switched on by default and cannot be disabled. This could have some performance impact.

{\itshape Matt Caswell}
\item SSLv2 doesn\textquotesingle{}t block disabled ciphers

A malicious client can negotiate SSLv2 ciphers that have been disabled on the server and complete SSLv2 handshakes even if all SSLv2 ciphers have been disabled, provided that the SSLv2 protocol was not also disabled via SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+SSLv2.

This issue was reported to Open\+SSL on 26th December 2015 by Nimrod Aviram and Sebastian Schinzel. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-3197}{\texttt{ CVE-\/2015-\/3197}})

{\itshape Viktor Dukhovni}
\item Reject DH handshakes with parameters shorter than 1024 bits.

{\itshape Kurt Roeckx}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md79}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+1p and 1.\+0.\+1q \mbox{[}3 Dec 2015\mbox{]}}{Changes between 1.\+0.\+1p and 1.\+0.\+1q \mbox{[}3 Dec 2015\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md79}

\begin{DoxyItemize}
\item Certificate verify crash with missing PSS parameter

The signature verification routines will crash with a NULL pointer dereference if presented with an ASN.\+1 signature using the RSA PSS algorithm and absent mask generation function parameter. Since these routines are used to verify certificate signature algorithms this can be used to crash any certificate verification operation and exploited in a DoS attack. Any application which performs certificate verification is vulnerable including Open\+SSL clients and servers which enable client authentication.

This issue was reported to Open\+SSL by Loïc Jonas Etienne (Qnective AG). (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-3194}{\texttt{ CVE-\/2015-\/3194}})

{\itshape Stephen Henson}
\item X509\+\_\+\+ATTRIBUTE memory leak

When presented with a malformed X509\+\_\+\+ATTRIBUTE structure Open\+SSL will leak memory. This structure is used by the PKCS\#7 and CMS routines so any application which reads PKCS\#7 or CMS data from untrusted sources is affected. SSL/\+TLS is not affected.

This issue was reported to Open\+SSL by Adam Langley (Google/\+Boring\+SSL) using lib\+Fuzzer. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-3195}{\texttt{ CVE-\/2015-\/3195}})

{\itshape Stephen Henson}
\item Rewrite EVP\+\_\+\+Decode\+Update (base64 decoding) to fix several bugs. This changes the decoding behaviour for some invalid messages, though the change is mostly in the more lenient direction, and legacy behaviour is preserved as much as possible.

{\itshape Emilia Käsper}
\item In DSA\+\_\+generate\+\_\+parameters\+\_\+ex, if the provided seed is too short, use a random seed, as already documented.

\texorpdfstring{$\ast$}{*}\+Rich Salz and Ismo Puustinen \href{mailto:ismo.puustinen@intel.com}{\texttt{ ismo.\+puustinen@intel.\+com}}\texorpdfstring{$\ast$}{*}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md80}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+1o and 1.\+0.\+1p \mbox{[}9 Jul 2015\mbox{]}}{Changes between 1.\+0.\+1o and 1.\+0.\+1p \mbox{[}9 Jul 2015\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md80}

\begin{DoxyItemize}
\item Alternate chains certificate forgery

During certificate verification, Open\+SSL will attempt to find an alternative certificate chain if the first attempt to build such a chain fails. An error in the implementation of this logic can mean that an attacker could cause certain checks on untrusted certificates to be bypassed, such as the CA flag, enabling them to use a valid leaf certificate to act as a CA and "{}issue"{} an invalid certificate.

This issue was reported to Open\+SSL by Adam Langley/\+David Benjamin (Google/\+Boring\+SSL). (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-1793}{\texttt{ CVE-\/2015-\/1793}})

{\itshape Matt Caswell}
\item Race condition handling PSK identify hint

If PSK identity hints are received by a multi-\/threaded client then the values are wrongly updated in the parent SSL\+\_\+\+CTX structure. This can result in a race condition potentially leading to a double free of the identify hint data. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-3196}{\texttt{ CVE-\/2015-\/3196}})

{\itshape Stephen Henson}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md81}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+1n and 1.\+0.\+1o \mbox{[}12 Jun 2015\mbox{]}}{Changes between 1.\+0.\+1n and 1.\+0.\+1o \mbox{[}12 Jun 2015\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md81}

\begin{DoxyItemize}
\item Fix HMAC ABI incompatibility. The previous version introduced an ABI incompatibility in the handling of HMAC. The previous ABI has now been restored.
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md82}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+1m and 1.\+0.\+1n \mbox{[}11 Jun 2015\mbox{]}}{Changes between 1.\+0.\+1m and 1.\+0.\+1n \mbox{[}11 Jun 2015\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md82}

\begin{DoxyItemize}
\item Malformed ECParameters causes infinite loop

When processing an ECParameters structure Open\+SSL enters an infinite loop if the curve specified is over a specially malformed binary polynomial field.

This can be used to perform denial of service against any system which processes public keys, certificate requests or certificates. This includes TLS clients and TLS servers with client authentication enabled.

This issue was reported to Open\+SSL by Joseph Barr-\/\+Pixton. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-1788}{\texttt{ CVE-\/2015-\/1788}})

{\itshape Andy Polyakov}
\item Exploitable out-\/of-\/bounds read in X509\+\_\+cmp\+\_\+time

X509\+\_\+cmp\+\_\+time does not properly check the length of the ASN1\+\_\+\+TIME string and can read a few bytes out of bounds. In addition, X509\+\_\+cmp\+\_\+time accepts an arbitrary number of fractional seconds in the time string.

An attacker can use this to craft malformed certificates and CRLs of various sizes and potentially cause a segmentation fault, resulting in a DoS on applications that verify certificates or CRLs. TLS clients that verify CRLs are affected. TLS clients and servers with client authentication enabled may be affected if they use custom verification callbacks.

This issue was reported to Open\+SSL by Robert Swiecki (Google), and independently by Hanno Böck. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-1789}{\texttt{ CVE-\/2015-\/1789}})

{\itshape Emilia Käsper}
\item PKCS7 crash with missing Enveloped\+Content

The PKCS\#7 parsing code does not handle missing inner Encrypted\+Content correctly. An attacker can craft malformed ASN.\+1-\/encoded PKCS\#7 blobs with missing content and trigger a NULL pointer dereference on parsing.

Applications that decrypt PKCS\#7 data or otherwise parse PKCS\#7 structures from untrusted sources are affected. Open\+SSL clients and servers are not affected.

This issue was reported to Open\+SSL by Michal Zalewski (Google). (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-1790}{\texttt{ CVE-\/2015-\/1790}})

{\itshape Emilia Käsper}
\item CMS verify infinite loop with unknown hash function

When verifying a signed\+Data message the CMS code can enter an infinite loop if presented with an unknown hash function OID. This can be used to perform denial of service against any system which verifies signed\+Data messages using the CMS code. This issue was reported to Open\+SSL by Johannes Bauer. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-1792}{\texttt{ CVE-\/2015-\/1792}})

{\itshape Stephen Henson}
\item Race condition handling New\+Session\+Ticket

If a New\+Session\+Ticket is received by a multi-\/threaded client when attempting to reuse a previous ticket then a race condition can occur potentially leading to a double free of the ticket data. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-1791}{\texttt{ CVE-\/2015-\/1791}})

{\itshape Matt Caswell}
\item Reject DH handshakes with parameters shorter than 768 bits.

{\itshape Kurt Roeckx and Emilia Kasper}
\item dhparam\+: generate 2048-\/bit parameters by default.

{\itshape Kurt Roeckx and Emilia Kasper}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md83}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+1l and 1.\+0.\+1m \mbox{[}19 Mar 2015\mbox{]}}{Changes between 1.\+0.\+1l and 1.\+0.\+1m \mbox{[}19 Mar 2015\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md83}

\begin{DoxyItemize}
\item Segmentation fault in ASN1\+\_\+\+TYPE\+\_\+cmp fix

The function ASN1\+\_\+\+TYPE\+\_\+cmp will crash with an invalid read if an attempt is made to compare ASN.\+1 boolean types. Since ASN1\+\_\+\+TYPE\+\_\+cmp is used to check certificate signature algorithm consistency this can be used to crash any certificate verification operation and exploited in a DoS attack. Any application which performs certificate verification is vulnerable including Open\+SSL clients and servers which enable client authentication. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0286}{\texttt{ CVE-\/2015-\/0286}})

{\itshape Stephen Henson}
\item ASN.\+1 structure reuse memory corruption fix

Reusing a structure in ASN.\+1 parsing may allow an attacker to cause memory corruption via an invalid write. Such reuse is and has been strongly discouraged and is believed to be rare.

Applications that parse structures containing CHOICE or ANY DEFINED BY components may be affected. Certificate parsing (d2i\+\_\+\+X509 and related functions) are however not affected. Open\+SSL clients and servers are not affected. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0287}{\texttt{ CVE-\/2015-\/0287}})

{\itshape Stephen Henson}
\item PKCS7 NULL pointer dereferences fix

The PKCS\#7 parsing code does not handle missing outer Content\+Info correctly. An attacker can craft malformed ASN.\+1-\/encoded PKCS\#7 blobs with missing content and trigger a NULL pointer dereference on parsing.

Applications that verify PKCS\#7 signatures, decrypt PKCS\#7 data or otherwise parse PKCS\#7 structures from untrusted sources are affected. Open\+SSL clients and servers are not affected.

This issue was reported to Open\+SSL by Michal Zalewski (Google). (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0289}{\texttt{ CVE-\/2015-\/0289}})

{\itshape Emilia Käsper}
\item DoS via reachable assert in SSLv2 servers fix

A malicious client can trigger an OPENSSL\+\_\+assert (i.\+e., an abort) in servers that both support SSLv2 and enable export cipher suites by sending a specially crafted SSLv2 CLIENT-\/\+MASTER-\/\+KEY message.

This issue was discovered by Sean Burford (Google) and Emilia Käsper (Open\+SSL development team). (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0293}{\texttt{ CVE-\/2015-\/0293}})

{\itshape Emilia Käsper}
\item Use After Free following d2i\+\_\+\+ECPrivatekey error fix

A malformed EC private key file consumed via the d2i\+\_\+\+ECPrivate\+Key function could cause a use after free condition. This, in turn, could cause a double free in several private key parsing functions (such as d2i\+\_\+\+Private\+Key or EVP\+\_\+\+PKCS82\+PKEY) and could lead to a DoS attack or memory corruption for applications that receive EC private keys from untrusted sources. This scenario is considered rare.

This issue was discovered by the Boring\+SSL project and fixed in their commit 517073cd4b. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0209}{\texttt{ CVE-\/2015-\/0209}})

{\itshape Matt Caswell}
\item X509\+\_\+to\+\_\+\+X509\+\_\+\+REQ NULL pointer deref fix

The function X509\+\_\+to\+\_\+\+X509\+\_\+\+REQ will crash with a NULL pointer dereference if the certificate key is invalid. This function is rarely used in practice.

This issue was discovered by Brian Carpenter. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0288}{\texttt{ CVE-\/2015-\/0288}})

{\itshape Stephen Henson}
\item Removed the export ciphers from the DEFAULT ciphers

{\itshape Kurt Roeckx}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md84}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+1k and 1.\+0.\+1l \mbox{[}15 Jan 2015\mbox{]}}{Changes between 1.\+0.\+1k and 1.\+0.\+1l \mbox{[}15 Jan 2015\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md84}

\begin{DoxyItemize}
\item Build fixes for the Windows and Open\+VMS platforms

{\itshape Matt Caswell and Richard Levitte}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md85}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+1j and 1.\+0.\+1k \mbox{[}8 Jan 2015\mbox{]}}{Changes between 1.\+0.\+1j and 1.\+0.\+1k \mbox{[}8 Jan 2015\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md85}

\begin{DoxyItemize}
\item Fix DTLS segmentation fault in dtls1\+\_\+get\+\_\+record. A carefully crafted DTLS message can cause a segmentation fault in Open\+SSL due to a NULL pointer dereference. This could lead to a Denial Of Service attack. Thanks to Markus Stenberg of Cisco Systems, Inc. for reporting this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3571}{\texttt{ CVE-\/2014-\/3571}})

{\itshape Steve Henson}
\item Fix DTLS memory leak in dtls1\+\_\+buffer\+\_\+record. A memory leak can occur in the dtls1\+\_\+buffer\+\_\+record function under certain conditions. In particular this could occur if an attacker sent repeated DTLS records with the same sequence number but for the next epoch. The memory leak could be exploited by an attacker in a Denial of Service attack through memory exhaustion. Thanks to Chris Mueller for reporting this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0206}{\texttt{ CVE-\/2015-\/0206}})

{\itshape Matt Caswell}
\item Fix issue where no-\/ssl3 configuration sets method to NULL. When openssl is built with the no-\/ssl3 option and a SSL v3 Client\+Hello is received the ssl method would be set to NULL which could later result in a NULL pointer dereference. Thanks to Frank Schmirler for reporting this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3569}{\texttt{ CVE-\/2014-\/3569}})

{\itshape Kurt Roeckx}
\item Abort handshake if server key exchange message is omitted for ephemeral ECDH ciphersuites.

Thanks to Karthikeyan Bhargavan of the PROSECCO team at INRIA for reporting this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3572}{\texttt{ CVE-\/2014-\/3572}})

{\itshape Steve Henson}
\item Remove non-\/export ephemeral RSA code on client and server. This code violated the TLS standard by allowing the use of temporary RSA keys in non-\/export ciphersuites and could be used by a server to effectively downgrade the RSA key length used to a value smaller than the server certificate. Thanks for Karthikeyan Bhargavan of the PROSECCO team at INRIA or reporting this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0204}{\texttt{ CVE-\/2015-\/0204}})

{\itshape Steve Henson}
\item Fixed issue where DH client certificates are accepted without verification. An Open\+SSL server will accept a DH certificate for client authentication without the certificate verify message. This effectively allows a client to authenticate without the use of a private key. This only affects servers which trust a client certificate authority which issues certificates containing DH keys\+: these are extremely rare and hardly ever encountered. Thanks for Karthikeyan Bhargavan of the PROSECCO team at INRIA or reporting this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0205}{\texttt{ CVE-\/2015-\/0205}})

{\itshape Steve Henson}
\item Ensure that the session ID context of an SSL is updated when its SSL\+\_\+\+CTX is updated via SSL\+\_\+set\+\_\+\+SSL\+\_\+\+CTX.

The session ID context is typically set from the parent SSL\+\_\+\+CTX, and can vary with the CTX.

{\itshape Adam Langley}
\item Fix various certificate fingerprint issues.

By using non-\/\+DER or invalid encodings outside the signed portion of a certificate the fingerprint can be changed without breaking the signature. Although no details of the signed portion of the certificate can be changed this can cause problems with some applications\+: e.\+g. those using the certificate fingerprint for blacklists.
\begin{DoxyEnumerate}
\item Reject signatures with non zero unused bits.
\end{DoxyEnumerate}

If the BIT STRING containing the signature has non zero unused bits reject the signature. All current signature algorithms require zero unused bits.
\begin{DoxyEnumerate}
\item Check certificate algorithm consistency.
\end{DoxyEnumerate}

Check the Algorithm\+Identifier inside TBS matches the one in the certificate signature. NB\+: this will result in signature failure errors for some broken certificates.

Thanks to Konrad Kraszewski from Google for reporting this issue.
\begin{DoxyEnumerate}
\item Check DSA/\+ECDSA signatures use DER.
\end{DoxyEnumerate}

Re-\/encode DSA/\+ECDSA signatures and compare with the original received signature. Return an error if there is a mismatch.

This will reject various cases including garbage after signature (thanks to Antti Karjalainen and Tuomo Untinen from the Codenomicon CROSS program for discovering this case) and use of BER or invalid ASN.\+1 INTEGERs (negative or with leading zeroes).

Further analysis was conducted and fixes were developed by Stephen Henson of the Open\+SSL core team.

(\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-8275}{\texttt{ CVE-\/2014-\/8275}})

{\itshape Steve Henson}
\item Correct Bignum squaring. Bignum squaring (BN\+\_\+sqr) may produce incorrect results on some platforms, including x86\+\_\+64. This bug occurs at random with a very low probability, and is not known to be exploitable in any way, though its exact impact is difficult to determine. Thanks to Pieter Wuille (Blockstream) who reported this issue and also suggested an initial fix. Further analysis was conducted by the Open\+SSL development team and Adam Langley of Google. The final fix was developed by Andy Polyakov of the Open\+SSL core team. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3570}{\texttt{ CVE-\/2014-\/3570}})

{\itshape Andy Polyakov}
\item Do not resume sessions on the server if the negotiated protocol version does not match the session\textquotesingle{}s version. Resuming with a different version, while not strictly forbidden by the RFC, is of questionable sanity and breaks all known clients.

{\itshape David Benjamin, Emilia Käsper}
\item Tighten handling of the Change\+Cipher\+Spec (CCS) message\+: reject early CCS messages during renegotiation. (Note that because renegotiation is encrypted, this early CCS was not exploitable.)

{\itshape Emilia Käsper}
\item Tighten client-\/side session ticket handling during renegotiation\+: ensure that the client only accepts a session ticket if the server sends the extension anew in the Server\+Hello. Previously, a TLS client would reuse the old extension state and thus accept a session ticket if one was announced in the initial Server\+Hello.

Similarly, ensure that the client requires a session ticket if one was advertised in the Server\+Hello. Previously, a TLS client would ignore a missing New\+Session\+Ticket message.

{\itshape Emilia Käsper}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md86}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+1i and 1.\+0.\+1j \mbox{[}15 Oct 2014\mbox{]}}{Changes between 1.\+0.\+1i and 1.\+0.\+1j \mbox{[}15 Oct 2014\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md86}

\begin{DoxyItemize}
\item SRTP Memory Leak.

A flaw in the DTLS SRTP extension parsing code allows an attacker, who sends a carefully crafted handshake message, to cause Open\+SSL to fail to free up to 64k of memory causing a memory leak. This could be exploited in a Denial Of Service attack. This issue affects Open\+SSL 1.\+0.\+1 server implementations for both SSL/\+TLS and DTLS regardless of whether SRTP is used or configured. Implementations of Open\+SSL that have been compiled with OPENSSL\+\_\+\+NO\+\_\+\+SRTP defined are not affected.

The fix was developed by the Open\+SSL team. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3513}{\texttt{ CVE-\/2014-\/3513}})

{\itshape Open\+SSL team}
\item Session Ticket Memory Leak.

When an Open\+SSL SSL/\+TLS/\+DTLS server receives a session ticket the integrity of that ticket is first verified. In the event of a session ticket integrity check failing, Open\+SSL will fail to free memory causing a memory leak. By sending a large number of invalid session tickets an attacker could exploit this issue in a Denial Of Service attack. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3567}{\texttt{ CVE-\/2014-\/3567}})

{\itshape Steve Henson}
\item Build option no-\/ssl3 is incomplete.

When Open\+SSL is configured with "{}no-\/ssl3"{} as a build option, servers could accept and complete an SSL 3.\+0 handshake, and clients could be configured to send them. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3568}{\texttt{ CVE-\/2014-\/3568}})

{\itshape Akamai and the Open\+SSL team}
\item Add support for TLS\+\_\+\+FALLBACK\+\_\+\+SCSV. Client applications doing fallback retries should call SSL\+\_\+set\+\_\+mode(s, SSL\+\_\+\+MODE\+\_\+\+SEND\+\_\+\+FALLBACK\+\_\+\+SCSV). (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3566}{\texttt{ CVE-\/2014-\/3566}})

{\itshape Adam Langley, Bodo Moeller}
\item Add additional Digest\+Info checks.

Re-\/encode Digest\+Into in DER and check against the original when verifying RSA signature\+: this will reject any improperly encoded Digest\+Info structures.

Note\+: this is a precautionary measure and no attacks are currently known.

{\itshape Steve Henson}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md87}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+1h and 1.\+0.\+1i \mbox{[}6 Aug 2014\mbox{]}}{Changes between 1.\+0.\+1h and 1.\+0.\+1i \mbox{[}6 Aug 2014\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md87}

\begin{DoxyItemize}
\item Fix SRP buffer overrun vulnerability. Invalid parameters passed to the SRP code can be overrun an internal buffer. Add sanity check that g, A, B \texorpdfstring{$<$}{<} N to SRP code.

Thanks to Sean Devlin and Watson Ladd of Cryptography Services, NCC Group for discovering this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3512}{\texttt{ CVE-\/2014-\/3512}})

{\itshape Steve Henson}
\item A flaw in the Open\+SSL SSL/\+TLS server code causes the server to negotiate TLS 1.\+0 instead of higher protocol versions when the Client\+Hello message is badly fragmented. This allows a man-\/in-\/the-\/middle attacker to force a downgrade to TLS 1.\+0 even if both the server and the client support a higher protocol version, by modifying the client\textquotesingle{}s TLS records.

Thanks to David Benjamin and Adam Langley (Google) for discovering and researching this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3511}{\texttt{ CVE-\/2014-\/3511}})

{\itshape David Benjamin}
\item Open\+SSL DTLS clients enabling anonymous (EC)DH ciphersuites are subject to a denial of service attack. A malicious server can crash the client with a null pointer dereference (read) by specifying an anonymous (EC)DH ciphersuite and sending carefully crafted handshake messages.

Thanks to Felix Gröbert (Google) for discovering and researching this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3510}{\texttt{ CVE-\/2014-\/3510}})

{\itshape Emilia Käsper}
\item By sending carefully crafted DTLS packets an attacker could cause openssl to leak memory. This can be exploited through a Denial of Service attack. Thanks to Adam Langley for discovering and researching this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3507}{\texttt{ CVE-\/2014-\/3507}})

{\itshape Adam Langley}
\item An attacker can force openssl to consume large amounts of memory whilst processing DTLS handshake messages. This can be exploited through a Denial of Service attack. Thanks to Adam Langley for discovering and researching this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3506}{\texttt{ CVE-\/2014-\/3506}})

{\itshape Adam Langley}
\item An attacker can force an error condition which causes openssl to crash whilst processing DTLS packets due to memory being freed twice. This can be exploited through a Denial of Service attack. Thanks to Adam Langley and Wan-\/\+Teh Chang for discovering and researching this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3505}{\texttt{ CVE-\/2014-\/3505}})

{\itshape Adam Langley}
\item If a multithreaded client connects to a malicious server using a resumed session and the server sends an ec point format extension it could write up to 255 bytes to freed memory.

Thanks to Gabor Tyukasz (Log\+Me\+In Inc) for discovering and researching this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3509}{\texttt{ CVE-\/2014-\/3509}})

{\itshape Gabor Tyukasz}
\item A malicious server can crash an Open\+SSL client with a null pointer dereference (read) by specifying an SRP ciphersuite even though it was not properly negotiated with the client. This can be exploited through a Denial of Service attack.

Thanks to Joonas Kuorilehto and Riku Hietamäki (Codenomicon) for discovering and researching this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-5139}{\texttt{ CVE-\/2014-\/5139}})

{\itshape Steve Henson}
\item A flaw in OBJ\+\_\+obj2txt may cause pretty printing functions such as X509\+\_\+name\+\_\+oneline, X509\+\_\+name\+\_\+print\+\_\+ex et al. to leak some information from the stack. Applications may be affected if they echo pretty printing output to the attacker.

Thanks to Ivan Fratric (Google) for discovering this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3508}{\texttt{ CVE-\/2014-\/3508}})

{\itshape Emilia Käsper, and Steve Henson}
\item Fix ec\+\_\+\+GFp\+\_\+simple\+\_\+points\+\_\+make\+\_\+affine (thus, EC\+\_\+\+POINTs\+\_\+mul etc.) for corner cases. (Certain input points at infinity could lead to bogus results, with non-\/infinity inputs mapped to infinity too.)

{\itshape Bodo Moeller}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md88}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+1g and 1.\+0.\+1h \mbox{[}5 Jun 2014\mbox{]}}{Changes between 1.\+0.\+1g and 1.\+0.\+1h \mbox{[}5 Jun 2014\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md88}

\begin{DoxyItemize}
\item Fix for SSL/\+TLS MITM flaw. An attacker using a carefully crafted handshake can force the use of weak keying material in Open\+SSL SSL/\+TLS clients and servers.

Thanks to KIKUCHI Masashi (Lepidum Co. Ltd.) for discovering and researching this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-0224}{\texttt{ CVE-\/2014-\/0224}})

{\itshape KIKUCHI Masashi, Steve Henson}
\item Fix DTLS recursion flaw. By sending an invalid DTLS handshake to an Open\+SSL DTLS client the code can be made to recurse eventually crashing in a DoS attack.

Thanks to Imre Rad (Search-\/\+Lab Ltd.) for discovering this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-0221}{\texttt{ CVE-\/2014-\/0221}})

{\itshape Imre Rad, Steve Henson}
\item Fix DTLS invalid fragment vulnerability. A buffer overrun attack can be triggered by sending invalid DTLS fragments to an Open\+SSL DTLS client or server. This is potentially exploitable to run arbitrary code on a vulnerable client or server.

Thanks to Jüri Aedla for reporting this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-0195}{\texttt{ CVE-\/2014-\/0195}})

{\itshape Jüri Aedla, Steve Henson}
\item Fix bug in TLS code where clients enable anonymous ECDH ciphersuites are subject to a denial of service attack.

Thanks to Felix Gröbert and Ivan Fratric at Google for discovering this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3470}{\texttt{ CVE-\/2014-\/3470}})

{\itshape Felix Gröbert, Ivan Fratric, Steve Henson}
\item Harmonize version and its documentation. -\/f flag is used to display compilation flags.

\texorpdfstring{$\ast$}{*}mancha \href{mailto:mancha1@zoho.com}{\texttt{ mancha1@zoho.\+com}}\texorpdfstring{$\ast$}{*}
\item Fix eckey\+\_\+priv\+\_\+encode so it immediately returns an error upon a failure in i2d\+\_\+\+ECPrivate\+Key.

\texorpdfstring{$\ast$}{*}mancha \href{mailto:mancha1@zoho.com}{\texttt{ mancha1@zoho.\+com}}\texorpdfstring{$\ast$}{*}
\item Fix some double frees. These are not thought to be exploitable.

\texorpdfstring{$\ast$}{*}mancha \href{mailto:mancha1@zoho.com}{\texttt{ mancha1@zoho.\+com}}\texorpdfstring{$\ast$}{*}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md89}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+1f and 1.\+0.\+1g \mbox{[}7 Apr 2014\mbox{]}}{Changes between 1.\+0.\+1f and 1.\+0.\+1g \mbox{[}7 Apr 2014\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md89}

\begin{DoxyItemize}
\item A missing bounds check in the handling of the TLS heartbeat extension can be used to reveal up to 64k of memory to a connected client or server.

Thanks for Neel Mehta of Google Security for discovering this bug and to Adam Langley \href{mailto:agl@chromium.org}{\texttt{ agl@chromium.\+org}} and Bodo Moeller \href{mailto:bmoeller@acm.org}{\texttt{ bmoeller@acm.\+org}} for preparing the fix (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-0160}{\texttt{ CVE-\/2014-\/0160}})

{\itshape Adam Langley, Bodo Moeller}
\item Fix for the attack described in the paper "{}\+Recovering Open\+SSL    ECDSA Nonces Using the FLUSH+\+RELOAD Cache Side-\/channel Attack"{} by Yuval Yarom and Naomi Benger. Details can be obtained from\+: \href{http://eprint.iacr.org/2014/140}{\texttt{ http\+://eprint.\+iacr.\+org/2014/140}}

Thanks to Yuval Yarom and Naomi Benger for discovering this flaw and to Yuval Yarom for supplying a fix (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-0076}{\texttt{ CVE-\/2014-\/0076}})

{\itshape Yuval Yarom and Naomi Benger}
\item TLS pad extension\+: draft-\/agl-\/tls-\/padding-\/03

Workaround for the "{}\+TLS hang bug"{} (see FAQ and PR\#2771)\+: if the TLS client Hello record length value would otherwise be \texorpdfstring{$>$}{>} 255 and less that 512 pad with a dummy extension containing zeroes so it is at least 512 bytes long.

{\itshape Adam Langley, Steve Henson}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md90}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+1e and 1.\+0.\+1f \mbox{[}6 Jan 2014\mbox{]}}{Changes between 1.\+0.\+1e and 1.\+0.\+1f \mbox{[}6 Jan 2014\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md90}

\begin{DoxyItemize}
\item Fix for TLS record tampering bug. A carefully crafted invalid handshake could crash Open\+SSL with a NULL pointer exception. Thanks to Anton Johansson for reporting this issues. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2013-4353}{\texttt{ CVE-\/2013-\/4353}})
\item Keep original DTLS digest and encryption contexts in retransmission structures so we can use the previous session parameters if they need to be resent. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2013-6450}{\texttt{ CVE-\/2013-\/6450}})

{\itshape Steve Henson}
\item Add option SSL\+\_\+\+OP\+\_\+\+SAFARI\+\_\+\+ECDHE\+\_\+\+ECDSA\+\_\+\+BUG (part of SSL\+\_\+\+OP\+\_\+\+ALL) which avoids preferring ECDHE-\/\+ECDSA ciphers when the client appears to be Safari on OS X. Safari on OS X 10.\+8..10.\+8.\+3 advertises support for several ECDHE-\/\+ECDSA ciphers, but fails to negotiate them. The bug is fixed in OS X 10.\+8.\+4, but Apple have ruled out both hot fixing 10.\+8..10.\+8.\+3 and forcing users to upgrade to 10.\+8.\+4 or newer.

{\itshape Rob Stradling, Adam Langley}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md91}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+1d and 1.\+0.\+1e \mbox{[}11 Feb 2013\mbox{]}}{Changes between 1.\+0.\+1d and 1.\+0.\+1e \mbox{[}11 Feb 2013\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md91}

\begin{DoxyItemize}
\item Correct fix for CVE-\/2013-\/0169. The original didn\textquotesingle{}t work on AES-\/\+NI supporting platforms or when small records were transferred.

{\itshape Andy Polyakov, Steve Henson}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md92}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+1c and 1.\+0.\+1d \mbox{[}5 Feb 2013\mbox{]}}{Changes between 1.\+0.\+1c and 1.\+0.\+1d \mbox{[}5 Feb 2013\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md92}

\begin{DoxyItemize}
\item Make the decoding of SSLv3, TLS and DTLS CBC records constant time.

This addresses the flaw in CBC record processing discovered by Nadhem Alfardan and Kenny Paterson. Details of this attack can be found at\+: \href{http://www.isg.rhul.ac.uk/tls/}{\texttt{ http\+://www.\+isg.\+rhul.\+ac.\+uk/tls/}}

Thanks go to Nadhem Alfardan and Kenny Paterson of the Information Security Group at Royal Holloway, University of London (www.\+isg.\+rhul.\+ac.\+uk) for discovering this flaw and Adam Langley and Emilia Käsper for the initial patch. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2013-0169}{\texttt{ CVE-\/2013-\/0169}})

{\itshape Emilia Käsper, Adam Langley, Ben Laurie, Andy Polyakov, Steve Henson}
\item Fix flaw in AESNI handling of TLS 1.\+2 and 1.\+1 records for CBC mode ciphersuites which can be exploited in a denial of service attack. Thanks go to and to Adam Langley \href{mailto:agl@chromium.org}{\texttt{ agl@chromium.\+org}} for discovering and detecting this bug and to Wolfgang Ettlinger \href{mailto:wolfgang.ettlinger@gmail.com}{\texttt{ wolfgang.\+ettlinger@gmail.\+com}} for independently discovering this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2012-2686}{\texttt{ CVE-\/2012-\/2686}})

{\itshape Adam Langley}
\item Return an error when checking OCSP signatures when key is NULL. This fixes a DoS attack. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2013-0166}{\texttt{ CVE-\/2013-\/0166}})

{\itshape Steve Henson}
\item Make openssl verify return errors.

\texorpdfstring{$\ast$}{*}\+Chris Palmer \href{mailto:palmer@google.com}{\texttt{ palmer@google.\+com}} and Ben Laurie\texorpdfstring{$\ast$}{*}
\item Call OCSP Stapling callback after ciphersuite has been chosen, so the right response is stapled. Also change SSL\+\_\+get\+\_\+certificate() so it returns the certificate actually sent. See \href{http://rt.openssl.org/Ticket/Display.html?id=2836}{\texttt{ http\+://rt.\+openssl.\+org/\+Ticket/\+Display.\+html?id=2836}}.

\texorpdfstring{$\ast$}{*}\+Rob Stradling \href{mailto:rob.stradling@comodo.com}{\texttt{ rob.\+stradling@comodo.\+com}}\texorpdfstring{$\ast$}{*}
\item Fix possible deadlock when decoding public keys.

{\itshape Steve Henson}
\item Don\textquotesingle{}t use TLS 1.\+0 record version number in initial client hello if renegotiating.

{\itshape Steve Henson}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md93}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+1b and 1.\+0.\+1c \mbox{[}10 May 2012\mbox{]}}{Changes between 1.\+0.\+1b and 1.\+0.\+1c \mbox{[}10 May 2012\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md93}

\begin{DoxyItemize}
\item Sanity check record length before skipping explicit IV in TLS 1.\+2, 1.\+1 and DTLS to fix DoS attack.

Thanks to Codenomicon for discovering this issue using Fuzz-\/o-\/\+Matic fuzzing as a service testing platform. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2012-2333}{\texttt{ CVE-\/2012-\/2333}})

{\itshape Steve Henson}
\item Initialise tkeylen properly when encrypting CMS messages. Thanks to Solar Designer of Openwall for reporting this issue.

{\itshape Steve Henson}
\item In FIPS mode don\textquotesingle{}t try to use composite ciphers as they are not approved.

{\itshape Steve Henson}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md94}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+1a and 1.\+0.\+1b \mbox{[}26 Apr 2012\mbox{]}}{Changes between 1.\+0.\+1a and 1.\+0.\+1b \mbox{[}26 Apr 2012\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md94}

\begin{DoxyItemize}
\item Open\+SSL 1.\+0.\+0 sets SSL\+\_\+\+OP\+\_\+\+ALL to 0x80000\+FFFL and Open\+SSL 1.\+0.\+1 and 1.\+0.\+1a set SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+TLSv1\+\_\+1 to 0x00000400L which would unfortunately mean any application compiled against Open\+SSL 1.\+0.\+0 headers setting SSL\+\_\+\+OP\+\_\+\+ALL would also set SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+TLSv1\+\_\+1, unintentionally disabling TLS 1.\+1 also. Fix this by changing the value of SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+TLSv1\+\_\+1 to 0x10000000L Any application which was previously compiled against Open\+SSL 1.\+0.\+1 or 1.\+0.\+1a headers and which cares about SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+TLSv1\+\_\+1 will need to be recompiled as a result. Letting be results in inability to disable specifically TLS 1.\+1 and in client context, in unlike event, limit maximum offered version to TLS 1.\+0 \mbox{[}see below\mbox{]}.

{\itshape Steve Henson}
\item In order to ensure interoperability SSL\+\_\+\+OP\+\_\+\+NO\+\_\+protocolX does not disable just protocol X, but all protocols above X {\itshape if} there are protocols {\itshape below} X still enabled. In more practical terms it means that if application wants to disable TLS1.\+0 in favor of TLS1.\+1 and above, it\textquotesingle{}s not sufficient to pass {\ttfamily SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+TLSv1}, one has to pass {\ttfamily SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+TLSv1\texorpdfstring{$\vert$}{|}\+SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+SSLv3\texorpdfstring{$\vert$}{|}\+SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+SSLv2}. This applies to client side.

{\itshape Andy Polyakov}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md95}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+1 and 1.\+0.\+1a \mbox{[}19 Apr 2012\mbox{]}}{Changes between 1.\+0.\+1 and 1.\+0.\+1a \mbox{[}19 Apr 2012\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md95}

\begin{DoxyItemize}
\item Check for potentially exploitable overflows in asn1\+\_\+d2i\+\_\+read\+\_\+bio BUF\+\_\+mem\+\_\+grow and BUF\+\_\+mem\+\_\+grow\+\_\+clean. Refuse attempts to shrink buffer in CRYPTO\+\_\+realloc\+\_\+clean.

Thanks to Tavis Ormandy, Google Security Team, for discovering this issue and to Adam Langley \href{mailto:agl@chromium.org}{\texttt{ agl@chromium.\+org}} for fixing it. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2012-2110}{\texttt{ CVE-\/2012-\/2110}})

{\itshape Adam Langley (Google), Tavis Ormandy, Google Security Team}
\item Don\textquotesingle{}t allow TLS 1.\+2 SHA-\/256 ciphersuites in TLS 1.\+0, 1.\+1 connections.

{\itshape Adam Langley}
\item Workarounds for some broken servers that "{}hang"{} if a client hello record length exceeds 255 bytes.
\begin{DoxyEnumerate}
\item Do not use record version number \texorpdfstring{$>$}{>} TLS 1.\+0 in initial client hello\+: some (but not all) hanging servers will now work.
\item If we set OPENSSL\+\_\+\+MAX\+\_\+\+TLS1\+\_\+2\+\_\+\+CIPHER\+\_\+\+LENGTH this will truncate the number of ciphers sent in the client hello. This should be set to an even number, such as 50, for example by passing\+: -\/DOPENSSL\+\_\+\+MAX\+\_\+\+TLS1\+\_\+2\+\_\+\+CIPHER\+\_\+\+LENGTH=50 to config or Configure. Most broken servers should now work.
\item If all else fails setting OPENSSL\+\_\+\+NO\+\_\+\+TLS1\+\_\+2\+\_\+\+CLIENT will disable TLS 1.\+2 client support entirely.
\end{DoxyEnumerate}

{\itshape Steve Henson}
\item Fix SEGV in Vector Permutation AES module observed in Open\+SSH.

{\itshape Andy Polyakov}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md96}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+0h and 1.\+0.\+1 \mbox{[}14 Mar 2012\mbox{]}}{Changes between 1.\+0.\+0h and 1.\+0.\+1 \mbox{[}14 Mar 2012\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md96}

\begin{DoxyItemize}
\item Add compatibility with old MDC2 signatures which use an ASN1 OCTET STRING form instead of a Digest\+Info.

{\itshape Steve Henson}
\item The format used for MDC2 RSA signatures is inconsistent between EVP and the RSA\+\_\+sign/\+RSA\+\_\+verify functions. This was made more apparent when Open\+SSL used RSA\+\_\+sign/\+RSA\+\_\+verify for some RSA signatures in particular those which went through EVP\+\_\+\+PKEY\+\_\+\+METHOD in 1.\+0.\+0 and later. Detect the correct format in RSA\+\_\+verify so both forms transparently work.

{\itshape Steve Henson}
\item Some servers which support TLS 1.\+0 can choke if we initially indicate support for TLS 1.\+2 and later renegotiate using TLS 1.\+0 in the RSA encrypted premaster secret. As a workaround use the maximum permitted client version in client hello, this should keep such servers happy and still work with previous versions of Open\+SSL.

{\itshape Steve Henson}
\item Add support for TLS/\+DTLS heartbeats.

\texorpdfstring{$\ast$}{*}\+Robin Seggelmann \href{mailto:seggelmann@fh-muenster.de}{\texttt{ seggelmann@fh-\/muenster.\+de}}\texorpdfstring{$\ast$}{*}
\item Add support for SCTP.

\texorpdfstring{$\ast$}{*}\+Robin Seggelmann \href{mailto:seggelmann@fh-muenster.de}{\texttt{ seggelmann@fh-\/muenster.\+de}}\texorpdfstring{$\ast$}{*}
\item Improved PRNG seeding for VOS.

\texorpdfstring{$\ast$}{*}\+Paul Green \href{mailto:Paul.Green@stratus.com}{\texttt{ Paul.\+Green@stratus.\+com}}\texorpdfstring{$\ast$}{*}
\item Extensive assembler packs updates, most notably\+:
\begin{DoxyItemize}
\item x86\mbox{[}\+\_\+64\mbox{]}\+: AES-\/\+NI, PCLMULQDQ, RDRAND support;
\item x86\mbox{[}\+\_\+64\mbox{]}\+: SSSE3 support (SHA1, vector-\/permutation AES);
\item x86\+\_\+64\+: bit-\/sliced AES implementation;
\item ARM\+: NEON support, contemporary platforms optimizations;
\item s390x\+: z196 support;
\item {\ttfamily \texorpdfstring{$\ast$}{*}}\+: GHASH and GF(2\texorpdfstring{$^\wedge$}{\string^}m) multiplication implementations;
\end{DoxyItemize}

{\itshape Andy Polyakov}
\item Make TLS-\/\+SRP code conformant with RFC 5054 API cleanup (removal of unnecessary code)

\texorpdfstring{$\ast$}{*}\+Peter Sylvester \href{mailto:peter.sylvester@edelweb.fr}{\texttt{ peter.\+sylvester@edelweb.\+fr}}\texorpdfstring{$\ast$}{*}
\item Add TLS key material exporter from RFC 5705.

{\itshape Eric Rescorla}
\item Add DTLS-\/\+SRTP negotiation from RFC 5764.

{\itshape Eric Rescorla}
\item Add Next Protocol Negotiation, \href{http://tools.ietf.org/html/draft-agl-tls-nextprotoneg-00}{\texttt{ http\+://tools.\+ietf.\+org/html/draft-\/agl-\/tls-\/nextprotoneg-\/00}}. Can be disabled with a no-\/npn flag to config or Configure. Code donated by Google.

\texorpdfstring{$\ast$}{*}\+Adam Langley \href{mailto:agl@google.com}{\texttt{ agl@google.\+com}} and Ben Laurie\texorpdfstring{$\ast$}{*}
\item Add optional 64-\/bit optimized implementations of elliptic curves NIST-\/\+P224, NIST-\/\+P256, NIST-\/\+P521, with constant-\/time single point multiplication on typical inputs. Compiler support for the nonstandard type {\ttfamily \+\_\+\+\_\+uint128\+\_\+t} is required to use this (present in gcc 4.\+4 and later, for 64-\/bit builds). Code made available under Apache License version 2.\+0.

Specify "{}enable-\/ec\+\_\+nistp\+\_\+64\+\_\+gcc\+\_\+128"{} on the Configure (or config) command line to include this in your build of Open\+SSL, and run "{}make depend"{} (or "{}make update"{}). This enables the following EC\+\_\+\+METHODs\+: \begin{DoxyVerb}    EC_GFp_nistp224_method()
    EC_GFp_nistp256_method()
    EC_GFp_nistp521_method()
\end{DoxyVerb}
 EC\+\_\+\+GROUP\+\_\+new\+\_\+by\+\_\+curve\+\_\+name() will automatically use these (while EC\+\_\+\+GROUP\+\_\+new\+\_\+curve\+\_\+\+GFp() currently prefers the more flexible implementations).

{\itshape Emilia Käsper, Adam Langley, Bodo Moeller (Google)}
\item Use type ossl\+\_\+ssize\+\_\+t instead of ssize\+\_\+t which isn\textquotesingle{}t available on all platforms. Move ssize\+\_\+t definition from \doxylink{e__os_8h_source}{e\+\_\+os.\+h} to the public header file \doxylink{e__os2_8h_source}{e\+\_\+os2.\+h} as it now appears in public header file \doxylink{cms_8h_source}{cms.\+h}

{\itshape Steve Henson}
\item New -\/sigopt option to the ca, req and x509 utilities. Additional signature parameters can be passed using this option and in particular PSS.

{\itshape Steve Henson}
\item Add RSA PSS signing function. This will generate and set the appropriate Algorithm\+Identifiers for PSS based on those in the corresponding EVP\+\_\+\+MD\+\_\+\+CTX structure. No application support yet.

{\itshape Steve Henson}
\item Support for companion algorithm specific ASN1 signing routines. New function ASN1\+\_\+item\+\_\+sign\+\_\+ctx() signs a pre-\/initialised EVP\+\_\+\+MD\+\_\+\+CTX structure and sets Algorithm\+Identifiers based on the appropriate parameters.

{\itshape Steve Henson}
\item Add new algorithm specific ASN1 verification initialisation function to EVP\+\_\+\+PKEY\+\_\+\+ASN1\+\_\+\+METHOD\+: this is not in EVP\+\_\+\+PKEY\+\_\+\+METHOD since the ASN1 handling will be the same no matter what EVP\+\_\+\+PKEY\+\_\+\+METHOD is used. Add a PSS handler to support verification of PSS signatures\+: checked against a number of sample certificates.

{\itshape Steve Henson}
\item Add signature printing for PSS. Add PSS OIDs.

\texorpdfstring{$\ast$}{*}\+Steve Henson, Martin Kaiser \href{mailto:lists@kaiser.cx}{\texttt{ lists@kaiser.\+cx}}\texorpdfstring{$\ast$}{*}
\item Add algorithm specific signature printing. An individual ASN1 method can now print out signatures instead of the standard hex dump.

More complex signatures (e.\+g. PSS) can print out more meaningful information. Include DSA version that prints out the signature parameters r, s.

{\itshape Steve Henson}
\item Password based recipient info support for CMS library\+: implementing RFC3211.

{\itshape Steve Henson}
\item Split password based encryption into PBES2 and PBKDF2 functions. This neatly separates the code into cipher and PBE sections and is required for some algorithms that split PBES2 into separate pieces (such as password based CMS).

{\itshape Steve Henson}
\item Session-\/handling fixes\+:
\begin{DoxyItemize}
\item Fix handling of connections that are resuming with a session ID, but also support Session Tickets.
\item Fix a bug that suppressed issuing of a new ticket if the client presented a ticket with an expired session.
\item Try to set the ticket lifetime hint to something reasonable.
\item Make tickets shorter by excluding irrelevant information.
\item On the client side, don\textquotesingle{}t ignore renewed tickets.
\end{DoxyItemize}

{\itshape Adam Langley, Bodo Moeller (Google)}
\item Fix PSK session representation.

{\itshape Bodo Moeller}
\item Add RC4-\/\+MD5 and AESNI-\/\+SHA1 "{}stitched"{} implementations.

This work was sponsored by Intel.

{\itshape Andy Polyakov}
\item Add GCM support to TLS library. Some custom code is needed to split the IV between the fixed (from PRF) and explicit (from TLS record) portions. This adds all GCM ciphersuites supported by RFC5288 and RFC5289. Generalise some {\ttfamily AES\texorpdfstring{$\ast$}{*}} cipherstrings to include GCM and add a special AESGCM string for GCM only.

{\itshape Steve Henson}
\item Expand range of ctrls for AES GCM. Permit setting invocation field on decrypt and retrieval of invocation field only on encrypt.

{\itshape Steve Henson}
\item Add HMAC ECC ciphersuites from RFC5289. Include SHA384 PRF support. As required by RFC5289 these ciphersuites cannot be used if for versions of TLS earlier than 1.\+2.

{\itshape Steve Henson}
\item For FIPS capable Open\+SSL interpret a NULL default public key method as unset and return the appropriate default but do {\itshape not} set the default. This means we can return the appropriate method in applications that switch between FIPS and non-\/\+FIPS modes.

{\itshape Steve Henson}
\item Redirect HMAC and CMAC operations to FIPS module in FIPS mode. If an ENGINE is used then we cannot handle that in the FIPS module so we keep original code iff non-\/\+FIPS operations are allowed.

{\itshape Steve Henson}
\item Add -\/attime option to openssl utilities.

\texorpdfstring{$\ast$}{*}\+Peter Eckersley \href{mailto:pde@eff.org}{\texttt{ pde@eff.\+org}}, Ben Laurie and Steve Henson\texorpdfstring{$\ast$}{*}
\item Redirect DSA and DH operations to FIPS module in FIPS mode.

{\itshape Steve Henson}
\item Redirect ECDSA and ECDH operations to FIPS module in FIPS mode. Also use FIPS EC methods unconditionally for now.

{\itshape Steve Henson}
\item New build option no-\/ec2m to disable characteristic 2 code.

{\itshape Steve Henson}
\item Backport libcrypto audit of return value checking from 1.\+1.\+0-\/dev; not all cases can be covered as some introduce binary incompatibilities.

{\itshape Steve Henson}
\item Redirect RSA operations to FIPS module including keygen, encrypt, decrypt, sign and verify. Block use of non FIPS RSA methods.

{\itshape Steve Henson}
\item Add similar low-\/level API blocking to ciphers.

{\itshape Steve Henson}
\item low-\/level digest APIs are not approved in FIPS mode\+: any attempt to use these will cause a fatal error. Applications that {\itshape really} want to use them can use the {\ttfamily private\+\_\+\texorpdfstring{$\ast$}{*}} version instead.

{\itshape Steve Henson}
\item Redirect cipher operations to FIPS module for FIPS builds.

{\itshape Steve Henson}
\item Redirect digest operations to FIPS module for FIPS builds.

{\itshape Steve Henson}
\item Update build system to add "{}fips"{} flag which will link in fipscanister.\+o for static and shared library builds embedding a signature if needed.

{\itshape Steve Henson}
\item Output TLS supported curves in preference order instead of numerical order. This is currently hardcoded for the highest order curves first. This should be configurable so applications can judge speed vs strength.

{\itshape Steve Henson}
\item Add TLS v1.\+2 server support for client authentication.

{\itshape Steve Henson}
\item Add support for FIPS mode in ssl library\+: disable SSLv3, non-\/\+FIPS ciphers and enable MD5.

{\itshape Steve Henson}
\item Functions FIPS\+\_\+mode\+\_\+set() and FIPS\+\_\+mode() which call the underlying FIPS modules versions.

{\itshape Steve Henson}
\item Add TLS v1.\+2 client side support for client authentication. Keep cache of handshake records longer as we don\textquotesingle{}t know the hash algorithm to use until after the certificate request message is received.

{\itshape Steve Henson}
\item Initial TLS v1.\+2 client support. Add a default signature algorithms extension including all the algorithms we support. Parse new signature format in client key exchange. Relax some ECC signing restrictions for TLS v1.\+2 as indicated in RFC5246.

{\itshape Steve Henson}
\item Add server support for TLS v1.\+2 signature algorithms extension. Switch to new signature format when needed using client digest preference. All server ciphersuites should now work correctly in TLS v1.\+2. No client support yet and no support for client certificates.

{\itshape Steve Henson}
\item Initial TLS v1.\+2 support. Add new SHA256 digest to ssl code, switch to SHA256 for PRF when using TLS v1.\+2 and later. Add new SHA256 based ciphersuites. At present only RSA key exchange ciphersuites work with TLS v1.\+2. Add new option for TLS v1.\+2 replacing the old and obsolete SSL\+\_\+\+OP\+\_\+\+PKCS1\+\_\+\+CHECK flags with SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+TLSv1\+\_\+2. New TLSv1.\+2 methods and version checking.

{\itshape Steve Henson}
\item New option OPENSSL\+\_\+\+NO\+\_\+\+SSL\+\_\+\+INTERN. If an application can be compiled with this defined it will not be affected by any changes to ssl internal structures. Add several utility functions to allow openssl application to work with OPENSSL\+\_\+\+NO\+\_\+\+SSL\+\_\+\+INTERN defined.

{\itshape Steve Henson}
\item A long standing patch to add support for SRP from Edel\+Web (Peter Sylvester and Christophe Renou) was integrated. \texorpdfstring{$\ast$}{*}\+Christophe Renou \href{mailto:christophe.renou@edelweb.fr}{\texttt{ christophe.\+renou@edelweb.\+fr}}, Peter Sylvester \href{mailto:peter.sylvester@edelweb.fr}{\texttt{ peter.\+sylvester@edelweb.\+fr}}, Tom Wu \href{mailto:tjw@cs.stanford.edu}{\texttt{ tjw@cs.\+stanford.\+edu}}, and Ben Laurie\texorpdfstring{$\ast$}{*}
\item Add functions to copy EVP\+\_\+\+PKEY\+\_\+\+METHOD and retrieve flags and id.

{\itshape Steve Henson}
\item Permit abbreviated handshakes when renegotiating using the function SSL\+\_\+renegotiate\+\_\+abbreviated().

\texorpdfstring{$\ast$}{*}\+Robin Seggelmann \href{mailto:seggelmann@fh-muenster.de}{\texttt{ seggelmann@fh-\/muenster.\+de}}\texorpdfstring{$\ast$}{*}
\item Add call to ENGINE\+\_\+register\+\_\+all\+\_\+complete() to ENGINE\+\_\+load\+\_\+builtin\+\_\+engines(), so some implementations get used automatically instead of needing explicit application support.

{\itshape Steve Henson}
\item Add support for TLS key exporter as described in RFC5705.

\texorpdfstring{$\ast$}{*}\+Robin Seggelmann \href{mailto:seggelmann@fh-muenster.de}{\texttt{ seggelmann@fh-\/muenster.\+de}}, Steve Henson\texorpdfstring{$\ast$}{*}
\item Initial TLSv1.\+1 support. Since TLSv1.\+1 is very similar to TLS v1.\+0 only a few changes are required\+:

Add SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+TLSv1\+\_\+1 flag. Add TLSv1\+\_\+1 methods. Update version checking logic to handle version 1.\+1. Add explicit IV handling (ported from DTLS code). Add command line options to s\+\_\+client/s\+\_\+server.

{\itshape Steve Henson}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md97}{}\doxysection{\texorpdfstring{Open\+SSL 1.\+0.\+0}{Open\+SSL 1.\+0.\+0}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md97}
\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md98}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+0s and 1.\+0.\+0t \mbox{[}3 Dec 2015\mbox{]}}{Changes between 1.\+0.\+0s and 1.\+0.\+0t \mbox{[}3 Dec 2015\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md98}

\begin{DoxyItemize}
\item X509\+\_\+\+ATTRIBUTE memory leak

When presented with a malformed X509\+\_\+\+ATTRIBUTE structure Open\+SSL will leak memory. This structure is used by the PKCS\#7 and CMS routines so any application which reads PKCS\#7 or CMS data from untrusted sources is affected. SSL/\+TLS is not affected.

This issue was reported to Open\+SSL by Adam Langley (Google/\+Boring\+SSL) using lib\+Fuzzer. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-3195}{\texttt{ CVE-\/2015-\/3195}})

{\itshape Stephen Henson}
\item Race condition handling PSK identify hint

If PSK identity hints are received by a multi-\/threaded client then the values are wrongly updated in the parent SSL\+\_\+\+CTX structure. This can result in a race condition potentially leading to a double free of the identify hint data. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-3196}{\texttt{ CVE-\/2015-\/3196}})

{\itshape Stephen Henson}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md99}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+0r and 1.\+0.\+0s \mbox{[}11 Jun 2015\mbox{]}}{Changes between 1.\+0.\+0r and 1.\+0.\+0s \mbox{[}11 Jun 2015\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md99}

\begin{DoxyItemize}
\item Malformed ECParameters causes infinite loop

When processing an ECParameters structure Open\+SSL enters an infinite loop if the curve specified is over a specially malformed binary polynomial field.

This can be used to perform denial of service against any system which processes public keys, certificate requests or certificates. This includes TLS clients and TLS servers with client authentication enabled.

This issue was reported to Open\+SSL by Joseph Barr-\/\+Pixton. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-1788}{\texttt{ CVE-\/2015-\/1788}})

{\itshape Andy Polyakov}
\item Exploitable out-\/of-\/bounds read in X509\+\_\+cmp\+\_\+time

X509\+\_\+cmp\+\_\+time does not properly check the length of the ASN1\+\_\+\+TIME string and can read a few bytes out of bounds. In addition, X509\+\_\+cmp\+\_\+time accepts an arbitrary number of fractional seconds in the time string.

An attacker can use this to craft malformed certificates and CRLs of various sizes and potentially cause a segmentation fault, resulting in a DoS on applications that verify certificates or CRLs. TLS clients that verify CRLs are affected. TLS clients and servers with client authentication enabled may be affected if they use custom verification callbacks.

This issue was reported to Open\+SSL by Robert Swiecki (Google), and independently by Hanno Böck. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-1789}{\texttt{ CVE-\/2015-\/1789}})

{\itshape Emilia Käsper}
\item PKCS7 crash with missing Enveloped\+Content

The PKCS\#7 parsing code does not handle missing inner Encrypted\+Content correctly. An attacker can craft malformed ASN.\+1-\/encoded PKCS\#7 blobs with missing content and trigger a NULL pointer dereference on parsing.

Applications that decrypt PKCS\#7 data or otherwise parse PKCS\#7 structures from untrusted sources are affected. Open\+SSL clients and servers are not affected.

This issue was reported to Open\+SSL by Michal Zalewski (Google). (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-1790}{\texttt{ CVE-\/2015-\/1790}})

{\itshape Emilia Käsper}
\item CMS verify infinite loop with unknown hash function

When verifying a signed\+Data message the CMS code can enter an infinite loop if presented with an unknown hash function OID. This can be used to perform denial of service against any system which verifies signed\+Data messages using the CMS code. This issue was reported to Open\+SSL by Johannes Bauer. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-1792}{\texttt{ CVE-\/2015-\/1792}})

{\itshape Stephen Henson}
\item Race condition handling New\+Session\+Ticket

If a New\+Session\+Ticket is received by a multi-\/threaded client when attempting to reuse a previous ticket then a race condition can occur potentially leading to a double free of the ticket data. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-1791}{\texttt{ CVE-\/2015-\/1791}})

{\itshape Matt Caswell}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md100}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+0q and 1.\+0.\+0r \mbox{[}19 Mar 2015\mbox{]}}{Changes between 1.\+0.\+0q and 1.\+0.\+0r \mbox{[}19 Mar 2015\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md100}

\begin{DoxyItemize}
\item Segmentation fault in ASN1\+\_\+\+TYPE\+\_\+cmp fix

The function ASN1\+\_\+\+TYPE\+\_\+cmp will crash with an invalid read if an attempt is made to compare ASN.\+1 boolean types. Since ASN1\+\_\+\+TYPE\+\_\+cmp is used to check certificate signature algorithm consistency this can be used to crash any certificate verification operation and exploited in a DoS attack. Any application which performs certificate verification is vulnerable including Open\+SSL clients and servers which enable client authentication. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0286}{\texttt{ CVE-\/2015-\/0286}})

{\itshape Stephen Henson}
\item ASN.\+1 structure reuse memory corruption fix

Reusing a structure in ASN.\+1 parsing may allow an attacker to cause memory corruption via an invalid write. Such reuse is and has been strongly discouraged and is believed to be rare.

Applications that parse structures containing CHOICE or ANY DEFINED BY components may be affected. Certificate parsing (d2i\+\_\+\+X509 and related functions) are however not affected. Open\+SSL clients and servers are not affected. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0287}{\texttt{ CVE-\/2015-\/0287}})

{\itshape Stephen Henson}
\item PKCS7 NULL pointer dereferences fix

The PKCS\#7 parsing code does not handle missing outer Content\+Info correctly. An attacker can craft malformed ASN.\+1-\/encoded PKCS\#7 blobs with missing content and trigger a NULL pointer dereference on parsing.

Applications that verify PKCS\#7 signatures, decrypt PKCS\#7 data or otherwise parse PKCS\#7 structures from untrusted sources are affected. Open\+SSL clients and servers are not affected.

This issue was reported to Open\+SSL by Michal Zalewski (Google). (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0289}{\texttt{ CVE-\/2015-\/0289}})

{\itshape Emilia Käsper}
\item DoS via reachable assert in SSLv2 servers fix

A malicious client can trigger an OPENSSL\+\_\+assert (i.\+e., an abort) in servers that both support SSLv2 and enable export cipher suites by sending a specially crafted SSLv2 CLIENT-\/\+MASTER-\/\+KEY message.

This issue was discovered by Sean Burford (Google) and Emilia Käsper (Open\+SSL development team). (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0293}{\texttt{ CVE-\/2015-\/0293}})

{\itshape Emilia Käsper}
\item Use After Free following d2i\+\_\+\+ECPrivatekey error fix

A malformed EC private key file consumed via the d2i\+\_\+\+ECPrivate\+Key function could cause a use after free condition. This, in turn, could cause a double free in several private key parsing functions (such as d2i\+\_\+\+Private\+Key or EVP\+\_\+\+PKCS82\+PKEY) and could lead to a DoS attack or memory corruption for applications that receive EC private keys from untrusted sources. This scenario is considered rare.

This issue was discovered by the Boring\+SSL project and fixed in their commit 517073cd4b. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0209}{\texttt{ CVE-\/2015-\/0209}})

{\itshape Matt Caswell}
\item X509\+\_\+to\+\_\+\+X509\+\_\+\+REQ NULL pointer deref fix

The function X509\+\_\+to\+\_\+\+X509\+\_\+\+REQ will crash with a NULL pointer dereference if the certificate key is invalid. This function is rarely used in practice.

This issue was discovered by Brian Carpenter. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0288}{\texttt{ CVE-\/2015-\/0288}})

{\itshape Stephen Henson}
\item Removed the export ciphers from the DEFAULT ciphers

{\itshape Kurt Roeckx}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md101}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+0p and 1.\+0.\+0q \mbox{[}15 Jan 2015\mbox{]}}{Changes between 1.\+0.\+0p and 1.\+0.\+0q \mbox{[}15 Jan 2015\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md101}

\begin{DoxyItemize}
\item Build fixes for the Windows and Open\+VMS platforms

{\itshape Matt Caswell and Richard Levitte}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md102}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+0o and 1.\+0.\+0p \mbox{[}8 Jan 2015\mbox{]}}{Changes between 1.\+0.\+0o and 1.\+0.\+0p \mbox{[}8 Jan 2015\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md102}

\begin{DoxyItemize}
\item Fix DTLS segmentation fault in dtls1\+\_\+get\+\_\+record. A carefully crafted DTLS message can cause a segmentation fault in Open\+SSL due to a NULL pointer dereference. This could lead to a Denial Of Service attack. Thanks to Markus Stenberg of Cisco Systems, Inc. for reporting this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3571}{\texttt{ CVE-\/2014-\/3571}})

{\itshape Steve Henson}
\item Fix DTLS memory leak in dtls1\+\_\+buffer\+\_\+record. A memory leak can occur in the dtls1\+\_\+buffer\+\_\+record function under certain conditions. In particular this could occur if an attacker sent repeated DTLS records with the same sequence number but for the next epoch. The memory leak could be exploited by an attacker in a Denial of Service attack through memory exhaustion. Thanks to Chris Mueller for reporting this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0206}{\texttt{ CVE-\/2015-\/0206}})

{\itshape Matt Caswell}
\item Fix issue where no-\/ssl3 configuration sets method to NULL. When openssl is built with the no-\/ssl3 option and a SSL v3 Client\+Hello is received the ssl method would be set to NULL which could later result in a NULL pointer dereference. Thanks to Frank Schmirler for reporting this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3569}{\texttt{ CVE-\/2014-\/3569}})

{\itshape Kurt Roeckx}
\item Abort handshake if server key exchange message is omitted for ephemeral ECDH ciphersuites.

Thanks to Karthikeyan Bhargavan of the PROSECCO team at INRIA for reporting this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3572}{\texttt{ CVE-\/2014-\/3572}})

{\itshape Steve Henson}
\item Remove non-\/export ephemeral RSA code on client and server. This code violated the TLS standard by allowing the use of temporary RSA keys in non-\/export ciphersuites and could be used by a server to effectively downgrade the RSA key length used to a value smaller than the server certificate. Thanks for Karthikeyan Bhargavan of the PROSECCO team at INRIA or reporting this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0204}{\texttt{ CVE-\/2015-\/0204}})

{\itshape Steve Henson}
\item Fixed issue where DH client certificates are accepted without verification. An Open\+SSL server will accept a DH certificate for client authentication without the certificate verify message. This effectively allows a client to authenticate without the use of a private key. This only affects servers which trust a client certificate authority which issues certificates containing DH keys\+: these are extremely rare and hardly ever encountered. Thanks for Karthikeyan Bhargavan of the PROSECCO team at INRIA or reporting this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2015-0205}{\texttt{ CVE-\/2015-\/0205}})

{\itshape Steve Henson}
\item Correct Bignum squaring. Bignum squaring (BN\+\_\+sqr) may produce incorrect results on some platforms, including x86\+\_\+64. This bug occurs at random with a very low probability, and is not known to be exploitable in any way, though its exact impact is difficult to determine. Thanks to Pieter Wuille (Blockstream) who reported this issue and also suggested an initial fix. Further analysis was conducted by the Open\+SSL development team and Adam Langley of Google. The final fix was developed by Andy Polyakov of the Open\+SSL core team. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3570}{\texttt{ CVE-\/2014-\/3570}})

{\itshape Andy Polyakov}
\item Fix various certificate fingerprint issues.

By using non-\/\+DER or invalid encodings outside the signed portion of a certificate the fingerprint can be changed without breaking the signature. Although no details of the signed portion of the certificate can be changed this can cause problems with some applications\+: e.\+g. those using the certificate fingerprint for blacklists.
\begin{DoxyEnumerate}
\item Reject signatures with non zero unused bits.
\end{DoxyEnumerate}

If the BIT STRING containing the signature has non zero unused bits reject the signature. All current signature algorithms require zero unused bits.
\begin{DoxyEnumerate}
\item Check certificate algorithm consistency.
\end{DoxyEnumerate}

Check the Algorithm\+Identifier inside TBS matches the one in the certificate signature. NB\+: this will result in signature failure errors for some broken certificates.

Thanks to Konrad Kraszewski from Google for reporting this issue.
\begin{DoxyEnumerate}
\item Check DSA/\+ECDSA signatures use DER.
\end{DoxyEnumerate}

Re-\/encode DSA/\+ECDSA signatures and compare with the original received signature. Return an error if there is a mismatch.

This will reject various cases including garbage after signature (thanks to Antti Karjalainen and Tuomo Untinen from the Codenomicon CROSS program for discovering this case) and use of BER or invalid ASN.\+1 INTEGERs (negative or with leading zeroes).

Further analysis was conducted and fixes were developed by Stephen Henson of the Open\+SSL core team.

(\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-8275}{\texttt{ CVE-\/2014-\/8275}})

{\itshape Steve Henson}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md103}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+0n and 1.\+0.\+0o \mbox{[}15 Oct 2014\mbox{]}}{Changes between 1.\+0.\+0n and 1.\+0.\+0o \mbox{[}15 Oct 2014\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md103}

\begin{DoxyItemize}
\item Session Ticket Memory Leak.

When an Open\+SSL SSL/\+TLS/\+DTLS server receives a session ticket the integrity of that ticket is first verified. In the event of a session ticket integrity check failing, Open\+SSL will fail to free memory causing a memory leak. By sending a large number of invalid session tickets an attacker could exploit this issue in a Denial Of Service attack. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3567}{\texttt{ CVE-\/2014-\/3567}})

{\itshape Steve Henson}
\item Build option no-\/ssl3 is incomplete.

When Open\+SSL is configured with "{}no-\/ssl3"{} as a build option, servers could accept and complete an SSL 3.\+0 handshake, and clients could be configured to send them. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3568}{\texttt{ CVE-\/2014-\/3568}})

{\itshape Akamai and the Open\+SSL team}
\item Add support for TLS\+\_\+\+FALLBACK\+\_\+\+SCSV. Client applications doing fallback retries should call SSL\+\_\+set\+\_\+mode(s, SSL\+\_\+\+MODE\+\_\+\+SEND\+\_\+\+FALLBACK\+\_\+\+SCSV). (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3566}{\texttt{ CVE-\/2014-\/3566}})

{\itshape Adam Langley, Bodo Moeller}
\item Add additional Digest\+Info checks.

Re-\/encode Digest\+Into in DER and check against the original when verifying RSA signature\+: this will reject any improperly encoded Digest\+Info structures.

Note\+: this is a precautionary measure and no attacks are currently known.

{\itshape Steve Henson}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md104}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+0m and 1.\+0.\+0n \mbox{[}6 Aug 2014\mbox{]}}{Changes between 1.\+0.\+0m and 1.\+0.\+0n \mbox{[}6 Aug 2014\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md104}

\begin{DoxyItemize}
\item Open\+SSL DTLS clients enabling anonymous (EC)DH ciphersuites are subject to a denial of service attack. A malicious server can crash the client with a null pointer dereference (read) by specifying an anonymous (EC)DH ciphersuite and sending carefully crafted handshake messages.

Thanks to Felix Gröbert (Google) for discovering and researching this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3510}{\texttt{ CVE-\/2014-\/3510}})

{\itshape Emilia Käsper}
\item By sending carefully crafted DTLS packets an attacker could cause openssl to leak memory. This can be exploited through a Denial of Service attack. Thanks to Adam Langley for discovering and researching this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3507}{\texttt{ CVE-\/2014-\/3507}})

{\itshape Adam Langley}
\item An attacker can force openssl to consume large amounts of memory whilst processing DTLS handshake messages. This can be exploited through a Denial of Service attack. Thanks to Adam Langley for discovering and researching this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3506}{\texttt{ CVE-\/2014-\/3506}})

{\itshape Adam Langley}
\item An attacker can force an error condition which causes openssl to crash whilst processing DTLS packets due to memory being freed twice. This can be exploited through a Denial of Service attack. Thanks to Adam Langley and Wan-\/\+Teh Chang for discovering and researching this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3505}{\texttt{ CVE-\/2014-\/3505}})

{\itshape Adam Langley}
\item If a multithreaded client connects to a malicious server using a resumed session and the server sends an ec point format extension it could write up to 255 bytes to freed memory.

Thanks to Gabor Tyukasz (Log\+Me\+In Inc) for discovering and researching this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3509}{\texttt{ CVE-\/2014-\/3509}})

{\itshape Gabor Tyukasz}
\item A flaw in OBJ\+\_\+obj2txt may cause pretty printing functions such as X509\+\_\+name\+\_\+oneline, X509\+\_\+name\+\_\+print\+\_\+ex et al. to leak some information from the stack. Applications may be affected if they echo pretty printing output to the attacker.

Thanks to Ivan Fratric (Google) for discovering this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3508}{\texttt{ CVE-\/2014-\/3508}})

{\itshape Emilia Käsper, and Steve Henson}
\item Fix ec\+\_\+\+GFp\+\_\+simple\+\_\+points\+\_\+make\+\_\+affine (thus, EC\+\_\+\+POINTs\+\_\+mul etc.) for corner cases. (Certain input points at infinity could lead to bogus results, with non-\/infinity inputs mapped to infinity too.)

{\itshape Bodo Moeller}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md105}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+0l and 1.\+0.\+0m \mbox{[}5 Jun 2014\mbox{]}}{Changes between 1.\+0.\+0l and 1.\+0.\+0m \mbox{[}5 Jun 2014\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md105}

\begin{DoxyItemize}
\item Fix for SSL/\+TLS MITM flaw. An attacker using a carefully crafted handshake can force the use of weak keying material in Open\+SSL SSL/\+TLS clients and servers.

Thanks to KIKUCHI Masashi (Lepidum Co. Ltd.) for discovering and researching this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-0224}{\texttt{ CVE-\/2014-\/0224}})

{\itshape KIKUCHI Masashi, Steve Henson}
\item Fix DTLS recursion flaw. By sending an invalid DTLS handshake to an Open\+SSL DTLS client the code can be made to recurse eventually crashing in a DoS attack.

Thanks to Imre Rad (Search-\/\+Lab Ltd.) for discovering this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-0221}{\texttt{ CVE-\/2014-\/0221}})

{\itshape Imre Rad, Steve Henson}
\item Fix DTLS invalid fragment vulnerability. A buffer overrun attack can be triggered by sending invalid DTLS fragments to an Open\+SSL DTLS client or server. This is potentially exploitable to run arbitrary code on a vulnerable client or server.

Thanks to Jüri Aedla for reporting this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-0195}{\texttt{ CVE-\/2014-\/0195}})

{\itshape Jüri Aedla, Steve Henson}
\item Fix bug in TLS code where clients enable anonymous ECDH ciphersuites are subject to a denial of service attack.

Thanks to Felix Gröbert and Ivan Fratric at Google for discovering this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-3470}{\texttt{ CVE-\/2014-\/3470}})

{\itshape Felix Gröbert, Ivan Fratric, Steve Henson}
\item Harmonize version and its documentation. -\/f flag is used to display compilation flags.

\texorpdfstring{$\ast$}{*}mancha \href{mailto:mancha1@zoho.com}{\texttt{ mancha1@zoho.\+com}}\texorpdfstring{$\ast$}{*}
\item Fix eckey\+\_\+priv\+\_\+encode so it immediately returns an error upon a failure in i2d\+\_\+\+ECPrivate\+Key.

\texorpdfstring{$\ast$}{*}mancha \href{mailto:mancha1@zoho.com}{\texttt{ mancha1@zoho.\+com}}\texorpdfstring{$\ast$}{*}
\item Fix some double frees. These are not thought to be exploitable.

\texorpdfstring{$\ast$}{*}mancha \href{mailto:mancha1@zoho.com}{\texttt{ mancha1@zoho.\+com}}\texorpdfstring{$\ast$}{*}
\item Fix for the attack described in the paper "{}\+Recovering Open\+SSL    ECDSA Nonces Using the FLUSH+\+RELOAD Cache Side-\/channel Attack"{} by Yuval Yarom and Naomi Benger. Details can be obtained from\+: \href{http://eprint.iacr.org/2014/140}{\texttt{ http\+://eprint.\+iacr.\+org/2014/140}}

Thanks to Yuval Yarom and Naomi Benger for discovering this flaw and to Yuval Yarom for supplying a fix (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2014-0076}{\texttt{ CVE-\/2014-\/0076}})

{\itshape Yuval Yarom and Naomi Benger}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md106}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+0k and 1.\+0.\+0l \mbox{[}6 Jan 2014\mbox{]}}{Changes between 1.\+0.\+0k and 1.\+0.\+0l \mbox{[}6 Jan 2014\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md106}

\begin{DoxyItemize}
\item Keep original DTLS digest and encryption contexts in retransmission structures so we can use the previous session parameters if they need to be resent. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2013-6450}{\texttt{ CVE-\/2013-\/6450}})

{\itshape Steve Henson}
\item Add option SSL\+\_\+\+OP\+\_\+\+SAFARI\+\_\+\+ECDHE\+\_\+\+ECDSA\+\_\+\+BUG (part of SSL\+\_\+\+OP\+\_\+\+ALL) which avoids preferring ECDHE-\/\+ECDSA ciphers when the client appears to be Safari on OS X. Safari on OS X 10.\+8..10.\+8.\+3 advertises support for several ECDHE-\/\+ECDSA ciphers, but fails to negotiate them. The bug is fixed in OS X 10.\+8.\+4, but Apple have ruled out both hot fixing 10.\+8..10.\+8.\+3 and forcing users to upgrade to 10.\+8.\+4 or newer.

{\itshape Rob Stradling, Adam Langley}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md107}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+0j and 1.\+0.\+0k \mbox{[}5 Feb 2013\mbox{]}}{Changes between 1.\+0.\+0j and 1.\+0.\+0k \mbox{[}5 Feb 2013\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md107}

\begin{DoxyItemize}
\item Make the decoding of SSLv3, TLS and DTLS CBC records constant time.

This addresses the flaw in CBC record processing discovered by Nadhem Alfardan and Kenny Paterson. Details of this attack can be found at\+: \href{http://www.isg.rhul.ac.uk/tls/}{\texttt{ http\+://www.\+isg.\+rhul.\+ac.\+uk/tls/}}

Thanks go to Nadhem Alfardan and Kenny Paterson of the Information Security Group at Royal Holloway, University of London (www.\+isg.\+rhul.\+ac.\+uk) for discovering this flaw and Adam Langley and Emilia Käsper for the initial patch. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2013-0169}{\texttt{ CVE-\/2013-\/0169}})

{\itshape Emilia Käsper, Adam Langley, Ben Laurie, Andy Polyakov, Steve Henson}
\item Return an error when checking OCSP signatures when key is NULL. This fixes a DoS attack. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2013-0166}{\texttt{ CVE-\/2013-\/0166}})

{\itshape Steve Henson}
\item Call OCSP Stapling callback after ciphersuite has been chosen, so the right response is stapled. Also change SSL\+\_\+get\+\_\+certificate() so it returns the certificate actually sent. See \href{http://rt.openssl.org/Ticket/Display.html?id=2836}{\texttt{ http\+://rt.\+openssl.\+org/\+Ticket/\+Display.\+html?id=2836}}. (This is a backport)

\texorpdfstring{$\ast$}{*}\+Rob Stradling \href{mailto:rob.stradling@comodo.com}{\texttt{ rob.\+stradling@comodo.\+com}}\texorpdfstring{$\ast$}{*}
\item Fix possible deadlock when decoding public keys.

{\itshape Steve Henson}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md108}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+0i and 1.\+0.\+0j \mbox{[}10 May 2012\mbox{]}}{Changes between 1.\+0.\+0i and 1.\+0.\+0j \mbox{[}10 May 2012\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md108}
\mbox{[}NB\+: Open\+SSL 1.\+0.\+0i and later 1.\+0.\+0 patch levels were released after Open\+SSL 1.\+0.\+1.\mbox{]}


\begin{DoxyItemize}
\item Sanity check record length before skipping explicit IV in DTLS to fix DoS attack.

Thanks to Codenomicon for discovering this issue using Fuzz-\/o-\/\+Matic fuzzing as a service testing platform. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2012-2333}{\texttt{ CVE-\/2012-\/2333}})

{\itshape Steve Henson}
\item Initialise tkeylen properly when encrypting CMS messages. Thanks to Solar Designer of Openwall for reporting this issue.

{\itshape Steve Henson}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md109}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+0h and 1.\+0.\+0i \mbox{[}19 Apr 2012\mbox{]}}{Changes between 1.\+0.\+0h and 1.\+0.\+0i \mbox{[}19 Apr 2012\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md109}

\begin{DoxyItemize}
\item Check for potentially exploitable overflows in asn1\+\_\+d2i\+\_\+read\+\_\+bio BUF\+\_\+mem\+\_\+grow and BUF\+\_\+mem\+\_\+grow\+\_\+clean. Refuse attempts to shrink buffer in CRYPTO\+\_\+realloc\+\_\+clean.

Thanks to Tavis Ormandy, Google Security Team, for discovering this issue and to Adam Langley \href{mailto:agl@chromium.org}{\texttt{ agl@chromium.\+org}} for fixing it. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2012-2110}{\texttt{ CVE-\/2012-\/2110}})

{\itshape Adam Langley (Google), Tavis Ormandy, Google Security Team}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md110}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+0g and 1.\+0.\+0h \mbox{[}12 Mar 2012\mbox{]}}{Changes between 1.\+0.\+0g and 1.\+0.\+0h \mbox{[}12 Mar 2012\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md110}

\begin{DoxyItemize}
\item Fix MMA (Bleichenbacher\textquotesingle{}s attack on PKCS \#1 v1.\+5 RSA padding) weakness in CMS and PKCS7 code. When RSA decryption fails use a random key for content decryption and always return the same error. Note\+: this attack needs on average 2\texorpdfstring{$^\wedge$}{\string^}20 messages so it only affects automated senders. The old behaviour can be re-\/enabled in the CMS code by setting the CMS\+\_\+\+DEBUG\+\_\+\+DECRYPT flag\+: this is useful for debugging and testing where an MMA defence is not necessary. Thanks to Ivan Nestlerode \href{mailto:inestlerode@us.ibm.com}{\texttt{ inestlerode@us.\+ibm.\+com}} for discovering this issue. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2012-0884}{\texttt{ CVE-\/2012-\/0884}})

{\itshape Steve Henson}
\item Fix CVE-\/2011-\/4619\+: make sure we really are receiving a client hello before rejecting multiple SGC restarts. Thanks to Ivan Nestlerode \href{mailto:inestlerode@us.ibm.com}{\texttt{ inestlerode@us.\+ibm.\+com}} for discovering this bug.

{\itshape Steve Henson}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md111}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+0f and 1.\+0.\+0g \mbox{[}18 Jan 2012\mbox{]}}{Changes between 1.\+0.\+0f and 1.\+0.\+0g \mbox{[}18 Jan 2012\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md111}

\begin{DoxyItemize}
\item Fix for DTLS DoS issue introduced by fix for CVE-\/2011-\/4109. Thanks to Antonio Martin, Enterprise Secure Access Research and Development, Cisco Systems, Inc. for discovering this bug and preparing a fix. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2012-0050}{\texttt{ CVE-\/2012-\/0050}})

{\itshape Antonio Martin}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md112}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+0e and 1.\+0.\+0f \mbox{[}4 Jan 2012\mbox{]}}{Changes between 1.\+0.\+0e and 1.\+0.\+0f \mbox{[}4 Jan 2012\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md112}

\begin{DoxyItemize}
\item Nadhem Alfardan and Kenny Paterson have discovered an extension of the Vaudenay padding oracle attack on CBC mode encryption which enables an efficient plaintext recovery attack against the Open\+SSL implementation of DTLS. Their attack exploits timing differences arising during decryption processing. A research paper describing this attack can be found at\+: \href{http://www.isg.rhul.ac.uk/~kp/dtls.pdf}{\texttt{ http\+://www.\+isg.\+rhul.\+ac.\+uk/\texorpdfstring{$\sim$}{\string~}kp/dtls.\+pdf}} Thanks go to Nadhem Alfardan and Kenny Paterson of the Information Security Group at Royal Holloway, University of London (www.\+isg.\+rhul.\+ac.\+uk) for discovering this flaw and to Robin Seggelmann \href{mailto:seggelmann@fh-muenster.de}{\texttt{ seggelmann@fh-\/muenster.\+de}} and Michael Tuexen \href{mailto:tuexen@fh-muenster.de}{\texttt{ tuexen@fh-\/muenster.\+de}} for preparing the fix. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2011-4108}{\texttt{ CVE-\/2011-\/4108}})

{\itshape Robin Seggelmann, Michael Tuexen}
\item Clear bytes used for block padding of SSL 3.\+0 records. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2011-4576}{\texttt{ CVE-\/2011-\/4576}})

{\itshape Adam Langley (Google)}
\item Only allow one SGC handshake restart for SSL/\+TLS. Thanks to George Kadianakis \href{mailto:desnacked@gmail.com}{\texttt{ desnacked@gmail.\+com}} for discovering this issue and Adam Langley for preparing the fix. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2011-4619}{\texttt{ CVE-\/2011-\/4619}})

{\itshape Adam Langley (Google)}
\item Check parameters are not NULL in GOST ENGINE. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2012-0027}{\texttt{ CVE-\/2012-\/0027}})

\texorpdfstring{$\ast$}{*}\+Andrey Kulikov \href{mailto:amdeich@gmail.com}{\texttt{ amdeich@gmail.\+com}}\texorpdfstring{$\ast$}{*}
\item Prevent malformed RFC3779 data triggering an assertion failure. Thanks to Andrew Chi, BBN Technologies, for discovering the flaw and Rob Austein \href{mailto:sra@hactrn.net}{\texttt{ sra@hactrn.\+net}} for fixing it. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2011-4577}{\texttt{ CVE-\/2011-\/4577}})

\texorpdfstring{$\ast$}{*}\+Rob Austein \href{mailto:sra@hactrn.net}{\texttt{ sra@hactrn.\+net}}\texorpdfstring{$\ast$}{*}
\item Improved PRNG seeding for VOS.

\texorpdfstring{$\ast$}{*}\+Paul Green \href{mailto:Paul.Green@stratus.com}{\texttt{ Paul.\+Green@stratus.\+com}}\texorpdfstring{$\ast$}{*}
\item Fix ssl\+\_\+ciph.\+c set-\/up race.

{\itshape Adam Langley (Google)}
\item Fix spurious failures in ecdsatest.\+c.

{\itshape Emilia Käsper (Google)}
\item Fix the BIO\+\_\+f\+\_\+buffer() implementation (which was mixing different interpretations of the {\ttfamily ...\+\_\+len} fields).

{\itshape Adam Langley (Google)}
\item Fix handling of BN\+\_\+\+BLINDING\+: now BN\+\_\+\+BLINDING\+\_\+invert\+\_\+ex (rather than BN\+\_\+\+BLINDING\+\_\+invert\+\_\+ex) calls BN\+\_\+\+BLINDING\+\_\+update, ensuring that concurrent threads won\textquotesingle{}t reuse the same blinding coefficients.

This also avoids the need to obtain the CRYPTO\+\_\+\+LOCK\+\_\+\+RSA\+\_\+\+BLINDING lock to call BN\+\_\+\+BLINDING\+\_\+invert\+\_\+ex, and avoids one use of BN\+\_\+\+BLINDING\+\_\+update for each BN\+\_\+\+BLINDING structure (previously, the last update always remained unused).

{\itshape Emilia Käsper (Google)}
\item In ssl3\+\_\+clear, preserve s3-\/\texorpdfstring{$>$}{>}init\+\_\+extra along with s3-\/\texorpdfstring{$>$}{>}rbuf.

{\itshape Bob Buckholz (Google)}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md113}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+0d and 1.\+0.\+0e \mbox{[}6 Sep 2011\mbox{]}}{Changes between 1.\+0.\+0d and 1.\+0.\+0e \mbox{[}6 Sep 2011\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md113}

\begin{DoxyItemize}
\item Fix bug where CRLs with next\+Update in the past are sometimes accepted by initialising X509\+\_\+\+STORE\+\_\+\+CTX properly. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2011-3207}{\texttt{ CVE-\/2011-\/3207}})

\texorpdfstring{$\ast$}{*}\+Kaspar Brand \href{mailto:ossl@velox.ch}{\texttt{ ossl@velox.\+ch}}\texorpdfstring{$\ast$}{*}
\item Fix SSL memory handling for (EC)DH ciphersuites, in particular for multi-\/threaded use of ECDH. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2011-3210}{\texttt{ CVE-\/2011-\/3210}})

{\itshape Adam Langley (Google)}
\item Fix x509\+\_\+name\+\_\+ex\+\_\+d2i memory leak on bad inputs.

{\itshape Bodo Moeller}
\item Remove hard coded ecdsa\+With\+SHA1 signature tests in ssl code and check signature public key algorithm by using OID xref utilities instead. Before this you could only use some ECC ciphersuites with SHA1 only.

{\itshape Steve Henson}
\item Add protection against ECDSA timing attacks as mentioned in the paper by Billy Bob Brumley and Nicola Tuveri, see\+: \href{http://eprint.iacr.org/2011/232.pdf}{\texttt{ http\+://eprint.\+iacr.\+org/2011/232.\+pdf}}

{\itshape Billy Bob Brumley and Nicola Tuveri}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md114}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+0c and 1.\+0.\+0d \mbox{[}8 Feb 2011\mbox{]}}{Changes between 1.\+0.\+0c and 1.\+0.\+0d \mbox{[}8 Feb 2011\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md114}

\begin{DoxyItemize}
\item Fix parsing of OCSP stapling Client\+Hello extension. CVE-\/2011-\/0014

{\itshape Neel Mehta, Adam Langley, Bodo Moeller (Google)}
\item Fix bug in string printing code\+: if {\itshape any} escaping is enabled we must escape the escape character (backslash) or the resulting string is ambiguous.

{\itshape Steve Henson}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md115}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+0b and 1.\+0.\+0c \mbox{[}2 Dec 2010\mbox{]}}{Changes between 1.\+0.\+0b and 1.\+0.\+0c \mbox{[}2 Dec 2010\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md115}

\begin{DoxyItemize}
\item Disable code workaround for ancient and obsolete Netscape browsers and servers\+: an attacker can use it in a ciphersuite downgrade attack. Thanks to Martin Rex for discovering this bug. CVE-\/2010-\/4180

{\itshape Steve Henson}
\item Fixed J-\/\+PAKE implementation error, originally discovered by Sebastien Martini, further info and confirmation from Stefan Arentz and Feng Hao. Note that this fix is a security fix. CVE-\/2010-\/4252

{\itshape Ben Laurie}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md116}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+0a and 1.\+0.\+0b \mbox{[}16 Nov 2010\mbox{]}}{Changes between 1.\+0.\+0a and 1.\+0.\+0b \mbox{[}16 Nov 2010\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md116}

\begin{DoxyItemize}
\item Fix extension code to avoid race conditions which can result in a buffer overrun vulnerability\+: resumed sessions must not be modified as they can be shared by multiple threads. CVE-\/2010-\/3864

{\itshape Steve Henson}
\item Fix WIN32 build system to correctly link an ENGINE directory into a DLL.

{\itshape Steve Henson}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md117}{}\doxysubsection{\texorpdfstring{Changes between 1.\+0.\+0 and 1.\+0.\+0a \mbox{[}01 Jun 2010\mbox{]}}{Changes between 1.\+0.\+0 and 1.\+0.\+0a \mbox{[}01 Jun 2010\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md117}

\begin{DoxyItemize}
\item Check return value of int\+\_\+rsa\+\_\+verify in pkey\+\_\+rsa\+\_\+verifyrecover (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2010-1633}{\texttt{ CVE-\/2010-\/1633}})

\texorpdfstring{$\ast$}{*}\+Steve Henson, Peter-\/\+Michael Hager \href{mailto:hager@dortmund.net}{\texttt{ hager@dortmund.\+net}}\texorpdfstring{$\ast$}{*}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md118}{}\doxysubsection{\texorpdfstring{Changes between 0.\+9.\+8n and 1.\+0.\+0 \mbox{[}29 Mar 2010\mbox{]}}{Changes between 0.\+9.\+8n and 1.\+0.\+0 \mbox{[}29 Mar 2010\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md118}

\begin{DoxyItemize}
\item Add "{}missing"{} function EVP\+\_\+\+CIPHER\+\_\+\+CTX\+\_\+copy(). This copies a cipher context. The operation can be customised via the ctrl mechanism in case ENGINEs want to include additional functionality.

{\itshape Steve Henson}
\item Tolerate yet another broken PKCS\#8 key format\+: private key value negative.

{\itshape Steve Henson}
\item Add new -\/subject\+\_\+hash\+\_\+old and -\/issuer\+\_\+hash\+\_\+old options to x509 utility to output hashes compatible with older versions of Open\+SSL.

\texorpdfstring{$\ast$}{*}\+Willy Weisz \href{mailto:weisz@vcpc.univie.ac.at}{\texttt{ weisz@vcpc.\+univie.\+ac.\+at}}\texorpdfstring{$\ast$}{*}
\item Fix compression algorithm handling\+: if resuming a session use the compression algorithm of the resumed session instead of determining it from client hello again. Don\textquotesingle{}t allow server to change algorithm.

{\itshape Steve Henson}
\item Add load\+\_\+crls() function to commands tidying load\+\_\+certs() too. Add option to verify utility to allow additional CRLs to be included.

{\itshape Steve Henson}
\item Update OCSP request code to permit adding custom headers to the request\+: some responders need this.

{\itshape Steve Henson}
\item The function EVP\+\_\+\+PKEY\+\_\+sign() returns \texorpdfstring{$<$}{<}=0 on error\+: check return code correctly.

\texorpdfstring{$\ast$}{*}\+Julia Lawall \href{mailto:julia@diku.dk}{\texttt{ julia@diku.\+dk}}\texorpdfstring{$\ast$}{*}
\item Update verify callback code in {\ttfamily apps/s\+\_\+cb.\+c} and {\ttfamily apps/verify.\+c}, it needlessly dereferenced structures, used obsolete functions and didn\textquotesingle{}t handle all updated verify codes correctly.

{\itshape Steve Henson}
\item Disable MD2 in the default configuration.

{\itshape Steve Henson}
\item In BIO\+\_\+pop() and BIO\+\_\+push() use the ctrl argument (which was NULL) to indicate the initial BIO being pushed or popped. This makes it possible to determine whether the BIO is the one explicitly called or as a result of the ctrl being passed down the chain. Fix BIO\+\_\+pop() and SSL BIOs so it handles reference counts correctly and doesn\textquotesingle{}t zero out the I/O bio when it is not being explicitly popped. WARNING\+: applications which included workarounds for the old buggy behaviour will need to be modified or they could free up already freed BIOs.

{\itshape Steve Henson}
\item Extend the uni2asc/asc2uni =\texorpdfstring{$>$}{>} OPENSSL\+\_\+uni2asc/\+OPENSSL\+\_\+asc2uni renaming to all platforms (within the 0.\+9.\+8 branch, this was done conditionally on Netware platforms to avoid a name clash).

\texorpdfstring{$\ast$}{*}\+Guenter \href{mailto:lists@gknw.net}{\texttt{ lists@gknw.\+net}}\texorpdfstring{$\ast$}{*}
\item Add ECDHE and PSK support to DTLS.

\texorpdfstring{$\ast$}{*}\+Michael Tuexen \href{mailto:tuexen@fh-muenster.de}{\texttt{ tuexen@fh-\/muenster.\+de}}\texorpdfstring{$\ast$}{*}
\item Add CHECKED\+\_\+\+STACK\+\_\+\+OF macro to \doxylink{safestack_8h_source}{safestack.\+h}, otherwise safestack can\textquotesingle{}t be used on C++.

{\itshape Steve Henson}
\item Add "{}missing"{} function EVP\+\_\+\+MD\+\_\+flags() (without this the only way to retrieve a digest flags is by accessing the structure directly. Update {\ttfamily EVP\+\_\+\+MD\+\_\+do\+\_\+all\texorpdfstring{$\ast$}{*}()} and {\ttfamily EVP\+\_\+\+CIPHER\+\_\+do\+\_\+all\texorpdfstring{$\ast$}{*}()} to include the name a digest or cipher is registered as in the "{}from"{} argument. Print out all registered digests in the dgst usage message instead of manually attempting to work them out.

{\itshape Steve Henson}
\item If no SSLv2 ciphers are used don\textquotesingle{}t use an SSLv2 compatible client hello\+: this allows the use of compression and extensions. Change default cipher string to remove SSLv2 ciphersuites. This effectively avoids ancient SSLv2 by default unless an application cipher string requests it.

{\itshape Steve Henson}
\item Alter match criteria in PKCS12\+\_\+parse(). It used to try to use local key ids to find matching certificates and keys but some PKCS\#12 files don\textquotesingle{}t follow the (somewhat unwritten) rules and this strategy fails. Now just gather all certificates together and the first private key then look for the first certificate that matches the key.

{\itshape Steve Henson}
\item Support use of registered digest and cipher names for dgst and cipher commands instead of having to add each one as a special case. So now you can do\+: \begin{DoxyVerb}    openssl sha256 foo
\end{DoxyVerb}
 as well as\+: \begin{DoxyVerb}    openssl dgst -sha256 foo
\end{DoxyVerb}
 and this works for ENGINE based algorithms too.

{\itshape Steve Henson}
\item Update Gost ENGINE to support parameter files.

\texorpdfstring{$\ast$}{*}\+Victor B. Wagner \href{mailto:vitus@cryptocom.ru}{\texttt{ vitus@cryptocom.\+ru}}\texorpdfstring{$\ast$}{*}
\item Support Generalized\+Time in ca utility.

\texorpdfstring{$\ast$}{*}\+Oliver Martin \href{mailto:oliver@volatilevoid.net}{\texttt{ oliver@volatilevoid.\+net}}, Steve Henson\texorpdfstring{$\ast$}{*}
\item Enhance the hash format used for certificate directory links. The new form uses the canonical encoding (meaning equivalent names will work even if they aren\textquotesingle{}t identical) and uses SHA1 instead of MD5. This form is incompatible with the older format and as a result c\+\_\+rehash should be used to rebuild symbolic links.

{\itshape Steve Henson}
\item Make PKCS\#8 the default write format for private keys, replacing the traditional format. This form is standardised, more secure and doesn\textquotesingle{}t include an implicit MD5 dependency.

{\itshape Steve Henson}
\item Add a \$gcc\+\_\+devteam\+\_\+warn option to Configure. The idea is that any code committed to Open\+SSL should pass this lot as a minimum.

{\itshape Steve Henson}
\item Add session ticket override functionality for use by EAP-\/\+FAST.

\texorpdfstring{$\ast$}{*}\+Jouni Malinen \href{mailto:j@w1.fi}{\texttt{ j@w1.\+fi}}\texorpdfstring{$\ast$}{*}
\item Modify HMAC functions to return a value. Since these can be implemented in an ENGINE errors can occur.

{\itshape Steve Henson}
\item Type-\/checked OBJ\+\_\+bsearch\+\_\+ex.

{\itshape Ben Laurie}
\item Type-\/checked OBJ\+\_\+bsearch. Also some constification necessitated by type-\/checking. Still to come\+: TXT\+\_\+\+DB, bsearch(?), OBJ\+\_\+bsearch\+\_\+ex, qsort, CRYPTO\+\_\+\+EX\+\_\+\+DATA, ASN1\+\_\+\+VALUE, ASN1\+\_\+\+STRING, CONF\+\_\+\+VALUE.

{\itshape Ben Laurie}
\item New function OPENSSL\+\_\+gmtime\+\_\+adj() to add a specific number of days and seconds to a tm structure directly, instead of going through OS specific date routines. This avoids any issues with OS routines such as the year 2038 bug. New {\ttfamily \texorpdfstring{$\ast$}{*}\+\_\+adj()} functions for ASN1 time structures and X509\+\_\+time\+\_\+adj\+\_\+ex() to cover the extended range. The existing X509\+\_\+time\+\_\+adj() is still usable and will no longer have any date issues.

{\itshape Steve Henson}
\item Delta CRL support. New use deltas option which will attempt to locate and search any appropriate delta CRLs available.

This work was sponsored by Google.

{\itshape Steve Henson}
\item Support for CRLs partitioned by reason code. Reorganise CRL processing code and add additional score elements. Validate alternate CRL paths as part of the CRL checking and indicate a new error "{}\+CRL path validation    error"{} in this case. Applications wanting additional details can use the verify callback and check the new "{}parent"{} field. If this is not NULL CRL path validation is taking place. Existing applications won\textquotesingle{}t see this because it requires extended CRL support which is off by default.

This work was sponsored by Google.

{\itshape Steve Henson}
\item Support for freshest CRL extension.

This work was sponsored by Google.

{\itshape Steve Henson}
\item Initial indirect CRL support. Currently only supported in the CRLs passed directly and not via lookup. Process certificate issuer CRL entry extension and lookup CRL entries by bother issuer name and serial number. Check and process CRL issuer entry in IDP extension.

This work was sponsored by Google.

{\itshape Steve Henson}
\item Add support for distinct certificate and CRL paths. The CRL issuer certificate is validated separately in this case. Only enabled if an extended CRL support flag is set\+: this flag will enable additional CRL functionality in future.

This work was sponsored by Google.

{\itshape Steve Henson}
\item Add support for policy mappings extension.

This work was sponsored by Google.

{\itshape Steve Henson}
\item Fixes to pathlength constraint, self issued certificate handling, policy processing to align with RFC3280 and PKITS tests.

This work was sponsored by Google.

{\itshape Steve Henson}
\item Support for name constraints certificate extension. DN, email, DNS and URI types are currently supported.

This work was sponsored by Google.

{\itshape Steve Henson}
\item To cater for systems that provide a pointer-\/based thread ID rather than numeric, deprecate the current numeric thread ID mechanism and replace it with a structure and associated callback type. This mechanism allows a numeric "{}hash"{} to be extracted from a thread ID in either case, and on platforms where pointers are larger than \textquotesingle{}long\textquotesingle{}, mixing is done to help ensure the numeric \textquotesingle{}hash\textquotesingle{} is usable even if it can\textquotesingle{}t be guaranteed unique. The default mechanism is to use "{}\&errno"{} as a pointer-\/based thread ID to distinguish between threads.

Applications that want to provide their own thread IDs should now use CRYPTO\+\_\+\+THREADID\+\_\+set\+\_\+callback() to register a callback that will call either CRYPTO\+\_\+\+THREADID\+\_\+set\+\_\+numeric() or CRYPTO\+\_\+\+THREADID\+\_\+set\+\_\+pointer().

Note that ERR\+\_\+remove\+\_\+state() is now deprecated, because it is tied to the assumption that thread IDs are numeric. ERR\+\_\+remove\+\_\+state(0) to free the current thread\textquotesingle{}s error state should be replaced by ERR\+\_\+remove\+\_\+thread\+\_\+state(\+NULL).

(This new approach replaces the functions CRYPTO\+\_\+set\+\_\+idptr\+\_\+callback(), CRYPTO\+\_\+get\+\_\+idptr\+\_\+callback(), and CRYPTO\+\_\+thread\+\_\+idptr() that existed in Open\+SSL 0.\+9.\+9-\/dev between June 2006 and August 2008. Also, if an application was previously providing a numeric thread callback that was inappropriate for distinguishing threads, then uniqueness might have been obtained with \&errno that happened immediately in the intermediate development versions of Open\+SSL; this is no longer the case, the numeric thread callback will now override the automatic use of \&errno.)

{\itshape Geoff Thorpe, with help from Bodo Moeller}
\item Initial support for different CRL issuing certificates. This covers a simple case where the self issued certificates in the chain exist and the real CRL issuer is higher in the existing chain.

This work was sponsored by Google.

{\itshape Steve Henson}
\item Removed effectively defunct crypto/store from the build.

{\itshape Ben Laurie}
\item Revamp of STACK to provide stronger type-\/checking. Still to come\+: TXT\+\_\+\+DB, bsearch(?), OBJ\+\_\+bsearch, qsort, CRYPTO\+\_\+\+EX\+\_\+\+DATA, ASN1\+\_\+\+VALUE, ASN1\+\_\+\+STRING, CONF\+\_\+\+VALUE.

{\itshape Ben Laurie}
\item Add a new SSL\+\_\+\+MODE\+\_\+\+RELEASE\+\_\+\+BUFFERS mode flag to release unused buffer RAM on SSL connections. This option can save about 34k per idle SSL.

{\itshape Nick Mathewson}
\item Revamp of LHASH to provide stronger type-\/checking. Still to come\+: STACK, TXT\+\_\+\+DB, bsearch, qsort.

{\itshape Ben Laurie}
\item Initial support for Cryptographic Message Syntax (aka CMS) based on RFC3850, RFC3851 and RFC3852. New cms directory and cms utility, support for data, signed\+Data, compressed\+Data, digested\+Data and encrypted\+Data, enveloped\+Data types included. Scripts to check against RFC4134 examples draft and interop and consistency checks of many content types and variants.

{\itshape Steve Henson}
\item Add options to enc utility to support use of zlib compression BIO.

{\itshape Steve Henson}
\item Extend mk1mf to support importing of options and assembly language files from Configure script, currently only included in VC-\/\+WIN32. The assembly language rules can now optionally generate the source files from the associated perl scripts.

{\itshape Steve Henson}
\item Implement remaining functionality needed to support GOST ciphersuites. Interop testing has been performed using Crypto\+Pro implementations.

\texorpdfstring{$\ast$}{*}\+Victor B. Wagner \href{mailto:vitus@cryptocom.ru}{\texttt{ vitus@cryptocom.\+ru}}\texorpdfstring{$\ast$}{*}
\item s390x assembler pack.

{\itshape Andy Polyakov}
\item ARMv4 assembler pack. ARMv4 refers to v4 and later ISA, not CPU "{}family."{}

{\itshape Andy Polyakov}
\item Implement Opaque PRF Input TLS extension as specified in draft-\/rescorla-\/tls-\/opaque-\/prf-\/input-\/00.\+txt. Since this is not an official specification yet and no extension type assignment by IANA exists, this extension (for now) will have to be explicitly enabled when building Open\+SSL by providing the extension number to use. For example, specify an option \begin{DoxyVerb}    -DTLSEXT_TYPE_opaque_prf_input=0x9527
\end{DoxyVerb}
 to the "{}config"{} or "{}\+Configure"{} script to enable the extension, assuming extension number 0x9527 (which is a completely arbitrary and unofficial assignment based on the MD5 hash of the Internet Draft). Note that by doing so, you potentially lose interoperability with other TLS implementations since these might be using the same extension number for other purposes.

SSL\+\_\+set\+\_\+tlsext\+\_\+opaque\+\_\+prf\+\_\+input(ssl, src, len) is used to set the opaque PRF input value to use in the handshake. This will create an internal copy of the length-\/\textquotesingle{}len\textquotesingle{} string at \textquotesingle{}src\textquotesingle{}, and will return non-\/zero for success.

To get more control and flexibility, provide a callback function by using \begin{DoxyVerb}    SSL_CTX_set_tlsext_opaque_prf_input_callback(ctx, cb)
    SSL_CTX_set_tlsext_opaque_prf_input_callback_arg(ctx, arg)
\end{DoxyVerb}
 where \begin{DoxyVerb}    int (*cb)(SSL *, void *peerinput, size_t len, void *arg);
    void *arg;
\end{DoxyVerb}
 Callback function \textquotesingle{}cb\textquotesingle{} will be called in handshakes, and is expected to use SSL\+\_\+set\+\_\+tlsext\+\_\+opaque\+\_\+prf\+\_\+input() as appropriate. Argument \textquotesingle{}arg\textquotesingle{} is for application purposes (the value as given to SSL\+\_\+\+CTX\+\_\+set\+\_\+tlsext\+\_\+opaque\+\_\+prf\+\_\+input\+\_\+callback\+\_\+arg() will directly be provided to the callback function). The callback function has to return non-\/zero to report success\+: usually 1 to use opaque PRF input just if possible, or 2 to enforce use of the opaque PRF input. In the latter case, the library will abort the handshake if opaque PRF input is not successfully negotiated.

Arguments \textquotesingle{}peerinput\textquotesingle{} and \textquotesingle{}len\textquotesingle{} given to the callback function will always be NULL and 0 in the case of a client. A server will see the client\textquotesingle{}s opaque PRF input through these variables if available (NULL and 0 otherwise). Note that if the server provides an opaque PRF input, the length must be the same as the length of the client\textquotesingle{}s opaque PRF input.

Note that the callback function will only be called when creating a new session (session resumption can resume whatever was previously negotiated), and will not be called in SSL 2.\+0 handshakes; thus, SSL\+\_\+\+CTX\+\_\+set\+\_\+options(ctx, SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+SSLv2) or SSL\+\_\+set\+\_\+options(ssl, SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+SSLv2) is especially recommended for applications that need to enforce opaque PRF input.

{\itshape Bodo Moeller}
\item Update ssl code to support digests other than SHA1+\+MD5 for handshake MAC.

\texorpdfstring{$\ast$}{*}\+Victor B. Wagner \href{mailto:vitus@cryptocom.ru}{\texttt{ vitus@cryptocom.\+ru}}\texorpdfstring{$\ast$}{*}
\item Add RFC4507 support to Open\+SSL. This includes the corrections in RFC4507bis. The encrypted ticket format is an encrypted encoded SSL\+\_\+\+SESSION structure, that way new session features are automatically supported.

If a client application caches session in an SSL\+\_\+\+SESSION structure support is transparent because tickets are now stored in the encoded SSL\+\_\+\+SESSION.

The SSL\+\_\+\+CTX structure automatically generates keys for ticket protection in servers so again support should be possible with no application modification.

If a client or server wishes to disable RFC4507 support then the option SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+TICKET can be set.

Add a TLS extension debugging callback to allow the contents of any client or server extensions to be examined.

This work was sponsored by Google.

{\itshape Steve Henson}
\item Final changes to avoid use of pointer pointer casts in Open\+SSL. Open\+SSL should now compile cleanly on gcc 4.\+2

\texorpdfstring{$\ast$}{*}\+Peter Hartley \href{mailto:pdh@utter.chaos.org.uk}{\texttt{ pdh@utter.\+chaos.\+org.\+uk}}, Steve Henson\texorpdfstring{$\ast$}{*}
\item Update SSL library to use new EVP\+\_\+\+PKEY MAC API. Include generic MAC support including streaming MAC support\+: this is required for GOST ciphersuite support.

\texorpdfstring{$\ast$}{*}\+Victor B. Wagner \href{mailto:vitus@cryptocom.ru}{\texttt{ vitus@cryptocom.\+ru}}, Steve Henson\texorpdfstring{$\ast$}{*}
\item Add option -\/stream to use PKCS\#7 streaming in smime utility. New function i2d\+\_\+\+PKCS7\+\_\+bio\+\_\+stream() and PEM\+\_\+write\+\_\+\+PKCS7\+\_\+bio\+\_\+stream() to output in BER and PEM format.

{\itshape Steve Henson}
\item Experimental support for use of HMAC via EVP\+\_\+\+PKEY interface. This allows HMAC to be handled via the {\ttfamily EVP\+\_\+\+Digest\+Sign\texorpdfstring{$\ast$}{*}()} interface. The EVP\+\_\+\+PKEY "{}key"{} in this case is the HMAC key, potentially allowing ENGINE support for HMAC keys which are unextractable. New -\/mac and -\/macopt options to dgst utility.

{\itshape Steve Henson}
\item New option -\/sigopt to dgst utility. Update dgst to use {\ttfamily EVP\+\_\+\+Digest\{Sign,Verify\}\texorpdfstring{$\ast$}{*}}. These two changes make it possible to use alternative signing parameters such as X9.\+31 or PSS in the dgst utility.

{\itshape Steve Henson}
\item Change ssl\+\_\+cipher\+\_\+apply\+\_\+rule(), the internal function that does the work each time a ciphersuite string requests enabling ("{}foo+bar"{}), moving ("{}+foo+bar"{}), disabling ("{}-\/foo+bar"{}, or removing ("{}!foo+bar"{}) a class of ciphersuites\+: Now it maintains the order of disabled ciphersuites such that those ciphersuites that most recently went from enabled to disabled not only stay in order with respect to each other, but also have higher priority than other disabled ciphersuites the next time ciphersuites are enabled again.

This means that you can now say, e.\+g., "{}\+PSK\+:-\/\+PSK\+:\+HIGH"{} to enable the same ciphersuites as with "{}\+HIGH"{} alone, but in a specific order where the PSK ciphersuites come first (since they are the most recently disabled ciphersuites when "{}\+HIGH"{} is parsed).

Also, change ssl\+\_\+create\+\_\+cipher\+\_\+list() (using this new functionality) such that between otherwise identical ciphersuites, ephemeral ECDH is preferred over ephemeral DH in the default order.

{\itshape Bodo Moeller}
\item Change ssl\+\_\+create\+\_\+cipher\+\_\+list() so that it automatically arranges the ciphersuites in reasonable order before starting to process the rule string. Thus, the definition for "{}\+DEFAULT"{} (SSL\+\_\+\+DEFAULT\+\_\+\+CIPHER\+\_\+\+LIST) now is just "{}\+ALL\+:!a\+NULL\+:!e\+NULL"{}, but remains equivalent to {\ttfamily "{}\+AES\+:\+ALL\+:!a\+NULL\+:!e\+NULL\+:+a\+ECDH\+:+k\+RSA\+:+\+RC4\+:@\+STRENGTH"{}}. This makes it much easier to arrive at a reasonable default order in applications for which anonymous ciphers are OK (meaning that you can\textquotesingle{}t actually use DEFAULT).

{\itshape Bodo Moeller; suggested by Victor Duchovni}
\item Split the SSL/\+TLS algorithm mask (as used for ciphersuite string processing) into multiple integers instead of setting "{}\+SSL\+\_\+\+MKEY\+\_\+\+MASK"{} bits, "{}\+SSL\+\_\+\+AUTH\+\_\+\+MASK"{} bits, "{}\+SSL\+\_\+\+ENC\+\_\+\+MASK"{}, "{}\+SSL\+\_\+\+MAC\+\_\+\+MASK"{}, and "{}\+SSL\+\_\+\+SSL\+\_\+\+MASK"{} bits all in a single integer. (These masks as well as the individual bit definitions are hidden away into the non-\/exported interface ssl/ssl\+\_\+locl.\+h, so this change to the definition of the SSL\+\_\+\+CIPHER structure shouldn\textquotesingle{}t affect applications.) This give us more bits for each of these categories, so there is no longer a need to coagulate AES128 and AES256 into a single algorithm bit, and to coagulate Camellia128 and Camellia256 into a single algorithm bit, which has led to all kinds of kludges.

Thus, among other things, the kludge introduced in 0.\+9.\+7m and 0.\+9.\+8e for masking out AES256 independently of AES128 or masking out Camellia256 independently of AES256 is not needed here in 0.\+9.\+9.

With the change, we also introduce new ciphersuite aliases that so far were missing\+: "{}\+AES128"{}, "{}\+AES256"{}, "{}\+CAMELLIA128"{}, and "{}\+CAMELLIA256"{}.

{\itshape Bodo Moeller}
\item Add support for dsa-\/with-\/\+SHA224 and dsa-\/with-\/\+SHA256. Use the leftmost N bytes of the signature input if the input is larger than the prime q (with N being the size in bytes of q).

{\itshape Nils Larsch}
\item Very {\itshape very} experimental PKCS\#7 streaming encoder support. Nothing uses it yet and it is largely untested.

{\itshape Steve Henson}
\item Add support for the ecdsa-\/with-\/\+SHA224/256/384/512 signature types.

{\itshape Nils Larsch}
\item Initial incomplete changes to avoid need for function casts in Open\+SSL some compilers (gcc 4.\+2 and later) reject their use. Safestack is reimplemented. Update ASN1 to avoid use of legacy functions.

{\itshape Steve Henson}
\item Win32/64 targets are linked with Winsock2.

{\itshape Andy Polyakov}
\item Add an X509\+\_\+\+CRL\+\_\+\+METHOD structure to allow CRL processing to be redirected to external functions. This can be used to increase CRL handling efficiency especially when CRLs are very large by (for example) storing the CRL revoked certificates in a database.

{\itshape Steve Henson}
\item Overhaul of by\+\_\+dir code. Add support for dynamic loading of CRLs so new CRLs added to a directory can be used. New command line option -\/verify\+\_\+return\+\_\+error to s\+\_\+client and s\+\_\+server. This causes real errors to be returned by the verify callback instead of carrying on no matter what. This reflects the way a "{}real world"{} verify callback would behave.

{\itshape Steve Henson}
\item GOST engine, supporting several GOST algorithms and public key formats. Kindly donated by Cryptocom.

{\itshape Cryptocom}
\item Partial support for Issuing Distribution Point CRL extension. CRLs partitioned by DP are handled but no indirect CRL or reason partitioning (yet). Complete overhaul of CRL handling\+: now the most suitable CRL is selected via a scoring technique which handles IDP and AKID in CRLs.

{\itshape Steve Henson}
\item New X509\+\_\+\+STORE\+\_\+\+CTX callbacks lookup\+\_\+crls() and lookup\+\_\+certs() which will ultimately be used for all verify operations\+: this will remove the X509\+\_\+\+STORE dependency on certificate verification and allow alternative lookup methods. X509\+\_\+\+STORE based implementations of these two callbacks.

{\itshape Steve Henson}
\item Allow multiple CRLs to exist in an X509\+\_\+\+STORE with matching issuer names. Modify get\+\_\+crl() to find a valid (unexpired) CRL if possible.

{\itshape Steve Henson}
\item New function X509\+\_\+\+CRL\+\_\+match() to check if two CRLs are identical. Normally this would be called X509\+\_\+\+CRL\+\_\+cmp() but that name is already used by a function that just compares CRL issuer names. Cache several CRL extensions in X509\+\_\+\+CRL structure and cache CRLDP in X509.

{\itshape Steve Henson}
\item Store a "{}canonical"{} representation of X509\+\_\+\+NAME structure (ASN1 Name) this maps equivalent X509\+\_\+\+NAME structures into a consistent structure. Name comparison can then be performed rapidly using memcmp().

{\itshape Steve Henson}
\item Non-\/blocking OCSP request processing. Add -\/timeout option to ocsp utility.

{\itshape Steve Henson}
\item Allow digests to supply their own micalg string for S/\+MIME type using the ctrl EVP\+\_\+\+MD\+\_\+\+CTRL\+\_\+\+MICALG.

{\itshape Steve Henson}
\item During PKCS7 signing pass the PKCS7 Signer\+Info structure to the EVP\+\_\+\+PKEY\+\_\+\+METHOD before and after signing via the EVP\+\_\+\+PKEY\+\_\+\+CTRL\+\_\+\+PKCS7\+\_\+\+SIGN ctrl. It can then customise the structure before and/or after signing if necessary.

{\itshape Steve Henson}
\item New function OBJ\+\_\+add\+\_\+sigid() to allow application defined signature OIDs to be added to Open\+SSLs internal tables. New function OBJ\+\_\+sigid\+\_\+free() to free up any added signature OIDs.

{\itshape Steve Henson}
\item New functions EVP\+\_\+\+CIPHER\+\_\+do\+\_\+all(), EVP\+\_\+\+CIPHER\+\_\+do\+\_\+all\+\_\+sorted(), EVP\+\_\+\+MD\+\_\+do\+\_\+all() and EVP\+\_\+\+MD\+\_\+do\+\_\+all\+\_\+sorted() to enumerate internal digest and cipher tables. New options added to openssl utility\+: list-\/message-\/digest-\/algorithms and list-\/cipher-\/algorithms.

{\itshape Steve Henson}
\item Change the array representation of binary polynomials\+: the list of degrees of non-\/zero coefficients is now terminated with -\/1. Previously it was terminated with 0, which was also part of the value; thus, the array representation was not applicable to polynomials where t\texorpdfstring{$^\wedge$}{\string^}0 has coefficient zero. This change makes the array representation useful in a more general context.

{\itshape Douglas Stebila}
\item Various modifications and fixes to SSL/\+TLS cipher string handling. For ECC, the code now distinguishes between fixed ECDH with RSA certificates on the one hand and with ECDSA certificates on the other hand, since these are separate ciphersuites. The unused code for Fortezza ciphersuites has been removed.

For consistency with EDH, ephemeral ECDH is now called "{}\+EECDH"{} (not "{}\+ECDHE"{}). For consistency with the code for DH certificates, use of ECDH certificates is now considered ECDH authentication, not RSA or ECDSA authentication (the latter is merely the CA\textquotesingle{}s signing algorithm and not actively used in the protocol).

The temporary ciphersuite alias "{}\+ECCdraft"{} is no longer available, and ECC ciphersuites are no longer excluded from "{}\+ALL"{} and "{}\+DEFAULT"{}. The following aliases now exist for RFC 4492 ciphersuites, most of these by analogy with the DH case\+: \begin{DoxyVerb}    kECDHr   - ECDH cert, signed with RSA
    kECDHe   - ECDH cert, signed with ECDSA
    kECDH    - ECDH cert (signed with either RSA or ECDSA)
    kEECDH   - ephemeral ECDH
    ECDH     - ECDH cert or ephemeral ECDH

    aECDH    - ECDH cert
    aECDSA   - ECDSA cert
    ECDSA    - ECDSA cert

    AECDH    - anonymous ECDH
    EECDH    - non-anonymous ephemeral ECDH (equivalent to "kEECDH:-AECDH")
\end{DoxyVerb}
 {\itshape Bodo Moeller}
\item Add additional S/\+MIME capabilities for AES and GOST ciphers if supported. Use correct micalg parameters depending on digest(s) in signed message.

{\itshape Steve Henson}
\item Add engine support for EVP\+\_\+\+PKEY\+\_\+\+ASN1\+\_\+\+METHOD. Add functions to process an ENGINE asn1 method. Support ENGINE lookups in the ASN1 code.

{\itshape Steve Henson}
\item Initial engine support for EVP\+\_\+\+PKEY\+\_\+\+METHOD. New functions to permit an engine to register a method. Add ENGINE lookups for methods and functional reference processing.

{\itshape Steve Henson}
\item New functions {\ttfamily EVP\+\_\+\+Digest\{Sign,Verify)\texorpdfstring{$\ast$}{*}}. These are enhanced versions of {\ttfamily EVP\+\_\+\{Sign,Verify\}\texorpdfstring{$\ast$}{*}} which allow an application to customise the signature process.

{\itshape Steve Henson}
\item New -\/resign option to smime utility. This adds one or more signers to an existing PKCS\#7 signed\+Data structure. Also -\/md option to use an alternative message digest algorithm for signing.

{\itshape Steve Henson}
\item Tidy up PKCS\#7 routines and add new functions to make it easier to create PKCS7 structures containing multiple signers. Update smime application to support multiple signers.

{\itshape Steve Henson}
\item New -\/macalg option to pkcs12 utility to allow setting of an alternative digest MAC.

{\itshape Steve Henson}
\item Initial support for PKCS\#5 v2.\+0 PRFs other than default SHA1 HMAC. Reorganize PBE internals to lookup from a static table using NIDs, add support for HMAC PBE OID translation. Add a EVP\+\_\+\+CIPHER ctrl\+: EVP\+\_\+\+CTRL\+\_\+\+PBE\+\_\+\+PRF\+\_\+\+NID this allows a cipher to specify an alternative PRF which will be automatically used with PBES2.

{\itshape Steve Henson}
\item Replace the algorithm specific calls to generate keys in "{}req"{} with the new API.

{\itshape Steve Henson}
\item Update PKCS\#7 enveloped data routines to use new API. This is now supported by any public key method supporting the encrypt operation. A ctrl is added to allow the public key algorithm to examine or modify the PKCS\#7 Recipient\+Info structure if it needs to\+: for RSA this is a no op.

{\itshape Steve Henson}
\item Add a ctrl to asn1 method to allow a public key algorithm to express a default digest type to use. In most cases this will be SHA1 but some algorithms (such as GOST) need to specify an alternative digest. The return value indicates how strong the preference is 1 means optional and 2 is mandatory (that is it is the only supported type). Modify ASN1\+\_\+item\+\_\+sign() to accept a NULL digest argument to indicate it should use the default md. Update openssl utilities to use the default digest type for signing if it is not explicitly indicated.

{\itshape Steve Henson}
\item Use OID cross reference table in ASN1\+\_\+sign() and ASN1\+\_\+verify(). New EVP\+\_\+\+MD flag EVP\+\_\+\+MD\+\_\+\+FLAG\+\_\+\+PKEY\+\_\+\+METHOD\+\_\+\+SIGNATURE. This uses the relevant signing method from the key type. This effectively removes the link between digests and public key types.

{\itshape Steve Henson}
\item Add an OID cross reference table and utility functions. Its purpose is to translate between signature OIDs such as SHA1\+Withrsa\+Encryption and SHA1, rsa\+Encryption. This will allow some of the algorithm specific hackery needed to use the correct OID to be removed.

{\itshape Steve Henson}
\item Remove algorithm specific dependencies when setting PKCS7\+\_\+\+SIGNER\+\_\+\+INFO structures for PKCS7\+\_\+sign(). They are now set up by the relevant public key ASN1 method.

{\itshape Steve Henson}
\item Add provisional EC pkey method with support for ECDSA and ECDH.

{\itshape Steve Henson}
\item Add support for key derivation (agreement) in the API, DH method and pkeyutl.

{\itshape Steve Henson}
\item Add DSA pkey method and DH pkey methods, extend DH ASN1 method to support public and private key formats. As a side effect these add additional command line functionality not previously available\+: DSA signatures can be generated and verified using pkeyutl and DH key support and generation in pkey, genpkey.

{\itshape Steve Henson}
\item Be\+OS support.

\texorpdfstring{$\ast$}{*}\+Oliver Tappe \href{mailto:zooey@hirschkaefer.de}{\texttt{ zooey@hirschkaefer.\+de}}\texorpdfstring{$\ast$}{*}
\item New make target "{}install\+\_\+html\+\_\+docs"{} installs HTML renditions of the manual pages.

\texorpdfstring{$\ast$}{*}\+Oliver Tappe \href{mailto:zooey@hirschkaefer.de}{\texttt{ zooey@hirschkaefer.\+de}}\texorpdfstring{$\ast$}{*}
\item New utility "{}genpkey"{} this is analogous to "{}genrsa"{} etc except it can generate keys for any algorithm. Extend and update EVP\+\_\+\+PKEY\+\_\+\+METHOD to support key and parameter generation and add initial key generation functionality for RSA.

{\itshape Steve Henson}
\item Add functions for main EVP\+\_\+\+PKEY\+\_\+method operations. The undocumented functions {\ttfamily EVP\+\_\+\+PKEY\+\_\+\{encrypt,decrypt\}} have been renamed to {\ttfamily EVP\+\_\+\+PKEY\+\_\+\{encrypt,decrypt\}\+\_\+old}.

{\itshape Steve Henson}
\item Initial definitions for EVP\+\_\+\+PKEY\+\_\+\+METHOD. This will be a high level public key API, doesn\textquotesingle{}t do much yet.

{\itshape Steve Henson}
\item New function EVP\+\_\+\+PKEY\+\_\+asn1\+\_\+get0\+\_\+info() to retrieve information about public key algorithms. New option to openssl utility\+: "{}list-\/public-\/key-\/algorithms"{} to print out info.

{\itshape Steve Henson}
\item Implement the Supported Elliptic Curves Extension for ECC ciphersuites from draft-\/ietf-\/tls-\/ecc-\/12.\+txt.

{\itshape Douglas Stebila}
\item Don\textquotesingle{}t free up OIDs in OBJ\+\_\+cleanup() if they are in use by EVP\+\_\+\+MD or EVP\+\_\+\+CIPHER structures to avoid later problems in EVP\+\_\+cleanup().

{\itshape Steve Henson}
\item New utilities pkey and pkeyparam. These are similar to algorithm specific utilities such as rsa, dsa, dsaparam etc except they process any key type.

{\itshape Steve Henson}
\item Transfer public key printing routines to EVP\+\_\+\+PKEY\+\_\+\+ASN1\+\_\+\+METHOD. New functions EVP\+\_\+\+PKEY\+\_\+print\+\_\+public(), EVP\+\_\+\+PKEY\+\_\+print\+\_\+private(), EVP\+\_\+\+PKEY\+\_\+print\+\_\+param() to print public key data from an EVP\+\_\+\+PKEY structure.

{\itshape Steve Henson}
\item Initial support for pluggable public key ASN1. De-\/spaghettify the public key ASN1 handling. Move public and private key ASN1 handling to a new EVP\+\_\+\+PKEY\+\_\+\+ASN1\+\_\+\+METHOD structure. Relocate algorithm specific handling to a single module within the relevant algorithm directory. Add functions to allow (near) opaque processing of public and private key structures.

{\itshape Steve Henson}
\item Implement the Supported Point Formats Extension for ECC ciphersuites from draft-\/ietf-\/tls-\/ecc-\/12.\+txt.

{\itshape Douglas Stebila}
\item Add initial support for RFC 4279 PSK TLS ciphersuites. Add members for the psk identity \mbox{[}hint\mbox{]} and the psk callback functions to the SSL\+\_\+\+SESSION, SSL and SSL\+\_\+\+CTX structure.

New ciphersuites\+: PSK-\/\+RC4-\/\+SHA, PSK-\/3\+DES-\/\+EDE-\/\+CBC-\/\+SHA, PSK-\/\+AES128-\/\+CBC-\/\+SHA, PSK-\/\+AES256-\/\+CBC-\/\+SHA

New functions\+: SSL\+\_\+\+CTX\+\_\+use\+\_\+psk\+\_\+identity\+\_\+hint SSL\+\_\+get\+\_\+psk\+\_\+identity\+\_\+hint SSL\+\_\+get\+\_\+psk\+\_\+identity SSL\+\_\+use\+\_\+psk\+\_\+identity\+\_\+hint

{\itshape Mika Kousa and Pasi Eronen of Nokia Corporation}
\item Add RFC 3161 compliant time stamp request creation, response generation and response verification functionality.

\texorpdfstring{$\ast$}{*}\+Zoltán Glózik \href{mailto:zglozik@opentsa.org}{\texttt{ zglozik@opentsa.\+org}}, The Open\+TSA Project\texorpdfstring{$\ast$}{*}
\item Add initial support for TLS extensions, specifically for the server\+\_\+name extension so far. The SSL\+\_\+\+SESSION, SSL\+\_\+\+CTX, and SSL data structures now have new members for a hostname. The SSL data structure has an additional member {\ttfamily SSL\+\_\+\+CTX \texorpdfstring{$\ast$}{*}initial\+\_\+ctx} so that new sessions can be stored in that context to allow for session resumption, even after the SSL has been switched to a new SSL\+\_\+\+CTX in reaction to a client\textquotesingle{}s server\+\_\+name extension.

New functions (subject to change)\+: \begin{DoxyVerb}    SSL_get_servername()
    SSL_get_servername_type()
    SSL_set_SSL_CTX()
\end{DoxyVerb}
 New CTRL codes and macros (subject to change)\+: \begin{DoxyVerb}    SSL_CTRL_SET_TLSEXT_SERVERNAME_CB
                        - SSL_CTX_set_tlsext_servername_callback()
    SSL_CTRL_SET_TLSEXT_SERVERNAME_ARG
                             - SSL_CTX_set_tlsext_servername_arg()
    SSL_CTRL_SET_TLSEXT_HOSTNAME           - SSL_set_tlsext_host_name()
\end{DoxyVerb}
 openssl s\+\_\+client has a new \textquotesingle{}-\/servername ...\textquotesingle{} option.

openssl s\+\_\+server has new options \textquotesingle{}-\/servername\+\_\+host ...\textquotesingle{}, \textquotesingle{}-\/cert2 ...\textquotesingle{}, \textquotesingle{}-\/key2 ...\textquotesingle{}, \textquotesingle{}-\/servername\+\_\+fatal\textquotesingle{} (subject to change). This allows testing the Host\+Name extension for a specific single hostname (\textquotesingle{}-\/cert\textquotesingle{} and \textquotesingle{}-\/key\textquotesingle{} remain fallbacks for handshakes without Host\+Name negotiation). If the unrecognized\+\_\+name alert has to be sent, this by default is a warning; it becomes fatal with the \textquotesingle{}-\/servername\+\_\+fatal\textquotesingle{} option.

{\itshape Peter Sylvester, Remy Allais, Christophe Renou}
\item Whirlpool hash implementation is added.

{\itshape Andy Polyakov}
\item BIGNUM code on 64-\/bit SPARCv9 targets is switched from bn(64,64) to bn(64,32). Because of instruction set limitations it doesn\textquotesingle{}t have any negative impact on performance. This was done mostly in order to make it possible to share assembler modules, such as bn\+\_\+mul\+\_\+mont implementations, between 32-\/ and 64-\/bit builds without hassle.

{\itshape Andy Polyakov}
\item Move code previously exiled into file crypto/ec/ec2\+\_\+smpt.\+c to ec2\+\_\+smpl.\+c, and no longer require the OPENSSL\+\_\+\+EC\+\_\+\+BIN\+\_\+\+PT\+\_\+\+COMP macro.

{\itshape Bodo Moeller}
\item New candidate for BIGNUM assembler implementation, bn\+\_\+mul\+\_\+mont, dedicated Montgomery multiplication procedure, is introduced. BN\+\_\+\+MONT\+\_\+\+CTX is modified to allow bn\+\_\+mul\+\_\+mont to reach for higher "{}64-\/bit"{} performance on certain 32-\/bit targets.

{\itshape Andy Polyakov}
\item New option SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+COMP to disable use of compression selectively in SSL structures. New SSL ctrl to set maximum send fragment size. Save memory by setting the I/O buffer sizes dynamically instead of using the maximum available value.

{\itshape Steve Henson}
\item New option -\/V for \textquotesingle{}openssl ciphers\textquotesingle{}. This prints the ciphersuite code in addition to the text details.

{\itshape Bodo Moeller}
\item Very, very preliminary EXPERIMENTAL support for printing of general ASN1 structures. This currently produces rather ugly output and doesn\textquotesingle{}t handle several customised structures at all.

{\itshape Steve Henson}
\item Integrated support for PVK file format and some related formats such as MS PUBLICKEYBLOB and PRIVATEKEYBLOB. Command line switches to support these in the \textquotesingle{}rsa\textquotesingle{} and \textquotesingle{}dsa\textquotesingle{} utilities.

{\itshape Steve Henson}
\item Support for PKCS\#1 RSAPublic\+Key format on rsa utility command line.

{\itshape Steve Henson}
\item Remove the ancient ASN1\+\_\+\+METHOD code. This was only ever used in one place for the (very old) "{}\+NETSCAPE"{} format certificates which are now handled using new ASN1 code equivalents.

{\itshape Steve Henson}
\item Let the TLSv1\+\_\+method() etc. functions return a \textquotesingle{}const\textquotesingle{} SSL\+\_\+\+METHOD pointer and make the SSL\+\_\+\+METHOD parameter in SSL\+\_\+\+CTX\+\_\+new, SSL\+\_\+\+CTX\+\_\+set\+\_\+ssl\+\_\+version and SSL\+\_\+set\+\_\+ssl\+\_\+method \textquotesingle{}const\textquotesingle{}.

{\itshape Nils Larsch}
\item Modify CRL distribution points extension code to print out previously unsupported fields. Enhance extension setting code to allow setting of all fields.

{\itshape Steve Henson}
\item Add print and set support for Issuing Distribution Point CRL extension.

{\itshape Steve Henson}
\item Change \textquotesingle{}Configure\textquotesingle{} script to enable Camellia by default.

{\itshape NTT}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md119}{}\doxysection{\texorpdfstring{Open\+SSL 0.\+9.\+x}{Open\+SSL 0.\+9.\+x}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md119}
\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md120}{}\doxysubsection{\texorpdfstring{Changes between 0.\+9.\+8m and 0.\+9.\+8n \mbox{[}24 Mar 2010\mbox{]}}{Changes between 0.\+9.\+8m and 0.\+9.\+8n \mbox{[}24 Mar 2010\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md120}

\begin{DoxyItemize}
\item When rejecting SSL/\+TLS records due to an incorrect version number, never update s-\/\texorpdfstring{$>$}{>}server with a new major version number. As of
\begin{DoxyItemize}
\item Open\+SSL 0.\+9.\+8m if \textquotesingle{}short\textquotesingle{} is a 16-\/bit type,
\item Open\+SSL 0.\+9.\+8f if \textquotesingle{}short\textquotesingle{} is longer than 16 bits, the previous behavior could result in a read attempt at NULL when receiving specific incorrect SSL/\+TLS records once record payload protection is active. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2010-0740}{\texttt{ CVE-\/2010-\/0740}})
\end{DoxyItemize}

\texorpdfstring{$\ast$}{*}\+Bodo Moeller, Adam Langley \href{mailto:agl@chromium.org}{\texttt{ agl@chromium.\+org}}\texorpdfstring{$\ast$}{*}
\item Fix for CVE-\/2010-\/0433 where some kerberos enabled versions of Open\+SSL could be crashed if the relevant tables were not present (e.\+g. chrooted).

\texorpdfstring{$\ast$}{*}\+Tomas Hoger \href{mailto:thoger@redhat.com}{\texttt{ thoger@redhat.\+com}}\texorpdfstring{$\ast$}{*}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md121}{}\doxysubsection{\texorpdfstring{Changes between 0.\+9.\+8l and 0.\+9.\+8m \mbox{[}25 Feb 2010\mbox{]}}{Changes between 0.\+9.\+8l and 0.\+9.\+8m \mbox{[}25 Feb 2010\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md121}

\begin{DoxyItemize}
\item Always check bn\+\_\+wexpand() return values for failure. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2009-3245}{\texttt{ CVE-\/2009-\/3245}})

{\itshape Martin Olsson, Neel Mehta}
\item Fix X509\+\_\+\+STORE locking\+: Every \textquotesingle{}objs\textquotesingle{} access requires a lock (to accommodate for stack sorting, always a write lock!).

{\itshape Bodo Moeller}
\item On some versions of WIN32 Heap32\+Next is very slow. This can cause excessive delays in the RAND\+\_\+poll()\+: over a minute. As a workaround include a time check in the inner Heap32\+Next loop too.

{\itshape Steve Henson}
\item The code that handled flushing of data in SSL/\+TLS originally used the BIO\+\_\+\+CTRL\+\_\+\+INFO ctrl to see if any data was pending first. This caused the problem outlined in PR\#1949. The fix suggested there however can trigger problems with buggy BIO\+\_\+\+CTRL\+\_\+\+WPENDING (e.\+g. some versions of Apache). So instead simplify the code to flush unconditionally. This should be fine since flushing with no data to flush is a no op.

{\itshape Steve Henson}
\item Handle TLS versions 2.\+0 and later properly and correctly use the highest version of TLS/\+SSL supported. Although TLS \texorpdfstring{$>$}{>}= 2.\+0 is some way off ancient servers have a habit of sticking around for a while...

{\itshape Steve Henson}
\item Modify compression code so it frees up structures without using the ex\+\_\+data callbacks. This works around a problem where some applications call CRYPTO\+\_\+cleanup\+\_\+all\+\_\+ex\+\_\+data() before application exit (e.\+g. when restarting) then use compression (e.\+g. SSL with compression) later. This results in significant per-\/connection memory leaks and has caused some security issues including CVE-\/2008-\/1678 and CVE-\/2009-\/4355.

{\itshape Steve Henson}
\item Constify crypto/cast (i.\+e., \texorpdfstring{$<$}{<}\doxylink{cast_8h_source}{openssl/cast.\+h}\texorpdfstring{$>$}{>})\+: a CAST\+\_\+\+KEY doesn\textquotesingle{}t change when encrypting or decrypting.

{\itshape Bodo Moeller}
\item Add option SSL\+\_\+\+OP\+\_\+\+LEGACY\+\_\+\+SERVER\+\_\+\+CONNECT which will allow clients to connect and renegotiate with servers which do not support RI. Until RI is more widely deployed this option is enabled by default.

{\itshape Steve Henson}
\item Add "{}missing"{} ssl ctrls to clear options and mode.

{\itshape Steve Henson}
\item If client attempts to renegotiate and doesn\textquotesingle{}t support RI respond with a no\+\_\+renegotiation alert as required by RFC5746. Some renegotiating TLS clients will continue a connection gracefully when they receive the alert. Unfortunately Open\+SSL mishandled this alert and would hang waiting for a server hello which it will never receive. Now we treat a received no\+\_\+renegotiation alert as a fatal error. This is because applications requesting a renegotiation might well expect it to succeed and would have no code in place to handle the server denying it so the only safe thing to do is to terminate the connection.

{\itshape Steve Henson}
\item Add ctrl macro SSL\+\_\+get\+\_\+secure\+\_\+renegotiation\+\_\+support() which returns 1 if peer supports secure renegotiation and 0 otherwise. Print out peer renegotiation support in s\+\_\+client/s\+\_\+server.

{\itshape Steve Henson}
\item Replace the highly broken and deprecated SPKAC certification method with the updated NID creation version. This should correctly handle UTF8.

{\itshape Steve Henson}
\item Implement RFC5746. Re-\/enable renegotiation but require the extension as needed. Unfortunately, SSL3\+\_\+\+FLAGS\+\_\+\+ALLOW\+\_\+\+UNSAFE\+\_\+\+LEGACY\+\_\+\+RENEGOTIATION turns out to be a bad idea. It has been replaced by SSL\+\_\+\+OP\+\_\+\+ALLOW\+\_\+\+UNSAFE\+\_\+\+LEGACY\+\_\+\+RENEGOTIATION which can be set with SSL\+\_\+\+CTX\+\_\+set\+\_\+options(). This is really not recommended unless you know what you are doing.

\texorpdfstring{$\ast$}{*}\+Eric Rescorla \href{mailto:ekr@networkresonance.com}{\texttt{ ekr@networkresonance.\+com}}, Ben Laurie, Steve Henson\texorpdfstring{$\ast$}{*}
\item Fixes to stateless session resumption handling. Use initial\+\_\+ctx when issuing and attempting to decrypt tickets in case it has changed during servername handling. Use a non-\/zero length session ID when attempting stateless session resumption\+: this makes it possible to determine if a resumption has occurred immediately after receiving server hello (several places in Open\+SSL subtly assume this) instead of later in the handshake.

{\itshape Steve Henson}
\item The functions ENGINE\+\_\+ctrl(), OPENSSL\+\_\+isservice(), CMS\+\_\+get1\+\_\+\+Recipient\+Request() and RAND\+\_\+bytes() can return \texorpdfstring{$<$}{<}=0 on error fixes for a few places where the return code is not checked correctly.

\texorpdfstring{$\ast$}{*}\+Julia Lawall \href{mailto:julia@diku.dk}{\texttt{ julia@diku.\+dk}}\texorpdfstring{$\ast$}{*}
\item Add --strict-\/warnings option to Configure script to include devteam warnings in other configurations.

{\itshape Steve Henson}
\item Add support for --libdir option and LIBDIR variable in makefiles. This makes it possible to install openssl libraries in locations which have names other than "{}lib"{}, for example "{}/usr/lib64"{} which some systems need.

{\itshape Steve Henson, based on patch from Jeremy Utley}
\item Don\textquotesingle{}t allow the use of leading 0x80 in OIDs. This is a violation of X690 8.\+9.\+12 and can produce some misleading textual output of OIDs.

{\itshape Steve Henson, reported by Dan Kaminsky}
\item Delete MD2 from algorithm tables. This follows the recommendation in several standards that it is not used in new applications due to several cryptographic weaknesses. For binary compatibility reasons the MD2 API is still compiled in by default.

{\itshape Steve Henson}
\item Add compression id to \{d2i,i2d\}\+\_\+\+SSL\+\_\+\+SESSION so it is correctly saved and restored.

{\itshape Steve Henson}
\item Rename uni2asc and asc2uni functions to OPENSSL\+\_\+uni2asc and OPENSSL\+\_\+asc2uni conditionally on Netware platforms to avoid a name clash.

\texorpdfstring{$\ast$}{*}\+Guenter \href{mailto:lists@gknw.net}{\texttt{ lists@gknw.\+net}}\texorpdfstring{$\ast$}{*}
\item Fix the server certificate chain building code to use X509\+\_\+verify\+\_\+cert(), it used to have an ad-\/hoc builder which was unable to cope with anything other than a simple chain.

\texorpdfstring{$\ast$}{*}\+David Woodhouse \href{mailto:dwmw2@infradead.org}{\texttt{ dwmw2@infradead.\+org}}, Steve Henson\texorpdfstring{$\ast$}{*}
\item Don\textquotesingle{}t check self signed certificate signatures in X509\+\_\+verify\+\_\+cert() by default (a flag can override this)\+: it just wastes time without adding any security. As a useful side effect self signed root CAs with non-\/\+FIPS digests are now usable in FIPS mode.

{\itshape Steve Henson}
\item In dtls1\+\_\+process\+\_\+out\+\_\+of\+\_\+seq\+\_\+message() the check if the current message is already buffered was missing. For every new message was memory allocated, allowing an attacker to perform an denial of service attack with sending out of seq handshake messages until there is no memory left. Additionally every future message was buffered, even if the sequence number made no sense and would be part of another handshake. So only messages with sequence numbers less than 10 in advance will be buffered. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2009-1378}{\texttt{ CVE-\/2009-\/1378}})

{\itshape Robin Seggelmann, discovered by Daniel Mentz}
\item Records are buffered if they arrive with a future epoch to be processed after finishing the corresponding handshake. There is currently no limitation to this buffer allowing an attacker to perform a DOS attack with sending records with future epochs until there is no memory left. This patch adds the pqueue\+\_\+size() function to determine the size of a buffer and limits the record buffer to 100 entries. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2009-1377}{\texttt{ CVE-\/2009-\/1377}})

{\itshape Robin Seggelmann, discovered by Daniel Mentz}
\item Keep a copy of frag-\/\texorpdfstring{$>$}{>}msg\+\_\+header.\+frag\+\_\+len so it can be used after the parent structure is freed. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2009-1379}{\texttt{ CVE-\/2009-\/1379}})

{\itshape Daniel Mentz}
\item Handle non-\/blocking I/O properly in SSL\+\_\+shutdown() call.

\texorpdfstring{$\ast$}{*}\+Darryl Miles \href{mailto:darryl-mailinglists@netbauds.net}{\texttt{ darryl-\/mailinglists@netbauds.\+net}}\texorpdfstring{$\ast$}{*}
\item Add {\ttfamily 2.\+5.\+4.\texorpdfstring{$\ast$}{*}} OIDs

\texorpdfstring{$\ast$}{*}\+Ilya O. \href{mailto:vrghost@gmail.com}{\texttt{ vrghost@gmail.\+com}}\texorpdfstring{$\ast$}{*}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md122}{}\doxysubsection{\texorpdfstring{Changes between 0.\+9.\+8k and 0.\+9.\+8l \mbox{[}5 Nov 2009\mbox{]}}{Changes between 0.\+9.\+8k and 0.\+9.\+8l \mbox{[}5 Nov 2009\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md122}

\begin{DoxyItemize}
\item Disable renegotiation completely -\/ this fixes a severe security problem (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2009-3555}{\texttt{ CVE-\/2009-\/3555}}) at the cost of breaking all renegotiation. Renegotiation can be re-\/enabled by setting SSL3\+\_\+\+FLAGS\+\_\+\+ALLOW\+\_\+\+UNSAFE\+\_\+\+LEGACY\+\_\+\+RENEGOTIATION in s3-\/\texorpdfstring{$>$}{>}flags at run-\/time. This is really not recommended unless you know what you\textquotesingle{}re doing.

{\itshape Ben Laurie}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md123}{}\doxysubsection{\texorpdfstring{Changes between 0.\+9.\+8j and 0.\+9.\+8k \mbox{[}25 Mar 2009\mbox{]}}{Changes between 0.\+9.\+8j and 0.\+9.\+8k \mbox{[}25 Mar 2009\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md123}

\begin{DoxyItemize}
\item Don\textquotesingle{}t set val to NULL when freeing up structures, it is freed up by underlying code. If {\ttfamily sizeof(void \texorpdfstring{$\ast$}{*}) \texorpdfstring{$>$}{>} sizeof(long)} this can result in zeroing past the valid field. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2009-0789}{\texttt{ CVE-\/2009-\/0789}})

\texorpdfstring{$\ast$}{*}\+Paolo Ganci \href{mailto:Paolo.Ganci@AdNovum.CH}{\texttt{ Paolo.\+Ganci@\+Ad\+Novum.\+CH}}\texorpdfstring{$\ast$}{*}
\item Fix bug where return value of CMS\+\_\+\+Signer\+Info\+\_\+verify\+\_\+content() was not checked correctly. This would allow some invalid signed attributes to appear to verify correctly. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2009-0591}{\texttt{ CVE-\/2009-\/0591}})

\texorpdfstring{$\ast$}{*}\+Ivan Nestlerode \href{mailto:inestlerode@us.ibm.com}{\texttt{ inestlerode@us.\+ibm.\+com}}\texorpdfstring{$\ast$}{*}
\item Reject Universal\+String and BMPString types with invalid lengths. This prevents a crash in ASN1\+\_\+\+STRING\+\_\+print\+\_\+ex() which assumes the strings have a legal length. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2009-0590}{\texttt{ CVE-\/2009-\/0590}})

{\itshape Steve Henson}
\item Set S/\+MIME signing as the default purpose rather than setting it unconditionally. This allows applications to override it at the store level.

{\itshape Steve Henson}
\item Permit restricted recursion of ASN1 strings. This is needed in practice to handle some structures.

{\itshape Steve Henson}
\item Improve efficiency of mem\+\_\+gets\+: don\textquotesingle{}t search whole buffer each time for a \textquotesingle{}~\newline
\textquotesingle{}

\texorpdfstring{$\ast$}{*}\+Jeremy Shapiro \href{mailto:jnshapir@us.ibm.com}{\texttt{ jnshapir@us.\+ibm.\+com}}\texorpdfstring{$\ast$}{*}
\item New -\/hex option for openssl rand.

{\itshape Matthieu Herrb}
\item Print out UTF8\+String and Numeric\+String when parsing ASN1.

{\itshape Steve Henson}
\item Support Numeric\+String type for name components.

{\itshape Steve Henson}
\item Allow CC in the environment to override the automatically chosen compiler. Note that nothing is done to ensure flags work with the chosen compiler.

{\itshape Ben Laurie}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md124}{}\doxysubsection{\texorpdfstring{Changes between 0.\+9.\+8i and 0.\+9.\+8j \mbox{[}07 Jan 2009\mbox{]}}{Changes between 0.\+9.\+8i and 0.\+9.\+8j \mbox{[}07 Jan 2009\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md124}

\begin{DoxyItemize}
\item Properly check EVP\+\_\+\+Verify\+Final() and similar return values (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2008-5077}{\texttt{ CVE-\/2008-\/5077}}).

{\itshape Ben Laurie, Bodo Moeller, Google Security Team}
\item Enable TLS extensions by default.

{\itshape Ben Laurie}
\item Allow the CHIL engine to be loaded, whether the application is multithreaded or not. (This does not release the developer from the obligation to set up the dynamic locking callbacks.)

\texorpdfstring{$\ast$}{*}\+Sander Temme \href{mailto:sander@temme.net}{\texttt{ sander@temme.\+net}}\texorpdfstring{$\ast$}{*}
\item Use correct exit code if there is an error in dgst command.

{\itshape Steve Henson; problem pointed out by Roland Dirlewanger}
\item Tweak Configure so that you need to say "{}experimental-\/jpake"{} to enable JPAKE, and need to use -\/DOPENSSL\+\_\+\+EXPERIMENTAL\+\_\+\+JPAKE in applications.

{\itshape Bodo Moeller}
\item Add experimental JPAKE support, including demo authentication in s\+\_\+client and s\+\_\+server.

{\itshape Ben Laurie}
\item Set the comparison function in v3\+\_\+addr\+\_\+canonize().

\texorpdfstring{$\ast$}{*}\+Rob Austein \href{mailto:sra@hactrn.net}{\texttt{ sra@hactrn.\+net}}\texorpdfstring{$\ast$}{*}
\item Add support for XMPP STARTTLS in s\+\_\+client.

\texorpdfstring{$\ast$}{*}\+Philip Paeps \href{mailto:philip@freebsd.org}{\texttt{ philip@freebsd.\+org}}\texorpdfstring{$\ast$}{*}
\item Change the server-\/side SSL\+\_\+\+OP\+\_\+\+NETSCAPE\+\_\+\+REUSE\+\_\+\+CIPHER\+\_\+\+CHANGE\+\_\+\+BUG behavior to ensure that even with this option, only ciphersuites in the server\textquotesingle{}s preference list will be accepted. (Note that the option applies only when resuming a session, so the earlier behavior was just about the algorithm choice for symmetric cryptography.)

{\itshape Bodo Moeller}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md125}{}\doxysubsection{\texorpdfstring{Changes between 0.\+9.\+8h and 0.\+9.\+8i \mbox{[}15 Sep 2008\mbox{]}}{Changes between 0.\+9.\+8h and 0.\+9.\+8i \mbox{[}15 Sep 2008\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md125}

\begin{DoxyItemize}
\item Fix NULL pointer dereference if a DTLS server received Change\+Cipher\+Spec as first record (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2009-1386}{\texttt{ CVE-\/2009-\/1386}}).

{\itshape PR \#1679}
\item Fix a state transition in s3\+\_\+srvr.\+c and d1\+\_\+srvr.\+c (was using SSL3\+\_\+\+ST\+\_\+\+CW\+\_\+\+CLNT\+\_\+\+HELLO\+\_\+B, should be {\ttfamily ...\+\_\+\+ST\+\_\+\+SW\+\_\+\+SRVR\+\_\+...}).

{\itshape Nagendra Modadugu}
\item The fix in 0.\+9.\+8c that supposedly got rid of unsafe double-\/checked locking was incomplete for RSA blinding, addressing just one layer of what turns out to have been doubly unsafe triple-\/checked locking.

So now fix this for real by retiring the MONT\+\_\+\+HELPER macro in crypto/rsa/rsa\+\_\+eay.\+c.

{\itshape Bodo Moeller; problem pointed out by Marius Schilder}
\item Various precautionary measures\+:
\begin{DoxyItemize}
\item Avoid size\+\_\+t integer overflow in HASH\+\_\+\+UPDATE (\doxylink{md32__common_8h_source}{md32\+\_\+common.\+h}).
\item Avoid a buffer overflow in d2i\+\_\+\+SSL\+\_\+\+SESSION() (ssl\+\_\+asn1.\+c). (NB\+: This would require knowledge of the secret session ticket key to exploit, in which case you\textquotesingle{}d be SOL either way.)
\item Change bn\+\_\+nist.\+c so that it will properly handle input BIGNUMs outside the expected range.
\item Enforce the \textquotesingle{}num\textquotesingle{} check in BN\+\_\+div() (bn\+\_\+div.\+c) for non-\/\+BN\+\_\+\+DEBUG builds.
\end{DoxyItemize}

{\itshape Neel Mehta, Bodo Moeller}
\item Allow engines to be "{}soft loaded"{} -\/ i.\+e. optionally don\textquotesingle{}t die if the load fails. Useful for distros.

{\itshape Ben Laurie and the Free\+BSD team}
\item Add support for Local Machine Keyset attribute in PKCS\#12 files.

{\itshape Steve Henson}
\item Fix BN\+\_\+\+GF2m\+\_\+mod\+\_\+arr() top-\/bit cleanup code.

{\itshape Huang Ying}
\item Expand ENGINE to support engine supplied SSL client certificate functions.

This work was sponsored by Logica.

{\itshape Steve Henson}
\item Add Crypto\+API ENGINE to support use of RSA and DSA keys held in Windows keystores. Support for SSL/\+TLS client authentication too. Not compiled unless enable-\/capieng specified to Configure.

This work was sponsored by Logica.

{\itshape Steve Henson}
\item Fix bug in X509\+\_\+\+ATTRIBUTE creation\+: don\textquotesingle{}t set attribute using ASN1\+\_\+\+TYPE\+\_\+set1 if MBSTRING flag set. This bug would crash certain attribute creation routines such as certificate requests and PKCS\#12 files.

{\itshape Steve Henson}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md126}{}\doxysubsection{\texorpdfstring{Changes between 0.\+9.\+8g and 0.\+9.\+8h \mbox{[}28 May 2008\mbox{]}}{Changes between 0.\+9.\+8g and 0.\+9.\+8h \mbox{[}28 May 2008\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md126}

\begin{DoxyItemize}
\item Fix flaw if \textquotesingle{}Server Key exchange message\textquotesingle{} is omitted from a TLS handshake which could lead to a client crash as found using the Codenomicon TLS test suite (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2008-1672}{\texttt{ CVE-\/2008-\/1672}})

{\itshape Steve Henson, Mark Cox}
\item Fix double free in TLS server name extensions which could lead to a remote crash found by Codenomicon TLS test suite (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2008-0891}{\texttt{ CVE-\/2008-\/0891}})

{\itshape Joe Orton}
\item Clear error queue in SSL\+\_\+\+CTX\+\_\+use\+\_\+certificate\+\_\+chain\+\_\+file()

Clear the error queue to ensure that error entries left from older function calls do not interfere with the correct operation.

{\itshape Lutz Jaenicke, Erik de Castro Lopo}
\item Remove root CA certificates of commercial CAs\+:

The Open\+SSL project does not recommend any specific CA and does not have any policy with respect to including or excluding any CA. Therefore, it does not make any sense to ship an arbitrary selection of root CA certificates with the Open\+SSL software.

{\itshape Lutz Jaenicke}
\item RSA OAEP patches to fix two separate invalid memory reads. The first one involves inputs when \textquotesingle{}lzero\textquotesingle{} is greater than \textquotesingle{}SHA\+\_\+\+DIGEST\+\_\+\+LENGTH\textquotesingle{} (it would read about SHA\+\_\+\+DIGEST\+\_\+\+LENGTH bytes before the beginning of from). The second one involves inputs where the \textquotesingle{}db\textquotesingle{} section contains nothing but zeroes (there is a one-\/byte invalid read after the end of \textquotesingle{}db\textquotesingle{}).

\texorpdfstring{$\ast$}{*}\+Ivan Nestlerode \href{mailto:inestlerode@us.ibm.com}{\texttt{ inestlerode@us.\+ibm.\+com}}\texorpdfstring{$\ast$}{*}
\item Partial backport from 0.\+9.\+9-\/dev\+:

Introduce bn\+\_\+mul\+\_\+mont (dedicated Montgomery multiplication procedure) as a candidate for BIGNUM assembler implementation. While 0.\+9.\+9-\/dev uses assembler for various architectures, only x86\+\_\+64 is available by default here in the 0.\+9.\+8 branch, and 32-\/bit x86 is available through a compile-\/time setting.

To try the 32-\/bit x86 assembler implementation, use Configure option "{}enable-\/montasm"{} (which exists only for this backport).

As "{}enable-\/montasm"{} for 32-\/bit x86 disclaims code stability anyway, in this constellation we activate additional code backported from 0.\+9.\+9-\/dev for further performance improvements, namely BN\+\_\+from\+\_\+montgomery\+\_\+word. (To enable this otherwise, e.\+g. x86\+\_\+64, try {\ttfamily -\/DMONT\+\_\+\+FROM\+\_\+\+WORD\+\_\+\+\_\+\+\_\+\+NON\+\_\+\+DEFAULT\+\_\+0\+\_\+9\+\_\+8\+\_\+\+BUILD}.)

{\itshape Andy Polyakov (backport partially by Bodo Moeller)}
\item Add TLS session ticket callback. This allows an application to set TLS ticket cipher and HMAC keys rather than relying on hardcoded fixed values. This is useful for key rollover for example where several key sets may exist with different names.

{\itshape Steve Henson}
\item Reverse ENGINE-\/internal logic for caching default ENGINE handles. This was broken until now in 0.\+9.\+8 releases, such that the only way a registered ENGINE could be used (assuming it initialises successfully on the host) was to explicitly set it as the default for the relevant algorithms. This is in contradiction with 0.\+9.\+7 behaviour and the documentation. With this fix, when an ENGINE is registered into a given algorithm\textquotesingle{}s table of implementations, the \textquotesingle{}uptodate\textquotesingle{} flag is reset so that auto-\/discovery will be used next time a new context for that algorithm attempts to select an implementation.

{\itshape Ian Lister (tweaked by Geoff Thorpe)}
\item Backport of CMS code to Open\+SSL 0.\+9.\+8. This differs from the 0.\+9.\+9 implementation in the following ways\+:

Lack of EVP\+\_\+\+PKEY\+\_\+\+ASN1\+\_\+\+METHOD means algorithm parameters have to be hard coded.

Lack of BER streaming support means one pass streaming processing is only supported if data is detached\+: setting the streaming flag is ignored for embedded content.

CMS support is disabled by default and must be explicitly enabled with the enable-\/cms configuration option.

{\itshape Steve Henson}
\item Update the GMP engine glue to do direct copies between BIGNUM and mpz\+\_\+t when openssl and GMP use the same limb size. Otherwise the existing "{}conversion via a text string export"{} trick is still used.

\texorpdfstring{$\ast$}{*}\+Paul Sheer \href{mailto:paulsheer@gmail.com}{\texttt{ paulsheer@gmail.\+com}}\texorpdfstring{$\ast$}{*}
\item Zlib compression BIO. This is a filter BIO which compressed and uncompresses any data passed through it.

{\itshape Steve Henson}
\item Add AES\+\_\+wrap\+\_\+key() and AES\+\_\+unwrap\+\_\+key() functions to implement RFC3394 compatible AES key wrapping.

{\itshape Steve Henson}
\item Add utility functions to handle ASN1 structures. ASN1\+\_\+\+STRING\+\_\+set0()\+: sets string data without copying. X509\+\_\+\+ALGOR\+\_\+set0() and X509\+\_\+\+ALGOR\+\_\+get0()\+: set and retrieve X509\+\_\+\+ALGOR (Algorithm\+Identifier) data. Attribute function X509at\+\_\+get0\+\_\+data\+\_\+by\+\_\+\+OBJ()\+: retrieves data from an X509\+\_\+\+ATTRIBUTE structure optionally checking it occurs only once. ASN1\+\_\+\+TYPE\+\_\+set1()\+: set and ASN1\+\_\+\+TYPE structure copying supplied data.

{\itshape Steve Henson}
\item Fix BN flag handling in RSA\+\_\+eay\+\_\+mod\+\_\+exp() and BN\+\_\+\+MONT\+\_\+\+CTX\+\_\+set() to get the expected BN\+\_\+\+FLG\+\_\+\+CONSTTIME behavior.

{\itshape Bodo Moeller (Google)}
\item Netware support\+:
\begin{DoxyItemize}
\item fixed wrong usage of ioctlsocket() when build for LIBC BSD sockets
\item fixed do\+\_\+tests.\+pl to run the test suite with CLIB builds too (CLIB\+\_\+\+OPT)
\item added some more tests to do\+\_\+tests.\+pl
\item fixed Running\+Process usage so that it works with newer LIBC NDKs too
\item removed usage of BN\+\_\+\+LLONG for CLIB builds to avoid runtime dependency
\item added new Configure targets netware-\/clib-\/bsdsock, netware-\/clib-\/gcc, netware-\/clib-\/bsdsock-\/gcc, netware-\/libc-\/bsdsock-\/gcc
\item various changes to netware.\+pl to enable gcc-\/cross builds on Win32 platform
\item changed crypto/bio/b\+\_\+sock.\+c to work with macro functions (CLIB BSD)
\item various changes to fix missing prototype warnings
\item fixed x86nasm.\+pl to create correct asm files for NASM COFF output
\item added AES, WHIRLPOOL and CPUID assembler code to build files
\item added missing AES assembler make rules to mk1mf.\+pl
\item fixed order of includes in {\ttfamily apps/ocsp.\+c} so that {\ttfamily \doxylink{e__os_8h_source}{e\+\_\+os.\+h}} settings apply
\end{DoxyItemize}

\texorpdfstring{$\ast$}{*}\+Guenter Knauf \href{mailto:eflash@gmx.net}{\texttt{ eflash@gmx.\+net}}\texorpdfstring{$\ast$}{*}
\item Implement certificate status request TLS extension defined in RFC3546. A client can set the appropriate parameters and receive the encoded OCSP response via a callback. A server can query the supplied parameters and set the encoded OCSP response in the callback. Add simplified examples to s\+\_\+client and s\+\_\+server.

{\itshape Steve Henson}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md127}{}\doxysubsection{\texorpdfstring{Changes between 0.\+9.\+8f and 0.\+9.\+8g \mbox{[}19 Oct 2007\mbox{]}}{Changes between 0.\+9.\+8f and 0.\+9.\+8g \mbox{[}19 Oct 2007\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md127}

\begin{DoxyItemize}
\item Fix various bugs\+:
\begin{DoxyItemize}
\item Binary incompatibility of \doxylink{structssl__ctx__st}{ssl\+\_\+ctx\+\_\+st} structure
\item DTLS interoperation with non-\/compliant servers
\item Don\textquotesingle{}t call get\+\_\+session\+\_\+cb() without proposed session
\item Fix ia64 assembler code
\end{DoxyItemize}

{\itshape Andy Polyakov, Steve Henson}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md128}{}\doxysubsection{\texorpdfstring{Changes between 0.\+9.\+8e and 0.\+9.\+8f \mbox{[}11 Oct 2007\mbox{]}}{Changes between 0.\+9.\+8e and 0.\+9.\+8f \mbox{[}11 Oct 2007\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md128}

\begin{DoxyItemize}
\item DTLS Handshake overhaul. There were longstanding issues with Open\+SSL DTLS implementation, which were making it impossible for RFC 4347 compliant client to communicate with Open\+SSL server. Unfortunately just fixing these incompatibilities would "{}cut off"{} pre-\/0.\+9.\+8f clients. To allow for hassle free upgrade post-\/0.\+9.\+8e server keeps tolerating non RFC compliant syntax. The opposite is not true, 0.\+9.\+8f client can not communicate with earlier server. This update even addresses CVE-\/2007-\/4995.

{\itshape Andy Polyakov}
\item Changes to avoid need for function casts in Open\+SSL\+: some compilers (gcc 4.\+2 and later) reject their use. \texorpdfstring{$\ast$}{*}\+Kurt Roeckx \href{mailto:kurt@roeckx.be}{\texttt{ kurt@roeckx.\+be}}, Peter Hartley \href{mailto:pdh@utter.chaos.org.uk}{\texttt{ pdh@utter.\+chaos.\+org.\+uk}}, Steve Henson\texorpdfstring{$\ast$}{*}
\item Add RFC4507 support to Open\+SSL. This includes the corrections in RFC4507bis. The encrypted ticket format is an encrypted encoded SSL\+\_\+\+SESSION structure, that way new session features are automatically supported.

If a client application caches session in an SSL\+\_\+\+SESSION structure support is transparent because tickets are now stored in the encoded SSL\+\_\+\+SESSION.

The SSL\+\_\+\+CTX structure automatically generates keys for ticket protection in servers so again support should be possible with no application modification.

If a client or server wishes to disable RFC4507 support then the option SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+TICKET can be set.

Add a TLS extension debugging callback to allow the contents of any client or server extensions to be examined.

This work was sponsored by Google.

{\itshape Steve Henson}
\item Add initial support for TLS extensions, specifically for the server\+\_\+name extension so far. The SSL\+\_\+\+SESSION, SSL\+\_\+\+CTX, and SSL data structures now have new members for a hostname. The SSL data structure has an additional member {\ttfamily SSL\+\_\+\+CTX \texorpdfstring{$\ast$}{*}initial\+\_\+ctx} so that new sessions can be stored in that context to allow for session resumption, even after the SSL has been switched to a new SSL\+\_\+\+CTX in reaction to a client\textquotesingle{}s server\+\_\+name extension.

New functions (subject to change)\+: \begin{DoxyVerb}    SSL_get_servername()
    SSL_get_servername_type()
    SSL_set_SSL_CTX()
\end{DoxyVerb}
 New CTRL codes and macros (subject to change)\+: \begin{DoxyVerb}    SSL_CTRL_SET_TLSEXT_SERVERNAME_CB
                        - SSL_CTX_set_tlsext_servername_callback()
    SSL_CTRL_SET_TLSEXT_SERVERNAME_ARG
                             - SSL_CTX_set_tlsext_servername_arg()
    SSL_CTRL_SET_TLSEXT_HOSTNAME           - SSL_set_tlsext_host_name()
\end{DoxyVerb}
 openssl s\+\_\+client has a new \textquotesingle{}-\/servername ...\textquotesingle{} option.

openssl s\+\_\+server has new options \textquotesingle{}-\/servername\+\_\+host ...\textquotesingle{}, \textquotesingle{}-\/cert2 ...\textquotesingle{}, \textquotesingle{}-\/key2 ...\textquotesingle{}, \textquotesingle{}-\/servername\+\_\+fatal\textquotesingle{} (subject to change). This allows testing the Host\+Name extension for a specific single hostname (\textquotesingle{}-\/cert\textquotesingle{} and \textquotesingle{}-\/key\textquotesingle{} remain fallbacks for handshakes without Host\+Name negotiation). If the unrecognized\+\_\+name alert has to be sent, this by default is a warning; it becomes fatal with the \textquotesingle{}-\/servername\+\_\+fatal\textquotesingle{} option.

{\itshape Peter Sylvester, Remy Allais, Christophe Renou, Steve Henson}
\item Add AES and SSE2 assembly language support to VC++ build.

{\itshape Steve Henson}
\item Mitigate attack on final subtraction in Montgomery reduction.

{\itshape Andy Polyakov}
\item Fix crypto/ec/ec\+\_\+mult.\+c to work properly with scalars of value 0 (which previously caused an internal error).

{\itshape Bodo Moeller}
\item Squeeze another 10\% out of IGE mode when in != out.

{\itshape Ben Laurie}
\item AES IGE mode speedup.

{\itshape Dean Gaudet (Google)}
\item Add the Korean symmetric 128-\/bit cipher SEED (see \href{http://www.kisa.or.kr/kisa/seed/jsp/seed_eng.jsp}{\texttt{ http\+://www.\+kisa.\+or.\+kr/kisa/seed/jsp/seed\+\_\+eng.\+jsp}}) and add SEED ciphersuites from RFC 4162\+: \begin{DoxyVerb}    TLS_RSA_WITH_SEED_CBC_SHA      =  "SEED-SHA"
    TLS_DHE_DSS_WITH_SEED_CBC_SHA  =  "DHE-DSS-SEED-SHA"
    TLS_DHE_RSA_WITH_SEED_CBC_SHA  =  "DHE-RSA-SEED-SHA"
    TLS_DH_anon_WITH_SEED_CBC_SHA  =  "ADH-SEED-SHA"
\end{DoxyVerb}
 To minimize changes between patchlevels in the Open\+SSL 0.\+9.\+8 series, SEED remains excluded from compilation unless Open\+SSL is configured with \textquotesingle{}enable-\/seed\textquotesingle{}.

{\itshape KISA, Bodo Moeller}
\item Mitigate branch prediction attacks, which can be practical if a single processor is shared, allowing a spy process to extract information. For detailed background information, see \href{http://eprint.iacr.org/2007/039}{\texttt{ http\+://eprint.\+iacr.\+org/2007/039}} (O. Aciicmez, S. Gueron, J.-\/P. Seifert, "{}\+New Branch Prediction Vulnerabilities in Open\+SSL    and Necessary Software Countermeasures"{}). The core of the change are new versions BN\+\_\+div\+\_\+no\+\_\+branch() and BN\+\_\+mod\+\_\+inverse\+\_\+no\+\_\+branch() of BN\+\_\+div() and BN\+\_\+mod\+\_\+inverse(), respectively, which are slower, but avoid the security-\/relevant conditional branches. These are automatically called by BN\+\_\+div() and BN\+\_\+mod\+\_\+inverse() if the flag BN\+\_\+\+FLG\+\_\+\+CONSTTIME is set for one of the input BIGNUMs. Also, BN\+\_\+is\+\_\+bit\+\_\+set() has been changed to remove a conditional branch.

BN\+\_\+\+FLG\+\_\+\+CONSTTIME is the new name for the previous BN\+\_\+\+FLG\+\_\+\+EXP\+\_\+\+CONSTTIME flag, since it now affects more than just modular exponentiation. (Since Open\+SSL 0.\+9.\+7h, setting this flag in the exponent causes BN\+\_\+mod\+\_\+exp\+\_\+mont() to use the alternative implementation in BN\+\_\+mod\+\_\+exp\+\_\+mont\+\_\+consttime().) The old name remains as a deprecated alias.

Similarly, RSA\+\_\+\+FLAG\+\_\+\+NO\+\_\+\+EXP\+\_\+\+CONSTTIME is replaced by a more general RSA\+\_\+\+FLAG\+\_\+\+NO\+\_\+\+CONSTTIME flag since the RSA implementation now uses constant-\/time implementations for more than just exponentiation. Here too the old name is kept as a deprecated alias.

BN\+\_\+\+BLINDING\+\_\+new() will now use BN\+\_\+dup() for the modulus so that the BN\+\_\+\+BLINDING structure gets an independent copy of the modulus. This means that the previous {\ttfamily BIGNUM \texorpdfstring{$\ast$}{*}m} argument to BN\+\_\+\+BLINDING\+\_\+new() and to BN\+\_\+\+BLINDING\+\_\+create\+\_\+param() now essentially becomes {\ttfamily const BIGNUM \texorpdfstring{$\ast$}{*}m}, although we can\textquotesingle{}t actually change this in the header file before 0.\+9.\+9. It allows RSA\+\_\+setup\+\_\+blinding() to use BN\+\_\+with\+\_\+flags() on the modulus to enable BN\+\_\+\+FLG\+\_\+\+CONSTTIME.

{\itshape Matthew D Wood (Intel Corp)}
\item In the SSL/\+TLS server implementation, be strict about session ID context matching (which matters if an application uses a single external cache for different purposes). Previously, out-\/of-\/context reuse was forbidden only if SSL\+\_\+\+VERIFY\+\_\+\+PEER was set. This did ensure strict client verification, but meant that, with applications using a single external cache for quite different requirements, clients could circumvent ciphersuite restrictions for a given session ID context by starting a session in a different context.

{\itshape Bodo Moeller}
\item Include "{}!e\+NULL"{} in SSL\+\_\+\+DEFAULT\+\_\+\+CIPHER\+\_\+\+LIST to make sure that a ciphersuite string such as "{}\+DEFAULT\+:\+RSA"{} cannot enable authentication-\/only ciphersuites.

{\itshape Bodo Moeller}
\item Update the SSL\+\_\+get\+\_\+shared\+\_\+ciphers() fix CVE-\/2006-\/3738 which was not complete and could lead to a possible single byte overflow (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2007-5135}{\texttt{ CVE-\/2007-\/5135}}) \mbox{[}Ben Laurie\mbox{]}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md129}{}\doxysubsection{\texorpdfstring{Changes between 0.\+9.\+8d and 0.\+9.\+8e \mbox{[}23 Feb 2007\mbox{]}}{Changes between 0.\+9.\+8d and 0.\+9.\+8e \mbox{[}23 Feb 2007\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md129}

\begin{DoxyItemize}
\item Since AES128 and AES256 (and similarly Camellia128 and Camellia256) share a single mask bit in the logic of ssl/ssl\+\_\+ciph.\+c, the code for masking out disabled ciphers needs a kludge to work properly if AES128 is available and AES256 isn\textquotesingle{}t (or if Camellia128 is available and Camellia256 isn\textquotesingle{}t).

{\itshape Victor Duchovni}
\item Fix the BIT STRING encoding generated by crypto/ec/ec\+\_\+asn1.\+c (within i2d\+\_\+\+ECPrivate\+Key, i2d\+\_\+\+ECPKParameters, i2d\+\_\+\+ECParameters)\+: When a point or a seed is encoded in a BIT STRING, we need to prevent the removal of trailing zero bits to get the proper DER encoding. (By default, crypto/asn1/a\+\_\+bitstr.\+c assumes the case of a Named\+Bit\+List, for which trailing 0 bits need to be removed.)

{\itshape Bodo Moeller}
\item Have SSL/\+TLS server implementation tolerate "{}mismatched"{} record protocol version while receiving Client\+Hello even if the Client\+Hello is fragmented. (The server can\textquotesingle{}t insist on the particular protocol version it has chosen before the Server\+Hello message has informed the client about his choice.)

{\itshape Bodo Moeller}
\item Add RFC 3779 support.

{\itshape Rob Austein for ARIN, Ben Laurie}
\item Load error codes if they are not already present instead of using a static variable. This allows them to be cleanly unloaded and reloaded. Improve header file function name parsing.

{\itshape Steve Henson}
\item extend SMTP and IMAP protocol emulation in s\+\_\+client to use EHLO or CAPABILITY handshake as required by RFCs.

{\itshape Goetz Babin-\/\+Ebell}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md130}{}\doxysubsection{\texorpdfstring{Changes between 0.\+9.\+8c and 0.\+9.\+8d \mbox{[}28 Sep 2006\mbox{]}}{Changes between 0.\+9.\+8c and 0.\+9.\+8d \mbox{[}28 Sep 2006\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md130}

\begin{DoxyItemize}
\item Introduce limits to prevent malicious keys being able to cause a denial of service. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2006-2940}{\texttt{ CVE-\/2006-\/2940}})

{\itshape Steve Henson, Bodo Moeller}
\item Fix ASN.\+1 parsing of certain invalid structures that can result in a denial of service. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2006-2937}{\texttt{ CVE-\/2006-\/2937}}) \mbox{[}Steve Henson\mbox{]}
\item Fix buffer overflow in SSL\+\_\+get\+\_\+shared\+\_\+ciphers() function. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2006-3738}{\texttt{ CVE-\/2006-\/3738}}) \mbox{[}Tavis Ormandy and Will Drewry, Google Security Team\mbox{]}
\item Fix SSL client code which could crash if connecting to a malicious SSLv2 server. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2006-4343}{\texttt{ CVE-\/2006-\/4343}})

{\itshape Tavis Ormandy and Will Drewry, Google Security Team}
\item Since 0.\+9.\+8b, ciphersuite strings naming explicit ciphersuites match only those. Before that, "{}\+AES256-\/\+SHA"{} would be interpreted as a pattern and match "{}\+AES128-\/\+SHA"{} too (since AES128-\/\+SHA got the same strength classification in 0.\+9.\+7h) as we currently only have a single AES bit in the ciphersuite description bitmap. That change, however, also applied to ciphersuite strings such as "{}\+RC4-\/\+MD5"{} that intentionally matched multiple ciphersuites -- namely, SSL 2.\+0 ciphersuites in addition to the more common ones from SSL 3.\+0/\+TLS 1.\+0.

So we change the selection algorithm again\+: Naming an explicit ciphersuite selects this one ciphersuite, and any other similar ciphersuite (same bitmap) from {\itshape other} protocol versions. Thus, "{}\+RC4-\/\+MD5"{} again will properly select both the SSL 2.\+0 ciphersuite and the SSL 3.\+0/\+TLS 1.\+0 ciphersuite.

Since SSL 2.\+0 does not have any ciphersuites for which the 128/256 bit distinction would be relevant, this works for now. The proper fix will be to use different bits for AES128 and AES256, which would have avoided the problems from the beginning; however, bits are scarce, so we can only do this in a new release (not just a patchlevel) when we can change the SSL\+\_\+\+CIPHER definition to split the single \textquotesingle{}unsigned long mask\textquotesingle{} bitmap into multiple values to extend the available space.

{\itshape Bodo Moeller}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md131}{}\doxysubsection{\texorpdfstring{Changes between 0.\+9.\+8b and 0.\+9.\+8c \mbox{[}05 Sep 2006\mbox{]}}{Changes between 0.\+9.\+8b and 0.\+9.\+8c \mbox{[}05 Sep 2006\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md131}

\begin{DoxyItemize}
\item Avoid PKCS \#1 v1.\+5 signature attack discovered by Daniel Bleichenbacher (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2006-4339}{\texttt{ CVE-\/2006-\/4339}}) \mbox{[}Ben Laurie and Google Security Team\mbox{]}
\item Add AES IGE and bi\+IGE modes.

{\itshape Ben Laurie}
\item Change the Unix randomness entropy gathering to use poll() when possible instead of select(), since the latter has some undesirable limitations.

{\itshape Darryl Miles via Richard Levitte and Bodo Moeller}
\item Disable "{}\+ECCdraft"{} ciphersuites more thoroughly. Now special treatment in ssl/ssl\+\_\+ciph.\+s makes sure that these ciphersuites cannot be implicitly activated as part of, e.\+g., the "{}\+AES"{} alias. However, please upgrade to Open\+SSL 0.\+9.\+9\mbox{[}-\/dev\mbox{]} for non-\/experimental use of the ECC ciphersuites to get TLS extension support, which is required for curve and point format negotiation to avoid potential handshake problems.

{\itshape Bodo Moeller}
\item Disable rogue ciphersuites\+:
\begin{DoxyItemize}
\item SSLv2 0x08 0x00 0x80 ("{}\+RC4-\/64-\/\+MD5"{})
\item SSLv3/\+TLSv1 0x00 0x61 ("{}\+EXP1024-\/\+RC2-\/\+CBC-\/\+MD5"{})
\item SSLv3/\+TLSv1 0x00 0x60 ("{}\+EXP1024-\/\+RC4-\/\+MD5"{})
\end{DoxyItemize}

The latter two were purportedly from draft-\/ietf-\/tls-\/56-\/bit-\/ciphersuites-\/0\mbox{[}01\mbox{]}.txt, but do not really appear there.

Also deactivate the remaining ciphersuites from draft-\/ietf-\/tls-\/56-\/bit-\/ciphersuites-\/01.\+txt. These are just as unofficial, and the ID has long expired.

{\itshape Bodo Moeller}
\item Fix RSA blinding Heisenbug (problems sometimes occurred on dual-\/core machines) and other potential thread-\/safety issues.

{\itshape Bodo Moeller}
\item Add the symmetric cipher Camellia (128-\/bit, 192-\/bit, 256-\/bit key versions), which is now available for royalty-\/free use (see \href{http://info.isl.ntt.co.jp/crypt/eng/info/chiteki.html}{\texttt{ http\+://info.\+isl.\+ntt.\+co.\+jp/crypt/eng/info/chiteki.\+html}}). Also, add Camellia TLS ciphersuites from RFC 4132.

To minimize changes between patchlevels in the Open\+SSL 0.\+9.\+8 series, Camellia remains excluded from compilation unless Open\+SSL is configured with \textquotesingle{}enable-\/camellia\textquotesingle{}.

{\itshape NTT}
\item Disable the padding bug check when compression is in use. The padding bug check assumes the first packet is of even length, this is not necessarily true if compression is enabled and can result in false positives causing handshake failure. The actual bug test is ancient code so it is hoped that implementations will either have fixed it by now or any which still have the bug do not support compression.

{\itshape Steve Henson}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md132}{}\doxysubsection{\texorpdfstring{Changes between 0.\+9.\+8a and 0.\+9.\+8b \mbox{[}04 May 2006\mbox{]}}{Changes between 0.\+9.\+8a and 0.\+9.\+8b \mbox{[}04 May 2006\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md132}

\begin{DoxyItemize}
\item When applying a cipher rule check to see if string match is an explicit cipher suite and only match that one cipher suite if it is.

{\itshape Steve Henson}
\item Link in manifests for VC++ if needed.

\texorpdfstring{$\ast$}{*}\+Austin Ziegler \href{mailto:halostatue@gmail.com}{\texttt{ halostatue@gmail.\+com}}\texorpdfstring{$\ast$}{*}
\item Update support for ECC-\/based TLS ciphersuites according to draft-\/ietf-\/tls-\/ecc-\/12.\+txt with proposed changes (but without TLS extensions, which are supported starting with the 0.\+9.\+9 branch, not in the Open\+SSL 0.\+9.\+8 branch).

{\itshape Douglas Stebila}
\item New functions EVP\+\_\+\+CIPHER\+\_\+\+CTX\+\_\+new() and EVP\+\_\+\+CIPHER\+\_\+\+CTX\+\_\+free() to support opaque EVP\+\_\+\+CIPHER\+\_\+\+CTX handling.

{\itshape Steve Henson}
\item Fixes and enhancements to zlib compression code. We now only use "{}zlib1.\+dll"{} and use the default {\ttfamily \+\_\+\+\_\+cdecl} calling convention on Win32 to conform with the standards mentioned here\+: \href{http://www.zlib.net/DLL_FAQ.txt}{\texttt{ http\+://www.\+zlib.\+net/\+DLL\+\_\+\+FAQ.\+txt}} Static zlib linking now works on Windows and the new --with-\/zlib-\/include --with-\/zlib-\/lib options to Configure can be used to supply the location of the headers and library. Gracefully handle case where zlib library can\textquotesingle{}t be loaded.

{\itshape Steve Henson}
\item Several fixes and enhancements to the OID generation code. The old code sometimes allowed invalid OIDs (1.\+X for X \texorpdfstring{$>$}{>}= 40 for example), couldn\textquotesingle{}t handle numbers larger than ULONG\+\_\+\+MAX, truncated printing and had a non standard OBJ\+\_\+obj2txt() behaviour.

{\itshape Steve Henson}
\item Add support for building of engines under engine/ as shared libraries under VC++ build system.

{\itshape Steve Henson}
\item Corrected the numerous bugs in the Win32 path splitter in DSO. Hopefully, we will not see any false combination of paths any more.

{\itshape Richard Levitte}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md133}{}\doxysubsection{\texorpdfstring{Changes between 0.\+9.\+8 and 0.\+9.\+8a \mbox{[}11 Oct 2005\mbox{]}}{Changes between 0.\+9.\+8 and 0.\+9.\+8a \mbox{[}11 Oct 2005\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md133}

\begin{DoxyItemize}
\item Remove the functionality of SSL\+\_\+\+OP\+\_\+\+MSIE\+\_\+\+SSLV2\+\_\+\+RSA\+\_\+\+PADDING (part of SSL\+\_\+\+OP\+\_\+\+ALL). This option used to disable the countermeasure against man-\/in-\/the-\/middle protocol-\/version rollback in the SSL 2.\+0 server implementation, which is a bad idea. (\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2005-2969}{\texttt{ CVE-\/2005-\/2969}})

{\itshape Bodo Moeller; problem pointed out by Yutaka Oiwa (Research Center for Information Security, National Institute of Advanced Industrial Science and Technology \mbox{[}AIST\mbox{]}, Japan)}
\item Add two function to clear and return the verify parameter flags.

{\itshape Steve Henson}
\item Keep cipherlists sorted in the source instead of sorting them at runtime, thus removing the need for a lock.

{\itshape Nils Larsch}
\item Avoid some small subgroup attacks in Diffie-\/\+Hellman.

{\itshape Nick Mathewson and Ben Laurie}
\item Add functions for well-\/known primes.

{\itshape Nick Mathewson}
\item Extended Windows CE support.

{\itshape Satoshi Nakamura and Andy Polyakov}
\item Initialize SSL\+\_\+\+METHOD structures at compile time instead of during runtime, thus removing the need for a lock.

{\itshape Steve Henson}
\item Make PKCS7\+\_\+decrypt() work even if no certificate is supplied by attempting to decrypt each encrypted key in turn. Add support to smime utility.

{\itshape Steve Henson}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md134}{}\doxysubsection{\texorpdfstring{Changes between 0.\+9.\+7h and 0.\+9.\+8 \mbox{[}05 Jul 2005\mbox{]}}{Changes between 0.\+9.\+7h and 0.\+9.\+8 \mbox{[}05 Jul 2005\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md134}
\mbox{[}NB\+: Open\+SSL 0.\+9.\+7i and later 0.\+9.\+7 patch levels were released after Open\+SSL 0.\+9.\+8.\mbox{]}


\begin{DoxyItemize}
\item Add libcrypto.\+pc and libssl.\+pc for those who feel they need them.

{\itshape Richard Levitte}
\item Change CA.\+sh and CA.\+pl so they don\textquotesingle{}t bundle the CSR and the private key into the same file any more.

{\itshape Richard Levitte}
\item Add initial support for Win64, both IA64 and AMD64/x64 flavors.

{\itshape Andy Polyakov}
\item Add -\/utf8 command line and config file option to \textquotesingle{}ca\textquotesingle{}.

\texorpdfstring{$\ast$}{*}\+Stefan \texorpdfstring{$<$}{<}\href{mailto:stf@udoma.org}{\texttt{ stf@udoma.\+org}}\texorpdfstring{$\ast$}{*}
\item Removed the macro des\+\_\+crypt(), as it seems to conflict with some libraries. Use DES\+\_\+crypt().

{\itshape Richard Levitte}
\item Correct naming of the \textquotesingle{}chil\textquotesingle{} and \textquotesingle{}4758cca\textquotesingle{} ENGINEs. This involves renaming the source and generated shared-\/libs for both. The engines will accept the corrected or legacy ids (\textquotesingle{}ncipher\textquotesingle{} and \textquotesingle{}4758\+\_\+cca\textquotesingle{} respectively) when binding. NB, this only applies when building \textquotesingle{}shared\textquotesingle{}.

\texorpdfstring{$\ast$}{*}\+Corinna Vinschen \href{mailto:vinschen@redhat.com}{\texttt{ vinschen@redhat.\+com}} and Geoff Thorpe\texorpdfstring{$\ast$}{*}
\item Add attribute functions to EVP\+\_\+\+PKEY structure. Modify PKCS12\+\_\+create() to recognize a CSP name attribute and use it. Make -\/CSP option work again in pkcs12 utility.

{\itshape Steve Henson}
\item Add new functionality to the bn blinding code\+:
\begin{DoxyItemize}
\item automatic re-\/creation of the BN\+\_\+\+BLINDING parameters after a fixed number of uses (currently 32)
\item add new function for parameter creation
\item introduce flags to control the update behaviour of the BN\+\_\+\+BLINDING parameters
\item hide BN\+\_\+\+BLINDING structure Add a second BN\+\_\+\+BLINDING slot to the RSA structure to improve performance when a single RSA object is shared among several threads.
\end{DoxyItemize}

{\itshape Nils Larsch}
\item Add support for DTLS.

\texorpdfstring{$\ast$}{*}\+Nagendra Modadugu \href{mailto:nagendra@cs.stanford.edu}{\texttt{ nagendra@cs.\+stanford.\+edu}} and Ben Laurie\texorpdfstring{$\ast$}{*}
\item Add support for DER encoded private keys (SSL\+\_\+\+FILETYPE\+\_\+\+ASN1) to SSL\+\_\+\+CTX\+\_\+use\+\_\+\+Private\+Key\+\_\+file() and SSL\+\_\+use\+\_\+\+Private\+Key\+\_\+file()

{\itshape Walter Goulet}
\item Remove buggy and incomplete DH cert support from ssl/ssl\+\_\+rsa.\+c and ssl/s3\+\_\+both.\+c

{\itshape Nils Larsch}
\item Use SHA-\/1 instead of MD5 as the default digest algorithm for the {\ttfamily apps/openssl} commands.

{\itshape Nils Larsch}
\item Compile clean with "{}-\/\+Wall -\/\+Wmissing-\/prototypes    -\/\+Wstrict-\/prototypes -\/\+Wmissing-\/declarations -\/\+Werror"{}. Currently DEBUG\+\_\+\+SAFESTACK must also be set.

{\itshape Ben Laurie}
\item Change ./\+Configure so that certain algorithms can be disabled by default. The new counterpiece to "{}no-\/xxx"{} is "{}enable-\/xxx"{}.

The patented RC5 and MDC2 algorithms will now be disabled unless "{}enable-\/rc5"{} and "{}enable-\/mdc2"{}, respectively, are specified.

(IDEA remains enabled despite being patented. This is because IDEA is frequently required for interoperability, and there is no license fee for non-\/commercial use. As before, "{}no-\/idea"{} can be used to avoid this algorithm.)

{\itshape Bodo Moeller}
\item Add processing of proxy certificates (see RFC 3820). This work was sponsored by KTH (The Royal Institute of Technology in Stockholm) and EGEE (Enabling Grids for E-\/science in Europe).

{\itshape Richard Levitte}
\item RC4 performance overhaul on modern architectures/implementations, such as Intel P4, IA-\/64 and AMD64.

{\itshape Andy Polyakov}
\item New utility extract-\/section.\+pl. This can be used specify an alternative section number in a pod file instead of having to treat each file as a separate case in Makefile. This can be done by adding two lines to the pod file\+:

=for comment openssl\+\_\+section\+:XXX

The blank line is mandatory.

{\itshape Steve Henson}
\item New arguments -\/certform, -\/keyform and -\/pass for s\+\_\+client and s\+\_\+server to allow alternative format key and certificate files and passphrase sources.

{\itshape Steve Henson}
\item New structure X509\+\_\+\+VERIFY\+\_\+\+PARAM which combines current verify parameters, update associated structures and add various utility functions.

Add new policy related verify parameters, include policy checking in standard verify code. Enhance \textquotesingle{}smime\textquotesingle{} application with extra parameters to support policy checking and print out.

{\itshape Steve Henson}
\item Add a new engine to support VIA Pad\+Lock ACE extensions in the VIA C3 Nehemiah processors. These extensions support AES encryption in hardware as well as RNG (though RNG support is currently disabled).

\texorpdfstring{$\ast$}{*}\+Michal Ludvig \href{mailto:michal@logix.cz}{\texttt{ michal@logix.\+cz}}, with help from Andy Polyakov\texorpdfstring{$\ast$}{*}
\item Deprecate {\ttfamily BN\+\_\+\mbox{[}get\texorpdfstring{$\vert$}{|}set\mbox{]}\+\_\+params()} functions (they were ignored internally).

{\itshape Geoff Thorpe}
\item New FIPS 180-\/2 algorithms, SHA-\/224/-\/256/-\/384/-\/512 are implemented.

{\itshape Andy Polyakov and a number of other people}
\item Improved Power\+PC platform support. Most notably BIGNUM assembler implementation contributed by IBM.

{\itshape Suresh Chari, Peter Waltenberg, Andy Polyakov}
\item The new \textquotesingle{}RSA\+\_\+generate\+\_\+key\+\_\+ex\textquotesingle{} function now takes a BIGNUM for the public exponent rather than \textquotesingle{}unsigned long\textquotesingle{}. There is a corresponding change to the new \textquotesingle{}rsa\+\_\+keygen\textquotesingle{} element of the RSA\+\_\+\+METHOD structure.

{\itshape Jelte Jansen, Geoff Thorpe}
\item Functionality for creating the initial serial number file is now moved from CA.\+pl to the \textquotesingle{}ca\textquotesingle{} utility with a new option -\/create\+\_\+serial.

(Before Open\+SSL 0.\+9.\+7e, CA.\+pl used to initialize the serial number file to 1, which is bound to cause problems. To avoid the problems while respecting compatibility between different 0.\+9.\+7 patchlevels, 0.\+9.\+7e employed \textquotesingle{}openssl x509 -\/next\+\_\+serial\textquotesingle{} in CA.\+pl for serial number initialization. With the new release 0.\+9.\+8, we can fix the problem directly in the \textquotesingle{}ca\textquotesingle{} utility.)

{\itshape Steve Henson}
\item Reduced header interdependencies by declaring more opaque objects in \doxylink{ossl__typ_8h_source}{ossl\+\_\+typ.\+h}. As a consequence, including some headers (eg. engine.\+h) will give fewer recursive includes, which could break lazy source code -\/ so this change is covered by the OPENSSL\+\_\+\+NO\+\_\+\+DEPRECATED symbol. As always, developers should define this symbol when building and using openssl to ensure they track the recommended behaviour, interfaces, \mbox{[}etc\mbox{]}, but backwards-\/compatible behaviour prevails when this isn\textquotesingle{}t defined.

{\itshape Geoff Thorpe}
\item New function X509\+\_\+\+POLICY\+\_\+\+NODE\+\_\+print() which prints out policy nodes.

{\itshape Steve Henson}
\item Add new EVP function EVP\+\_\+\+CIPHER\+\_\+\+CTX\+\_\+rand\+\_\+key and associated functionality. This will generate a random key of the appropriate length based on the cipher context. The EVP\+\_\+\+CIPHER can provide its own random key generation routine to support keys of a specific form. This is used in the des and 3des routines to generate a key of the correct parity. Update S/\+MIME code to use new functions and hence generate correct parity DES keys. Add EVP\+\_\+\+CHECK\+\_\+\+DES\+\_\+\+KEY define to return an error if the key is not valid (weak or incorrect parity).

{\itshape Steve Henson}
\item Add a local set of CRLs that can be used by X509\+\_\+verify\+\_\+cert() as well as looking them up. This is useful when the verified structure may contain CRLs, for example PKCS\#7 signed\+Data. Modify PKCS7\+\_\+verify() to use any CRLs present unless the new PKCS7\+\_\+\+NO\+\_\+\+CRL flag is asserted.

{\itshape Steve Henson}
\item Extend ASN1 oid configuration module. It now additionally accepts the syntax\+:

short\+Name = some long name, 1.\+2.\+3.\+4

{\itshape Steve Henson}
\item Reimplemented the BN\+\_\+\+CTX implementation. There is now no more static limitation on the number of variables it can handle nor the depth of the "{}stack"{} handling for BN\+\_\+\+CTX\+\_\+start()/\+BN\+\_\+\+CTX\+\_\+end() pairs. The stack information can now expand as required, and rather than having a single static array of bignums, BN\+\_\+\+CTX now uses a linked-\/list of such arrays allowing it to expand on demand whilst maintaining the usefulness of BN\+\_\+\+CTX\textquotesingle{}s "{}bundling"{}.

{\itshape Geoff Thorpe}
\item Add a missing BN\+\_\+\+CTX parameter to the \textquotesingle{}rsa\+\_\+mod\+\_\+exp\textquotesingle{} callback in RSA\+\_\+\+METHOD to allow all RSA operations to function using a single BN\+\_\+\+CTX.

{\itshape Geoff Thorpe}
\item Preliminary support for certificate policy evaluation and checking. This is initially intended to pass the tests outlined in "{}\+Conformance Testing    of Relying Party Client Certificate Path Processing Logic"{} v1.\+07.

{\itshape Steve Henson}
\item bn\+\_\+dup\+\_\+expand() has been deprecated, it was introduced in 0.\+9.\+7 and remained unused and not that useful. A variety of other little bignum tweaks and fixes have also been made continuing on from the audit (see below).

{\itshape Geoff Thorpe}
\item Constify all or almost all d2i, c2i, s2i and r2i functions, along with associated ASN1, EVP and SSL functions and old ASN1 macros.

{\itshape Richard Levitte}
\item BN\+\_\+zero() only needs to set \textquotesingle{}top\textquotesingle{} and \textquotesingle{}neg\textquotesingle{} to zero for correct results, and this should never fail. So the return value from the use of BN\+\_\+set\+\_\+word() (which can fail due to needless expansion) is now deprecated; if OPENSSL\+\_\+\+NO\+\_\+\+DEPRECATED is defined, BN\+\_\+zero() is a void macro.

{\itshape Geoff Thorpe}
\item BN\+\_\+\+CTX\+\_\+get() should return zero-\/valued bignums, providing the same initialised value as BN\+\_\+new().

{\itshape Geoff Thorpe, suggested by Ulf Möller}
\item Support for inhibit\+Any\+Policy certificate extension.

{\itshape Steve Henson}
\item An audit of the BIGNUM code is underway, for which debugging code is enabled when BN\+\_\+\+DEBUG is defined. This makes stricter enforcements on what is considered valid when processing BIGNUMs, and causes execution to assert() when a problem is discovered. If BN\+\_\+\+DEBUG\+\_\+\+RAND is defined, further steps are taken to deliberately pollute unused data in BIGNUM structures to try and expose faulty code further on. For now, openssl will (in its default mode of operation) continue to tolerate the inconsistent forms that it has tolerated in the past, but authors and packagers should consider trying openssl and their own applications when compiled with these debugging symbols defined. It will help highlight potential bugs in their own code, and will improve the test coverage for Open\+SSL itself. At some point, these tighter rules will become openssl\textquotesingle{}s default to improve maintainability, though the assert()s and other overheads will remain only in debugging configurations. See bn.\+h for more details.

{\itshape Geoff Thorpe, Nils Larsch, Ulf Möller}
\item BN\+\_\+\+CTX\+\_\+init() has been deprecated, as BN\+\_\+\+CTX is an opaque structure that can only be obtained through BN\+\_\+\+CTX\+\_\+new() (which implicitly initialises it). The presence of this function only made it possible to overwrite an existing structure (and cause memory leaks).

{\itshape Geoff Thorpe}
\item Because of the callback-\/based approach for implementing LHASH as a template type, lh\+\_\+insert() adds opaque objects to hash-\/tables and lh\+\_\+doall() or lh\+\_\+doall\+\_\+arg() are typically used with a destructor callback to clean up those corresponding objects before destroying the hash table (and losing the object pointers). So some over-\/zealous constifications in LHASH have been relaxed so that lh\+\_\+insert() does not take (nor store) the objects as "{}const"{} and the {\ttfamily lh\+\_\+doall\mbox{[}\+\_\+arg\mbox{]}} callback wrappers are not prototyped to have "{}const"{} restrictions on the object pointers they are given (and so aren\textquotesingle{}t required to cast them away any more).

{\itshape Geoff Thorpe}
\item The tmdiff.\+h API was so ugly and minimal that our own timing utility (speed) prefers to use its own implementation. The two implementations haven\textquotesingle{}t been consolidated as yet (volunteers?) but the tmdiff API has had its object type properly exposed (MS\+\_\+\+TM) instead of casting to/from {\ttfamily char \texorpdfstring{$\ast$}{*}}. This may still change yet if someone realises MS\+\_\+\+TM and {\ttfamily ms\+\_\+time\+\_\+\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}} aren\textquotesingle{}t necessarily the greatest nomenclatures -\/ but this is what was used internally to the implementation so I\textquotesingle{}ve used that for now.

{\itshape Geoff Thorpe}
\item Ensure that deprecated functions do not get compiled when OPENSSL\+\_\+\+NO\+\_\+\+DEPRECATED is defined. Some "{}openssl"{} subcommands and a few of the self-\/tests were still using deprecated key-\/generation functions so these have been updated also.

{\itshape Geoff Thorpe}
\item Reorganise PKCS\#7 code to separate the digest location functionality into PKCS7\+\_\+find\+\_\+digest(), digest addition into PKCS7\+\_\+bio\+\_\+add\+\_\+digest(). New function PKCS7\+\_\+set\+\_\+digest() to set the digest type for PKCS\#7 digested\+Data type. Add additional code to correctly generate the digested\+Data type and add support for this type in PKCS7 initialization functions.

{\itshape Steve Henson}
\item New function PKCS7\+\_\+set0\+\_\+type\+\_\+other() this initializes a PKCS7 structure of type "{}other"{}.

{\itshape Steve Henson}
\item Fix prime generation loop in crypto/bn/bn\+\_\+prime.\+pl by making sure the loop does correctly stop and breaking ("{}division by zero"{}) modulus operations are not performed. The (pre-\/generated) prime table \doxylink{bn__prime_8h_source}{crypto/bn/bn\+\_\+prime.\+h} was already correct, but it could not be re-\/generated on some platforms because of the "{}division by zero"{} situation in the script.

{\itshape Ralf S. Engelschall}
\item Update support for ECC-\/based TLS ciphersuites according to draft-\/ietf-\/tls-\/ecc-\/03.\+txt\+: the KDF1 key derivation function with SHA-\/1 now is only used for "{}small"{} curves (where the representation of a field element takes up to 24 bytes); for larger curves, the field element resulting from ECDH is directly used as premaster secret.

{\itshape Douglas Stebila (Sun Microsystems Laboratories)}
\item Add code for k\+P+lQ timings to crypto/ec/ectest.\+c, and add SEC2 curve secp160r1 to the tests.

{\itshape Douglas Stebila (Sun Microsystems Laboratories)}
\item Add the possibility to load symbols globally with DSO.

\texorpdfstring{$\ast$}{*}\+Götz Babin-\/\+Ebell \href{mailto:babin-ebell@trustcenter.de}{\texttt{ babin-\/ebell@trustcenter.\+de}} via Richard Levitte\texorpdfstring{$\ast$}{*}
\item Add the functions ERR\+\_\+set\+\_\+mark() and ERR\+\_\+pop\+\_\+to\+\_\+mark() for better control of the error stack.

{\itshape Richard Levitte}
\item Add support for STORE in ENGINE.

{\itshape Richard Levitte}
\item Add the STORE type. The intention is to provide a common interface to certificate and key stores, be they simple file-\/based stores, or HSM-\/type store, or LDAP stores, or... NOTE\+: The code is currently UNTESTED and isn\textquotesingle{}t really used anywhere.

{\itshape Richard Levitte}
\item Add a generic structure called OPENSSL\+\_\+\+ITEM. This can be used to pass a list of arguments to any function as well as provide a way for a function to pass data back to the caller.

{\itshape Richard Levitte}
\item Add the functions BUF\+\_\+strndup() and BUF\+\_\+memdup(). BUF\+\_\+strndup() works like BUF\+\_\+strdup() but can be used to duplicate a portion of a string. The copy gets NUL-\/terminated. BUF\+\_\+memdup() duplicates a memory area.

{\itshape Richard Levitte}
\item Add the function sk\+\_\+find\+\_\+ex() which works like sk\+\_\+find(), but will return an index to an element even if an exact match couldn\textquotesingle{}t be found. The index is guaranteed to point at the element where the searched-\/for key would be inserted to preserve sorting order.

{\itshape Richard Levitte}
\item Add the function OBJ\+\_\+bsearch\+\_\+ex() which works like OBJ\+\_\+bsearch() but takes an extra flags argument for optional functionality. Currently, the following flags are defined\+:

OBJ\+\_\+\+BSEARCH\+\_\+\+VALUE\+\_\+\+ON\+\_\+\+NOMATCH This one gets OBJ\+\_\+bsearch\+\_\+ex() to return a pointer to the first element where the comparing function returns a negative or zero number.

OBJ\+\_\+\+BSEARCH\+\_\+\+FIRST\+\_\+\+VALUE\+\_\+\+ON\+\_\+\+MATCH This one gets OBJ\+\_\+bsearch\+\_\+ex() to return a pointer to the first element where the comparing function returns zero. This is useful if there are more than one element where the comparing function returns zero.

{\itshape Richard Levitte}
\item Make it possible to create self-\/signed certificates with \textquotesingle{}openssl ca\textquotesingle{} in such a way that the self-\/signed certificate becomes part of the CA database and uses the same mechanisms for serial number generation as all other certificate signing. The new flag \textquotesingle{}-\/selfsign\textquotesingle{} enables this functionality. Adapt CA.\+sh and CA.\+pl.\+in.

{\itshape Richard Levitte}
\item Add functionality to check the public key of a certificate request against a given private. This is useful to check that a certificate request can be signed by that key (self-\/signing).

{\itshape Richard Levitte}
\item Make it possible to have multiple active certificates with the same subject in the CA index file. This is done only if the keyword \textquotesingle{}unique\+\_\+subject\textquotesingle{} is set to \textquotesingle{}no\textquotesingle{} in the main CA section (default if \textquotesingle{}CA\+\_\+default\textquotesingle{}) of the configuration file. The value is saved with the database itself in a separate index attribute file, named like the index file with \textquotesingle{}.attr\textquotesingle{} appended to the name.

{\itshape Richard Levitte}
\item Generate multi-\/valued AVAs using \textquotesingle{}+\textquotesingle{} notation in config files for req and dir\+Name.

{\itshape Steve Henson}
\item Support for name\+Constraints certificate extension.

{\itshape Steve Henson}
\item Support for policy\+Constraints certificate extension.

{\itshape Steve Henson}
\item Support for policy\+Mappings certificate extension.

{\itshape Steve Henson}
\item Make sure the default DSA\+\_\+\+METHOD implementation only uses its dsa\+\_\+mod\+\_\+exp() and/or bn\+\_\+mod\+\_\+exp() handlers if they are non-\/\+NULL, and change its own handlers to be NULL so as to remove unnecessary indirection. This lets alternative implementations fallback to the default implementation more easily.

{\itshape Geoff Thorpe}
\item Support for directory\+Name in General\+Name related extensions in config files.

{\itshape Steve Henson}
\item Make it possible to link applications using Makefile.\+shared. Make that possible even when linking against static libraries!

{\itshape Richard Levitte}
\item Support for single pass processing for S/\+MIME signing. This now means that S/\+MIME signing can be done from a pipe, in addition cleartext signing (multipart/signed type) is effectively streaming and the signed data does not need to be all held in memory.

This is done with a new flag PKCS7\+\_\+\+STREAM. When this flag is set PKCS7\+\_\+sign() only initializes the PKCS7 structure and the actual signing is done after the data is output (and digests calculated) in SMIME\+\_\+write\+\_\+\+PKCS7().

{\itshape Steve Henson}
\item Add full support for -\/rpath/-\/R, both in shared libraries and applications, at least on the platforms where it\textquotesingle{}s known how to do it.

{\itshape Richard Levitte}
\item In crypto/ec/ec\+\_\+mult.\+c, implement fast point multiplication with precomputation, based on w\+NAF splitting\+: EC\+\_\+\+GROUP\+\_\+precompute\+\_\+mult() will now compute a table of multiples of the generator that makes subsequent invocations of EC\+\_\+\+POINTs\+\_\+mul() or EC\+\_\+\+POINT\+\_\+mul() faster (notably in the case of a single point multiplication, scalar \texorpdfstring{$\ast$}{*} generator).

{\itshape Nils Larsch, Bodo Moeller}
\item IPv6 support for certificate extensions. The various extensions which use the IP\+:a.\+b.\+c.\+d can now take IPv6 addresses using the formats of RFC1884 2.\+2 . IPv6 addresses are now also displayed correctly.

{\itshape Steve Henson}
\item Added an ENGINE that implements RSA by performing private key exponentiations with the GMP library. The conversions to and from GMP\textquotesingle{}s mpz\+\_\+t format aren\textquotesingle{}t optimised nor are any montgomery forms cached, and on x86 it appears Open\+SSL\textquotesingle{}s own performance has caught up. However there are likely to be other architectures where GMP could provide a boost. This ENGINE is not built in by default, but it can be specified at Configure time and should be accompanied by the necessary linker additions, eg; ./config -\/DOPENSSL\+\_\+\+USE\+\_\+\+GMP -\/lgmp

{\itshape Geoff Thorpe}
\item "{}openssl engine"{} will not display ENGINE/\+DSO load failure errors when testing availability of engines with "{}-\/t"{} -\/ the old behaviour is produced by increasing the feature\textquotesingle{}s verbosity with "{}-\/tt"{}.

{\itshape Geoff Thorpe}
\item ECDSA routines\+: under certain error conditions uninitialized BN objects could be freed. Solution\+: make sure initialization is performed early enough. (Reported and fix supplied by Nils Larsch \href{mailto:nla@trustcenter.de}{\texttt{ nla@trustcenter.\+de}} via PR\#459)

{\itshape Lutz Jaenicke}
\item Key-\/generation can now be implemented in RSA\+\_\+\+METHOD, DSA\+\_\+\+METHOD and DH\+\_\+\+METHOD (eg. by ENGINE implementations) to override the normal software implementations. For DSA and DH, parameter generation can also be overridden by providing the appropriate method callbacks.

{\itshape Geoff Thorpe}
\item Change the "{}progress"{} mechanism used in key-\/generation and primality testing to functions that take a new BN\+\_\+\+GENCB pointer in place of callback/argument pairs. The new API functions have {\ttfamily \+\_\+ex} postfixes and the older functions are reimplemented as wrappers for the new ones. The OPENSSL\+\_\+\+NO\+\_\+\+DEPRECATED symbol can be used to hide declarations of the old functions to help (graceful) attempts to migrate to the new functions. Also, the new key-\/generation API functions operate on a caller-\/supplied key-\/structure and return success/failure rather than returning a key or NULL -\/ this is to help make "{}keygen"{} another member function of RSA\+\_\+\+METHOD etc.

Example for using the new callback interface\+: \begin{DoxyVerb}    int (*my_callback)(int a, int b, BN_GENCB *cb) = ...;
    void *my_arg = ...;
    BN_GENCB my_cb;

    BN_GENCB_set(&my_cb, my_callback, my_arg);

    return BN_is_prime_ex(some_bignum, BN_prime_checks, NULL, &cb);
    /* For the meaning of a, b in calls to my_callback(), see the
     * documentation of the function that calls the callback.
     * cb will point to my_cb; my_arg can be retrieved as cb->arg.
     * my_callback should return 1 if it wants BN_is_prime_ex()
     * to continue, or 0 to stop.
     */
\end{DoxyVerb}
 {\itshape Geoff Thorpe}
\item Change the ZLIB compression method to be stateful, and make it available to TLS with the number defined in draft-\/ietf-\/tls-\/compression-\/04.\+txt.

{\itshape Richard Levitte}
\item Add the ASN.\+1 structures and functions for Certificate\+Pair, which is defined as follows (according to X.\+509\+\_\+4th\+Edition\+Draft\+V6.\+pdf)\+: \begin{DoxyVerb}    CertificatePair ::= SEQUENCE {
       forward         [0]     Certificate OPTIONAL,
       reverse         [1]     Certificate OPTIONAL,
       -- at least one of the pair shall be present -- }
\end{DoxyVerb}
 Also implement the PEM functions to read and write certificate pairs, and defined the PEM tag as "{}\+CERTIFICATE PAIR"{}.

This needed to be defined, mostly for the sake of the LDAP attribute cross\+Certificate\+Pair, but may prove useful elsewhere as well.

{\itshape Richard Levitte}
\item Make it possible to inhibit symlinking of shared libraries in Makefile.\+shared, for Cygwin\textquotesingle{}s sake.

{\itshape Richard Levitte}
\item Extend the BIGNUM API by creating a function void BN\+\_\+set\+\_\+negative(\+BIGNUM \texorpdfstring{$\ast$}{*}a, int neg); and a macro that behave like int BN\+\_\+is\+\_\+negative(const BIGNUM \texorpdfstring{$\ast$}{*}a);

to avoid the need to access \textquotesingle{}a-\/\texorpdfstring{$>$}{>}neg\textquotesingle{} directly in applications.

{\itshape Nils Larsch}
\item Implement fast modular reduction for pseudo-\/\+Mersenne primes used in NIST curves (crypto/bn/bn\+\_\+nist.\+c, crypto/ec/ecp\+\_\+nist.\+c). EC\+\_\+\+GROUP\+\_\+new\+\_\+curve\+\_\+\+GFp() will now automatically use this if applicable.

\texorpdfstring{$\ast$}{*}\+Nils Larsch \href{mailto:nla@trustcenter.de}{\texttt{ nla@trustcenter.\+de}}\texorpdfstring{$\ast$}{*}
\item Add new lock type (CRYPTO\+\_\+\+LOCK\+\_\+\+BN).

{\itshape Bodo Moeller}
\item Change the ENGINE framework to automatically load engines dynamically from specific directories unless they could be found to already be built in or loaded. Move all the current engines except for the cryptodev one to a new directory engines/. The engines in engines/ are built as shared libraries if the "{}shared"{} options was given to ./\+Configure or ./config. Otherwise, they are inserted in libcrypto.\+a. /usr/local/ssl/engines is the default directory for dynamic engines, but that can be overridden at configure time through the usual use of --prefix and/or --openssldir, and at run time with the environment variable OPENSSL\+\_\+\+ENGINES.

{\itshape Geoff Thorpe and Richard Levitte}
\item Add Makefile.\+shared, a helper makefile to build shared libraries. Adapt Makefile.\+org.

{\itshape Richard Levitte}
\item Add version info to Win32 DLLs.

\texorpdfstring{$\ast$}{*}\+Peter \textquotesingle{}Luna\textquotesingle{} Runestig"{} $<$peter@runestig.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Add new \textquotesingle{}medium level\textquotesingle{} PKCS\#12 API. Certificates and keys    can be added using this API to created arbitrary PKCS\#12    files while avoiding the low-\/level API.     New options to PKCS12\+\_\+create(), key or cert can be NULL and    will then be omitted from the output file. The encryption    algorithm NIDs can be set to -\/1 for no encryption, the mac    iteration count can be set to 0 to omit the mac.     Enhance pkcs12 utility by making the -\/nokeys and -\/nocerts    options work when creating a PKCS\#12 file. New option -\/nomac    to omit the mac, NONE can be set for an encryption algorithm.    New code is modified to use the enhanced PKCS12\+\_\+create()    instead of the low-\/level API.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Extend ASN1 encoder to support indefinite length constructed    encoding. This can output sequences tags and octet strings in    this form. Modify pk7\+\_\+asn1.\+c to support indefinite length    encoding. This is experimental and needs additional code to    be useful, such as an ASN1 bio and some enhanced streaming    PKCS\#7 code.     Extend template encode functionality so that tagging is passed    down to the template encoder.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Let \textquotesingle{}openssl req\textquotesingle{} fail if an argument to \textquotesingle{}-\/newkey\textquotesingle{} is not    recognized instead of using RSA as a default.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Add support for ECC-\/based ciphersuites from draft-\/ietf-\/tls-\/ecc-\/01.\+txt.    As these are not official, they are not included in "{}ALL"{};    the "{}ECCdraft"{} ciphersuite group alias can be used to select them.     $<$em$>$\+Vipul Gupta and Sumit Gupta (\+Sun Microsystems Laboratories)$<$/em$>$   \texorpdfstring{$\ast$}{*} Add ECDH engine support.     $<$em$>$\+Nils Gura and Douglas Stebila (\+Sun Microsystems Laboratories)$<$/em$>$   \texorpdfstring{$\ast$}{*} Add ECDH in new directory crypto/ecdh/.     $<$em$>$\+Douglas Stebila (\+Sun Microsystems Laboratories)$<$/em$>$   \texorpdfstring{$\ast$}{*} Let BN\+\_\+rand\+\_\+range() abort with an error after 100 iterations    without success (which indicates a broken PRNG).     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Change BN\+\_\+mod\+\_\+sqrt() so that it verifies that the input value    is really the square of the return value.  (\+Previously,    BN\+\_\+mod\+\_\+sqrt would show GIGO behaviour.)     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Add named elliptic curves over binary fields from X9.\+62, SECG,    and WAP/\+WTLS; add OIDs that were still missing.     $<$em$>$\+Sheueling Chang Shantz and Douglas Stebila (\+Sun Microsystems Laboratories)$<$/em$>$   \texorpdfstring{$\ast$}{*} Extend the EC library for elliptic curves over binary fields    (new files ec2\+\_\+smpl.\+c, ec2\+\_\+smpt.\+c, ec2\+\_\+mult.\+c in crypto/ec/).    New EC\+\_\+\+METHOD\+: @iverbatim      EC\+\_\+\+GF2m\+\_\+simple\+\_\+method @endiverbatim    New API functions\+: @iverbatim      EC\+\_\+\+GROUP\+\_\+new\+\_\+curve\+\_\+\+GF2m     EC\+\_\+\+GROUP\+\_\+set\+\_\+curve\+\_\+\+GF2m     EC\+\_\+\+GROUP\+\_\+get\+\_\+curve\+\_\+\+GF2m     EC\+\_\+\+POINT\+\_\+set\+\_\+affine\+\_\+coordinates\+\_\+\+GF2m     EC\+\_\+\+POINT\+\_\+get\+\_\+affine\+\_\+coordinates\+\_\+\+GF2m     EC\+\_\+\+POINT\+\_\+set\+\_\+compressed\+\_\+coordinates\+\_\+\+GF2m @endiverbatim    Point compression for binary fields is disabled by default for    patent reasons (compile with OPENSSL\+\_\+\+EC\+\_\+\+BIN\+\_\+\+PT\+\_\+\+COMP defined to    enable it).     As binary polynomials are represented as BIGNUMs, various members    of the EC\+\_\+\+GROUP and EC\+\_\+\+POINT data structures can be shared    between the implementations for prime fields and binary fields;    the above $<$tt$>$...\+\_\+\+GF2m functions$<$/tt$>$ (except for EX\+\_\+\+GROUP\+\_\+new\+\_\+curve\+\_\+\+GF2m)    are essentially identical to their $<$tt$>$...\+\_\+\+GFp$<$/tt$>$ counterparts.    (\+For simplicity, the $<$tt$>$...\+\_\+\+GFp$<$/tt$>$ prefix has been dropped from    various internal method names.)     An internal \textquotesingle{}field\+\_\+div\textquotesingle{} method (similar to \textquotesingle{}field\+\_\+mul\textquotesingle{} and    \textquotesingle{}field\+\_\+sqr\textquotesingle{}) has been added; this is used only for binary fields.     $<$em$>$\+Sheueling Chang Shantz and Douglas Stebila (\+Sun Microsystems Laboratories)$<$/em$>$   \texorpdfstring{$\ast$}{*} Optionally dispatch EC\+\_\+\+POINT\+\_\+mul(), EC\+\_\+\+POINT\+\_\+precompute\+\_\+mult()    through methods (\textquotesingle{}mul\textquotesingle{}, \textquotesingle{}precompute\+\_\+mult\textquotesingle{}).     The generic implementations (now internally called \textquotesingle{}ec\+\_\+w\+NAF\+\_\+mul\textquotesingle{}    and \textquotesingle{}ec\+\_\+w\+NAF\+\_\+precomputed\+\_\+mult\textquotesingle{}) remain the default if these    methods are undefined.     $<$em$>$\+Sheueling Chang Shantz and Douglas Stebila (\+Sun Microsystems Laboratories)$<$/em$>$   \texorpdfstring{$\ast$}{*} New function EC\+\_\+\+GROUP\+\_\+get\+\_\+degree, which is defined through    EC\+\_\+\+METHOD.  For curves over prime fields, this returns the bit    length of the modulus.     $<$em$>$\+Sheueling Chang Shantz and Douglas Stebila (\+Sun Microsystems Laboratories)$<$/em$>$   \texorpdfstring{$\ast$}{*} New functions EC\+\_\+\+GROUP\+\_\+dup, EC\+\_\+\+POINT\+\_\+dup.    (\+These simply call ...\+\_\+new  and ...\+\_\+copy).     $<$em$>$\+Sheueling Chang Shantz and Douglas Stebila (\+Sun Microsystems Laboratories)$<$/em$>$   \texorpdfstring{$\ast$}{*} Add binary polynomial arithmetic software in crypto/bn/bn\+\_\+gf2m.\+c.    Polynomials are represented as BIGNUMs (where the sign bit is not    used) in the following functions \mbox{[}macros\mbox{]}\+: @iverbatim      BN\+\_\+\+GF2m\+\_\+add     BN\+\_\+\+GF2m\+\_\+sub             \mbox{[}= BN\+\_\+\+GF2m\+\_\+add\mbox{]}     BN\+\_\+\+GF2m\+\_\+mod             \mbox{[}wrapper for BN\+\_\+\+GF2m\+\_\+mod\+\_\+arr\mbox{]}     BN\+\_\+\+GF2m\+\_\+mod\+\_\+mul         \mbox{[}wrapper for BN\+\_\+\+GF2m\+\_\+mod\+\_\+mul\+\_\+arr\mbox{]}     BN\+\_\+\+GF2m\+\_\+mod\+\_\+sqr         \mbox{[}wrapper for BN\+\_\+\+GF2m\+\_\+mod\+\_\+sqr\+\_\+arr\mbox{]}     BN\+\_\+\+GF2m\+\_\+mod\+\_\+inv     BN\+\_\+\+GF2m\+\_\+mod\+\_\+exp         \mbox{[}wrapper for BN\+\_\+\+GF2m\+\_\+mod\+\_\+exp\+\_\+arr\mbox{]}     BN\+\_\+\+GF2m\+\_\+mod\+\_\+sqrt        \mbox{[}wrapper for BN\+\_\+\+GF2m\+\_\+mod\+\_\+sqrt\+\_\+arr\mbox{]}     BN\+\_\+\+GF2m\+\_\+mod\+\_\+solve\+\_\+quad  \mbox{[}wrapper for BN\+\_\+\+GF2m\+\_\+mod\+\_\+solve\+\_\+quad\+\_\+arr\mbox{]}     BN\+\_\+\+GF2m\+\_\+cmp             \mbox{[}= BN\+\_\+ucmp\mbox{]} @endiverbatim    (\+Note that only the \textquotesingle{}mod\textquotesingle{} functions are actually for fields GF(2\texorpdfstring{$^\wedge$}{\string^}m).    BN\+\_\+\+GF2m\+\_\+add() is misnomer, but this is for the sake of consistency.)     For some functions, an the irreducible polynomial defining a    field can be given as an \textquotesingle{}unsigned int\mbox{[}$\,$\mbox{]}\textquotesingle{} with strictly    decreasing elements giving the indices of those bits that are set;    i.\+e., p\mbox{[}$\,$\mbox{]} represents the polynomial            f(t) = t\texorpdfstring{$^\wedge$}{\string^}p\mbox{[}0\mbox{]} + t\texorpdfstring{$^\wedge$}{\string^}p\mbox{[}1\mbox{]} + ... + t\texorpdfstring{$^\wedge$}{\string^}p\mbox{[}k\mbox{]}    where            p\mbox{[}0\mbox{]} $>$ p\mbox{[}1\mbox{]} $>$ ... $>$ p\mbox{[}k\mbox{]} = 0.    This applies to the following functions\+: @iverbatim      BN\+\_\+\+GF2m\+\_\+mod\+\_\+arr     BN\+\_\+\+GF2m\+\_\+mod\+\_\+mul\+\_\+arr     BN\+\_\+\+GF2m\+\_\+mod\+\_\+sqr\+\_\+arr     BN\+\_\+\+GF2m\+\_\+mod\+\_\+inv\+\_\+arr        \mbox{[}wrapper for BN\+\_\+\+GF2m\+\_\+mod\+\_\+inv\mbox{]}     BN\+\_\+\+GF2m\+\_\+mod\+\_\+div\+\_\+arr        \mbox{[}wrapper for BN\+\_\+\+GF2m\+\_\+mod\+\_\+div\mbox{]}     BN\+\_\+\+GF2m\+\_\+mod\+\_\+exp\+\_\+arr     BN\+\_\+\+GF2m\+\_\+mod\+\_\+sqrt\+\_\+arr     BN\+\_\+\+GF2m\+\_\+mod\+\_\+solve\+\_\+quad\+\_\+arr     BN\+\_\+\+GF2m\+\_\+poly2arr     BN\+\_\+\+GF2m\+\_\+arr2poly @endiverbatim    Conversion can be performed by the following functions\+: @iverbatim      BN\+\_\+\+GF2m\+\_\+poly2arr     BN\+\_\+\+GF2m\+\_\+arr2poly @endiverbatim    bntest.\+c has additional tests for binary polynomial arithmetic.     Two implementations for BN\+\_\+\+GF2m\+\_\+mod\+\_\+div() are available.    The default algorithm simply uses BN\+\_\+\+GF2m\+\_\+mod\+\_\+inv() and    BN\+\_\+\+GF2m\+\_\+mod\+\_\+mul().  The alternative algorithm is compiled in only    if OPENSSL\+\_\+\+SUN\+\_\+\+GF2\+M\+\_\+\+DIV is defined (patent pending; read the    copyright notice in crypto/bn/bn\+\_\+gf2m.\+c before enabling it).     $<$em$>$\+Sheueling Chang Shantz and Douglas Stebila (\+Sun Microsystems Laboratories)$<$/em$>$   \texorpdfstring{$\ast$}{*} Add new error code \textquotesingle{}\+ERR\+\_\+\+R\+\_\+\+DISABLED\textquotesingle{} that can be used when some    functionality is disabled at compile-\/time.     \texorpdfstring{$\ast$}{*}\+Douglas Stebila $<$douglas.\+stebila@sun.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Change default behaviour of \textquotesingle{}openssl asn1parse\textquotesingle{} so that more    information is visible when viewing, e.\+g., a certificate\+:     Modify asn1\+\_\+parse2 (crypto/asn1/asn1\+\_\+par.\+c) so that in non-\/\textquotesingle{}dump\textquotesingle{}    mode the content of non-\/printable OCTET STRINGs is output in a    style similar to INTEGERs, but with \textquotesingle{}\mbox{[}\+HEX DUMP\mbox{]}\textquotesingle{} prepended to    avoid the appearance of a printable string.     \texorpdfstring{$\ast$}{*}\+Nils Larsch $<$nla@trustcenter.\+de$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Add \textquotesingle{}asn1\+\_\+flag\textquotesingle{} and \textquotesingle{}asn1\+\_\+form\textquotesingle{} member to EC\+\_\+\+GROUP with access    functions            EC\+\_\+\+GROUP\+\_\+set\+\_\+asn1\+\_\+flag()            EC\+\_\+\+GROUP\+\_\+get\+\_\+asn1\+\_\+flag()            EC\+\_\+\+GROUP\+\_\+set\+\_\+point\+\_\+conversion\+\_\+form()            EC\+\_\+\+GROUP\+\_\+get\+\_\+point\+\_\+conversion\+\_\+form()    These control ASN1 encoding details\+:    -\/ Curves (i.\+e., groups) are encoded explicitly unless asn1\+\_\+flag      has been set to OPENSSL\+\_\+\+EC\+\_\+\+NAMED\+\_\+\+CURVE.    -\/ Points are encoded in uncompressed form by default; options for      asn1\+\_\+for are as for point2oct, namely            POINT\+\_\+\+CONVERSION\+\_\+\+COMPRESSED            POINT\+\_\+\+CONVERSION\+\_\+\+UNCOMPRESSED            POINT\+\_\+\+CONVERSION\+\_\+\+HYBRID     Also add \textquotesingle{}seed\textquotesingle{} and \textquotesingle{}seed\+\_\+len\textquotesingle{} members to EC\+\_\+\+GROUP with access    functions            EC\+\_\+\+GROUP\+\_\+set\+\_\+seed()            EC\+\_\+\+GROUP\+\_\+get0\+\_\+seed()            EC\+\_\+\+GROUP\+\_\+get\+\_\+seed\+\_\+len()    This is used only for ASN1 purposes (so far).     \texorpdfstring{$\ast$}{*}\+Nils Larsch $<$nla@trustcenter.\+de$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Add \textquotesingle{}field\+\_\+type\textquotesingle{} member to EC\+\_\+\+METHOD, which holds the NID    of the appropriate field type OID.  The new function    EC\+\_\+\+METHOD\+\_\+get\+\_\+field\+\_\+type() returns this value.     \texorpdfstring{$\ast$}{*}\+Nils Larsch $<$nla@trustcenter.\+de$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Add functions            EC\+\_\+\+POINT\+\_\+point2bn()            EC\+\_\+\+POINT\+\_\+bn2point()            EC\+\_\+\+POINT\+\_\+point2hex()            EC\+\_\+\+POINT\+\_\+hex2point()    providing useful interfaces to EC\+\_\+\+POINT\+\_\+point2oct() and    EC\+\_\+\+POINT\+\_\+oct2point().     \texorpdfstring{$\ast$}{*}\+Nils Larsch $<$nla@trustcenter.\+de$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Change internals of the EC library so that the functions            EC\+\_\+\+GROUP\+\_\+set\+\_\+generator()            EC\+\_\+\+GROUP\+\_\+get\+\_\+generator()            EC\+\_\+\+GROUP\+\_\+get\+\_\+order()            EC\+\_\+\+GROUP\+\_\+get\+\_\+cofactor()    are implemented directly in crypto/ec/ec\+\_\+lib.\+c and not dispatched    to methods, which would lead to unnecessary code duplication when    adding different types of curves.     \texorpdfstring{$\ast$}{*}\+Nils Larsch $<$nla@trustcenter.\+de$>$ with input by Bodo Moeller\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Implement compute\+\_\+w\+NAF (crypto/ec/ec\+\_\+mult.\+c) without BIGNUM    arithmetic, and such that modified w\+NAFs are generated    (which avoid length expansion in many cases).     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Add a function EC\+\_\+\+GROUP\+\_\+check\+\_\+discriminant() (defined via    EC\+\_\+\+METHOD) that verifies that the curve discriminant is non-\/zero.     Add a function EC\+\_\+\+GROUP\+\_\+check() that makes some sanity tests    on a EC\+\_\+\+GROUP, its generator and order.  This includes    EC\+\_\+\+GROUP\+\_\+check\+\_\+discriminant().     \texorpdfstring{$\ast$}{*}\+Nils Larsch $<$nla@trustcenter.\+de$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Add ECDSA in new directory crypto/ecdsa/.     Add applications \textquotesingle{}openssl ecparam\textquotesingle{} and \textquotesingle{}openssl ecdsa\textquotesingle{}    (these are based on \textquotesingle{}openssl dsaparam\textquotesingle{} and \textquotesingle{}openssl dsa\textquotesingle{}).     ECDSA support is also included in various other files across the    library.  Most notably,    -\/ \textquotesingle{}openssl req\textquotesingle{} now has a \textquotesingle{}-\/newkey ecdsa\+:file\textquotesingle{} option;    -\/ EVP\+\_\+\+PKCS82\+PKEY (crypto/evp/evp\+\_\+pkey.\+c) now can handle ECDSA;    -\/ X509\+\_\+\+PUBKEY\+\_\+get (crypto/asn1/x\+\_\+pubkey.\+c) and      d2i\+\_\+\+Public\+Key (crypto/asn1/d2i\+\_\+pu.\+c) have been modified to make      them suitable for ECDSA where domain parameters must be      extracted before the specific public key;    -\/ ECDSA engine support has been added.     \texorpdfstring{$\ast$}{*}\+Nils Larsch $<$nla@trustcenter.\+de$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Include some named elliptic curves, and add OIDs from X9.\+62,    SECG, and WAP/\+WTLS.  Each curve can be obtained from the new    function            EC\+\_\+\+GROUP\+\_\+new\+\_\+by\+\_\+curve\+\_\+name(),    and the list of available named curves can be obtained with            EC\+\_\+get\+\_\+builtin\+\_\+curves().    Also add a \textquotesingle{}curve\+\_\+name\textquotesingle{} member to EC\+\_\+\+GROUP objects, which can be    accessed via            EC\+\_\+\+GROUP\+\_\+set\+\_\+curve\+\_\+name()            EC\+\_\+\+GROUP\+\_\+get\+\_\+curve\+\_\+name()     \texorpdfstring{$\ast$}{*}\+Nils Larsch $<$larsch@trustcenter.\+de, Bodo Moeller\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Remove a few calls to bn\+\_\+wexpand() in BN\+\_\+sqr() (the one in there    was actually never needed) and in BN\+\_\+mul().  The removal in BN\+\_\+mul()    required a small change in bn\+\_\+mul\+\_\+part\+\_\+recursive() and the addition    of the functions bn\+\_\+cmp\+\_\+part\+\_\+words(), bn\+\_\+sub\+\_\+part\+\_\+words() and    bn\+\_\+add\+\_\+part\+\_\+words(), which do the same thing as bn\+\_\+cmp\+\_\+words(),    bn\+\_\+sub\+\_\+words() and bn\+\_\+add\+\_\+words() except they take arrays with    differing sizes.     $<$em$>$\+Richard Levitte$<$/em$>$  @subsection autotoc\+\_\+md135 Changes between 0.\+9.\+7l and 0.\+9.\+7m  \mbox{[}23 Feb 2007\mbox{]}   \texorpdfstring{$\ast$}{*} Cleanse PEM buffers before freeing them since they may contain    sensitive data.     \texorpdfstring{$\ast$}{*}\+Benjamin Bennett $<$ben@psc.\+edu$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Include "{}!e\+NULL"{} in SSL\+\_\+\+DEFAULT\+\_\+\+CIPHER\+\_\+\+LIST to make sure that    a ciphersuite string such as "{}DEFAULT\+:RSA"{} cannot enable    authentication-\/only ciphersuites.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Since AES128 and AES256 share a single mask bit in the logic of    ssl/ssl\+\_\+ciph.\+c, the code for masking out disabled ciphers needs a    kludge to work properly if AES128 is available and AES256 isn\textquotesingle{}t.     $<$em$>$\+Victor Duchovni$<$/em$>$   \texorpdfstring{$\ast$}{*} Expand security boundary to match 1.\+1.\+1 module.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Remove redundant features\+: hash file source, editing of test vectors    modify fipsld to use external fips\+\_\+premain.\+c signature.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} New perl script mkfipsscr.\+pl to create shell scripts or batch files to    run algorithm test programs.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Make algorithm test programs more tolerant of whitespace.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Have SSL/\+TLS server implementation tolerate "{}mismatched"{} record    protocol version while receiving Client\+Hello even if the    Client\+Hello is fragmented.  (\+The server can\textquotesingle{}t insist on the    particular protocol version it has chosen before the Server\+Hello    message has informed the client about his choice.)     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Load error codes if they are not already present instead of using a    static variable. This allows them to be cleanly unloaded and reloaded.     $<$em$>$\+Steve Henson$<$/em$>$  @subsection autotoc\+\_\+md136 Changes between 0.\+9.\+7k and 0.\+9.\+7l  \mbox{[}28 Sep 2006\mbox{]}   \texorpdfstring{$\ast$}{*} Introduce limits to prevent malicious keys being able to    cause a denial of service.  ($<$a href="{}\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2006-2940}{\texttt{ https\+://www.\+openssl.\+org/news/vulnerabilities.\+html\#\+CVE-\/2006-\/2940}}"{} $>$\+CVE-\/2006-\/2940$<$/a$>$)     $<$em$>$\+Steve Henson, Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix ASN.\+1 parsing of certain invalid structures that can result    in a denial of service.  ($<$a href="{}\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2006-2937}{\texttt{ https\+://www.\+openssl.\+org/news/vulnerabilities.\+html\#\+CVE-\/2006-\/2937}}"{} $>$\+CVE-\/2006-\/2937$<$/a$>$)  \mbox{[}\+Steve Henson\mbox{]}   \texorpdfstring{$\ast$}{*} Fix buffer overflow in SSL\+\_\+get\+\_\+shared\+\_\+ciphers() function.    ($<$a href="{}\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2006-3738}{\texttt{ https\+://www.\+openssl.\+org/news/vulnerabilities.\+html\#\+CVE-\/2006-\/3738}}"{} $>$\+CVE-\/2006-\/3738$<$/a$>$) \mbox{[}\+Tavis Ormandy and Will Drewry, Google Security Team\mbox{]}   \texorpdfstring{$\ast$}{*} Fix SSL client code which could crash if connecting to a    malicious SSLv2 server.  ($<$a href="{}\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2006-4343}{\texttt{ https\+://www.\+openssl.\+org/news/vulnerabilities.\+html\#\+CVE-\/2006-\/4343}}"{} $>$\+CVE-\/2006-\/4343$<$/a$>$)     $<$em$>$\+Tavis Ormandy and Will Drewry, Google Security Team$<$/em$>$   \texorpdfstring{$\ast$}{*} Change ciphersuite string processing so that an explicit    ciphersuite selects this one ciphersuite (so that "{}AES256-\/\+SHA"{}    will no longer include "{}AES128-\/\+SHA"{}), and any other similar    ciphersuite (same bitmap) from $<$em$>$other$<$/em$>$ protocol versions (so that    "{}RC4-\/\+MD5"{} will still include both the SSL 2.\+0 ciphersuite and the    SSL 3.\+0/\+TLS 1.\+0 ciphersuite).  This is a backport combining    changes from 0.\+9.\+8b and 0.\+9.\+8d.     $<$em$>$\+Bodo Moeller$<$/em$>$  @subsection autotoc\+\_\+md137 Changes between 0.\+9.\+7j and 0.\+9.\+7k  \mbox{[}05 Sep 2006\mbox{]}   \texorpdfstring{$\ast$}{*} Avoid PKCS \#1 v1.\+5 signature attack discovered by Daniel Bleichenbacher    ($<$a href="{}\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2006-4339}{\texttt{ https\+://www.\+openssl.\+org/news/vulnerabilities.\+html\#\+CVE-\/2006-\/4339}}"{} $>$\+CVE-\/2006-\/4339$<$/a$>$)  \mbox{[}\+Ben Laurie and Google Security Team\mbox{]}   \texorpdfstring{$\ast$}{*} Change the Unix randomness entropy gathering to use poll() when    possible instead of select(), since the latter has some    undesirable limitations.     $<$em$>$\+Darryl Miles via Richard Levitte and Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Disable rogue ciphersuites\+:     -\/ SSLv2 0x08 0x00 0x80 ("{}RC4-\/64-\/\+MD5"{})    -\/ SSLv3/\+TLSv1 0x00 0x61 ("{}EXP1024-\/\+RC2-\/\+CBC-\/\+MD5"{})    -\/ SSLv3/\+TLSv1 0x00 0x60 ("{}EXP1024-\/\+RC4-\/\+MD5"{})     The latter two were purportedly from    draft-\/ietf-\/tls-\/56-\/bit-\/ciphersuites-\/0\mbox{[}01\mbox{]}.\+txt, but do not really    appear there.     Also deactivate the remaining ciphersuites from    draft-\/ietf-\/tls-\/56-\/bit-\/ciphersuites-\/01.\+txt.  These are just as    unofficial, and the ID has long expired.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix RSA blinding Heisenbug (problems sometimes occurred on    dual-\/core machines) and other potential thread-\/safety issues.     $<$em$>$\+Bodo Moeller$<$/em$>$  @subsection autotoc\+\_\+md138 Changes between 0.\+9.\+7i and 0.\+9.\+7j  \mbox{[}04 May 2006\mbox{]}   \texorpdfstring{$\ast$}{*} Adapt fipsld and the build system to link against the validated FIPS    module in FIPS mode.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Fixes for VC++ 2005 build under Windows.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Add new Windows build target VC-\/32-\/\+GMAKE for VC++. This uses GNU make    from a Windows bash shell such as MSYS. It is autodetected from the    "{}config"{} script when run from a VC++ environment. Modify standard VC++    build to use fipscanister.\+o from the GNU make build.     $<$em$>$\+Steve Henson$<$/em$>$  @subsection autotoc\+\_\+md139 Changes between 0.\+9.\+7h and 0.\+9.\+7i  \mbox{[}14 Oct 2005\mbox{]}   \texorpdfstring{$\ast$}{*} Wrapped the definition of EVP\+\_\+\+MAX\+\_\+\+MD\+\_\+\+SIZE in a \#ifdef OPENSSL\+\_\+\+FIPS.    The value now differs depending on if you build for FIPS or not.    BEWARE!  A program linked with a shared FIPSed libcrypto can\textquotesingle{}t be    safely run with a non-\/\+FIPSed libcrypto, as it may crash because of    the difference induced by this change.     $<$em$>$\+Andy Polyakov$<$/em$>$  @subsection autotoc\+\_\+md140 Changes between 0.\+9.\+7g and 0.\+9.\+7h  \mbox{[}11 Oct 2005\mbox{]}   \texorpdfstring{$\ast$}{*} Remove the functionality of SSL\+\_\+\+OP\+\_\+\+MSIE\+\_\+\+SSLV2\+\_\+\+RSA\+\_\+\+PADDING    (part of SSL\+\_\+\+OP\+\_\+\+ALL).  This option used to disable the    countermeasure against man-\/in-\/the-\/middle protocol-\/version    rollback in the SSL 2.\+0 server implementation, which is a bad    idea.  ($<$a href="{}\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2005-2969}{\texttt{ https\+://www.\+openssl.\+org/news/vulnerabilities.\+html\#\+CVE-\/2005-\/2969}}"{} $>$\+CVE-\/2005-\/2969$<$/a$>$)     $<$em$>$\+Bodo Moeller; problem pointed out by Yutaka Oiwa (\+Research Center    for Information Security, National Institute of Advanced Industrial    Science and Technology \mbox{[}\+AIST, Japan)\mbox{]}$<$/em$>$   \texorpdfstring{$\ast$}{*} Minimal support for X9.\+31 signatures and PSS padding modes. This is    mainly for FIPS compliance and not fully integrated at this stage.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} For DSA signing, unless DSA\+\_\+\+FLAG\+\_\+\+NO\+\_\+\+EXP\+\_\+\+CONSTTIME is set, perform    the exponentiation using a fixed-\/length exponent.  (\+Otherwise,    the information leaked through timing could expose the secret key    after many signatures; cf. Bleichenbacher\textquotesingle{}s attack on DSA with    biased k.)     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Make a new fixed-\/window mod\+\_\+exp implementation the default for    RSA, DSA, and DH private-\/key operations so that the sequence of    squares and multiplies and the memory access pattern are    independent of the particular secret key.  This will mitigate    cache-\/timing and potential related attacks.     BN\+\_\+mod\+\_\+exp\+\_\+mont\+\_\+consttime() is the new exponentiation implementation,    and this is automatically used by BN\+\_\+mod\+\_\+exp\+\_\+mont() if the new flag    BN\+\_\+\+FLG\+\_\+\+EXP\+\_\+\+CONSTTIME is set for the exponent.  RSA, DSA, and DH    will use this BN flag for private exponents unless the flag    RSA\+\_\+\+FLAG\+\_\+\+NO\+\_\+\+EXP\+\_\+\+CONSTTIME, DSA\+\_\+\+FLAG\+\_\+\+NO\+\_\+\+EXP\+\_\+\+CONSTTIME, or    DH\+\_\+\+FLAG\+\_\+\+NO\+\_\+\+EXP\+\_\+\+CONSTTIME, respectively, is set.     $<$em$>$\+Matthew D Wood (\+Intel Corp), with some changes by Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Change the client implementation for SSLv23\+\_\+method() and    SSLv23\+\_\+client\+\_\+method() so that is uses the SSL 3.\+0/\+TLS 1.\+0    Client Hello message format if the SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+SSLv2 option is set.    (\+Previously, the SSL 2.\+0 backwards compatible Client Hello    message format would be used even with SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+SSLv2.)     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Add support for smime-\/type MIME parameter in S/\+MIME messages which some    clients need.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} New function BN\+\_\+\+MONT\+\_\+\+CTX\+\_\+set\+\_\+locked() to set montgomery parameters in    a threadsafe manner. Modify rsa code to use new function and add calls    to dsa and dh code (which had race conditions before).     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Include the fixed error library code in the C error file definitions    instead of fixing them up at runtime. This keeps the error code    structures constant.     $<$em$>$\+Steve Henson$<$/em$>$  @subsection autotoc\+\_\+md141 Changes between 0.\+9.\+7f and 0.\+9.\+7g  \mbox{[}11 Apr 2005\mbox{]}  \mbox{[}\+NB\+: Open\+SSL 0.\+9.\+7h and later 0.\+9.\+7 patch levels were released after \+Open\+SSL 0.\+9.\+8.\mbox{]}   \texorpdfstring{$\ast$}{*} Fixes for newer kerberos headers. NB\+: the casts are needed because    the \textquotesingle{}length\textquotesingle{} field is signed on one version and unsigned on another    with no (?) obvious way to tell the difference, without these VC++    complains. Also the "{}definition"{} of FAR (blank) is no longer included    nor is the error ENOMEM. KRB5\+\_\+\+PRIVATE has to be set to 1 to pick up    some needed definitions.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Undo Cygwin change.     $<$em$>$\+Ulf Möller$<$/em$>$   \texorpdfstring{$\ast$}{*} Added support for proxy certificates according to RFC 3820.    Because they may be a security thread to unaware applications,    they must be explicitly allowed in run-\/time.  See    docs/\+HOWTO/proxy\+\_\+certificates.\+txt for further information.     $<$em$>$\+Richard Levitte$<$/em$>$  @subsection autotoc\+\_\+md142 Changes between 0.\+9.\+7e and 0.\+9.\+7f  \mbox{[}22 Mar 2005\mbox{]}   \texorpdfstring{$\ast$}{*} Use (\+SSL\+\_\+\+RANDOM\+\_\+\+VALUE -\/ 4) bytes of pseudo random data when generating    server and client random values. Previously    (\+SSL\+\_\+\+RANDOM\+\_\+\+VALUE -\/ sizeof(time\+\_\+t)) would be used which would result in    less random data when sizeof(time\+\_\+t) $>$ 4 (some 64 bit platforms).     This change has negligible security impact because\+:     1. Server and client random values still have 24 bytes of pseudo random       data.     2. Server and client random values are sent in the clear in the initial       handshake.     3. The master secret is derived using the premaster secret (48 bytes in       size for static RSA ciphersuites) as well as client server and random       values.     The Open\+SSL team would like to thank the UK NISCC for bringing this issue    to our attention.     $<$em$>$\+Stephen Henson, reported by UK NISCC$<$/em$>$   \texorpdfstring{$\ast$}{*} Use Windows randomness collection on Cygwin.     $<$em$>$\+Ulf Möller$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix hang in EGD/\+PRNGD query when communication socket is closed    prematurely by EGD/\+PRNGD.     \texorpdfstring{$\ast$}{*}\+Darren Tucker $<$dtucker@zip.\+com.\+au$>$ via Lutz Jänicke, resolves \#1014\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Prompt for pass phrases when appropriate for PKCS12 input format.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Back-\/port of selected performance improvements from development    branch, as well as improved support for Power\+PC platforms.     $<$em$>$\+Andy Polyakov$<$/em$>$   \texorpdfstring{$\ast$}{*} Add lots of checks for memory allocation failure, error codes to indicate    failure and freeing up memory if a failure occurs.     \texorpdfstring{$\ast$}{*}\+Nauticus Networks SSL Team $<$openssl@nauticusnet.\+com$>$, Steve Henson\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Add new -\/passin argument to dgst.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Perform some character comparisons of different types in X509\+\_\+\+NAME\+\_\+cmp\+:    this is needed for some certificates that re-\/encode DNs into UTF8\+Strings    (in violation of RFC3280) and can\textquotesingle{}t or won\textquotesingle{}t issue name rollover    certificates.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Make an explicit check during certificate validation to see that    the CA setting in each certificate on the chain is correct.  As a    side effect always do the following basic checks on extensions,    not just when there\textquotesingle{}s an associated purpose to the check\+:     -\/ if there is an unhandled critical extension (unless the user      has chosen to ignore this fault)    -\/ if the path length has been exceeded (if one is set at all)    -\/ that certain extensions fit the associated purpose (if one has      been given)     $<$em$>$\+Richard Levitte$<$/em$>$  @subsection autotoc\+\_\+md143 Changes between 0.\+9.\+7d and 0.\+9.\+7e  \mbox{[}25 Oct 2004\mbox{]}   \texorpdfstring{$\ast$}{*} Avoid a race condition when CRLs are checked in a multi threaded    environment. This would happen due to the reordering of the revoked    entries during signature checking and serial number lookup. Now the    encoding is cached and the serial number sort performed under a lock.    Add new STACK function sk\+\_\+is\+\_\+sorted().     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Add Delta CRL to the extension code.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Various fixes to s3\+\_\+pkt.\+c so alerts are sent properly.     \texorpdfstring{$\ast$}{*}\+David Holmes $<$d.\+holmes@f5.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Reduce the chances of duplicate issuer name and serial numbers (in    violation of RFC3280) using the Open\+SSL certificate creation utilities.    This is done by creating a random 64 bit value for the initial serial    number when a serial number file is created or when a self signed    certificate is created using \textquotesingle{}openssl req -\/x509\textquotesingle{}. The initial serial    number file is created using \textquotesingle{}openssl x509 -\/next\+\_\+serial\textquotesingle{} in CA.\+pl    rather than being initialized to 1.     $<$em$>$\+Steve Henson$<$/em$>$  @subsection autotoc\+\_\+md144 Changes between 0.\+9.\+7c and 0.\+9.\+7d  \mbox{[}17 Mar 2004\mbox{]}   \texorpdfstring{$\ast$}{*} Fix null-\/pointer assignment in do\+\_\+change\+\_\+cipher\+\_\+spec() revealed    by using the Codenomicon TLS Test Tool ($<$a href="{}\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2004-0079}{\texttt{ https\+://www.\+openssl.\+org/news/vulnerabilities.\+html\#\+CVE-\/2004-\/0079}}"{} $>$\+CVE-\/2004-\/0079$<$/a$>$)     $<$em$>$\+Joe Orton, Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix flaw in SSL/\+TLS handshaking when using Kerberos ciphersuites    ($<$a href="{}\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2004-0112}{\texttt{ https\+://www.\+openssl.\+org/news/vulnerabilities.\+html\#\+CVE-\/2004-\/0112}}"{} $>$\+CVE-\/2004-\/0112$<$/a$>$)     $<$em$>$\+Joe Orton, Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Make it possible to have multiple active certificates with the same    subject in the CA index file.  This is done only if the keyword    \textquotesingle{}unique\+\_\+subject\textquotesingle{} is set to \textquotesingle{}no\textquotesingle{} in the main CA section (default    if \textquotesingle{}\+CA\+\_\+default\textquotesingle{}) of the configuration file.  The value is saved    with the database itself in a separate index attribute file,    named like the index file with \textquotesingle{}.\+attr\textquotesingle{} appended to the name.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} X509 verify fixes. Disable broken certificate workarounds when    X509\+\_\+\+V\+\_\+\+FLAGS\+\_\+\+X509\+\_\+\+STRICT is set. Check CRL issuer has c\+RLSign set if    key\+Usage extension present. Don\textquotesingle{}t accept CRLs with unhandled critical    extensions\+: since verify currently doesn\textquotesingle{}t process CRL extensions this    rejects a CRL with $<$em$>$any$<$/em$>$ critical extensions. Add new verify error codes    for these cases.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} When creating an OCSP nonce use an OCTET STRING inside the extn\+Value.    A clarification of RFC2560 will require the use of OCTET STRINGs and    some implementations cannot handle the current raw format. Since Open\+SSL    copies and compares OCSP nonces as opaque blobs without any attempt at    parsing them this should not create any compatibility issues.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} New md flag EVP\+\_\+\+MD\+\_\+\+CTX\+\_\+\+FLAG\+\_\+\+REUSE this allows md\+\_\+data to be reused when    calling EVP\+\_\+\+MD\+\_\+\+CTX\+\_\+copy\+\_\+ex() to avoid calling OPENSSL\+\_\+malloc(). Without    this HMAC (and other) operations are several times slower than Open\+SSL    $<$ 0.\+9.\+7.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Print out Generalized\+Time and UTCTime in ASN1\+\_\+\+STRING\+\_\+print\+\_\+ex().     \texorpdfstring{$\ast$}{*}\+Peter Sylvester $<$\+Peter.\+Sylvester@\+Edel\+Web.\+fr$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Use the correct content when signing type "{}other"{}.     $<$em$>$\+Steve Henson$<$/em$>$  @subsection autotoc\+\_\+md145 Changes between 0.\+9.\+7b and 0.\+9.\+7c  \mbox{[}30 Sep 2003\mbox{]}   \texorpdfstring{$\ast$}{*} Fix various bugs revealed by running the NISCC test suite\+:     Stop out of bounds reads in the ASN1 code when presented with    invalid tags (\+CVE-\/2003-\/0543 and CVE-\/2003-\/0544).     Free up ASN1\+\_\+\+TYPE correctly if ANY type is invalid ($<$a href="{}\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2003-0545}{\texttt{ https\+://www.\+openssl.\+org/news/vulnerabilities.\+html\#\+CVE-\/2003-\/0545}}"{} $>$\+CVE-\/2003-\/0545$<$/a$>$).     If verify callback ignores invalid public key errors don\textquotesingle{}t try to check    certificate signature with the NULL public key.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} New -\/ignore\+\_\+err option in ocsp application to stop the server    exiting on the first error in a request.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} In ssl3\+\_\+accept() (ssl/s3\+\_\+srvr.\+c) only accept a client certificate    if the server requested one\+: as stated in TLS 1.\+0 and SSL 3.\+0    specifications.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} In ssl3\+\_\+get\+\_\+client\+\_\+hello() (ssl/s3\+\_\+srvr.\+c), tolerate additional    extra data after the compression methods not only for TLS 1.\+0    but also for SSL 3.\+0 (as required by the specification).     $<$em$>$\+Bodo Moeller; problem pointed out by Matthias Loepfe$<$/em$>$   \texorpdfstring{$\ast$}{*} Change X509\+\_\+certificate\+\_\+type() to mark the key as exported/exportable    when it\textquotesingle{}s 512 $<$em$>$bits$<$/em$>$ long, not 512 bytes.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Change AES\+\_\+cbc\+\_\+encrypt() so it outputs exact multiple of    blocks during encryption.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Various fixes to base64 BIO and non blocking I/\+O. On write    flushes were not handled properly if the BIO retried. On read    data was not being buffered properly and had various logic bugs.    This also affects blocking I/\+O when the data being decoded is a    certain size.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Various S/\+MIME bugfixes and compatibility changes\+:    output correct application/pkcs7 MIME type if    PKCS7\+\_\+\+NOOLDMIMETYPE is set. Tolerate some broken signatures.    Output CR+\+LF for EOL if PKCS7\+\_\+\+CRLFEOL is set (this makes opening    of files as .\+eml work). Correctly handle very long lines in MIME    parser.     $<$em$>$\+Steve Henson$<$/em$>$  @subsection autotoc\+\_\+md146 Changes between 0.\+9.\+7a and 0.\+9.\+7b  \mbox{[}10 Apr 2003\mbox{]}   \texorpdfstring{$\ast$}{*} Countermeasure against the Klima-\/\+Pokorny-\/\+Rosa extension of    Bleichbacher\textquotesingle{}s attack on PKCS \#1 v1.\+5 padding\+: treat    a protocol version number mismatch like a decryption error    in ssl3\+\_\+get\+\_\+client\+\_\+key\+\_\+exchange (ssl/s3\+\_\+srvr.\+c).     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Turn on RSA blinding by default in the default implementation    to avoid a timing attack. Applications that don\textquotesingle{}t want it can call    RSA\+\_\+blinding\+\_\+off() or use the new flag RSA\+\_\+\+FLAG\+\_\+\+NO\+\_\+\+BLINDING.    They would be ill-\/advised to do so in most cases.     $<$em$>$\+Ben Laurie, Steve Henson, Geoff Thorpe, Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Change RSA blinding code so that it works when the PRNG is not    seeded (in this case, the secret RSA exponent is abused as    an unpredictable seed -- if it is not unpredictable, there    is no point in blinding anyway).  Make RSA blinding thread-\/safe    by remembering the creator\textquotesingle{}s thread ID in rsa-\/$>$blinding and    having all other threads use local one-\/time blinding factors    (this requires more computation than sharing rsa-\/$>$blinding, but    avoids excessive locking; and if an RSA object is not shared    between threads, blinding will still be very fast).     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Fixed a typo bug that would cause ENGINE\+\_\+set\+\_\+default() to set an    ENGINE as defaults for all supported algorithms irrespective of    the \textquotesingle{}flags\textquotesingle{} parameter. \textquotesingle{}flags\textquotesingle{} is now honoured, so applications    should make sure they are passing it correctly.     $<$em$>$\+Geoff Thorpe$<$/em$>$   \texorpdfstring{$\ast$}{*} Target "{}mingw"{} now allows native Windows code to be generated in    the Cygwin environment as well as with the Min\+GW compiler.     $<$em$>$\+Ulf Moeller$<$/em$>$  @subsection autotoc\+\_\+md147 Changes between 0.\+9.\+7 and 0.\+9.\+7a  \mbox{[}19 Feb 2003\mbox{]}   \texorpdfstring{$\ast$}{*} In ssl3\+\_\+get\+\_\+record (ssl/s3\+\_\+pkt.\+c), minimize information leaked    via timing by performing a MAC computation even if incorrect    block cipher padding has been found.  This is a countermeasure    against active attacks where the attacker has to distinguish    between bad padding and a MAC verification error. ($<$a href="{}\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2003-0078}{\texttt{ https\+://www.\+openssl.\+org/news/vulnerabilities.\+html\#\+CVE-\/2003-\/0078}}"{} $>$\+CVE-\/2003-\/0078$<$/a$>$)     $<$em$>$\+Bodo Moeller; problem pointed out by Brice Canvel (\+EPFL),    Alain Hiltgen (\+UBS), Serge Vaudenay (\+EPFL), and    Martin Vuagnoux (\+EPFL, Ilion)$<$/em$>$   \texorpdfstring{$\ast$}{*} Make the no-\/err option work as intended.  The intention with no-\/err    is not to have the whole error stack handling routines removed from    libcrypto, it\textquotesingle{}s only intended to remove all the function name and    reason texts, thereby removing some of the footprint that may not    be interesting if those errors aren\textquotesingle{}t displayed anyway.     NOTE\+: it\textquotesingle{}s still possible for any application or module to have its    own set of error texts inserted.  The routines are there, just not    used by default when no-\/err is given.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Add support for Free\+BSD on IA64.     \texorpdfstring{$\ast$}{*}dirk.\+meyer@dinoex.\+sub.\+org via Richard Levitte, resolves \#454\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Adjust DES\+\_\+cbc\+\_\+cksum() so it returns the same value as the MIT    Kerberos function mit\+\_\+des\+\_\+cbc\+\_\+cksum().  Before this change,    the value returned by DES\+\_\+cbc\+\_\+cksum() was like the one from    mit\+\_\+des\+\_\+cbc\+\_\+cksum(), except the bytes were swapped.     \texorpdfstring{$\ast$}{*}\+Kevin Greaney $<$\+Kevin.\+Greaney@hp.\+com$>$ and Richard Levitte\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Allow an application to disable the automatic SSL chain building.    Before this a rather primitive chain build was always performed in    ssl3\+\_\+output\+\_\+cert\+\_\+chain()\+: an application had no way to send the    correct chain if the automatic operation produced an incorrect result.     Now the chain builder is disabled if either\+:     1. Extra certificates are added via SSL\+\_\+\+CTX\+\_\+add\+\_\+extra\+\_\+chain\+\_\+cert().     2. The mode flag SSL\+\_\+\+MODE\+\_\+\+NO\+\_\+\+AUTO\+\_\+\+CHAIN is set.     The reasoning behind this is that an application would not want the    auto chain building to take place if extra chain certificates are    present and it might also want a means of sending no additional    certificates (for example the chain has two certificates and the    root is omitted).     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Add the possibility to build without the ENGINE framework.     \texorpdfstring{$\ast$}{*}\+Steven Reddie $<$smr@essemer.\+com.\+au$>$ via Richard Levitte\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Under Win32 gmtime() can return NULL\+: check return value in    OPENSSL\+\_\+gmtime(). Add error code for case where gmtime() fails.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} DSA routines\+: under certain error conditions uninitialized BN objects    could be freed. Solution\+: make sure initialization is performed early    enough. (\+Reported and fix supplied by Ivan D Nestlerode $<$nestler@\+MIT.\+EDU$>$,    Nils Larsch $<$nla@trustcenter.\+de$>$ via PR\#459)     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Another fix for SSLv2 session ID handling\+: the session ID was incorrectly    checked on reconnect on the client side, therefore session resumption    could still fail with a "{}ssl session id is different"{} error. This    behaviour is masked when SSL\+\_\+\+OP\+\_\+\+ALL is used due to    SSL\+\_\+\+OP\+\_\+\+MICROSOFT\+\_\+\+SESS\+\_\+\+ID\+\_\+\+BUG being set.    Behaviour observed by Crispin Flowerday $<$crispin@flowerday.\+cx$>$ as    followup to PR \#377.     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} IA-\/32 assembler support enhancements\+: unified ELF targets, support    for SCO/\+Caldera platforms, fix for Cygwin shared build.     $<$em$>$\+Andy Polyakov$<$/em$>$   \texorpdfstring{$\ast$}{*} Add support for Free\+BSD on sparc64.  As a consequence, support for    Free\+BSD on non-\/x86 processors is separate from x86 processors on    the config script, much like the Net\+BSD support.     \texorpdfstring{$\ast$}{*}\+Richard Levitte \& Kris Kennaway $<$kris@obsecurity.\+org$>$\texorpdfstring{$\ast$}{*}  @subsection autotoc\+\_\+md148 Changes between 0.\+9.\+6h and 0.\+9.\+7  \mbox{[}31 Dec 2002\mbox{]}  \mbox{[}\+NB\+: Open\+SSL 0.\+9.\+6i and later 0.\+9.\+6 patch levels were released after \+Open\+SSL 0.\+9.\+7.\mbox{]}   \texorpdfstring{$\ast$}{*} Fix session ID handling in SSLv2 client code\+: the SERVER FINISHED    code (06) was taken as the first octet of the session ID and the last    octet was ignored consequently. As a result SSLv2 client side session    caching could not have worked due to the session ID mismatch between    client and server.    Behaviour observed by Crispin Flowerday $<$crispin@flowerday.\+cx$>$ as    PR \#377.     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Change the declaration of needed Kerberos libraries to use EX\+\_\+\+LIBS    instead of the special (and badly supported) LIBKRB5.  LIBKRB5 is    removed entirely.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} The hw\+\_\+ncipher.\+c engine requires dynamic locks.  Unfortunately, it    seems that in spite of existing for more than a year, many application    author have done nothing to provide the necessary callbacks, which    means that this particular engine will not work properly anywhere.    This is a very unfortunate situation which forces us, in the name    of usability, to give the hw\+\_\+ncipher.\+c a static lock, which is part    of libcrypto.    NOTE\+: This is for the 0.\+9.\+7 series ONLY.  This hack will never    appear in 0.\+9.\+8 or later.  We EXPECT application authors to have    dealt properly with this when 0.\+9.\+8 is released (unless we actually    make such changes in the libcrypto locking code that changes will    have to be made anyway).     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} In asn1\+\_\+d2i\+\_\+read\+\_\+bio() repeatedly call BIO\+\_\+read() until all content    octets have been read, EOF or an error occurs. Without this change    some truncated ASN1 structures will not produce an error.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Disable Heimdal support, since it hasn\textquotesingle{}t been fully implemented.    Still give the possibility to force the use of Heimdal, but with    warnings and a request that patches get sent to openssl-\/dev.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Add the VC-\/\+CE target, introduce the WINCE sysname, and add    INSTALL.\+WCE and appropriate conditionals to make it build.     \texorpdfstring{$\ast$}{*}\+Steven Reddie $<$smr@essemer.\+com.\+au$>$ via Richard Levitte\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Change the DLL names for Cygwin to cygcrypto-\/x.\+y.\+z.\+dll and    cygssl-\/x.\+y.\+z.\+dll, where x, y and z are the major, minor and    edit numbers of the version.     \texorpdfstring{$\ast$}{*}\+Corinna Vinschen $<$vinschen@redhat.\+com$>$ and Richard Levitte\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Introduce safe string copy and catenation functions    (\+BUF\+\_\+strlcpy() and BUF\+\_\+strlcat()).     $<$em$>$\+Ben Laurie (\+CHATS) and Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Avoid using fixed-\/size buffers for one-\/line DNs.     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} Add BUF\+\_\+\+MEM\+\_\+grow\+\_\+clean() to avoid information leakage when    resizing buffers containing secrets, and use where appropriate.     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} Avoid using fixed size buffers for configuration file location.     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} Avoid filename truncation for various CA files.     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} Use sizeof in preference to magic numbers.     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} Avoid filename truncation in cert requests.     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} Add assertions to check for (supposedly impossible) buffer    overflows.     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} Don\textquotesingle{}t cache truncated DNS entries in the local cache (this could    potentially lead to a spoofing attack).     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix various buffers to be large enough for hex/decimal    representations in a platform independent manner.     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} Add CRYPTO\+\_\+realloc\+\_\+clean() to avoid information leakage when    resizing buffers containing secrets, and use where appropriate.     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} Add BIO\+\_\+indent() to avoid much slightly worrying code to do    indents.     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} Convert sprintf()/\+BIO\+\_\+puts() to BIO\+\_\+printf().     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} buffer\+\_\+gets() could terminate with the buffer only half    full. Fixed.     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} Add assertions to prevent user-\/supplied crypto functions from    overflowing internal buffers by having large block sizes, etc.     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} New OPENSSL\+\_\+assert() macro (similar to assert(), but enabled    unconditionally).     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} Eliminate unused copy of key in RC4.     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} Eliminate unused and incorrectly sized buffers for IV in pem.\+h.     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix off-\/by-\/one error in EGD path.     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} If RANDFILE path is too long, ignore instead of truncating.     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} Eliminate unused and incorrectly sized X.\+509 structure    CBCParameter.     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} Eliminate unused and dangerous function knumber().     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} Eliminate unused and dangerous structure, KSSL\+\_\+\+ERR.     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} Protect against overlong session ID context length in an encoded    session object. Since these are local, this does not appear to be    exploitable.     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} Change from security patch (see 0.\+9.\+6e below) that did not affect    the 0.\+9.\+6 release series\+:     Remote buffer overflow in SSL3 protocol -\/ an attacker could    supply an oversized master key in Kerberos-\/enabled versions.    ($<$a href="{}\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2002-0657}{\texttt{ https\+://www.\+openssl.\+org/news/vulnerabilities.\+html\#\+CVE-\/2002-\/0657}}"{} $>$\+CVE-\/2002-\/0657$<$/a$>$)     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} Change the SSL kerb5 codes to match RFC 2712.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Make -\/nameopt work fully for req and add -\/reqopt switch.     \texorpdfstring{$\ast$}{*}\+Michael Bell $<$michael.\+bell@rz.\+hu-\/berlin.\+de$>$, Steve Henson\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} The "{}block size"{} for block ciphers in CFB and OFB mode should be 1.     \texorpdfstring{$\ast$}{*}\+Steve Henson, reported by Yngve Nysaeter Pettersen $<$yngve@opera.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Make sure tests can be performed even if the corresponding algorithms    have been removed entirely.  This was also the last step to make    Open\+SSL compilable with DJGPP under all reasonable conditions.     \texorpdfstring{$\ast$}{*}\+Richard Levitte, Doug Kaufman $<$dkaufman@rahul.\+net$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Add cipher selection rules COMPLEMENTOFALL and COMPLEMENTOFDEFAULT    to allow version independent disabling of normally unselected ciphers,    which may be activated as a side-\/effect of selecting a single cipher.     (\+E.\+g., cipher list string "{}RSA"{} enables ciphersuites that are left    out of "{}ALL"{} because they do not provide symmetric encryption.    "{}RSA\+:!\+COMPLEMEMENTOFALL"{} avoids these unsafe ciphersuites.)     $<$em$>$\+Lutz Jaenicke, Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Add appropriate support for separate platform-\/dependent build    directories.  The recommended way to make a platform-\/dependent    build directory is the following (tested on Linux), maybe with    some local tweaks\+: @iverbatim      \# Place yourself outside of the Open\+SSL source tree.  In     \# this example, the environment variable OPENSSL\+\_\+\+SOURCE     \# is assumed to contain the absolute Open\+SSL source directory.     mkdir -\/p objtree/"{}\`{}uname -\/s\`{}-\/\`{}uname -\/r\`{}-\/\`{}uname -\/m\`{}"{}     cd objtree/"{}\`{}uname -\/s\`{}-\/\`{}uname -\/r\`{}-\/\`{}uname -\/m\`{}"{}     (cd \$\+OPENSSL\+\_\+\+SOURCE; find . -\/type f) \texorpdfstring{$\vert$}{|} while read F; do             mkdir -\/p \`{}dirname \$\+F\`{}             ln -\/s \$\+OPENSSL\+\_\+\+SOURCE/\$\+F \$\+F     done @endiverbatim    To be absolutely sure not to disturb the source tree, a "{}make clean"{}    is a good thing.  If it isn\textquotesingle{}t successful, don\textquotesingle{}t worry about it,    it probably means the source directory is very clean.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Make sure any ENGINE control commands make local copies of string    pointers passed to them whenever necessary. Otherwise it is possible    the caller may have overwritten (or deallocated) the original string    data when a later ENGINE operation tries to use the stored values.     \texorpdfstring{$\ast$}{*}\+Götz Babin-\/\+Ebell $<$babinebell@trustcenter.\+de$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Improve diagnostics in file reading and command-\/line digests.     \texorpdfstring{$\ast$}{*}\+Ben Laurie aided and abetted by Solar Designer $<$solar@openwall.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Add AES modes CFB and OFB to the object database.  Correct an    error in AES-\/\+CFB decryption.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Remove most calls to EVP\+\_\+\+CIPHER\+\_\+\+CTX\+\_\+cleanup() in evp\+\_\+enc.\+c, this    allows existing EVP\+\_\+\+CIPHER\+\_\+\+CTX structures to be reused after    calling $<$tt$>$\+EVP\+\_\+\texorpdfstring{$\ast$}{*}\+Final()$<$/tt$>$. This behaviour is used by encryption    BIOs and some applications. This has the side effect that    applications must explicitly clean up cipher contexts with    EVP\+\_\+\+CIPHER\+\_\+\+CTX\+\_\+cleanup() or they will leak memory.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Check the values of dna and dnb in bn\+\_\+mul\+\_\+recursive before calling    bn\+\_\+mul\+\_\+comba (a non zero value means the a or b arrays do not contain    n2 elements) and fallback to bn\+\_\+mul\+\_\+normal if either is not zero.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix escaping of non-\/\+ASCII characters when using the -\/subj option    of the "{}openssl req"{} command line tool. (\+Robert Joop $<$joop@fokus.\+gmd.\+de$>$)     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Make object definitions compliant to LDAP (\+RFC2256)\+: SN is the short    form for "{}surname"{}, serial\+Number has no short form.    Use "{}mail"{} as the short name for "{}rfc822\+Mailbox"{} according to RFC2798;    therefore remove "{}mail"{} short name for "{}internet 7"{}.    The OID for unique identifiers in X509 certificates is    x500\+Unique\+Identifier, not unique\+Identifier.    Some more OID additions. (\+Michael Bell $<$michael.\+bell@rz.\+hu-\/berlin.\+de$>$)     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Add an "{}init"{} command to the ENGINE config module and auto initialize    ENGINEs. Without any "{}init"{} command the ENGINE will be initialized    after all ctrl commands have been executed on it. If init=1 the    ENGINE is initialized at that point (ctrls before that point are run    on the uninitialized ENGINE and after on the initialized one). If    init=0 then the ENGINE will not be initialized at all.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix the \textquotesingle{}app\+\_\+verify\+\_\+callback\textquotesingle{} interface so that the user-\/defined    argument is actually passed to the callback\+: In the    SSL\+\_\+\+CTX\+\_\+set\+\_\+cert\+\_\+verify\+\_\+callback() prototype, the callback    declaration has been changed from            int (\texorpdfstring{$\ast$}{*}cb)()    into            int (\texorpdfstring{$\ast$}{*}cb)(\+X509\+\_\+\+STORE\+\_\+\+CTX \texorpdfstring{$\ast$}{*},void \texorpdfstring{$\ast$}{*});    in ssl\+\_\+verify\+\_\+cert\+\_\+chain (ssl/ssl\+\_\+cert.\+c), the call            i=s-\/$>$ctx-\/$>$app\+\_\+verify\+\_\+callback(\&ctx)    has been changed into            i=s-\/$>$ctx-\/$>$app\+\_\+verify\+\_\+callback(\&ctx, s-\/$>$ctx-\/$>$app\+\_\+verify\+\_\+arg).     To update applications using SSL\+\_\+\+CTX\+\_\+set\+\_\+cert\+\_\+verify\+\_\+callback(),    a dummy argument can be added to their callback functions.     \texorpdfstring{$\ast$}{*}\+D. K. Smetters $<$smetters@parc.\+xerox.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Added the \textquotesingle{}4758cca\textquotesingle{} ENGINE to support IBM 4758 cards.     \texorpdfstring{$\ast$}{*}\+Maurice Gittens $<$maurice@gittens.\+nl$>$, touchups by Geoff Thorpe\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Add and OPENSSL\+\_\+\+LOAD\+\_\+\+CONF define which will cause    Open\+SSL\+\_\+add\+\_\+all\+\_\+algorithms() to load the openssl.\+cnf config file.    This allows older applications to transparently support certain    Open\+SSL features\+: such as crypto acceleration and dynamic ENGINE loading.    Two new functions OPENSSL\+\_\+add\+\_\+all\+\_\+algorithms\+\_\+noconf() which will never    load the config file and OPENSSL\+\_\+add\+\_\+all\+\_\+algorithms\+\_\+conf() which will    always load it have also been added.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Add the OFB, CFB and CTR (all with 128 bit feedback) to AES.    Adjust NIDs and EVP layer.     \texorpdfstring{$\ast$}{*}\+Stephen Sprunk $<$stephen@sprunk.\+org$>$ and Richard Levitte\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Config modules support in openssl utility.     Most commands now load modules from the config file,    though in a few (such as version) this isn\textquotesingle{}t done    because it couldn\textquotesingle{}t be used for anything.     In the case of ca and req the config file used is    the same as the utility itself\+: that is the -\/config    command line option can be used to specify an    alternative file.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Move default behaviour from OPENSSL\+\_\+config(). If appname is NULL    use "{}openssl\+\_\+conf"{} if filename is NULL use default openssl config file.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Add an argument to OPENSSL\+\_\+config() to allow the use of an alternative    config section name. Add a new flag to tolerate a missing config file    and move code to CONF\+\_\+modules\+\_\+load\+\_\+file().     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Support for crypto accelerator cards from Accelerated Encryption    Processing, www.\+aep.\+ie.  (\+Use engine \textquotesingle{}aep\textquotesingle{})    The support was copied from 0.\+9.\+6c \mbox{[}engine\mbox{]} and adapted/corrected    to work with the new engine framework.     $<$em$>$\+AEP Inc. and Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Support for Sure\+Ware crypto accelerator cards from Baltimore    Technologies.  (\+Use engine \textquotesingle{}sureware\textquotesingle{})    The support was copied from 0.\+9.\+6c \mbox{[}engine\mbox{]} and adapted    to work with the new engine framework.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Have the CHIL engine fork-\/safe (as defined by n\+Cipher) and actually    make the newer ENGINE framework commands for the CHIL engine work.     \texorpdfstring{$\ast$}{*}\+Toomas Kiisk $<$vix@cyber.\+ee$>$ and Richard Levitte\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Make it possible to produce shared libraries on Reliant\+UNIX.     \texorpdfstring{$\ast$}{*}\+Robert Dahlem $<$\+Robert.\+Dahlem@ffm2.\+siemens.\+de$>$ via Richard Levitte\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Add the configuration target debug-\/linux-\/ppro.    Make \textquotesingle{}openssl rsa\textquotesingle{} use the general key loading routines    implemented in $<$tt$>$apps.\+c$<$/tt$>$, and make those routines able to    handle the key format FORMAT\+\_\+\+NETSCAPE and the variant    FORMAT\+\_\+\+IISSGC.     \texorpdfstring{$\ast$}{*}\+Toomas Kiisk $<$vix@cyber.\+ee$>$ via Richard Levitte\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Fix a crashbug and a logic bug in hwcrhk\+\_\+load\+\_\+pubkey().     \texorpdfstring{$\ast$}{*}\+Toomas Kiisk $<$vix@cyber.\+ee$>$ via Richard Levitte\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Add -\/keyform to rsautl, and document -\/engine.     \texorpdfstring{$\ast$}{*}\+Richard Levitte, inspired by Toomas Kiisk $<$vix@cyber.\+ee$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Change BIO\+\_\+new\+\_\+file (crypto/bio/bss\+\_\+file.\+c) to use new    BIO\+\_\+\+R\+\_\+\+NO\+\_\+\+SUCH\+\_\+\+FILE error code rather than the generic    ERR\+\_\+\+R\+\_\+\+SYS\+\_\+\+LIB error code if fopen() fails with ENOENT.     $<$em$>$\+Ben Laurie$<$/em$>$   \texorpdfstring{$\ast$}{*} Add new functions            ERR\+\_\+peek\+\_\+last\+\_\+error            ERR\+\_\+peek\+\_\+last\+\_\+error\+\_\+line            ERR\+\_\+peek\+\_\+last\+\_\+error\+\_\+line\+\_\+data.    These are similar to            ERR\+\_\+peek\+\_\+error            ERR\+\_\+peek\+\_\+error\+\_\+line            ERR\+\_\+peek\+\_\+error\+\_\+line\+\_\+data,    but report on the latest error recorded rather than the first one    still in the error queue.     $<$em$>$\+Ben Laurie, Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} default\+\_\+algorithms option in ENGINE config module. This allows things    like\+:    default\+\_\+algorithms = ALL    default\+\_\+algorithms = RSA, DSA, RAND, CIPHERS, DIGESTS     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Preliminary ENGINE config module.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} New experimental application configuration code.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Change the AES code to follow the same name structure as all other    symmetric ciphers, and behave the same way.  Move everything to    the directory crypto/aes, thereby obsoleting crypto/rijndael.     \texorpdfstring{$\ast$}{*}\+Stephen Sprunk $<$stephen@sprunk.\+org$>$ and Richard Levitte\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} SECURITY\+: remove unsafe setjmp/signal interaction from ui\+\_\+openssl.\+c.     $<$em$>$\+Ben Laurie and Theo de Raadt$<$/em$>$   \texorpdfstring{$\ast$}{*} Add option to output public keys in req command.     \texorpdfstring{$\ast$}{*}\+Massimiliano Pala madwolf@openca.\+org\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Use w\+NAFs in EC\+\_\+\+POINTs\+\_\+mul() for improved efficiency    (up to about 10\% better than before for P-\/192 and P-\/224).     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} New functions/macros @iverbatim      SSL\+\_\+\+CTX\+\_\+set\+\_\+msg\+\_\+callback(ctx, cb)     SSL\+\_\+\+CTX\+\_\+set\+\_\+msg\+\_\+callback\+\_\+arg(ctx, arg)     SSL\+\_\+set\+\_\+msg\+\_\+callback(ssl, cb)     SSL\+\_\+set\+\_\+msg\+\_\+callback\+\_\+arg(ssl, arg) @endiverbatim    to request calling a callback function @iverbatim      void cb(int write\+\_\+p, int version, int content\+\_\+type,             const void \texorpdfstring{$\ast$}{*}buf, size\+\_\+t len, SSL \texorpdfstring{$\ast$}{*}ssl, void \texorpdfstring{$\ast$}{*}arg) @endiverbatim    whenever a protocol message has been completely received    (write\+\_\+p == 0) or sent (write\+\_\+p == 1).  Here \textquotesingle{}version\textquotesingle{} is the    protocol version  according to which the SSL library interprets    the current protocol message (\+SSL2\+\_\+\+VERSION, SSL3\+\_\+\+VERSION, or    TLS1\+\_\+\+VERSION).  \textquotesingle{}content\+\_\+type\textquotesingle{} is 0 in the case of SSL 2.\+0, or    the content type as defined in the SSL 3.\+0/\+TLS 1.\+0 protocol    specification (change\+\_\+cipher\+\_\+spec(20), alert(21), handshake(22)).    \textquotesingle{}buf\textquotesingle{} and \textquotesingle{}len\textquotesingle{} point to the actual message, \textquotesingle{}ssl\textquotesingle{} to the    SSL object, and \textquotesingle{}arg\textquotesingle{} is the application-\/defined value set by    SSL\mbox{[}\+\_\+\+CTX\mbox{]}\+\_\+set\+\_\+msg\+\_\+callback\+\_\+arg().     \textquotesingle{}openssl s\+\_\+client\textquotesingle{} and \textquotesingle{}openssl s\+\_\+server\textquotesingle{} have new \textquotesingle{}-\/msg\textquotesingle{} options    to enable a callback that displays all protocol messages.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Change the shared library support so shared libraries are built as    soon as the corresponding static library is finished, and thereby get    openssl and the test programs linked against the shared library.    This still only happens when the keyword "{}shard"{} has been given to    the configuration scripts.     NOTE\+: shared library support is still an experimental thing, and    backward binary compatibility is still not guaranteed.     \texorpdfstring{$\ast$}{*}"{}Maciej W. Rozycki"{} $<$macro@ds2.\+pg.\+gda.\+pl$>$ and Richard Levitte\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Add support for Subject Information Access extension.     \texorpdfstring{$\ast$}{*}\+Peter Sylvester $<$\+Peter.\+Sylvester@\+Edel\+Web.\+fr$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Make BUF\+\_\+\+MEM\+\_\+grow() behaviour more consistent\+: Initialise to zero    additional bytes when new memory had to be allocated, not just    when reusing an existing buffer.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} New command line and configuration option \textquotesingle{}utf8\textquotesingle{} for the req command.    This allows field values to be specified as UTF8 strings.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Add -\/multi and -\/mr options to "{}openssl speed"{} -\/ giving multiple parallel    runs for the former and machine-\/readable output for the latter.     $<$em$>$\+Ben Laurie$<$/em$>$   \texorpdfstring{$\ast$}{*} Add \textquotesingle{}-\/noemail\+DN\textquotesingle{} option to \textquotesingle{}openssl ca\textquotesingle{}.  This prevents inclusion    of the e-\/mail address in the DN (i.\+e., it will go into a certificate    extension only).  The new configuration file option \textquotesingle{}email\+\_\+in\+\_\+dn = no\textquotesingle{}    has the same effect.     \texorpdfstring{$\ast$}{*}\+Massimiliano Pala madwolf@openca.\+org\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Change all functions with names starting with $<$tt$>$des\+\_\+$<$/tt$>$ to be starting    with $<$tt$>$\+DES\+\_\+$<$/tt$>$ instead.  Add wrappers that are compatible with libdes,    but are named $<$tt$>$\+\_\+ossl\+\_\+old\+\_\+des\+\_\+\texorpdfstring{$\ast$}{*}$<$/tt$>$.  Finally, add macros that map the    $<$tt$>$des\+\_\+\texorpdfstring{$\ast$}{*}$<$/tt$>$ symbols to the corresponding $<$tt$>$\+\_\+ossl\+\_\+old\+\_\+des\+\_\+\texorpdfstring{$\ast$}{*}$<$/tt$>$ if libdes    compatibility is desired.  If Open\+SSL 0.\+9.\+6c compatibility is    desired, the $<$tt$>$des\+\_\+\texorpdfstring{$\ast$}{*}$<$/tt$>$ symbols will be mapped to $<$tt$>$\+DES\+\_\+\texorpdfstring{$\ast$}{*}$<$/tt$>$, with one    exception.     Since we provide two compatibility mappings, the user needs to    define the macro OPENSSL\+\_\+\+DES\+\_\+\+LIBDES\+\_\+\+COMPATIBILITY if libdes    compatibility is desired.  The default (i.\+e., when that macro    isn\textquotesingle{}t defined) is Open\+SSL 0.\+9.\+6c compatibility.     There are also macros that enable and disable the support of old    des functions altogether.  Those are OPENSSL\+\_\+\+ENABLE\+\_\+\+OLD\+\_\+\+DES\+\_\+\+SUPPORT    and OPENSSL\+\_\+\+DISABLE\+\_\+\+OLD\+\_\+\+DES\+\_\+\+SUPPORT.  If none or both of those    are defined, the default will apply\+: to support the old des routines.     In either case, one must include openssl/des.\+h to get the correct    definitions.  Do not try to just include openssl/des\+\_\+old.\+h, that    won\textquotesingle{}t work.     NOTE\+: This is a major break of an old API into a new one.  Software    authors are encouraged to switch to the $<$tt$>$\+DES\+\_\+$<$/tt$>$ style functions.  Some    time in the future, des\+\_\+old.\+h and the libdes compatibility functions    will be disable (i.\+e. OPENSSL\+\_\+\+DISABLE\+\_\+\+OLD\+\_\+\+DES\+\_\+\+SUPPORT will be the    default), and then completely removed.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Test for certificates which contain unsupported critical extensions.    If such a certificate is found during a verify operation it is    rejected by default\+: this behaviour can be overridden by either    handling the new error X509\+\_\+\+V\+\_\+\+ERR\+\_\+\+UNHANDLED\+\_\+\+CRITICAL\+\_\+\+EXTENSION or    by setting the verify flag X509\+\_\+\+V\+\_\+\+FLAG\+\_\+\+IGNORE\+\_\+\+CRITICAL. A new function    X509\+\_\+supported\+\_\+extension() has also been added which returns 1 if a    particular extension is supported.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Modify the behaviour of EVP cipher functions in similar way to digests    to retain compatibility with existing code.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Modify the behaviour of EVP\+\_\+\+Digest\+Init() and EVP\+\_\+\+Digest\+Final() to retain    compatibility with existing code. In particular the \textquotesingle{}ctx\textquotesingle{} parameter does    not have to be to be initialized before the call to EVP\+\_\+\+Digest\+Init() and    it is tidied up after a call to EVP\+\_\+\+Digest\+Final(). New function    EVP\+\_\+\+Digest\+Final\+\_\+ex() which does not tidy up the ctx. Similarly function    EVP\+\_\+\+MD\+\_\+\+CTX\+\_\+copy() changed to not require the destination to be    initialized valid and new function EVP\+\_\+\+MD\+\_\+\+CTX\+\_\+copy\+\_\+ex() added which    requires the destination to be valid.     Modify all the Open\+SSL digest calls to use EVP\+\_\+\+Digest\+Init\+\_\+ex(),    EVP\+\_\+\+Digest\+Final\+\_\+ex() and EVP\+\_\+\+MD\+\_\+\+CTX\+\_\+copy\+\_\+ex().     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Change ssl3\+\_\+get\+\_\+message (ssl/s3\+\_\+both.\+c) and the functions using it    so that complete \textquotesingle{}\+Handshake\textquotesingle{} protocol structures are kept in memory    instead of overwriting \textquotesingle{}msg\+\_\+type\textquotesingle{} and \textquotesingle{}length\textquotesingle{} with \textquotesingle{}body\textquotesingle{} data.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Add an implementation of SSL\+\_\+add\+\_\+dir\+\_\+cert\+\_\+subjects\+\_\+to\+\_\+stack for Win32.     $<$em$>$\+Massimo Santin via Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Major restructuring to the underlying ENGINE code. This includes    reduction of linker bloat, separation of pure "{}ENGINE"{} manipulation    (initialisation, etc) from functionality dealing with implementations    of specific crypto interfaces. This change also introduces integrated    support for symmetric ciphers and digest implementations -\/ so ENGINEs    can now accelerate these by providing EVP\+\_\+\+CIPHER and EVP\+\_\+\+MD    implementations of their own. This is detailed in    @ref "{}C\+:/\+Users/namph/\+Downloads/openssl/openssl-\/3.2.\+1/crypto/engine/\+README.md"{} "{}crypto/engine/\+README.\+md"{}    as it couldn\textquotesingle{}t be adequately described here. However, there are a few    API changes worth noting -\/ some RSA, DSA, DH, and RAND functions that    were changed in the original introduction of ENGINE code have now    reverted back -\/ the hooking from this code to ENGINE is now a good    deal more passive and at run-\/time, operations deal directly with    RSA\+\_\+\+METHODs, DSA\+\_\+\+METHODs (etc) as they did before, rather than    dereferencing through an ENGINE pointer any more. Also, the ENGINE    functions dealing with $<$tt$>$\+BN\+\_\+\+MOD\+\_\+\+EXP\mbox{[}\+\_\+\+CRT\mbox{]}$<$/tt$>$ handlers have been removed -\/    they were not being used by the framework as there is no concept of a    BIGNUM\+\_\+\+METHOD and they could not be generalised to the new    \textquotesingle{}\+ENGINE\+\_\+\+TABLE\textquotesingle{} mechanism that underlies the new code. Similarly,    ENGINE\+\_\+cpy() has been removed as it cannot be consistently defined in    the new code.     $<$em$>$\+Geoff Thorpe$<$/em$>$   \texorpdfstring{$\ast$}{*} Change ASN1\+\_\+\+GENERALIZEDTIME\+\_\+check() to allow fractional seconds.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Change mkdef.\+pl to sort symbols that get the same entry number,    and make sure the automatically generated functions $<$tt$>$\+ERR\+\_\+load\+\_\+\texorpdfstring{$\ast$}{*}$<$/tt$>$    become part of libeay.\+num as well.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} New function SSL\+\_\+renegotiate\+\_\+pending().  This returns true once    renegotiation has been requested (either SSL\+\_\+renegotiate() call    or Hello\+Request/\+Client\+Hello received from the peer) and becomes    false once a handshake has been completed.    (\+For servers, SSL\+\_\+renegotiate() followed by SSL\+\_\+do\+\_\+handshake()    sends a Hello\+Request, but does not ensure that a handshake takes    place.  SSL\+\_\+renegotiate\+\_\+pending() is useful for checking if the    client has followed the request.)     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} New SSL option SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+SESSION\+\_\+\+RESUMPTION\+\_\+\+ON\+\_\+\+RENEGOTIATION.    By default, clients may request session resumption even during    renegotiation (if session ID contexts permit); with this option,    session resumption is possible only in the first handshake.     SSL\+\_\+\+OP\+\_\+\+ALL is now 0x00000\+FFFL instead of 0x000\+FFFFFL.  This makes    more bits available for options that should not be part of    SSL\+\_\+\+OP\+\_\+\+ALL (such as SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+SESSION\+\_\+\+RESUMPTION\+\_\+\+ON\+\_\+\+RENEGOTIATION).     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Add some demos for certificate and certificate request creation.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Make maximum certificate chain size accepted from the peer application    settable ($<$tt$>$\+SSL\texorpdfstring{$\ast$}{*}\+\_\+get/set\+\_\+max\+\_\+cert\+\_\+list()$<$/tt$>$), as proposed by    "{}Douglas E. Engert"{} $<$deengert@anl.\+gov$>$.     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Add support for shared libraries for Unixware-\/7    (\+Boyd Lynn Gerber $<$gerberb@zenez.\+com$>$).     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Add a "{}destroy"{} handler to ENGINEs that allows structural cleanup to    be done prior to destruction. Use this to unload error strings from    ENGINEs that load their own error strings. NB\+: This adds two new API    functions to "{}get"{} and "{}set"{} this destroy handler in an ENGINE.     $<$em$>$\+Geoff Thorpe$<$/em$>$   \texorpdfstring{$\ast$}{*} Alter all existing ENGINE implementations (except "{}openssl"{} and    "{}openbsd"{}) to dynamically instantiate their own error strings. This    makes them more flexible to be built both as statically-\/linked ENGINEs    and self-\/contained shared-\/libraries loadable via the "{}dynamic"{} ENGINE.    Also, add stub code to each that makes building them as self-\/contained    shared-\/libraries easier (see @ref "{}README-\/\+Engine.\+md"{} "{}README-\/\+Engine.\+md"{}).     $<$em$>$\+Geoff Thorpe$<$/em$>$   \texorpdfstring{$\ast$}{*} Add a "{}dynamic"{} ENGINE that provides a mechanism for binding ENGINE    implementations into applications that are completely implemented in    self-\/contained shared-\/libraries. The "{}dynamic"{} ENGINE exposes control    commands that can be used to configure what shared-\/library to load and    to control aspects of the way it is handled. Also, made an update to    the @ref "{}README-\/\+Engine.\+md"{} "{}README-\/\+Engine.\+md"{} file    that brings its information up-\/to-\/date and    provides some information and instructions on the "{}dynamic"{} ENGINE    (ie. how to use it, how to build "{}dynamic"{}-\/loadable ENGINEs, etc).     $<$em$>$\+Geoff Thorpe$<$/em$>$   \texorpdfstring{$\ast$}{*} Make it possible to unload ranges of ERR strings with a new    "{}ERR\+\_\+unload\+\_\+strings"{} function.     $<$em$>$\+Geoff Thorpe$<$/em$>$   \texorpdfstring{$\ast$}{*} Add a copy() function to EVP\+\_\+\+MD.     $<$em$>$\+Ben Laurie$<$/em$>$   \texorpdfstring{$\ast$}{*} Make EVP\+\_\+\+MD routines take a context pointer instead of just the    md\+\_\+data void pointer.     $<$em$>$\+Ben Laurie$<$/em$>$   \texorpdfstring{$\ast$}{*} Add flags to EVP\+\_\+\+MD and EVP\+\_\+\+MD\+\_\+\+CTX. EVP\+\_\+\+MD\+\_\+\+FLAG\+\_\+\+ONESHOT indicates    that the digest can only process a single chunk of data    (typically because it is provided by a piece of    hardware). EVP\+\_\+\+MD\+\_\+\+CTX\+\_\+\+FLAG\+\_\+\+ONESHOT indicates that the application    is only going to provide a single chunk of data, and hence the    framework needn\textquotesingle{}t accumulate the data for oneshot drivers.     $<$em$>$\+Ben Laurie$<$/em$>$   \texorpdfstring{$\ast$}{*} As with "{}ERR"{}, make it possible to replace the underlying "{}ex\+\_\+data"{}    functions. This change also alters the storage and management of global    ex\+\_\+data state -\/ it\textquotesingle{}s now all inside ex\+\_\+data.\+c and all "{}class"{} code (eg.    RSA, BIO, SSL\+\_\+\+CTX, etc) no longer stores its own STACKS and per-\/class    index counters. The API functions that use this state have been changed    to take a "{}class\+\_\+index"{} rather than pointers to the class\textquotesingle{}s local STACK    and counter, and there is now an API function to dynamically create new    classes. This centralisation allows us to (a) plug a lot of the    thread-\/safety problems that existed, and (b) makes it possible to clean    up all allocated state using "{}CRYPTO\+\_\+cleanup\+\_\+all\+\_\+ex\+\_\+data()"{}. W.\+r.\+t. (b)    such data would previously have always leaked in application code and    workarounds were in place to make the memory debugging turn a blind eye    to it. Application code that doesn\textquotesingle{}t use this new function will still    leak as before, but their memory debugging output will announce it now    rather than letting it slide.     Besides the addition of CRYPTO\+\_\+cleanup\+\_\+all\+\_\+ex\+\_\+data(), another API change    induced by the "{}ex\+\_\+data"{} overhaul is that X509\+\_\+\+STORE\+\_\+\+CTX\+\_\+init() now    has a return value to indicate success or failure.     $<$em$>$\+Geoff Thorpe$<$/em$>$   \texorpdfstring{$\ast$}{*} Make it possible to replace the underlying "{}ERR"{} functions such that the    global state (2 LHASH tables and 2 locks) is only used by the "{}default"{}    implementation. This change also adds two functions to "{}get"{} and "{}set"{}    the implementation prior to it being automatically set the first time    any other ERR function takes place. Ie. an application can call "{}get"{},    pass the return value to a module it has just loaded, and that module    can call its own "{}set"{} function using that value. This means the    module\textquotesingle{}s "{}ERR"{} operations will use (and modify) the error state in the    application and not in its own statically linked copy of Open\+SSL code.     $<$em$>$\+Geoff Thorpe$<$/em$>$   \texorpdfstring{$\ast$}{*} Give DH, DSA, and RSA types their own $<$tt$>$\texorpdfstring{$\ast$}{*}\+\_\+up\+\_\+ref()$<$/tt$>$ function to increment    reference counts. This performs normal REF\+\_\+\+PRINT/\+REF\+\_\+\+CHECK macros on    the operation, and provides a more encapsulated way for external code    (crypto/evp/ and ssl/) to do this. Also changed the evp and ssl code    to use these functions rather than manually incrementing the counts.     Also rename "{}DSO\+\_\+up()"{} function to more descriptive "{}DSO\+\_\+up\+\_\+ref()"{}.     $<$em$>$\+Geoff Thorpe$<$/em$>$   \texorpdfstring{$\ast$}{*} Add EVP test program.     $<$em$>$\+Ben Laurie$<$/em$>$   \texorpdfstring{$\ast$}{*} Add symmetric cipher support to ENGINE. Expect the API to change!     $<$em$>$\+Ben Laurie$<$/em$>$   \texorpdfstring{$\ast$}{*} New CRL functions\+: X509\+\_\+\+CRL\+\_\+set\+\_\+version(), X509\+\_\+\+CRL\+\_\+set\+\_\+issuer\+\_\+name()    X509\+\_\+\+CRL\+\_\+set\+\_\+last\+Update(), X509\+\_\+\+CRL\+\_\+set\+\_\+next\+Update(), X509\+\_\+\+CRL\+\_\+sort(),    X509\+\_\+\+REVOKED\+\_\+set\+\_\+serial\+Number(), and X509\+\_\+\+REVOKED\+\_\+set\+\_\+revocation\+Date().    These allow a CRL to be built without having to access X509\+\_\+\+CRL fields    directly. Modify \textquotesingle{}ca\textquotesingle{} application to use new functions.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Move SSL\+\_\+\+OP\+\_\+\+TLS\+\_\+\+ROLLBACK\+\_\+\+BUG out of the SSL\+\_\+\+OP\+\_\+\+ALL list of recommended    bug workarounds. Rollback attack detection is a security feature.    The problem will only arise on Open\+SSL servers when TLSv1 is not    available (sslv3\+\_\+server\+\_\+method() or SSL\+\_\+\+OP\+\_\+\+NO\+\_\+\+TLSv1).    Software authors not wanting to support TLSv1 will have special reasons    for their choice and can explicitly enable this option.     $<$em$>$\+Bodo Moeller, Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Rationalise EVP so it can be extended\+: don\textquotesingle{}t include a union of    cipher/digest structures, add init/cleanup functions for EVP\+\_\+\+MD\+\_\+\+CTX    (similar to those existing for EVP\+\_\+\+CIPHER\+\_\+\+CTX).    Usage example\+: @iverbatim      EVP\+\_\+\+MD\+\_\+\+CTX md;      EVP\+\_\+\+MD\+\_\+\+CTX\+\_\+init(\&md);             /\texorpdfstring{$\ast$}{*} new function call \texorpdfstring{$\ast$}{*}/     EVP\+\_\+\+Digest\+Init(\&md, EVP\+\_\+sha1());     EVP\+\_\+\+Digest\+Update(\&md, in, len);     EVP\+\_\+\+Digest\+Final(\&md, out, NULL);     EVP\+\_\+\+MD\+\_\+\+CTX\+\_\+cleanup(\&md);          /\texorpdfstring{$\ast$}{*} new function call \texorpdfstring{$\ast$}{*}/ @endiverbatim    $<$em$>$\+Ben Laurie$<$/em$>$   \texorpdfstring{$\ast$}{*} Make DES key schedule conform to the usual scheme, as well as    correcting its structure. This means that calls to DES functions    now have to pass a pointer to a des\+\_\+key\+\_\+schedule instead of a    plain des\+\_\+key\+\_\+schedule (which was actually always a pointer    anyway)\+: E.\+g., @iverbatim      des\+\_\+key\+\_\+schedule ks;      des\+\_\+set\+\_\+key\+\_\+checked(..., \&ks);     des\+\_\+ncbc\+\_\+encrypt(..., \&ks, ...); @endiverbatim    (\+Note that a later change renames \textquotesingle{}des\+\_\+...\textquotesingle{} into \textquotesingle{}\+DES\+\_\+...\textquotesingle{}.)     $<$em$>$\+Ben Laurie$<$/em$>$   \texorpdfstring{$\ast$}{*} Initial reduction of linker bloat\+: the use of some functions, such as    PEM causes large amounts of unused functions to be linked in due to    poor organisation. For example pem\+\_\+all.\+c contains every PEM function    which has a knock on effect of linking in large amounts of (unused)    ASN1 code. Grouping together similar functions and splitting unrelated    functions prevents this.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Cleanup of EVP macros.     $<$em$>$\+Ben Laurie$<$/em$>$   \texorpdfstring{$\ast$}{*} Change historical references to $<$tt$>$\{\+NID,\+SN,\+LN\}\+\_\+des\+\_\+ede$<$/tt$>$ and ede3 to add the    correct $<$tt$>$\+\_\+ecb suffix$<$/tt$>$.     $<$em$>$\+Ben Laurie$<$/em$>$   \texorpdfstring{$\ast$}{*} Add initial OCSP responder support to ocsp application. The    revocation information is handled using the text based index    use by the ca application. The responder can either handle    requests generated internally, supplied in files (for example    via a CGI script) or using an internal minimal server.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Add configuration choices to get zlib compression for TLS.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Changes to Kerberos SSL for RFC 2712 compliance\+:    1. Implemented real Kerberos\+Wrapper, instead of just using       KRB5 AP\+\_\+\+REQ message.  \mbox{[}\+Thanks to Simon Wilkinson $<$sxw@sxw.\+org.\+uk$>$\mbox{]}    2. Implemented optional authenticator field of Kerberos\+Wrapper.     Added openssl-\/style ASN.\+1 macros for Kerberos ticket, ap\+\_\+req,    and authenticator structs; see crypto/krb5/.     Generalized Kerberos calls to support multiple Kerberos libraries.    \texorpdfstring{$\ast$}{*}\+Vern Staats $<$staatsvr@asc.\+hpc.\+mil$>$, Jeffrey Altman $<$jaltman@columbia.\+edu$>$    via Richard Levitte\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Cause \textquotesingle{}openssl speed\textquotesingle{} to use fully hard-\/coded DSA keys as it    already does with RSA. testdsa.\+h now has \textquotesingle{}priv\+\_\+key/pub\+\_\+key\textquotesingle{}    values for each of the key sizes rather than having just    parameters (and \textquotesingle{}speed\textquotesingle{} generating keys each time).     $<$em$>$\+Geoff Thorpe$<$/em$>$   \texorpdfstring{$\ast$}{*} Speed up EVP routines.    Before\+: crypt pe              8 bytes     64 bytes    256 bytes   1024 bytes   8192 bytes s-\/cbc           4408.\+85k     5560.\+51k     5778.\+46k     5862.\+20k     5825.\+16k s-\/cbc           4389.\+55k     5571.\+17k     5792.\+23k     5846.\+91k     5832.\+11k s-\/cbc           4394.\+32k     5575.\+92k     5807.\+44k     5848.\+37k     5841.\+30k crypt s-\/cbc           3482.\+66k     5069.\+49k     5496.\+39k     5614.\+16k     5639.\+28k s-\/cbc           3480.\+74k     5068.\+76k     5510.\+34k     5609.\+87k     5635.\+52k s-\/cbc           3483.\+72k     5067.\+62k     5504.\+60k     5708.\+01k     5724.\+80k    After\+: crypt s-\/cbc           4660.\+16k     5650.\+19k     5807.\+19k     5827.\+13k     5783.\+32k crypt s-\/cbc           3624.\+96k     5258.\+21k     5530.\+91k     5624.\+30k     5628.\+26k     $<$em$>$\+Ben Laurie$<$/em$>$   \texorpdfstring{$\ast$}{*} Added the OS2-\/\+EMX target.     \texorpdfstring{$\ast$}{*}"{}Brian Havard"{} $<$brianh@kheldar.\+apana.\+org.\+au$>$ and Richard Levitte\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Rewrite commands to use $<$tt$>$\+NCONF$<$/tt$>$ routines instead of the old $<$tt$>$\+CONF$<$/tt$>$.    New functions to support $<$tt$>$\+NCONF$<$/tt$>$ routines in extension code.    New function $<$tt$>$\+CONF\+\_\+set\+\_\+nconf()$<$/tt$>$    to allow functions which take an $<$tt$>$\+NCONF$<$/tt$>$ to also handle the old $<$tt$>$\+LHASH$<$/tt$>$    structure\+: this means that the old $<$tt$>$\+CONF$<$/tt$>$ compatible routines can be    retained (in particular w.\+rt. extensions) without having to duplicate the    code. New function $<$tt$>$\+X509\+V3\+\_\+add\+\_\+ext\+\_\+nconf\+\_\+sk()$<$/tt$>$ to add extensions to a stack.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Enhance the general user interface with mechanisms for inner control    and with possibilities to have yes/no kind of prompts.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Change all calls to low-\/level digest routines in the library and    applications to use EVP. Add missing calls to HMAC\+\_\+cleanup() and    don\textquotesingle{}t assume HMAC\+\_\+\+CTX can be copied using memcpy().     \texorpdfstring{$\ast$}{*}\+Verdon Walker $<$\+VWalker@novell.\+com$>$, Steve Henson\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Add the possibility to control engines through control names but with    arbitrary arguments instead of just a string.    Change the key loaders to take a UI\+\_\+\+METHOD instead of a callback    function pointer.  NOTE\+: this breaks binary compatibility with earlier    versions of Open\+SSL \mbox{[}engine\mbox{]}.    Adapt the n\+Cipher code for these new conditions and add a card insertion    callback.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Enhance the general user interface with mechanisms to better support    dialog box interfaces, application-\/defined prompts, the possibility    to use defaults (for example default passwords from somewhere else)    and interrupts/cancellations.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Tidy up PKCS\#12 attribute handling. Add support for the CSP name    attribute in PKCS\#12 files, add new -\/\+CSP option to pkcs12 utility.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix a memory leak in \textquotesingle{}sk\+\_\+dup()\textquotesingle{} in the case reallocation fails. (\+Also    tidy up some unnecessarily weird code in \textquotesingle{}sk\+\_\+new()\textquotesingle{}).     \texorpdfstring{$\ast$}{*}\+Geoff, reported by Diego Tartara $<$dtartara@novamens.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Change the key loading routines for ENGINEs to use the same kind    callback (pem\+\_\+password\+\_\+cb) as all other routines that need this    kind of callback.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Increase ENTROPY\+\_\+\+NEEDED to 32 bytes, as Rijndael can operate with    256 bit (=32 byte) keys. Of course seeding with more entropy bytes    than this minimum value is recommended.     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} New random seeder for Open\+VMS, using the system process statistics    that are easily reachable.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Windows apparently can\textquotesingle{}t transparently handle global    variables defined in DLLs. Initialisations such as\+: @iverbatim      const ASN1\+\_\+\+ITEM \texorpdfstring{$\ast$}{*}it = \&\+ASN1\+\_\+\+INTEGER\+\_\+it; @endiverbatim    won\textquotesingle{}t compile. This is used by the any applications that need to    declare their own ASN1 modules. This was fixed by adding the option    EXPORT\+\_\+\+VAR\+\_\+\+AS\+\_\+\+FN to all Win32 platforms, although this isn\textquotesingle{}t strictly    needed for static libraries under Win32.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} New functions X509\+\_\+\+PURPOSE\+\_\+set() and X509\+\_\+\+TRUST\+\_\+set() to handle    setting of purpose and trust fields. New X509\+\_\+\+STORE trust and    purpose functions and tidy up setting in other SSL functions.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Add copies of X509\+\_\+\+STORE\+\_\+\+CTX fields and callbacks to X509\+\_\+\+STORE    structure. These are inherited by X509\+\_\+\+STORE\+\_\+\+CTX when it is    initialised. This allows various defaults to be set in the    X509\+\_\+\+STORE structure (such as flags for CRL checking and custom    purpose or trust settings) for functions which only use X509\+\_\+\+STORE\+\_\+\+CTX    internally such as S/\+MIME.     Modify X509\+\_\+\+STORE\+\_\+\+CTX\+\_\+purpose\+\_\+inherit() so it only sets purposes and    trust settings if they are not set in X509\+\_\+\+STORE. This allows X509\+\_\+\+STORE    purposes and trust (in S/\+MIME for example) to override any set by default.     Add command line options for CRL checking to smime, s\+\_\+client and s\+\_\+server    applications.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Initial CRL based revocation checking. If the CRL checking flag(s)    are set then the CRL is looked up in the X509\+\_\+\+STORE structure and    its validity and signature checked, then if the certificate is found    in the CRL the verify fails with a revoked error.     Various new CRL related callbacks added to X509\+\_\+\+STORE\+\_\+\+CTX structure.     Command line options added to \textquotesingle{}verify\textquotesingle{} application to support this.     This needs some additional work, such as being able to handle multiple    CRLs with different times, extension based lookup (rather than just    by subject name) and ultimately more complete V2 CRL extension    handling.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Add a general user interface API (crypto/ui/).  This is designed    to replace things like des\+\_\+read\+\_\+password and friends (backward    compatibility functions using this new API are provided).    The purpose is to remove prompting functions from the DES code    section as well as provide for prompting through dialog boxes in    a window system and the like.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Add "{}ex\+\_\+data"{} support to ENGINE so implementations can add state at a    per-\/structure level rather than having to store it globally.     $<$em$>$\+Geoff$<$/em$>$   \texorpdfstring{$\ast$}{*} Make it possible for ENGINE structures to be copied when retrieved by    ENGINE\+\_\+by\+\_\+id() if the ENGINE specifies a new flag\+: ENGINE\+\_\+\+FLAGS\+\_\+\+BY\+\_\+\+ID\+\_\+\+COPY.    This causes the "{}original"{} ENGINE structure to act like a template,    analogous to the RSA vs. RSA\+\_\+\+METHOD type of separation. Because of this    operational state can be localised to each ENGINE structure, despite the    fact they all share the same "{}methods"{}. New ENGINE structures returned in    this case have no functional references and the return value is the single    structural reference. This matches the single structural reference returned    by ENGINE\+\_\+by\+\_\+id() normally, when it is incremented on the pre-\/existing    ENGINE structure.     $<$em$>$\+Geoff$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix ASN1 decoder when decoding type ANY and V\+\_\+\+ASN1\+\_\+\+OTHER\+: since this    needs to match any other type at all we need to manually clear the    tag cache.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Changes to the "{}openssl engine"{} utility to include;    -\/ verbosity levels (\textquotesingle{}-\/v\textquotesingle{}, \textquotesingle{}-\/vv\textquotesingle{}, and \textquotesingle{}-\/vvv\textquotesingle{}) that provide information      about an ENGINE\textquotesingle{}s available control commands.    -\/ executing control commands from command line arguments using the      \textquotesingle{}-\/pre\textquotesingle{} and \textquotesingle{}-\/post\textquotesingle{} switches. \textquotesingle{}-\/post\textquotesingle{} is only used if \textquotesingle{}-\/t\textquotesingle{} is      specified and the ENGINE is successfully initialised. The syntax for      the individual commands are colon-\/separated, for example;            openssl engine chil -\/pre FORK\+\_\+\+CHECK\+:0 -\/pre SO\+\_\+\+PATH\+:/lib/test.\+so     $<$em$>$\+Geoff$<$/em$>$   \texorpdfstring{$\ast$}{*} New dynamic control command support for ENGINEs. ENGINEs can now    declare their own commands (numbers), names (strings), descriptions,    and input types for run-\/time discovery by calling applications. A    subset of these commands are implicitly classed as "{}executable"{}    depending on their input type, and only these can be invoked through    the new string-\/based API function ENGINE\+\_\+ctrl\+\_\+cmd\+\_\+string(). (\+Eg. this    can be based on user input, config files, etc). The distinction is    that "{}executable"{} commands cannot return anything other than a boolean    result and can only support numeric or string input, whereas some    discoverable commands may only be for direct use through    ENGINE\+\_\+ctrl(), eg. supporting the exchange of binary data, function    pointers, or other custom uses. The "{}executable"{} commands are to    support parameterisations of ENGINE behaviour that can be    unambiguously defined by ENGINEs and used consistently across any    Open\+SSL-\/based application. Commands have been added to all the    existing hardware-\/supporting ENGINEs, noticeably "{}SO\+\_\+\+PATH"{} to allow    control over shared-\/library paths without source code alterations.     $<$em$>$\+Geoff$<$/em$>$   \texorpdfstring{$\ast$}{*} Changed all ENGINE implementations to dynamically allocate their    ENGINEs rather than declaring them statically. Apart from this being    necessary with the removal of the ENGINE\+\_\+\+FLAGS\+\_\+\+MALLOCED distinction,    this also allows the implementations to compile without using the    internal engine\+\_\+int.\+h header.     $<$em$>$\+Geoff$<$/em$>$   \texorpdfstring{$\ast$}{*} Minor adjustment to "{}rand"{} code. RAND\+\_\+get\+\_\+rand\+\_\+method() now returns a    \textquotesingle{}const\textquotesingle{} value. Any code that should be able to modify a RAND\+\_\+\+METHOD    should already have non-\/const pointers to it (ie. they should only    modify their own ones).     $<$em$>$\+Geoff$<$/em$>$   \texorpdfstring{$\ast$}{*} Made a variety of little tweaks to the ENGINE code.    -\/ "{}atalla"{} and "{}ubsec"{} string definitions were moved from header files      to C code. "{}nuron"{} string definitions were placed in variables      rather than hard-\/coded -\/ allowing parameterisation of these values      later on via ctrl() commands.    -\/ Removed unused "{}if 0"{}\textquotesingle{}d code.    -\/ Fixed engine list iteration code so it uses ENGINE\+\_\+free() to release      structural references.    -\/ Constified the RAND\+\_\+\+METHOD element of ENGINE structures.    -\/ Constified various get/set functions as appropriate and added      missing functions (including a catch-\/all ENGINE\+\_\+cpy that duplicates      all ENGINE values onto a new ENGINE except reference counts/state).    -\/ Removed NULL parameter checks in get/set functions. Setting a method      or function to NULL is a way of cancelling out a previously set      value.  Passing a NULL ENGINE parameter is just plain stupid anyway      and doesn\textquotesingle{}t justify the extra error symbols and code.    -\/ Deprecate the ENGINE\+\_\+\+FLAGS\+\_\+\+MALLOCED define and move the area for      flags from engine\+\_\+int.\+h to engine.\+h.    -\/ Changed prototypes for ENGINE handler functions (init(), finish(),      ctrl(), key-\/load functions, etc) to take an (\+ENGINE\texorpdfstring{$\ast$}{*}) parameter.     $<$em$>$\+Geoff$<$/em$>$   \texorpdfstring{$\ast$}{*} Implement binary inversion algorithm for BN\+\_\+mod\+\_\+inverse in addition    to the algorithm using long division.  The binary algorithm can be    used only if the modulus is odd.  On 32-\/bit systems, it is faster    only for relatively small moduli (roughly 20-\/30\% for 128-\/bit moduli,    roughly 5-\/15\% for 256-\/bit moduli), so we use it only for moduli    up to 450 bits.  In 64-\/bit environments, the binary algorithm    appears to be advantageous for much longer moduli; here we use it    for moduli up to 2048 bits.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Rewrite CHOICE field setting in ASN1\+\_\+item\+\_\+ex\+\_\+d2i(). The old code    could not support the combine flag in choice fields.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Add a \textquotesingle{}copy\+\_\+extensions\textquotesingle{} option to the \textquotesingle{}ca\textquotesingle{} utility. This copies    extensions from a certificate request to the certificate.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Allow multiple \textquotesingle{}certopt\textquotesingle{} and \textquotesingle{}nameopt\textquotesingle{} options to be separated    by commas. Add \textquotesingle{}namopt\textquotesingle{} and \textquotesingle{}certopt\textquotesingle{} options to the \textquotesingle{}ca\textquotesingle{} config    file\+: this allows the display of the certificate about to be    signed to be customised, to allow certain fields to be included    or excluded and extension details. The old system didn\textquotesingle{}t display    multicharacter strings properly, omitted fields not in the policy    and couldn\textquotesingle{}t display additional details such as extensions.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Function EC\+\_\+\+POINTs\+\_\+mul for multiple scalar multiplication    of an arbitrary number of elliptic curve points            \textbackslash{}sum scalars\mbox{[}i\mbox{]}\texorpdfstring{$\ast$}{*}points\mbox{[}i\mbox{]},    optionally including the generator defined for the EC\+\_\+\+GROUP\+:            scalar\texorpdfstring{$\ast$}{*}generator +  \textbackslash{}sum scalars\mbox{[}i\mbox{]}\texorpdfstring{$\ast$}{*}points\mbox{[}i\mbox{]}.     EC\+\_\+\+POINT\+\_\+mul is a simple wrapper function for the typical case    that the point list has just one item (besides the optional    generator).     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} First EC\+\_\+\+METHODs for curves over GF(p)\+:     EC\+\_\+\+GFp\+\_\+simple\+\_\+method() uses the basic BN\+\_\+mod\+\_\+mul and BN\+\_\+mod\+\_\+sqr    operations and provides various method functions that can also    operate with faster implementations of modular arithmetic.     EC\+\_\+\+GFp\+\_\+mont\+\_\+method() reuses most functions that are part of    EC\+\_\+\+GFp\+\_\+simple\+\_\+method, but uses Montgomery arithmetic.     \texorpdfstring{$\ast$}{*}\+Bodo Moeller; point addition and point doubling    implementation directly derived from source code provided by    Lenka Fibikova $<$fibikova@exp-\/math.\+uni-\/essen.\+de$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Framework for elliptic curves (crypto/ec/ec.\+h, crypto/ec/ec\+\_\+lcl.\+h,    crypto/ec/ec\+\_\+lib.\+c)\+:     Curves are EC\+\_\+\+GROUP objects (with an optional group generator)    based on EC\+\_\+\+METHODs that are built into the library.     Points are EC\+\_\+\+POINT objects based on EC\+\_\+\+GROUP objects.     Most of the framework would be able to handle curves over arbitrary    finite fields, but as there are no obvious types for fields other    than GF(p), some functions are limited to that for now.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Add the -\/\+HTTP option to s\+\_\+server.  It is similar to -\/\+WWW, but requires    that the file contains a complete HTTP response.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Add the ec directory to mkdef.\+pl and mkfiles.\+pl. In mkdef.\+pl    change the def and num file printf format specifier from "{}\%-\/40s\+XXX"{}    to "{}\%-\/39s XXX"{}. The latter will always guarantee a space after the    field while the former will cause them to run together if the field    is 40 of more characters long.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Constify the cipher and digest \textquotesingle{}method\textquotesingle{} functions and structures    and modify related functions to take constant EVP\+\_\+\+MD and EVP\+\_\+\+CIPHER    pointers.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Hide BN\+\_\+\+CTX structure details in bn\+\_\+lcl.\+h instead of publishing them    in $<$openssl/bn.\+h$>$.  Also further increase BN\+\_\+\+CTX\+\_\+\+NUM to 32.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Modify $<$tt$>$\+EVP\+\_\+\+Digest\texorpdfstring{$\ast$}{*}()$<$/tt$>$ routines so they now return values. Although the    internal software routines can never fail additional hardware versions    might.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Clean up crypto/err/err.\+h and change some error codes to avoid conflicts\+:     Previously ERR\+\_\+\+R\+\_\+\+FATAL was too small and coincided with ERR\+\_\+\+LIB\+\_\+\+PKCS7    (= ERR\+\_\+\+R\+\_\+\+PKCS7\+\_\+\+LIB); it is now 64 instead of 32.     ASN1 error codes            ERR\+\_\+\+R\+\_\+\+NESTED\+\_\+\+ASN1\+\_\+\+ERROR            ...            ERR\+\_\+\+R\+\_\+\+MISSING\+\_\+\+ASN1\+\_\+\+EOS    were 4 .. 9, conflicting with            ERR\+\_\+\+LIB\+\_\+\+RSA (= ERR\+\_\+\+R\+\_\+\+RSA\+\_\+\+LIB)            ...            ERR\+\_\+\+LIB\+\_\+\+PEM (= ERR\+\_\+\+R\+\_\+\+PEM\+\_\+\+LIB).    They are now 58 .. 63 (i.\+e., just below ERR\+\_\+\+R\+\_\+\+FATAL).     Add new error code \textquotesingle{}\+ERR\+\_\+\+R\+\_\+\+INTERNAL\+\_\+\+ERROR\textquotesingle{}.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Don\textquotesingle{}t overuse locks in crypto/err/err.\+c\+: For data retrieval, CRYPTO\+\_\+r\+\_\+lock    suffices.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} New option \textquotesingle{}-\/subj arg\textquotesingle{} for \textquotesingle{}openssl req\textquotesingle{} and \textquotesingle{}openssl ca\textquotesingle{}.  This    sets the subject name for a new request or supersedes the    subject name in a given request. Formats that can be parsed are            \textquotesingle{}\+CN=\+Some Name, OU=my\+OU, C=\+IT\textquotesingle{}    and            \textquotesingle{}\+CN=\+Some Name/\+OU=my\+OU/\+C=\+IT\textquotesingle{}.     Add options \textquotesingle{}-\/batch\textquotesingle{} and \textquotesingle{}-\/verbose\textquotesingle{} to \textquotesingle{}openssl req\textquotesingle{}.     \texorpdfstring{$\ast$}{*}\+Massimiliano Pala $<$madwolf@hackmasters.\+net$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Introduce the possibility to access global variables through    functions on platform were that\textquotesingle{}s the best way to handle exporting    global variables in shared libraries.  To enable this functionality,    one must configure with "{}EXPORT\+\_\+\+VAR\+\_\+\+AS\+\_\+\+FN"{} or defined the C macro    "{}OPENSSL\+\_\+\+EXPORT\+\_\+\+VAR\+\_\+\+AS\+\_\+\+FUNCTION"{} in crypto/opensslconf.\+h (the latter    is normally done by Configure or something similar).     To implement a global variable, use the macro OPENSSL\+\_\+\+IMPLEMENT\+\_\+\+GLOBAL    in the source file (foo.\+c) like this\+: @iverbatim      OPENSSL\+\_\+\+IMPLEMENT\+\_\+\+GLOBAL(int,foo)=1;     OPENSSL\+\_\+\+IMPLEMENT\+\_\+\+GLOBAL(double,bar); @endiverbatim    To declare a global variable, use the macros OPENSSL\+\_\+\+DECLARE\+\_\+\+GLOBAL    and OPENSSL\+\_\+\+GLOBAL\+\_\+\+REF in the header file (foo.\+h) like this\+: @iverbatim      OPENSSL\+\_\+\+DECLARE\+\_\+\+GLOBAL(int,foo);     \#define foo OPENSSL\+\_\+\+GLOBAL\+\_\+\+REF(foo)     OPENSSL\+\_\+\+DECLARE\+\_\+\+GLOBAL(double,bar);     \#define bar OPENSSL\+\_\+\+GLOBAL\+\_\+\+REF(bar) @endiverbatim    The \#defines are very important, and therefore so is including the    header file everywhere where the defined globals are used.     The macro OPENSSL\+\_\+\+EXPORT\+\_\+\+VAR\+\_\+\+AS\+\_\+\+FUNCTION also affects the definition    of ASN.\+1 items, but that structure is a bit different.     The largest change is in util/mkdef.\+pl which has been enhanced with    better and easier to understand logic to choose which symbols should    go into the Windows .\+def files as well as a number of fixes and code    cleanup (among others, algorithm keywords are now sorted    lexicographically to avoid constant rewrites).     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} In BN\+\_\+div() keep a copy of the sign of \textquotesingle{}num\textquotesingle{} before writing the    result to \textquotesingle{}rm\textquotesingle{} because if rm==num the value will be overwritten    and produce the wrong result if \textquotesingle{}num\textquotesingle{} is negative\+: this caused    problems with BN\+\_\+mod() and BN\+\_\+nnmod().     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Function OCSP\+\_\+request\+\_\+verify(). This checks the signature on an    OCSP request and verifies the signer certificate. The signer    certificate is just checked for a generic purpose and OCSP request    trust settings.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Add OCSP\+\_\+check\+\_\+validity() function to check the validity of OCSP    responses. OCSP responses are prepared in real time and may only    be a few seconds old. Simply checking that the current time lies    between this\+Update and next\+Update max reject otherwise valid responses    caused by either OCSP responder or client clock inaccuracy. Instead    we allow this\+Update and next\+Update to fall within a certain period of    the current time. The age of the response can also optionally be    checked. Two new options -\/validity\+\_\+period and -\/status\+\_\+age added to    ocsp utility.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} If signature or public key algorithm is unrecognized print out its    OID rather that just UNKNOWN.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Change OCSP\+\_\+cert\+\_\+to\+\_\+id() to tolerate a NULL subject certificate and    OCSP\+\_\+cert\+\_\+id\+\_\+new() a NULL serial\+Number. This allows a partial certificate    ID to be generated from the issuer certificate alone which can then be    passed to OCSP\+\_\+id\+\_\+issuer\+\_\+cmp().     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} New compilation option ASN1\+\_\+\+ITEM\+\_\+\+FUNCTIONS. This causes the new    ASN1 modules to export functions returning ASN1\+\_\+\+ITEM pointers    instead of the ASN1\+\_\+\+ITEM structures themselves. This adds several    new macros which allow the underlying ASN1 function/structure to    be accessed transparently. As a result code should not use ASN1\+\_\+\+ITEM    references directly (such as \&\+X509\+\_\+it) but instead use the relevant    macros (such as ASN1\+\_\+\+ITEM\+\_\+rptr(\+X509)). This option is to allow    use of the new ASN1 code on platforms where exporting structures    is problematical (for example in shared libraries) but exporting    functions returning pointers to structures is not.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Add support for overriding the generation of SSL/\+TLS session IDs.    These callbacks can be registered either in an SSL\+\_\+\+CTX or per SSL.    The purpose of this is to allow applications to control, if they wish,    the arbitrary values chosen for use as session IDs, particularly as it    can be useful for session caching in multiple-\/server environments. A    command-\/line switch for testing this (and any client code that wishes    to use such a feature) has been added to "{}s\+\_\+server"{}.     $<$em$>$\+Geoff Thorpe, Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Modify mkdef.\+pl to recognise and parse preprocessor conditionals    of the form $<$tt$>$\textbackslash{}\#if defined(...) \texorpdfstring{$\vert$}{|}\texorpdfstring{$\vert$}{|} defined(...) \texorpdfstring{$\vert$}{|}\texorpdfstring{$\vert$}{|} ...$<$/tt$>$ and    $<$tt$>$\textbackslash{}\#if !defined(...) \textbackslash{}\&\textbackslash{}\& !defined(...) \textbackslash{}\&\textbackslash{}\& ...$<$/tt$>$.  This also avoids    the growing number of special cases it was previously handling.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Make all configuration macros available for application by making    sure they are available in opensslconf.\+h, by giving them names starting    with $<$tt$>$\+OPENSSL\+\_\+$<$/tt$>$ to avoid conflicts with other packages and by making    sure e\+\_\+os2.\+h will cover all platform-\/specific cases together with    opensslconf.\+h.    Additionally, it is now possible to define configuration/platform-\/    specific names (called "{}system identities"{}).  In the C code, these    are prefixed with $<$tt$>$\+OPENSSL\+\_\+\+SYSNAME\+\_\+$<$/tt$>$.  e\+\_\+os2.\+h will create another    macro with the name beginning with $<$tt$>$\+OPENSSL\+\_\+\+SYS\+\_\+$<$/tt$>$, which is determined    from $<$tt$>$\+OPENSSL\+\_\+\+SYSNAME\+\_\+\texorpdfstring{$\ast$}{*}$<$/tt$>$ or compiler-\/specific macros depending on    what is available.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} New option -\/set\+\_\+serial to \textquotesingle{}req\textquotesingle{} and \textquotesingle{}x509\textquotesingle{} this allows the serial    number to use to be specified on the command line. Previously self    signed certificates were hard coded with serial number 0 and the    CA options of \textquotesingle{}x509\textquotesingle{} had to use a serial number in a file which was    auto incremented.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} New options to \textquotesingle{}ca\textquotesingle{} utility to support V2 CRL entry extensions.    Currently CRL reason, invalidity date and hold instruction are    supported. Add new CRL extensions to V3 code and some new objects.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} New function EVP\+\_\+\+CIPHER\+\_\+\+CTX\+\_\+set\+\_\+padding() this is used to    disable standard block padding (aka PKCS\#5 padding) in the EVP    API, which was previously mandatory. This means that the data is    not padded in any way and so the total length much be a multiple    of the block size, otherwise an error occurs.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Initial (incomplete) OCSP SSL support.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} New function OCSP\+\_\+parse\+\_\+url(). This splits up a URL into its host,    port and path components\+: primarily to parse OCSP URLs. New -\/url    option to ocsp utility.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} New nonce behavior. The return value of OCSP\+\_\+check\+\_\+nonce() now    reflects the various checks performed. Applications can decide    whether to tolerate certain situations such as an absent nonce    in a response when one was present in a request\+: the ocsp application    just prints out a warning. New function OCSP\+\_\+add1\+\_\+basic\+\_\+nonce()    this is to allow responders to include a nonce in a response even if    the request is nonce-\/less.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Disable stdin buffering in $<$tt$>$load\+\_\+cert()$<$/tt$>$ ($<$tt$>$apps/apps.\+c$<$/tt$>$) so that no certs are    skipped when using openssl x509 multiple times on a single input file,    e.\+g. $<$tt$>$(openssl x509 -\/out cert1; openssl x509 -\/out cert2) \textbackslash{}$<$certs$<$/tt$>$.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Make ASN1\+\_\+\+UTCTIME\+\_\+set\+\_\+string() and ASN1\+\_\+\+GENERALIZEDTIME\+\_\+set\+\_\+string()    set string type\+: to handle setting ASN1\+\_\+\+TIME structures. Fix ca    utility to correctly initialize revocation date of CRLs.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} New option SSL\+\_\+\+OP\+\_\+\+CIPHER\+\_\+\+SERVER\+\_\+\+PREFERENCE allows the server to override    the clients preferred ciphersuites and rather use its own preferences.    Should help to work around M\$ SGC (\+Server Gated Cryptography) bug in    Internet Explorer by ensuring unchanged hash method during stepup.    (\+Also replaces the broken/deactivated SSL\+\_\+\+OP\+\_\+\+NON\+\_\+\+EXPORT\+\_\+\+FIRST option.)     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Make mkdef.\+pl recognise all DECLARE\+\_\+\+ASN1 macros, change rijndael    to aes and add a new \textquotesingle{}exist\textquotesingle{} option to print out symbols that don\textquotesingle{}t    appear to exist.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Additional options to ocsp utility to allow flags to be set and    additional certificates supplied.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Add the option -\/\+VAfile to \textquotesingle{}openssl ocsp\textquotesingle{}, so the user can give the    OCSP client a number of certificate to only verify the response    signature against.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Update Rijndael code to version 3.\+0 and change EVP AES ciphers to    handle the new API. Currently only ECB, CBC modes supported. Add new    AES OIDs.     Add TLS AES ciphersuites as described in RFC3268, "{}Advanced Encryption Standard (AES) Ciphersuites for Transport Layer Security (TLS)"{}.  (\+In beta versions of Open\+SSL 0.\+9.\+7, these were    not enabled by default and were not part of the "{}ALL"{} ciphersuite    alias because they were not yet official; they could be    explicitly requested by specifying the "{}AESdraft"{} ciphersuite    group alias.  In the final release of Open\+SSL 0.\+9.\+7, the group    alias is called "{}AES"{} and is part of "{}ALL"{}.)     $<$em$>$\+Ben Laurie, Steve  Henson, Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} New function OCSP\+\_\+copy\+\_\+nonce() to copy nonce value (if present) from    request to response.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Functions for OCSP responders. OCSP\+\_\+request\+\_\+onereq\+\_\+count(),    OCSP\+\_\+request\+\_\+onereq\+\_\+get0(), OCSP\+\_\+onereq\+\_\+get0\+\_\+id() and OCSP\+\_\+id\+\_\+get0\+\_\+info()    extract information from a certificate request. OCSP\+\_\+response\+\_\+create()    creates a response and optionally adds a basic response structure.    OCSP\+\_\+basic\+\_\+add1\+\_\+status() adds a complete single response to a basic    response and returns the OCSP\+\_\+\+SINGLERESP structure just added (to allow    extensions to be included for example). OCSP\+\_\+basic\+\_\+add1\+\_\+cert() adds a    certificate to a basic response and OCSP\+\_\+basic\+\_\+sign() signs a basic    response with various flags. New helper functions ASN1\+\_\+\+TIME\+\_\+check()    (checks validity of ASN1\+\_\+\+TIME structure) and ASN1\+\_\+\+TIME\+\_\+to\+\_\+generalizedtime()    (converts ASN1\+\_\+\+TIME to Generalized\+Time).     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Various new functions. EVP\+\_\+\+Digest() combines EVP\+\_\+\+Digest\{\+Init,\+Update,\+Final\}()    in a single operation. X509\+\_\+get0\+\_\+pubkey\+\_\+bitstr() extracts the public\+\_\+key    structure from a certificate. X509\+\_\+pubkey\+\_\+digest() digests the public\+\_\+key    contents\+: this is used in various key identifiers.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Make sk\+\_\+sort() tolerate a NULL argument.     \texorpdfstring{$\ast$}{*}\+Steve Henson reported by Massimiliano Pala $<$madwolf@comune.\+modena.\+it$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} New OCSP verify flag OCSP\+\_\+\+TRUSTOTHER. When set the "{}other"{} certificates    passed by the function are trusted implicitly. If any of them signed the    response then it is assumed to be valid and is not verified.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} In PKCS7\+\_\+set\+\_\+type() initialise content\+\_\+type in PKCS7\+\_\+\+ENC\+\_\+\+CONTENT    to data. This was previously part of the PKCS7 ASN1 code. This    was causing problems with Open\+SSL created PKCS\#12 and PKCS\#7 structures.    \texorpdfstring{$\ast$}{*}\+Steve Henson, reported by Kenneth R. Robinette                               $<$support@securenetterm.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Add CRYPTO\+\_\+push\+\_\+info() and CRYPTO\+\_\+pop\+\_\+info() calls to new ASN1    routines\+: without these tracing memory leaks is very painful.    Fix leaks in PKCS12 and PKCS7 routines.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Make X509\+\_\+time\+\_\+adj() cope with the new behaviour of ASN1\+\_\+\+TIME\+\_\+new().    Previously it initialised the \textquotesingle{}type\textquotesingle{} argument to V\+\_\+\+ASN1\+\_\+\+UTCTIME which    effectively meant Generalized\+Time would never be used. Now it    is initialised to -\/1 but X509\+\_\+time\+\_\+adj() now has to check the value    and use ASN1\+\_\+\+TIME\+\_\+set() if the value is not V\+\_\+\+ASN1\+\_\+\+UTCTIME or    V\+\_\+\+ASN1\+\_\+\+GENERALIZEDTIME, without this it always uses Generalized\+Time.    \texorpdfstring{$\ast$}{*}\+Steve Henson, reported by Kenneth R. Robinette                               $<$support@securenetterm.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Fixes to BN\+\_\+to\+\_\+\+ASN1\+\_\+\+INTEGER when bn is zero. This would previously    result in a zero length in the ASN1\+\_\+\+INTEGER structure which was    not consistent with the structure when d2i\+\_\+\+ASN1\+\_\+\+INTEGER() was used    and would cause ASN1\+\_\+\+INTEGER\+\_\+cmp() to fail. Enhance s2i\+\_\+\+ASN1\+\_\+\+INTEGER()    to cope with hex and negative integers. Fix bug in i2a\+\_\+\+ASN1\+\_\+\+INTEGER()    where it did not print out a minus for negative ASN1\+\_\+\+INTEGER.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Add summary printout to ocsp utility. The various functions which    convert status values to strings have been renamed to\+:    OCSP\+\_\+response\+\_\+status\+\_\+str(), OCSP\+\_\+cert\+\_\+status\+\_\+str() and    OCSP\+\_\+crl\+\_\+reason\+\_\+str() and are no longer static. New options    to verify nonce values and to disable verification. OCSP response    printout format cleaned up.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Add additional OCSP certificate checks. These are those specified    in RFC2560. This consists of two separate checks\+: the CA of the    certificate being checked must either be the OCSP signer certificate    or the issuer of the OCSP signer certificate. In the latter case the    OCSP signer certificate must contain the OCSP signing extended key    usage. This check is performed by attempting to match the OCSP    signer or the OCSP signer CA to the issuer\+Name\+Hash and issuer\+Key\+Hash    in the OCSP\+\_\+\+CERTID structures of the response.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Initial OCSP certificate verification added to OCSP\+\_\+basic\+\_\+verify()    and related routines. This uses the standard Open\+SSL certificate    verify routines to perform initial checks (just CA validity) and    to obtain the certificate chain. Then additional checks will be    performed on the chain. Currently the root CA is checked to see    if it is explicitly trusted for OCSP signing. This is used to set    a root CA as a global signing root\+: that is any certificate that    chains to that CA is an acceptable OCSP signing certificate.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} New \textquotesingle{}-\/extfile ...\textquotesingle{} option to \textquotesingle{}openssl ca\textquotesingle{} for reading X.\+509v3    extensions from a separate configuration file.    As when reading extensions from the main configuration file,    the \textquotesingle{}-\/extensions ...\textquotesingle{} option may be used for specifying the    section to use.     \texorpdfstring{$\ast$}{*}\+Massimiliano Pala $<$madwolf@comune.\+modena.\+it$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} New OCSP utility. Allows OCSP requests to be generated or    read. The request can be sent to a responder and the output    parsed, outputted or printed in text form. Not complete yet\+:    still needs to check the OCSP response validity.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} New subcommands for \textquotesingle{}openssl ca\textquotesingle{}\+:    $<$tt$>$openssl ca -\/status \textbackslash{}$<$serial\textbackslash{}$>$$<$/tt$>$ prints the status of the cert with    the given serial number (according to the index file).    $<$tt$>$openssl ca -\/updatedb$<$/tt$>$ updates the expiry status of certificates    in the index file.     \texorpdfstring{$\ast$}{*}\+Massimiliano Pala $<$madwolf@comune.\+modena.\+it$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} New \textquotesingle{}-\/newreq-\/nodes\textquotesingle{} command option to CA.\+pl.  This is like    \textquotesingle{}-\/newreq\textquotesingle{}, but calls \textquotesingle{}openssl req\textquotesingle{} with the \textquotesingle{}-\/nodes\textquotesingle{} option    so that the resulting key is not encrypted.     \texorpdfstring{$\ast$}{*}\+Damien Miller $<$djm@mindrot.\+org$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} New configuration for the GNU Hurd.     \texorpdfstring{$\ast$}{*}\+Jonathan Bartlett $<$johnnyb@wolfram.\+com$>$ via Richard Levitte\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Initial code to implement OCSP basic response verify. This    is currently incomplete. Currently just finds the signer\textquotesingle{}s    certificate and verifies the signature on the response.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} New SSLeay\+\_\+version code SSLEAY\+\_\+\+DIR to determine the compiled-\/in    value of OPENSSLDIR.  This is available via the new \textquotesingle{}-\/d\textquotesingle{} option    to \textquotesingle{}openssl version\textquotesingle{}, and is also included in \textquotesingle{}openssl version -\/a\textquotesingle{}.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Allowing defining memory allocation callbacks that will be given    file name and line number information in additional arguments    (a $<$tt$>$const char\texorpdfstring{$\ast$}{*}$<$/tt$>$ and an int).  The basic functionality remains, as    well as the original possibility to just replace malloc(),    realloc() and free() by functions that do not know about these    additional arguments.  To register and find out the current    settings for extended allocation functions, the following    functions are provided\+: @iverbatim      CRYPTO\+\_\+set\+\_\+mem\+\_\+ex\+\_\+functions     CRYPTO\+\_\+set\+\_\+locked\+\_\+mem\+\_\+ex\+\_\+functions     CRYPTO\+\_\+get\+\_\+mem\+\_\+ex\+\_\+functions     CRYPTO\+\_\+get\+\_\+locked\+\_\+mem\+\_\+ex\+\_\+functions @endiverbatim    These work the same way as CRYPTO\+\_\+set\+\_\+mem\+\_\+functions and friends.    $<$tt$>$\+CRYPTO\+\_\+get\+\_\+\mbox{[}locked\+\_\+\mbox{]}mem\+\_\+functions$<$/tt$>$ now writes 0 where such an    extended allocation function is enabled.    Similarly, $<$tt$>$\+CRYPTO\+\_\+get\+\_\+\mbox{[}locked\+\_\+\mbox{]}mem\+\_\+ex\+\_\+functions$<$/tt$>$ writes 0 where    a conventional allocation function is enabled.     $<$em$>$\+Richard Levitte, Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Finish off removing the remaining LHASH function pointer casts.    There should no longer be any prototype-\/casting required when using    the LHASH abstraction, and any casts that remain are "{}bugs"{}. See    the callback types and macros at the head of lhash.\+h for details    (and "{}OBJ\+\_\+cleanup"{} in crypto/objects/obj\+\_\+dat.\+c as an example).     $<$em$>$\+Geoff Thorpe$<$/em$>$   \texorpdfstring{$\ast$}{*} Add automatic query of EGD sockets in RAND\+\_\+poll() for the unix variant.    If /dev/\mbox{[}u\mbox{]}random devices are not available or do not return enough    entropy, EGD style sockets (served by EGD or PRNGD) will automatically    be queried.    The locations /var/run/egd-\/pool, /dev/egd-\/pool, /etc/egd-\/pool, and    /etc/entropy will be queried once each in this sequence, querying stops    when enough entropy was collected without querying more sockets.     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Change the Unix RAND\+\_\+poll() variant to be able to poll several    random devices, as specified by DEVRANDOM, until a sufficient amount    of data has been collected.   We spend at most 10 ms on each file    (select timeout) and read in non-\/blocking mode.  DEVRANDOM now    defaults to the list "{}/dev/urandom"{}, "{}/dev/random"{}, "{}/dev/srandom"{}    (previously it was just the string "{}/dev/urandom"{}), so on typical    platforms the 10 ms delay will never occur.    Also separate out the Unix variant to its own file, rand\+\_\+unix.\+c.    For VMS, there\textquotesingle{}s a currently-\/empty rand\+\_\+vms.\+c.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Move OCSP client related routines to ocsp\+\_\+cl.\+c. These    provide utility functions which an application needing    to issue a request to an OCSP responder and analyse the    response will typically need\+: as opposed to those which an    OCSP responder itself would need which will be added later.     OCSP\+\_\+request\+\_\+sign() signs an OCSP request with an API similar    to PKCS7\+\_\+sign(). OCSP\+\_\+response\+\_\+status() returns status of OCSP    response. OCSP\+\_\+response\+\_\+get1\+\_\+basic() extracts basic response    from response. OCSP\+\_\+resp\+\_\+find\+\_\+status()\+: finds and extracts status    information from an OCSP\+\_\+\+CERTID structure (which will be created    when the request structure is built). These are built from lower    level functions which work on OCSP\+\_\+\+SINGLERESP structures but    won\textquotesingle{}t normally be used unless the application wishes to examine    extensions in the OCSP response for example.     Replace nonce routines with a pair of functions.    OCSP\+\_\+request\+\_\+add1\+\_\+nonce() adds a nonce value and optionally    generates a random value. OCSP\+\_\+check\+\_\+nonce() checks the    validity of the nonce in an OCSP response.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Change function OCSP\+\_\+request\+\_\+add() to OCSP\+\_\+request\+\_\+add0\+\_\+id().    This doesn\textquotesingle{}t copy the supplied OCSP\+\_\+\+CERTID and avoids the    need to free up the newly created id. Change return type    to OCSP\+\_\+\+ONEREQ to return the internal OCSP\+\_\+\+ONEREQ structure.    This can then be used to add extensions to the request.    Deleted OCSP\+\_\+request\+\_\+new(), since most of its functionality    is now in OCSP\+\_\+\+REQUEST\+\_\+new() (and the case insensitive name    clash) apart from the ability to set the request name which    will be added elsewhere.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Update OCSP API. Remove obsolete extensions argument from    various functions. Extensions are now handled using the new    OCSP extension code. New simple OCSP HTTP function which    can be used to send requests and parse the response.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix the PKCS\#7 (\+S/\+MIME) code to work with new ASN1. Two new    ASN1\+\_\+\+ITEM structures help with sign and verify. PKCS7\+\_\+\+ATTR\+\_\+\+SIGN    uses the special reorder version of SET OF to sort the attributes    and reorder them to match the encoded order. This resolves a long    standing problem\+: a verify on a PKCS7 structure just after signing    it used to fail because the attribute order did not match the    encoded order. PKCS7\+\_\+\+ATTR\+\_\+\+VERIFY does not reorder the attributes\+:    it uses the received order. This is necessary to tolerate some broken    software that does not order SET OF. This is handled by encoding    as a SEQUENCE OF but using implicit tagging (with UNIVERSAL class)    to produce the required SET OF.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Have mk1mf.\+pl generate the macros OPENSSL\+\_\+\+BUILD\+\_\+\+SHLIBCRYPTO and    OPENSSL\+\_\+\+BUILD\+\_\+\+SHLIBSSL and use them appropriately in the header    files to get correct declarations of the ASN.\+1 item variables.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Rewrite of PKCS\#12 code to use new ASN1 functionality. Replace many    PKCS\#12 macros with real functions. Fix two unrelated ASN1 bugs\+:    asn1\+\_\+check\+\_\+tlen() would sometimes attempt to use \textquotesingle{}ctx\textquotesingle{} when it was    NULL and ASN1\+\_\+\+TYPE was not dereferenced properly in asn1\+\_\+ex\+\_\+c2i().    New ASN1 macro\+: DECLARE\+\_\+\+ASN1\+\_\+\+ITEM() which just declares the relevant    ASN1\+\_\+\+ITEM and no wrapper functions.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} New functions or ASN1\+\_\+item\+\_\+d2i\+\_\+fp() and ASN1\+\_\+item\+\_\+d2i\+\_\+bio(). These    replace the old function pointer based I/\+O routines. Change most of    the $<$tt$>$\texorpdfstring{$\ast$}{*}\+\_\+d2i\+\_\+bio()$<$/tt$>$ and $<$tt$>$\texorpdfstring{$\ast$}{*}\+\_\+d2i\+\_\+fp()$<$/tt$>$ functions to use these.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Enhance mkdef.\+pl to be more accepting about spacing in C preprocessor    lines, recognize more "{}algorithms"{} that can be deselected, and make    it complain about algorithm deselection that isn\textquotesingle{}t recognised.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} New ASN1 functions to handle dup, sign, verify, digest, pack and    unpack operations in terms of ASN1\+\_\+\+ITEM. Modify existing wrappers    to use new functions. Add NO\+\_\+\+ASN1\+\_\+\+OLD which can be set to remove    some old style ASN1 functions\+: this can be used to determine if old    code will still work when these eventually go away.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} New extension functions for OCSP structures, these follow the    same conventions as certificates and CRLs.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} New function X509\+V3\+\_\+add1\+\_\+i2d(). This automatically encodes and    adds an extension. Its behaviour can be customised with various    flags to append, replace or delete. Various wrappers added for    certificates and CRLs.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix to avoid calling the underlying ASN1 print routine when    an extension cannot be parsed. Correct a typo in the    OCSP\+\_\+\+SERVICELOC extension. Tidy up print OCSP format.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Make mkdef.\+pl parse some of the ASN1 macros and add appropriate    entries for variables.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Add functionality to $<$tt$>$apps/openssl.\+c$<$/tt$>$ for detecting locking    problems\+: As the program is single-\/threaded, all we have    to do is register a locking callback using an array for    storing which locks are currently held by the program.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Use a lock around the call to CRYPTO\+\_\+get\+\_\+ex\+\_\+new\+\_\+index() in    SSL\+\_\+get\+\_\+ex\+\_\+data\+\_\+\+X509\+\_\+\+STORE\+\_\+idx(), which is used in    ssl\+\_\+verify\+\_\+cert\+\_\+chain() and thus can be called at any time    during TLS/\+SSL handshakes so that thread-\/safety is essential.    Unfortunately, the ex\+\_\+data design is not at all suited    for multi-\/threaded use, so it probably should be abolished.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Added Broadcom "{}ubsec"{} ENGINE to Open\+SSL.     $<$em$>$\+Broadcom, tweaked and integrated by Geoff Thorpe$<$/em$>$   \texorpdfstring{$\ast$}{*} Move common extension printing code to new function    X509\+V3\+\_\+print\+\_\+extensions(). Reorganise OCSP print routines and    implement some needed OCSP ASN1 functions. Add OCSP extensions.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} New function X509\+\_\+signature\+\_\+print() to remove duplication in some    print routines.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Add a special meaning when SET OF and SEQUENCE OF flags are both    set (this was treated exactly the same as SET OF previously). This    is used to reorder the STACK representing the structure to match the    encoding. This will be used to get round a problem where a PKCS7    structure which was signed could not be verified because the STACK    order did not reflect the encoded order.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Reimplement the OCSP ASN1 module using the new code.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Update the X509\+V3 code to permit the use of an ASN1\+\_\+\+ITEM structure    for its ASN1 operations. The old style function pointers still exist    for now but they will eventually go away.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Merge in replacement ASN1 code from the ASN1 branch. This almost    completely replaces the old ASN1 functionality with a table driven    encoder and decoder which interprets an ASN1\+\_\+\+ITEM structure describing    the ASN1 module. Compatibility with the existing ASN1 API (i2d,d2i) is    largely maintained. Almost all of the old asn1\+\_\+mac.\+h macro based ASN1    has also been converted to the new form.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Change BN\+\_\+mod\+\_\+exp\+\_\+recp so that negative moduli are tolerated    (the sign is ignored).  Similarly, ignore the sign in BN\+\_\+\+MONT\+\_\+\+CTX\+\_\+set    so that BN\+\_\+mod\+\_\+exp\+\_\+mont and BN\+\_\+mod\+\_\+exp\+\_\+mont\+\_\+word work    for negative moduli.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix BN\+\_\+uadd and BN\+\_\+usub\+: Always return non-\/negative results instead    of not touching the result\textquotesingle{}s sign bit.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} BN\+\_\+div bugfix\+: If the result is 0, the sign (res-\/$>$neg) must not be    set.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Changed the LHASH code to use prototypes for callbacks, and created    macros to declare and implement thin (optionally static) functions    that provide type-\/safety and avoid function pointer casting for the    type-\/specific callbacks.     $<$em$>$\+Geoff Thorpe$<$/em$>$   \texorpdfstring{$\ast$}{*} Added Kerberos Cipher Suites to be used with TLS, as written in    RFC 2712.    \texorpdfstring{$\ast$}{*}\+Veers Staats $<$staatsvr@asc.\+hpc.\+mil$>$,    Jeffrey Altman $<$jaltman@columbia.\+edu$>$, via Richard Levitte\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Reformat the FAQ so the different questions and answers can be divided    in sections depending on the subject.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Have the zlib compression code load ZLIB.\+DLL dynamically under    Windows.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} New function BN\+\_\+mod\+\_\+sqrt for computing square roots modulo a prime    (using the probabilistic Tonelli-\/\+Shanks algorithm unless    p == 3 (mod 4)  or  p == 5 (mod 8),  which are cases that can    be handled deterministically).     \texorpdfstring{$\ast$}{*}\+Lenka Fibikova $<$fibikova@exp-\/math.\+uni-\/essen.\+de$>$, Bodo Moeller\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Make BN\+\_\+mod\+\_\+inverse faster by explicitly handling small quotients    in the Euclid loop. (\+Speed gain about 20\% for small moduli \mbox{[}256 or    512 bits\mbox{]}, about 30\% for larger ones \mbox{[}1024 or 2048 bits\mbox{]}.)     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} New function BN\+\_\+kronecker.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix BN\+\_\+gcd so that it works on negative inputs; the result is    positive unless both parameters are zero.    Previously something reasonably close to an infinite loop was    possible because numbers could be growing instead of shrinking    in the implementation of Euclid\textquotesingle{}s algorithm.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix BN\+\_\+is\+\_\+word() and BN\+\_\+is\+\_\+one() macros to take into account the    sign of the number in question.     Fix BN\+\_\+is\+\_\+word(a,w) to work correctly for w == 0.     The old BN\+\_\+is\+\_\+word(a,w) macro is now called BN\+\_\+abs\+\_\+is\+\_\+word(a,w)    because its test if the absolute value of \textquotesingle{}a\textquotesingle{} equals \textquotesingle{}w\textquotesingle{}.    Note that BN\+\_\+abs\+\_\+is\+\_\+word does $<$em$>$not$<$/em$>$ handle w == 0 reliably;    it exists mostly for use in the implementations of BN\+\_\+is\+\_\+zero(),    BN\+\_\+is\+\_\+one(), and BN\+\_\+is\+\_\+word().     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} New function BN\+\_\+swap.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Use BN\+\_\+nnmod instead of BN\+\_\+mod in crypto/bn/bn\+\_\+exp.\+c so that    the exponentiation functions are more likely to produce reasonable    results on negative inputs.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Change BN\+\_\+mod\+\_\+mul so that the result is always non-\/negative.    Previously, it could be negative if one of the factors was negative;    I don\textquotesingle{}t think anyone really wanted that behaviour.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Move $<$tt$>$\+BN\+\_\+mod\+\_\+...$<$/tt$>$ functions into new file $<$tt$>$crypto/bn/bn\+\_\+mod.\+c$<$/tt$>$    (except for exponentiation, which stays in $<$tt$>$crypto/bn/bn\+\_\+exp.\+c$<$/tt$>$,    and $<$tt$>$\+BN\+\_\+mod\+\_\+mul\+\_\+reciprocal$<$/tt$>$, which stays in $<$tt$>$crypto/bn/bn\+\_\+recp.\+c$<$/tt$>$)    and add new functions\+: @iverbatim      BN\+\_\+nnmod     BN\+\_\+mod\+\_\+sqr     BN\+\_\+mod\+\_\+add     BN\+\_\+mod\+\_\+add\+\_\+quick     BN\+\_\+mod\+\_\+sub     BN\+\_\+mod\+\_\+sub\+\_\+quick     BN\+\_\+mod\+\_\+lshift1     BN\+\_\+mod\+\_\+lshift1\+\_\+quick     BN\+\_\+mod\+\_\+lshift     BN\+\_\+mod\+\_\+lshift\+\_\+quick @endiverbatim    These functions always generate non-\/negative results.     $<$tt$>$\+BN\+\_\+nnmod$<$/tt$>$ otherwise is $<$tt$>$like BN\+\_\+mod$<$/tt$>$ (if $<$tt$>$\+BN\+\_\+mod$<$/tt$>$ computes a remainder $<$tt$>$r$<$/tt$>$    such that $<$tt$>$\texorpdfstring{$\vert$}{|}m\texorpdfstring{$\vert$}{|} \textbackslash{}$<$ r \textbackslash{}$<$ 0$<$/tt$>$, $<$tt$>$\+BN\+\_\+nnmod$<$/tt$>$ will output $<$tt$>$rem + \texorpdfstring{$\vert$}{|}m\texorpdfstring{$\vert$}{|}$<$/tt$>$ instead).     $<$tt$>$\+BN\+\_\+mod\+\_\+\+XXX\+\_\+quick(r, a, \mbox{[}b,\mbox{]} m)$<$/tt$>$ generates the same result as    $<$tt$>$\+BN\+\_\+mod\+\_\+\+XXX(r, a, \mbox{[}b,\mbox{]} m, ctx)$<$/tt$>$, but requires that $<$tt$>$a$<$/tt$>$ \mbox{[}and  $<$tt$>$b$<$/tt$>$\mbox{]}    be reduced modulo $<$tt$>$m$<$/tt$>$.     \texorpdfstring{$\ast$}{*}\+Lenka Fibikova $<$fibikova@exp-\/math.\+uni-\/essen.\+de$>$, Bodo Moeller\texorpdfstring{$\ast$}{*}                   \texorpdfstring{$\ast$}{*} In \textquotesingle{}openssl passwd\textquotesingle{}, verify passwords read from the terminal    unless the \textquotesingle{}-\/salt\textquotesingle{} option is used (which usually means that    verification would just waste user\textquotesingle{}s time since the resulting    hash is going to be compared with some given password hash)    or the new \textquotesingle{}-\/noverify\textquotesingle{} option is used.     This is an incompatible change, but it does not affect    non-\/interactive use of \textquotesingle{}openssl passwd\textquotesingle{} (passwords on the command    line, \textquotesingle{}-\/stdin\textquotesingle{} option, \textquotesingle{}-\/in ...\textquotesingle{} option) and thus should not    cause any problems.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Remove all references to RSAref, since there\textquotesingle{}s no more need for it.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Make DSO load along a path given through an environment variable    (\+SHLIB\+\_\+\+PATH) with shl\+\_\+load().     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Constify the ENGINE code as a result of BIGNUM constification.    Also constify the RSA code and most things related to it.  In a    few places, most notable in the depth of the ASN.\+1 code, ugly    casts back to non-\/const were required (to be solved at a later    time)     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Make it so the openssl application has all engines loaded by default.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Constify the BIGNUM routines a little more.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Add the following functions\+: @iverbatim      ENGINE\+\_\+load\+\_\+cswift()     ENGINE\+\_\+load\+\_\+chil()     ENGINE\+\_\+load\+\_\+atalla()     ENGINE\+\_\+load\+\_\+nuron()     ENGINE\+\_\+load\+\_\+builtin\+\_\+engines() @endiverbatim    That way, an application can itself choose if external engines that    are built-\/in in Open\+SSL shall ever be used or not.  The benefit is    that applications won\textquotesingle{}t have to be linked with libdl or other dso    libraries unless it\textquotesingle{}s really needed.     Changed \textquotesingle{}openssl engine\textquotesingle{} to load all engines on demand.    Changed the engine header files to avoid the duplication of some    declarations (they differed!).     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} \textquotesingle{}openssl engine\textquotesingle{} can now list capabilities.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Better error reporting in \textquotesingle{}openssl engine\textquotesingle{}.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Never call load\+\_\+dh\+\_\+param(\+NULL) in s\+\_\+server.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Add engine application.  It can currently list engines by name and    identity, and test if they are actually available.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Improve RPM specification file by forcing symbolic linking and making    sure the installed documentation is also owned by root.\+root.     \texorpdfstring{$\ast$}{*}\+Damien Miller $<$djm@mindrot.\+org$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Give the Open\+SSL applications more possibilities to make use of    keys (public as well as private) handled by engines.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Add OCSP code that comes from Cert\+Co.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Add VMS support for the Rijndael code.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Added untested support for Nuron crypto accelerator.     $<$em$>$\+Ben Laurie$<$/em$>$   \texorpdfstring{$\ast$}{*} Add support for external cryptographic devices.  This code was    previously distributed separately as the "{}engine"{} branch.     $<$em$>$\+Geoff Thorpe, Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Rework the filename-\/translation in the DSO code. It is now possible to    have far greater control over how a "{}name"{} is turned into a filename    depending on the operating environment and any oddities about the    different shared library filenames on each system.     $<$em$>$\+Geoff Thorpe$<$/em$>$   \texorpdfstring{$\ast$}{*} Support threads on Free\+BSD-\/elf in Configure.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix for SHA1 assembly problem with MASM\+: it produces    warnings about corrupt line number information when assembling    with debugging information. This is caused by the overlapping    of two sections.     \texorpdfstring{$\ast$}{*}\+Bernd Matthes $<$mainbug@celocom.\+de$>$, Steve Henson\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} NCONF changes.    NCONF\+\_\+get\+\_\+number() has no error checking at all.  As a replacement,    NCONF\+\_\+get\+\_\+number\+\_\+e() is defined ($<$tt$>$\+\_\+e$<$/tt$>$ for "{}error checking"{}) and is    promoted strongly.  The old NCONF\+\_\+get\+\_\+number is kept around for    binary backward compatibility.    Make it possible for methods to load from something other than a BIO,    by providing a function pointer that is given a name instead of a BIO.    For example, this could be used to load configuration data from an    LDAP server.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix for non blocking accept BIOs. Added new I/\+O special reason    BIO\+\_\+\+RR\+\_\+\+ACCEPT to cover this case. Previously use of accept BIOs    with non blocking I/\+O was not possible because no retry code was    implemented. Also added new SSL code SSL\+\_\+\+WANT\+\_\+\+ACCEPT to cover    this case.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Added the beginnings of Rijndael support.     $<$em$>$\+Ben Laurie$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix for bug in Directory\+String mask setting. Add support for    X509\+\_\+\+NAME\+\_\+print\+\_\+ex() in \textquotesingle{}req\textquotesingle{} and X509\+\_\+print\+\_\+ex() function    to allow certificate printing to more controllable, additional    \textquotesingle{}certopt\textquotesingle{} option to \textquotesingle{}x509\textquotesingle{} to allow new printing options to be    set.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Clean old EAY MD5 hack from e\+\_\+os.\+h.     $<$em$>$\+Richard Levitte$<$/em$>$  @subsection autotoc\+\_\+md149 Changes between 0.\+9.\+6l and 0.\+9.\+6m  \mbox{[}17 Mar 2004\mbox{]}   \texorpdfstring{$\ast$}{*} Fix null-\/pointer assignment in do\+\_\+change\+\_\+cipher\+\_\+spec() revealed    by using the Codenomicon TLS Test Tool ($<$a href="{}\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2004-0079}{\texttt{ https\+://www.\+openssl.\+org/news/vulnerabilities.\+html\#\+CVE-\/2004-\/0079}}"{} $>$\+CVE-\/2004-\/0079$<$/a$>$)     $<$em$>$\+Joe Orton, Steve Henson$<$/em$>$  @subsection autotoc\+\_\+md150 Changes between 0.\+9.\+6k and 0.\+9.\+6l  \mbox{[}04 Nov 2003\mbox{]}   \texorpdfstring{$\ast$}{*} Fix additional bug revealed by the NISCC test suite\+:     Stop bug triggering large recursion when presented with    certain ASN.\+1 tags ($<$a href="{}\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2003-0851}{\texttt{ https\+://www.\+openssl.\+org/news/vulnerabilities.\+html\#\+CVE-\/2003-\/0851}}"{} $>$\+CVE-\/2003-\/0851$<$/a$>$)     $<$em$>$\+Steve Henson$<$/em$>$  @subsection autotoc\+\_\+md151 Changes between 0.\+9.\+6j and 0.\+9.\+6k  \mbox{[}30 Sep 2003\mbox{]}   \texorpdfstring{$\ast$}{*} Fix various bugs revealed by running the NISCC test suite\+:     Stop out of bounds reads in the ASN1 code when presented with    invalid tags (\+CVE-\/2003-\/0543 and CVE-\/2003-\/0544).     If verify callback ignores invalid public key errors don\textquotesingle{}t try to check    certificate signature with the NULL public key.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} In ssl3\+\_\+accept() (ssl/s3\+\_\+srvr.\+c) only accept a client certificate    if the server requested one\+: as stated in TLS 1.\+0 and SSL 3.\+0    specifications.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} In ssl3\+\_\+get\+\_\+client\+\_\+hello() (ssl/s3\+\_\+srvr.\+c), tolerate additional    extra data after the compression methods not only for TLS 1.\+0    but also for SSL 3.\+0 (as required by the specification).     $<$em$>$\+Bodo Moeller; problem pointed out by Matthias Loepfe$<$/em$>$   \texorpdfstring{$\ast$}{*} Change X509\+\_\+certificate\+\_\+type() to mark the key as exported/exportable    when it\textquotesingle{}s 512 $<$em$>$bits$<$/em$>$ long, not 512 bytes.     $<$em$>$\+Richard Levitte$<$/em$>$  @subsection autotoc\+\_\+md152 Changes between 0.\+9.\+6i and 0.\+9.\+6j  \mbox{[}10 Apr 2003\mbox{]}   \texorpdfstring{$\ast$}{*} Countermeasure against the Klima-\/\+Pokorny-\/\+Rosa extension of    Bleichbacher\textquotesingle{}s attack on PKCS \#1 v1.\+5 padding\+: treat    a protocol version number mismatch like a decryption error    in ssl3\+\_\+get\+\_\+client\+\_\+key\+\_\+exchange (ssl/s3\+\_\+srvr.\+c).     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Turn on RSA blinding by default in the default implementation    to avoid a timing attack. Applications that don\textquotesingle{}t want it can call    RSA\+\_\+blinding\+\_\+off() or use the new flag RSA\+\_\+\+FLAG\+\_\+\+NO\+\_\+\+BLINDING.    They would be ill-\/advised to do so in most cases.     $<$em$>$\+Ben Laurie, Steve Henson, Geoff Thorpe, Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Change RSA blinding code so that it works when the PRNG is not    seeded (in this case, the secret RSA exponent is abused as    an unpredictable seed -- if it is not unpredictable, there    is no point in blinding anyway).  Make RSA blinding thread-\/safe    by remembering the creator\textquotesingle{}s thread ID in rsa-\/$>$blinding and    having all other threads use local one-\/time blinding factors    (this requires more computation than sharing rsa-\/$>$blinding, but    avoids excessive locking; and if an RSA object is not shared    between threads, blinding will still be very fast).     $<$em$>$\+Bodo Moeller$<$/em$>$  @subsection autotoc\+\_\+md153 Changes between 0.\+9.\+6h and 0.\+9.\+6i  \mbox{[}19 Feb 2003\mbox{]}   \texorpdfstring{$\ast$}{*} In ssl3\+\_\+get\+\_\+record (ssl/s3\+\_\+pkt.\+c), minimize information leaked    via timing by performing a MAC computation even if incorrect    block cipher padding has been found.  This is a countermeasure    against active attacks where the attacker has to distinguish    between bad padding and a MAC verification error. ($<$a href="{}\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2003-0078}{\texttt{ https\+://www.\+openssl.\+org/news/vulnerabilities.\+html\#\+CVE-\/2003-\/0078}}"{} $>$\+CVE-\/2003-\/0078$<$/a$>$)     $<$em$>$\+Bodo Moeller; problem pointed out by Brice Canvel (\+EPFL),    Alain Hiltgen (\+UBS), Serge Vaudenay (\+EPFL), and    Martin Vuagnoux (\+EPFL, Ilion)$<$/em$>$  @subsection autotoc\+\_\+md154 Changes between 0.\+9.\+6g and 0.\+9.\+6h  \mbox{[}5 Dec 2002\mbox{]}   \texorpdfstring{$\ast$}{*} New function OPENSSL\+\_\+cleanse(), which is used to cleanse a section of    memory from its contents.  This is done with a counter that will    place alternating values in each byte.  This can be used to solve    two issues\+: 1) the removal of calls to memset() by highly optimizing    compilers, and 2) cleansing with other values than 0, since those can    be read through on certain media, for example a swap space on disk.     $<$em$>$\+Geoff Thorpe$<$/em$>$   \texorpdfstring{$\ast$}{*} Bugfix\+: client side session caching did not work with external caching,    because the session-\/$>$cipher setting was not restored when reloading    from the external cache. This problem was masked, when    SSL\+\_\+\+OP\+\_\+\+NETSCAPE\+\_\+\+REUSE\+\_\+\+CIPHER\+\_\+\+CHANGE\+\_\+\+BUG (part of SSL\+\_\+\+OP\+\_\+\+ALL) was set.    (\+Found by Steve Haslam $<$steve@araqnid.\+ddts.\+net$>$.)     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix client\+\_\+certificate (ssl/s2\+\_\+clnt.\+c)\+: The permissible total    length of the REQUEST-\/\+CERTIFICATE message is 18 .. 34, not 17 .. 33.     \texorpdfstring{$\ast$}{*}\+Zeev Lieber $<$zeev-\/l@yahoo.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Undo an undocumented change introduced in 0.\+9.\+6e which caused    repeated calls to Open\+SSL\+\_\+add\+\_\+all\+\_\+ciphers() and    Open\+SSL\+\_\+add\+\_\+all\+\_\+digests() to be ignored, even after calling    EVP\+\_\+cleanup().     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Change the default configuration reader to deal with last line not    being properly terminated.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Change X509\+\_\+\+NAME\+\_\+cmp() so it applies the special rules on handling    DN values that are of type Printable\+String, as well as RDNs of type    email\+Address where the value has the type ia5\+String.     \texorpdfstring{$\ast$}{*}stefank@valicert.\+com via Richard Levitte\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Add a SSL\+\_\+\+SESS\+\_\+\+CACHE\+\_\+\+NO\+\_\+\+INTERNAL\+\_\+\+STORE flag to take over half    the job SSL\+\_\+\+SESS\+\_\+\+CACHE\+\_\+\+NO\+\_\+\+INTERNAL\+\_\+\+LOOKUP was inconsistently    doing, define a new flag (\+SSL\+\_\+\+SESS\+\_\+\+CACHE\+\_\+\+NO\+\_\+\+INTERNAL) to be    the bitwise-\/\+OR of the two for use by the majority of applications    wanting this behaviour, and update the docs. The documented    behaviour and actual behaviour were inconsistent and had been    changing anyway, so this is more a bug-\/fix than a behavioural    change.     $<$em$>$\+Geoff Thorpe, diagnosed by Nadav Har\textquotesingle{}\+El$<$/em$>$   \texorpdfstring{$\ast$}{*} Don\textquotesingle{}t impose a 16-\/byte length minimum on session IDs in ssl/s3\+\_\+clnt.\+c    (the SSL 3.\+0 and TLS 1.\+0 specifications allow any length up to 32 bytes).     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix initialization code race conditions in            SSLv23\+\_\+method(),  SSLv23\+\_\+client\+\_\+method(),   SSLv23\+\_\+server\+\_\+method(),            SSLv2\+\_\+method(),   SSLv2\+\_\+client\+\_\+method(),    SSLv2\+\_\+server\+\_\+method(),            SSLv3\+\_\+method(),   SSLv3\+\_\+client\+\_\+method(),    SSLv3\+\_\+server\+\_\+method(),            TLSv1\+\_\+method(),   TLSv1\+\_\+client\+\_\+method(),    TLSv1\+\_\+server\+\_\+method(),            ssl2\+\_\+get\+\_\+cipher\+\_\+by\+\_\+char(),            ssl3\+\_\+get\+\_\+cipher\+\_\+by\+\_\+char().     \texorpdfstring{$\ast$}{*}\+Patrick Mc\+Cormick $<$patrick@tellme.\+com$>$, Bodo Moeller\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Reorder cleanup sequence in SSL\+\_\+\+CTX\+\_\+free()\+: only remove the ex\+\_\+data after    the cached sessions are flushed, as the remove\+\_\+cb() might use ex\+\_\+data    contents. Bug found by Sam Varshavchik $<$mrsam@courier-\/mta.\+com$>$    (see \mbox{[}openssl.\+org \#212\mbox{]}).     $<$em$>$\+Geoff Thorpe, Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix typo in OBJ\+\_\+txt2obj which incorrectly passed the content    length, instead of the encoding length to d2i\+\_\+\+ASN1\+\_\+\+OBJECT.     $<$em$>$\+Steve Henson$<$/em$>$  @subsection autotoc\+\_\+md155 Changes between 0.\+9.\+6f and 0.\+9.\+6g  \mbox{[}9 Aug 2002\mbox{]}   \texorpdfstring{$\ast$}{*} \mbox{[}\+In 0.\+9.\+6g-\/engine release\+:\mbox{]}    Fix crypto/engine/vendor\+\_\+defns/cswift.\+h for WIN32 (use $<$tt$>$\+\_\+stdcall$<$/tt$>$).     \texorpdfstring{$\ast$}{*}\+Lynn Gazis $<$lgazis@rainbow.\+com$>$\texorpdfstring{$\ast$}{*}  @subsection autotoc\+\_\+md156 Changes between 0.\+9.\+6e and 0.\+9.\+6f  \mbox{[}8 Aug 2002\mbox{]}   \texorpdfstring{$\ast$}{*} Fix ASN1 checks. Check for overflow by comparing with LONG\+\_\+\+MAX    and get fix the header length calculation.    \texorpdfstring{$\ast$}{*}\+Florian Weimer $<$\+Weimer@\+CERT.\+Uni-\/\+Stuttgart.\+DE$>$,    Alon Kantor $<$alonk@checkpoint.\+com$>$ (and others), Steve Henson\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Use proper error handling instead of \textquotesingle{}assertions\textquotesingle{} in buffer    overflow checks added in 0.\+9.\+6e.  This prevents Do\+S (the    assertions could call abort()).     \texorpdfstring{$\ast$}{*}\+Arne Ansper $<$arne@ats.\+cyber.\+ee$>$, Bodo Moeller\texorpdfstring{$\ast$}{*}  @subsection autotoc\+\_\+md157 Changes between 0.\+9.\+6d and 0.\+9.\+6e  \mbox{[}30 Jul 2002\mbox{]}   \texorpdfstring{$\ast$}{*} Add various sanity checks to asn1\+\_\+get\+\_\+length() to reject    the ASN1 length bytes if they exceed sizeof(long), will appear    negative or the content length exceeds the length of the    supplied buffer.     \texorpdfstring{$\ast$}{*}\+Steve Henson, Adi Stav $<$stav@mercury.\+co.\+il$>$, James Yonan $<$jim@ntlp.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Fix cipher selection routines\+: ciphers without encryption had no flags    for the cipher strength set and where therefore not handled correctly    by the selection routines (\+PR \#130).     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix EVP\+\_\+dsa\+\_\+sha macro.     $<$em$>$\+Nils Larsch$<$/em$>$   \texorpdfstring{$\ast$}{*} New option         SSL\+\_\+\+OP\+\_\+\+DONT\+\_\+\+INSERT\+\_\+\+EMPTY\+\_\+\+FRAGMENTS    for disabling the SSL 3.\+0/\+TLS 1.\+0 CBC vulnerability countermeasure    that was added in Open\+SSL 0.\+9.\+6d.     As the countermeasure turned out to be incompatible with some    broken SSL implementations, the new option is part of SSL\+\_\+\+OP\+\_\+\+ALL.    SSL\+\_\+\+OP\+\_\+\+ALL is usually employed when compatibility with weird SSL    implementations is desired (e.\+g. \textquotesingle{}-\/bugs\textquotesingle{} option to \textquotesingle{}s\+\_\+client\textquotesingle{} and    \textquotesingle{}s\+\_\+server\textquotesingle{}), so the new option is automatically set in many    applications.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Changes in security patch\+:     Changes marked "{}(CHATS)"{} were sponsored by the Defense Advanced    Research Projects Agency (\+DARPA) and Air Force Research Laboratory,    Air Force Materiel Command, USAF, under agreement number    F30602-\/01-\/2-\/0537.   \texorpdfstring{$\ast$}{*} Add various sanity checks to asn1\+\_\+get\+\_\+length() to reject    the ASN1 length bytes if they exceed sizeof(long), will appear    negative or the content length exceeds the length of the    supplied buffer. ($<$a href="{}\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2002-0659}{\texttt{ https\+://www.\+openssl.\+org/news/vulnerabilities.\+html\#\+CVE-\/2002-\/0659}}"{} $>$\+CVE-\/2002-\/0659$<$/a$>$)     \texorpdfstring{$\ast$}{*}\+Steve Henson, Adi Stav $<$stav@mercury.\+co.\+il$>$, James Yonan $<$jim@ntlp.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Assertions for various potential buffer overflows, not known to    happen in practice.     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} Various temporary buffers to hold ASCII versions of integers were    too small for 64 bit platforms. ($<$a href="{}\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2002-0655}{\texttt{ https\+://www.\+openssl.\+org/news/vulnerabilities.\+html\#\+CVE-\/2002-\/0655}}"{} $>$\+CVE-\/2002-\/0655$<$/a$>$)    \texorpdfstring{$\ast$}{*}\+Matthew Byng-\/\+Maddick $<$mbm@aldigital.\+co.\+uk$>$ and Ben Laurie (\+CHATS)$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Remote buffer overflow in SSL3 protocol -\/ an attacker could    supply an oversized session ID to a client. ($<$a href="{}\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2002-0656}{\texttt{ https\+://www.\+openssl.\+org/news/vulnerabilities.\+html\#\+CVE-\/2002-\/0656}}"{} $>$\+CVE-\/2002-\/0656$<$/a$>$)     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$   \texorpdfstring{$\ast$}{*} Remote buffer overflow in SSL2 protocol -\/ an attacker could    supply an oversized client master key. ($<$a href="{}\href{https://www.openssl.org/news/vulnerabilities.html\#CVE-2002-0656}{\texttt{ https\+://www.\+openssl.\+org/news/vulnerabilities.\+html\#\+CVE-\/2002-\/0656}}"{} $>$\+CVE-\/2002-\/0656$<$/a$>$)     $<$em$>$\+Ben Laurie (\+CHATS)$<$/em$>$  @subsection autotoc\+\_\+md158 Changes between 0.\+9.\+6c and 0.\+9.\+6d  \mbox{[}9 May 2002\mbox{]}   \texorpdfstring{$\ast$}{*} Fix crypto/asn1/a\+\_\+sign.\+c so that \textquotesingle{}parameters\textquotesingle{} is omitted (not    encoded as NULL) with id-\/dsa-\/with-\/sha1.     \texorpdfstring{$\ast$}{*}\+Nils Larsch $<$nla@trustcenter.\+de$>$; problem pointed out by Bodo Moeller\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Check various $<$tt$>$\+X509\+\_\+...()$<$/tt$>$ return values in $<$tt$>$apps/req.\+c$<$/tt$>$.     \texorpdfstring{$\ast$}{*}\+Nils Larsch $<$nla@trustcenter.\+de$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Fix BASE64 decode (\+EVP\+\_\+\+Decode\+Update) for data with CR/\+LF ended lines\+:    an end-\/of-\/file condition would erroneously be flagged, when the CRLF    was just at the end of a processed block. The bug was discovered when    processing data through a buffering memory BIO handing the data to a    BASE64-\/decoding BIO. Bug fund and patch submitted by Pavel Tsekov    $<$ptsekov@syntrex.\+com$>$ and Nedelcho Stanev.     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Implement a countermeasure against a vulnerability recently found    in CBC ciphersuites in SSL 3.\+0/\+TLS 1.\+0\+: Send an empty fragment    before application data chunks to avoid the use of known IVs    with data potentially chosen by the attacker.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix length checks in ssl3\+\_\+get\+\_\+client\+\_\+hello().     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} TLS/\+SSL library bugfix\+: use s-\/$>$s3-\/$>$in\+\_\+read\+\_\+app\+\_\+data differently    to prevent ssl3\+\_\+read\+\_\+internal() from incorrectly assuming that    ssl3\+\_\+read\+\_\+bytes() found application data while handshake    processing was enabled when in fact s-\/$>$s3-\/$>$in\+\_\+read\+\_\+app\+\_\+data was    merely automatically cleared during the initial handshake.     \texorpdfstring{$\ast$}{*}\+Bodo Moeller; problem pointed out by Arne Ansper $<$arne@ats.\+cyber.\+ee$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Fix object definitions for Private and Enterprise\+: they were not    recognized in their shortname (=lowercase) representation. Extend    obj\+\_\+dat.\+pl to issue an error when using undefined keywords instead    of silently ignoring the problem (\+Svenning Sorensen    $<$sss@sss.\+dnsalias.\+net$>$).     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix DH\+\_\+generate\+\_\+parameters() so that it works for \textquotesingle{}non-\/standard\textquotesingle{}    generators, i.\+e. generators other than 2 and 5.  (\+Previously, the    code did not properly initialise the \textquotesingle{}add\textquotesingle{} and \textquotesingle{}rem\textquotesingle{} values to    BN\+\_\+generate\+\_\+prime().)     In the new general case, we do not insist that \textquotesingle{}generator\textquotesingle{} is    actually a primitive root\+: This requirement is rather pointless;    a generator of the order-\/q subgroup is just as good, if not    better.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Map new X509 verification errors to alerts. Discovered and submitted by    Tom Wu $<$tom@arcot.\+com$>$.     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix ssl3\+\_\+pending() (ssl/s3\+\_\+lib.\+c) to prevent SSL\+\_\+pending() from    returning non-\/zero before the data has been completely received    when using non-\/blocking I/\+O.     $<$em$>$\+Bodo Moeller; problem pointed out by John Hughes$<$/em$>$   \texorpdfstring{$\ast$}{*} Some of the ciphers missed the strength entry (\+SSL\+\_\+\+LOW etc).     $<$em$>$\+Ben Laurie, Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix bug in SSL\+\_\+clear()\+: bad sessions were not removed (found by    Yoram Zahavi $<$\+Yoram\+Z@gilian.\+com$>$).     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Add information about Cyg\+Win 1.\+3 and on, and preserve proper    configuration for the versions before that.     \texorpdfstring{$\ast$}{*}\+Corinna Vinschen $<$vinschen@redhat.\+com$>$ and Richard Levitte\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Make removal from session cache (\+SSL\+\_\+\+CTX\+\_\+remove\+\_\+session()) more robust\+:    check whether we deal with a copy of a session and do not delete from    the cache in this case. Problem reported by "{}Izhar Shoshani Levi"{}    $<$izhar@checkpoint.\+com$>$.     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Do not store session data into the internal session cache, if it    is never intended to be looked up (\+SSL\+\_\+\+SESS\+\_\+\+CACHE\+\_\+\+NO\+\_\+\+INTERNAL\+\_\+\+LOOKUP    flag is set). Proposed by Aslam $<$aslam@funk.\+com$>$.     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Have ASN1\+\_\+\+BIT\+\_\+\+STRING\+\_\+set\+\_\+bit() really clear a bit when the requested    value is 0.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} \mbox{[}\+In 0.\+9.\+6d-\/engine release\+:\mbox{]}    Fix a crashbug and a logic bug in hwcrhk\+\_\+load\+\_\+pubkey().     \texorpdfstring{$\ast$}{*}\+Toomas Kiisk $<$vix@cyber.\+ee$>$ via Richard Levitte\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Add the configuration target linux-\/s390x.     \texorpdfstring{$\ast$}{*}\+Neale Ferguson $<$\+Neale.\+Ferguson@\+Software\+AG-\/\+USA.\+com$>$ via Richard Levitte\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} The earlier bugfix for the SSL3\+\_\+\+ST\+\_\+\+SW\+\_\+\+HELLO\+\_\+\+REQ\+\_\+\+C case of    ssl3\+\_\+accept (ssl/s3\+\_\+srvr.\+c) incorrectly used a local flag    variable as an indication that a Client\+Hello message has been    received.  As the flag value will be lost between multiple    invocations of ssl3\+\_\+accept when using non-\/blocking I/\+O, the    function may not be aware that a handshake has actually taken    place, thus preventing a new session from being added to the    session cache.     To avoid this problem, we now set s-\/$>$new\+\_\+session to 2 instead of    using a local variable.     $<$em$>$\+Lutz Jaenicke, Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Bugfix\+: Return -\/1 from ssl3\+\_\+get\+\_\+server\+\_\+done (ssl3/s3\+\_\+clnt.\+c)    if the SSL\+\_\+\+R\+\_\+\+LENGTH\+\_\+\+MISMATCH error is detected.     $<$em$>$\+Geoff Thorpe, Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} New \textquotesingle{}shared\+\_\+ldflag\textquotesingle{} column in Configure platform table.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix EVP\+\_\+\+CIPHER\+\_\+mode macro.     \texorpdfstring{$\ast$}{*}"{}Dan S. Camper"{} $<$dan@bti.\+net$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Fix ssl3\+\_\+read\+\_\+bytes (ssl/s3\+\_\+pkt.\+c)\+: To ignore messages of unknown    type, we must throw them away by setting rr-\/$>$length to 0.     \texorpdfstring{$\ast$}{*}\+D P Chang $<$dpc@qualys.\+com$>$\texorpdfstring{$\ast$}{*}  @subsection autotoc\+\_\+md159 Changes between 0.\+9.\+6b and 0.\+9.\+6c  \mbox{[}21 dec 2001\mbox{]}   \texorpdfstring{$\ast$}{*} Fix BN\+\_\+rand\+\_\+range bug pointed out by Dominikus Scherkl    $<$\+Dominikus.\+Scherkl@biodata.\+com$>$.  (\+The previous implementation    worked incorrectly for those cases where range = $<$tt$>$10...\+\_\+2$<$/tt$>$  and    $<$tt$>$3\texorpdfstring{$\ast$}{*}range$<$/tt$>$  is two bits longer than  range.)     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Only add signing time to PKCS7 structures if it is not already    present.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix crypto/objects/objects.\+h\+: "{}ld-\/ce"{} should be "{}id-\/ce"{},    OBJ\+\_\+ld\+\_\+ce should be OBJ\+\_\+id\+\_\+ce.    Also some ip-\/pda OIDs in crypto/objects/objects.\+txt were    incorrect (cf. RFC 3039).     $<$em$>$\+Matt Cooper, Frederic Giudicelli, Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Release CRYPTO\+\_\+\+LOCK\+\_\+\+DYNLOCK when CRYPTO\+\_\+destroy\+\_\+dynlockid()    returns early because it has nothing to do.     \texorpdfstring{$\ast$}{*}\+Andy Schneider $<$andy.\+schneider@bjss.\+co.\+uk$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} \mbox{[}\+In 0.\+9.\+6c-\/engine release\+:\mbox{]}    Fix mutex callback return values in crypto/engine/hw\+\_\+ncipher.\+c.     \texorpdfstring{$\ast$}{*}\+Andy Schneider $<$andy.\+schneider@bjss.\+co.\+uk$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} \mbox{[}\+In 0.\+9.\+6c-\/engine release\+:\mbox{]}    Add support for Cryptographic Appliance\textquotesingle{}s keyserver technology.    (\+Use engine \textquotesingle{}keyclient\textquotesingle{})     $<$em$>$\+Cryptographic Appliances and Geoff Thorpe$<$/em$>$   \texorpdfstring{$\ast$}{*} Add a configuration entry for OS/390 Unix.  The C compiler \textquotesingle{}c89\textquotesingle{}    is called via tools/c89.\+sh because arguments have to be    rearranged (all \textquotesingle{}-\/\+L\textquotesingle{} options must appear before the first object    modules).     \texorpdfstring{$\ast$}{*}\+Richard Shapiro $<$rshapiro@abinitio.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} \mbox{[}\+In 0.\+9.\+6c-\/engine release\+:\mbox{]}    Add support for Broadcom crypto accelerator cards, backported    from 0.\+9.\+7.     \texorpdfstring{$\ast$}{*}\+Broadcom, Nalin Dahyabhai $<$nalin@redhat.\+com$>$, Mark Cox\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} \mbox{[}\+In 0.\+9.\+6c-\/engine release\+:\mbox{]}    Add support for Sure\+Ware crypto accelerator cards from    Baltimore Technologies.  (\+Use engine \textquotesingle{}sureware\textquotesingle{})     $<$em$>$\+Baltimore Technologies and Mark Cox$<$/em$>$   \texorpdfstring{$\ast$}{*} \mbox{[}\+In 0.\+9.\+6c-\/engine release\+:\mbox{]}    Add support for crypto accelerator cards from Accelerated    Encryption Processing, www.\+aep.\+ie.  (\+Use engine \textquotesingle{}aep\textquotesingle{})     $<$em$>$\+AEP Inc. and Mark Cox$<$/em$>$   \texorpdfstring{$\ast$}{*} Add a configuration entry for gcc on Unix\+Ware.     \texorpdfstring{$\ast$}{*}\+Gary Benson $<$gbenson@redhat.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Change ssl/s2\+\_\+clnt.\+c and ssl/s2\+\_\+srvr.\+c so that received handshake    messages are stored in a single piece (fixed-\/length part and    variable-\/length part combined) and fix various bugs found on the way.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Disable caching in BIO\+\_\+gethostbyname(), directly use gethostbyname()    instead.  BIO\+\_\+gethostbyname() does not know what timeouts are    appropriate, so entries would stay in cache even when they have    become invalid.    \texorpdfstring{$\ast$}{*}\+Bodo Moeller; problem pointed out by Rich Salz $<$rsalz@zolera.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Change ssl23\+\_\+get\+\_\+client\+\_\+hello (ssl/s23\+\_\+srvr.\+c) behaviour when    faced with a pathologically small Client\+Hello fragment that does    not contain client\+\_\+version\+: Instead of aborting with an error,    simply choose the highest available protocol version (i.\+e.,    TLS 1.\+0 unless it is disabled).  In practice, Client\+Hello    messages are never sent like this, but this change gives us    strictly correct behaviour at least for TLS.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix SSL handshake functions and SSL\+\_\+clear() such that SSL\+\_\+clear()    never resets s-\/$>$method to s-\/$>$ctx-\/$>$method when called from within    one of the SSL handshake functions.     $<$em$>$\+Bodo Moeller; problem pointed out by Niko Baric$<$/em$>$   \texorpdfstring{$\ast$}{*} In ssl3\+\_\+get\+\_\+client\+\_\+hello (ssl/s3\+\_\+srvr.\+c), generate a fatal alert    (sent using the client\textquotesingle{}s version number) if client\+\_\+version is    smaller than the protocol version in use.  Also change    ssl23\+\_\+get\+\_\+client\+\_\+hello (ssl/s23\+\_\+srvr.\+c) to select TLS 1.\+0 if    the client demanded SSL 3.\+0 but only TLS 1.\+0 is enabled; then    the client will at least see that alert.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix ssl3\+\_\+get\+\_\+message (ssl/s3\+\_\+both.\+c) to handle message fragmentation    correctly.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Avoid infinite loop in ssl3\+\_\+get\+\_\+message (ssl/s3\+\_\+both.\+c) if a    client receives Hello\+Request while in a handshake.     \texorpdfstring{$\ast$}{*}\+Bodo Moeller; bug noticed by Andy Schneider $<$andy.\+schneider@bjss.\+co.\+uk$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Bugfix in ssl3\+\_\+accept (ssl/s3\+\_\+srvr.\+c)\+: Case SSL3\+\_\+\+ST\+\_\+\+SW\+\_\+\+HELLO\+\_\+\+REQ\+\_\+\+C    should end in \textquotesingle{}break\textquotesingle{}, not \textquotesingle{}goto end\textquotesingle{} which circumvents various    cleanups done in state SSL\+\_\+\+ST\+\_\+\+OK.   But session related stuff    must be disabled for SSL\+\_\+\+ST\+\_\+\+OK in the case that we just sent a    Hello\+Request.     Also avoid some overhead by not calling ssl\+\_\+init\+\_\+wbio\+\_\+buffer()    before just sending a Hello\+Request.     \texorpdfstring{$\ast$}{*}\+Bodo Moeller, Eric Rescorla $<$ekr@rtfm.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Fix ssl/s3\+\_\+enc.\+c, ssl/t1\+\_\+enc.\+c and ssl/s3\+\_\+pkt.\+c so that we don\textquotesingle{}t    reveal whether illegal block cipher padding was found or a MAC    verification error occurred.  (\+Neither SSLerr() codes nor alerts    are directly visible to potential attackers, but the information    may leak via logfiles.)     Similar changes are not required for the SSL 2.\+0 implementation    because the number of padding bytes is sent in clear for SSL 2.\+0,    and the extra bytes are just ignored.  However ssl/s2\+\_\+pkt.\+c    failed to verify that the purported number of padding bytes is in    the legal range.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Add Open\+UNIX-\/8 support including shared libraries    (\+Boyd Lynn Gerber $<$gerberb@zenez.\+com$>$).     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Improve RSA\+\_\+padding\+\_\+check\+\_\+\+PKCS1\+\_\+\+OAEP() check again to avoid    \textquotesingle{}wristwatch attack\textquotesingle{} using huge encoding parameters (cf.    James H. Manger\textquotesingle{}s CRYPTO 2001 paper).  Note that the    RSA\+\_\+\+PKCS1\+\_\+\+OAEP\+\_\+\+PADDING case of RSA\+\_\+private\+\_\+decrypt() does not use    encoding parameters and hence was not vulnerable.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} BN\+\_\+sqr() bug fix.     \texorpdfstring{$\ast$}{*}\+Ulf Möller, reported by Jim Ellis $<$jim.\+ellis@cavium.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Rabin-\/\+Miller test analyses assume uniformly distributed witnesses,    so use BN\+\_\+pseudo\+\_\+rand\+\_\+range() instead of using BN\+\_\+pseudo\+\_\+rand()    followed by modular reduction.     \texorpdfstring{$\ast$}{*}\+Bodo Moeller; pointed out by Adam Young $<$\+AYoung1@\+NCSUS.\+JNJ.\+COM$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Add BN\+\_\+pseudo\+\_\+rand\+\_\+range() with obvious functionality\+: BN\+\_\+rand\+\_\+range()    equivalent based on BN\+\_\+pseudo\+\_\+rand() instead of BN\+\_\+rand().     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} s3\+\_\+srvr.\+c\+: allow sending of large client certificate lists ($>$ 16 k\+B).    This function was broken, as the check for a new client hello message    to handle SGC did not allow these large messages.    (\+Tracked down by "{}Douglas E. Engert"{} $<$deengert@anl.\+gov$>$.)     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Add alert descriptions for TLSv1 to $<$tt$>$\+SSL\+\_\+alert\+\_\+desc\+\_\+string\mbox{[}\+\_\+long\mbox{]}()$<$/tt$>$.     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix buggy behaviour of BIO\+\_\+get\+\_\+num\+\_\+renegotiates() and BIO\+\_\+ctrl()    for BIO\+\_\+\+C\+\_\+\+GET\+\_\+\+WRITE\+\_\+\+BUF\+\_\+\+SIZE ("{}Stephen Hinton"{} $<$shinton@netopia.\+com$>$).     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Rework the configuration and shared library support for Tru64 Unix.    The configuration part makes use of modern compiler features and    still retains old compiler behavior for those that run older versions    of the OS.  The shared library support part includes a variant that    uses the RPATH feature, and is available through the special    configuration target "{}alpha-\/cc-\/rpath"{}, which will never be selected    automatically.     \texorpdfstring{$\ast$}{*}\+Tim Mooney $<$mooney@dogbert.\+cc.\+ndsu.\+No\+Dak.\+edu$>$ via Richard Levitte\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} In ssl3\+\_\+get\+\_\+key\+\_\+exchange (ssl/s3\+\_\+clnt.\+c), call ssl3\+\_\+get\+\_\+message()    with the same message size as in ssl3\+\_\+get\+\_\+certificate\+\_\+request().    Otherwise, if no Server\+Key\+Exchange message occurs, Certificate\+Request    messages might inadvertently be reject as too long.     \texorpdfstring{$\ast$}{*}\+Petr Lampa $<$lampa@fee.\+vutbr.\+cz$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Enhanced support for IA-\/64 Unix platforms (well, Linux and HP-\/\+UX).     $<$em$>$\+Andy Polyakov$<$/em$>$   \texorpdfstring{$\ast$}{*} Modified SSL library such that the verify\+\_\+callback that has been set    specifically for an SSL object with SSL\+\_\+set\+\_\+verify() is actually being    used. Before the change, a verify\+\_\+callback set with this function was    ignored and the verify\+\_\+callback() set in the SSL\+\_\+\+CTX at the time of    the call was used. New function X509\+\_\+\+STORE\+\_\+\+CTX\+\_\+set\+\_\+verify\+\_\+cb() introduced    to allow the necessary settings.     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Initialize static variable in crypto/dsa/dsa\+\_\+lib.\+c and crypto/dh/dh\+\_\+lib.\+c    explicitly to NULL, as at least on Solaris 8 this seems not always to be    done automatically (in contradiction to the requirements of the C    standard). This made problems when used from Open\+SSH.     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} In Open\+SSL 0.\+9.\+6a and 0.\+9.\+6b, crypto/dh/dh\+\_\+key.\+c ignored    dh-\/$>$length and always used @iverbatim      BN\+\_\+rand\+\_\+range(priv\+\_\+key, dh-\/$>$p). @endiverbatim    BN\+\_\+rand\+\_\+range() is not necessary for Diffie-\/\+Hellman, and this    specific range makes Diffie-\/\+Hellman unnecessarily inefficient if    dh-\/$>$length (recommended exponent length) is much smaller than the    length of dh-\/$>$p.  We could use BN\+\_\+rand\+\_\+range() if the order of    the subgroup was stored in the DH structure, but we only have    dh-\/$>$length.     So switch back to @iverbatim      BN\+\_\+rand(priv\+\_\+key, l, ...) @endiverbatim    where \textquotesingle{}l\textquotesingle{} is dh-\/$>$length if this is defined, or BN\+\_\+num\+\_\+bits(dh-\/$>$p)-\/1    otherwise.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} In @iverbatim      RSA\+\_\+eay\+\_\+public\+\_\+encrypt     RSA\+\_\+eay\+\_\+private\+\_\+decrypt     RSA\+\_\+eay\+\_\+private\+\_\+encrypt (signing)     RSA\+\_\+eay\+\_\+public\+\_\+decrypt (signature verification) @endiverbatim    (default implementations for RSA\+\_\+public\+\_\+encrypt,    RSA\+\_\+private\+\_\+decrypt, RSA\+\_\+private\+\_\+encrypt, RSA\+\_\+public\+\_\+decrypt),    always reject numbers $>$= n.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} In crypto/rand/md\+\_\+rand.\+c, use a new short-\/time lock CRYPTO\+\_\+\+LOCK\+\_\+\+RAND2    to synchronize access to \textquotesingle{}locking\+\_\+thread\textquotesingle{}.  This is necessary on    systems where access to \textquotesingle{}locking\+\_\+thread\textquotesingle{} (an \textquotesingle{}unsigned long\textquotesingle{}    variable) is not atomic.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} In crypto/rand/md\+\_\+rand.\+c, set \textquotesingle{}locking\+\_\+thread\textquotesingle{} to current thread\textquotesingle{}s ID    $<$em$>$before$<$/em$>$ setting the \textquotesingle{}crypto\+\_\+lock\+\_\+rand\textquotesingle{} flag.  The previous code had    a race condition if 0 is a valid thread ID.     \texorpdfstring{$\ast$}{*}\+Travis Vitek $<$vitek@roguewave.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Add support for shared libraries under Irix.     \texorpdfstring{$\ast$}{*}\+Albert Chin-\/\+A-\/\+Young $<$china@thewrittenword.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Add configuration option to build on Linux on both big-\/endian and    little-\/endian MIPS.     \texorpdfstring{$\ast$}{*}\+Ralf Baechle $<$ralf@uni-\/koblenz.\+de$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Add the possibility to create shared libraries on HP-\/\+UX.     $<$em$>$\+Richard Levitte$<$/em$>$  @subsection autotoc\+\_\+md160 Changes between 0.\+9.\+6a and 0.\+9.\+6b  \mbox{[}9 Jul 2001\mbox{]}   \texorpdfstring{$\ast$}{*} Change ssleay\+\_\+rand\+\_\+bytes (crypto/rand/md\+\_\+rand.\+c)    to avoid a SSLeay/\+Open\+SSL PRNG weakness pointed out by    Markku-\/\+Juhani O. Saarinen $<$markku-\/juhani.\+saarinen@nokia.\+com$>$\+:    PRNG state recovery was possible based on the output of    one PRNG request appropriately sized to gain knowledge on    \textquotesingle{}md\textquotesingle{} followed by enough consecutive 1-\/byte PRNG requests    to traverse all of \textquotesingle{}state\textquotesingle{}.     1. When updating \textquotesingle{}md\+\_\+local\textquotesingle{} (the current thread\textquotesingle{}s copy of \textquotesingle{}md\textquotesingle{})       during PRNG output generation, hash all of the previous       \textquotesingle{}md\+\_\+local\textquotesingle{} value, not just the half used for PRNG output.     2. Make the number of bytes from \textquotesingle{}state\textquotesingle{} included into the hash       independent from the number of PRNG bytes requested.     The first measure alone would be sufficient to avoid    Markku-\/\+Juhani\textquotesingle{}s attack.  (\+Actually it had never occurred    to me that the half of \textquotesingle{}md\+\_\+local\textquotesingle{} used for chaining was the    half from which PRNG output bytes were taken -- I had always    assumed that the secret half would be used.)  The second    measure makes sure that additional data from \textquotesingle{}state\textquotesingle{} is never    mixed into \textquotesingle{}md\+\_\+local\textquotesingle{} in small portions; this heuristically    further strengthens the PRNG.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix crypto/bn/asm/mips3.\+s.     $<$em$>$\+Andy Polyakov$<$/em$>$   \texorpdfstring{$\ast$}{*} When only the key is given to "{}enc"{}, the IV is undefined. Print out    an error message in this case.     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Handle special case when X509\+\_\+\+NAME is empty in X509 printing routines.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} In dsa\+\_\+do\+\_\+verify (crypto/dsa/dsa\+\_\+ossl.\+c), verify that r and s are    positive and less than q.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Don\textquotesingle{}t change $<$tt$>$\texorpdfstring{$\ast$}{*}pointer$<$/tt$>$ in CRYPTO\+\_\+add\+\_\+lock() is add\+\_\+lock\+\_\+callback is    used\+: it isn\textquotesingle{}t thread safe and the add\+\_\+lock\+\_\+callback should handle    that itself.     \texorpdfstring{$\ast$}{*}\+Paul Rose $<$\+Paul.\+Rose@bridge.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Verify that incoming data obeys the block size in    ssl3\+\_\+enc (ssl/s3\+\_\+enc.\+c) and tls1\+\_\+enc (ssl/t1\+\_\+enc.\+c).     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix OAEP check.     $<$em$>$\+Ulf Möller, Bodo Möller$<$/em$>$   \texorpdfstring{$\ast$}{*} The countermeasure against Bleichbacher\textquotesingle{}s attack on PKCS \#1 v1.\+5    RSA encryption was accidentally removed in s3\+\_\+srvr.\+c in Open\+SSL 0.\+9.\+5    when fixing the server behaviour for backwards-\/compatible \textquotesingle{}client    hello\textquotesingle{} messages.  (\+Note that the attack is impractical against    SSL 3.\+0 and TLS 1.\+0 anyway because length and version checking    means that the probability of guessing a valid ciphertext is    around 2\texorpdfstring{$^\wedge$}{\string^}-\/40; see section 5 in Bleichenbacher\textquotesingle{}s CRYPTO \textquotesingle{}98    paper.)     Before 0.\+9.\+5, the countermeasure (hide the error by generating a    random \textquotesingle{}decryption result\textquotesingle{}) did not work properly because    ERR\+\_\+clear\+\_\+error() was missing, meaning that SSL\+\_\+get\+\_\+error() would    detect the supposedly ignored error.     Both problems are now fixed.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} In crypto/bio/bf\+\_\+buff.\+c, increase DEFAULT\+\_\+\+BUFFER\+\_\+\+SIZE to 4096    (previously it was 1024).     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix for compatibility mode trust settings\+: ignore trust settings    unless some valid trust or reject settings are present.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix for blowfish EVP\+: its a variable length cipher.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix various bugs related to DSA S/\+MIME verification. Handle missing    parameters in DSA public key structures and return an error in the    DSA routines if parameters are absent.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} In versions up to 0.\+9.\+6, RAND\+\_\+file\+\_\+name() resorted to file "{}.rnd"{}    in the current directory if neither \$\+RANDFILE nor \$\+HOME was set.    RAND\+\_\+file\+\_\+name() in 0.\+9.\+6a returned NULL in this case.  This has    caused some confusion to Windows users who haven\textquotesingle{}t defined \$\+HOME.    Thus RAND\+\_\+file\+\_\+name() is changed again\+: e\+\_\+os.\+h can define a    DEFAULT\+\_\+\+HOME, which will be used if \$\+HOME is not set.    For Windows, we use "{}C\+:"{}; on other platforms, we still require    environment variables.   \texorpdfstring{$\ast$}{*} Move \textquotesingle{}if (!initialized) RAND\+\_\+poll()\textquotesingle{} into regions protected by    CRYPTO\+\_\+\+LOCK\+\_\+\+RAND.  This is not strictly necessary, but avoids    having multiple threads call RAND\+\_\+poll() concurrently.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} In crypto/rand/md\+\_\+rand.\+c, replace \textquotesingle{}add\+\_\+do\+\_\+not\+\_\+lock\textquotesingle{} flag by a    combination of a flag and a thread ID variable.    Otherwise while one thread is in ssleay\+\_\+rand\+\_\+bytes (which sets the    flag), $<$em$>$other$<$/em$>$ threads can enter ssleay\+\_\+add\+\_\+bytes without obeying    the CRYPTO\+\_\+\+LOCK\+\_\+\+RAND lock (and may even illegally release the lock    that they do not hold after the first thread unsets add\+\_\+do\+\_\+not\+\_\+lock).     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Change bctest again\+: \textquotesingle{}-\/x\textquotesingle{} expressions are not available in all    versions of \textquotesingle{}test\textquotesingle{}.     $<$em$>$\+Bodo Moeller$<$/em$>$  @subsection autotoc\+\_\+md161 Changes between 0.\+9.\+6 and 0.\+9.\+6a  \mbox{[}5 Apr 2001\mbox{]}   \texorpdfstring{$\ast$}{*} Fix a couple of memory leaks in PKCS7\+\_\+data\+Decode()     \texorpdfstring{$\ast$}{*}\+Steve Henson, reported by Heyun Zheng $<$hzheng@atdsprint.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Change Configure and Makefiles to provide EXE\+\_\+\+EXT, which will contain    the default extension for executables, if any.  Also, make the perl    scripts that use symlink() to test if it really exists and use "{}cp"{}    if it doesn\textquotesingle{}t.  All this made Open\+SSL compilable and installable in    Cyg\+Win.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix for asn1\+\_\+\+Get\+Sequence() for indefinite length constructed data.    If SEQUENCE is length is indefinite just set c-\/$>$slen to the total    amount of data available.     \texorpdfstring{$\ast$}{*}\+Steve Henson, reported by shige@\+Free\+BSD.\+org\texorpdfstring{$\ast$}{*}     $<$em$>$\+This change does not apply to 0.\+9.\+7.$<$/em$>$   \texorpdfstring{$\ast$}{*} Change bctest to avoid here-\/documents inside command substitution    (workaround for Free\+BSD /bin/sh bug).    For compatibility with Ultrix, avoid shell functions (introduced    in the bctest version that searches along \$\+PATH).     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Rename \textquotesingle{}des\+\_\+encrypt\textquotesingle{} to \textquotesingle{}des\+\_\+encrypt1\textquotesingle{}.  This avoids the clashes    with des\+\_\+encrypt() defined on some operating systems, like Solaris    and Unix\+Ware.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Check the result of RSA-\/\+CRT (see D. Boneh, R. De\+Millo, R. Lipton\+:    On the Importance of Eliminating Errors in Cryptographic    Computations, J. Cryptology 14 (2001) 2, 101-\/119,    $<$http\+://theory.\+stanford.\+edu/\texorpdfstring{$\sim$}{\string~}dabo/papers/faults.\+ps.\+gz$>$).     $<$em$>$\+Ulf Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} MIPS assembler BIGNUM division bug fix.     $<$em$>$\+Andy Polyakov$<$/em$>$   \texorpdfstring{$\ast$}{*} Disabled incorrect Alpha assembler code.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix PKCS\#7 decode routines so they correctly update the length    after reading an EOC for the EXPLICIT tag.     $<$em$>$\+Steve Henson$<$/em$>$     $<$em$>$\+This change does not apply to 0.\+9.\+7.$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix bug in PKCS\#12 key generation routines. This was triggered    if a 3\+DES key was generated with a 0 initial byte. Include    PKCS12\+\_\+\+BROKEN\+\_\+\+KEYGEN compilation option to retain the old    (but broken) behaviour.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Enhance bctest to search for a working bc along \$\+PATH and print    it when found.     \texorpdfstring{$\ast$}{*}\+Tim Rice $<$tim@multitalents.\+net$>$ via Richard Levitte\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Fix memory leaks in err.\+c\+: free err\+\_\+data string if necessary;    don\textquotesingle{}t write to the wrong index in ERR\+\_\+set\+\_\+error\+\_\+data.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Implement ssl23\+\_\+peek (analogous to ssl23\+\_\+read), which previously    did not exist.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Replace rdtsc with $<$tt$>$\+\_\+emit$<$/tt$>$ statements for VC++ version 5.     \texorpdfstring{$\ast$}{*}\+Jeremy Cooper $<$jeremy@baymoo.\+org$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Make it possible to reuse SSLv2 sessions.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} In copy\+\_\+email() check for $>$= 0 as a return value for    X509\+\_\+\+NAME\+\_\+get\+\_\+index\+\_\+by\+\_\+\+NID() since 0 is a valid index.     \texorpdfstring{$\ast$}{*}\+Steve Henson reported by Massimiliano Pala $<$madwolf@opensca.\+org$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Avoid coredump with unsupported or invalid public keys by checking if    X509\+\_\+get\+\_\+pubkey() fails in PKCS7\+\_\+verify(). Fix memory leak when    PKCS7\+\_\+verify() fails with non detached data.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Don\textquotesingle{}t use getenv in library functions when run as setuid/setgid.    New function OPENSSL\+\_\+issetugid().     $<$em$>$\+Ulf Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Avoid false positives in memory leak detection code (crypto/mem\+\_\+dbg.\+c)    due to incorrect handling of multi-\/threading\+:     1. Fix timing glitch in the Mem\+Check\+\_\+off() portion of CRYPTO\+\_\+mem\+\_\+ctrl().     2. Fix logical glitch in is\+\_\+\+Mem\+Check\+\_\+on() aka CRYPTO\+\_\+is\+\_\+mem\+\_\+check\+\_\+on().     3. Count how many times Mem\+Check\+\_\+off() has been called so that       nested use can be treated correctly.  This also avoids       inband-\/signalling in the previous code (which relied on the       assumption that thread ID 0 is impossible).     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Add "{}-\/rand"{} option also to s\+\_\+client and s\+\_\+server.     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix CPU detection on Irix 6.\+x.    \texorpdfstring{$\ast$}{*}\+Kurt Hockenbury $<$khockenb@stevens-\/tech.\+edu$>$ and    "{}Bruce W. Forsberg"{} $<$bruce.\+forsberg@baesystems.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Fix X509\+\_\+\+NAME bug which produced incorrect encoding if X509\+\_\+\+NAME    was empty.     $<$em$>$\+Steve Henson$<$/em$>$     $<$em$>$\+This change does not apply to 0.\+9.\+7.$<$/em$>$   \texorpdfstring{$\ast$}{*} Use the cached encoding of an X509\+\_\+\+NAME structure rather than    copying it. This is apparently the reason for the libsafe "{}errors"{}    but the code is actually correct.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Add new function BN\+\_\+rand\+\_\+range(), and fix DSA\+\_\+sign\+\_\+setup() to prevent    Bleichenbacher\textquotesingle{}s DSA attack.    Extend BN\+\_\+\mbox{[}pseudo\+\_\+\mbox{]}rand\+: As before, top=1 forces the highest two bits    to be set and top=0 forces the highest bit to be set; top=-\/1 is new    and leaves the highest bit random.     $<$em$>$\+Ulf Moeller, Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} In the $<$tt$>$\+NCONF\+\_\+...$<$/tt$>$-\/based implementations for $<$tt$>$\+CONF\+\_\+...$<$/tt$>$ queries    (crypto/conf/conf\+\_\+lib.\+c), if the input LHASH is NULL, avoid using    a temporary CONF structure with the data component set to NULL    (which gives segmentation faults in lh\+\_\+retrieve).    Instead, use NULL for the CONF pointer in CONF\+\_\+get\+\_\+string and    CONF\+\_\+get\+\_\+number (which may use environment variables) and directly    return NULL from CONF\+\_\+get\+\_\+section.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix potential buffer overrun for EBCDIC.     $<$em$>$\+Ulf Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Tolerate non\+Repudiation as being valid for S/\+MIME signing and cert\+Sign    key\+Usage if basic\+Constraints absent for a CA.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Make SMIME\+\_\+write\+\_\+\+PKCS7() write mail header values with a format that    is more generally accepted (no spaces before the semicolon), since    some programs can\textquotesingle{}t parse those values properly otherwise.  Also make    sure BIO\textquotesingle{}s that break lines after each write do not create invalid    headers.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Make the CRL encoding routines work with empty SEQUENCE OF. The    macros previously used would not encode an empty SEQUENCE OF    and break the signature.     $<$em$>$\+Steve Henson$<$/em$>$     $<$em$>$\+This change does not apply to 0.\+9.\+7.$<$/em$>$   \texorpdfstring{$\ast$}{*} Zero the premaster secret after deriving the master secret in    DH ciphersuites.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Add some EVP\+\_\+add\+\_\+digest\+\_\+alias registrations (as found in    Open\+SSL\+\_\+add\+\_\+all\+\_\+digests()) to SSL\+\_\+library\+\_\+init()    aka Open\+SSL\+\_\+add\+\_\+ssl\+\_\+algorithms().  This provides improved    compatibility with peers using X.\+509 certificates    with unconventional Algorithm\+Identifier OIDs.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix for Irix with NO\+\_\+\+ASM.     \texorpdfstring{$\ast$}{*}"{}Bruce W. Forsberg"{} $<$bruce.\+forsberg@baesystems.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} ./config script fixes.     $<$em$>$\+Ulf Moeller, Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix \textquotesingle{}openssl passwd -\/1\textquotesingle{}.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Change PKCS12\+\_\+key\+\_\+gen\+\_\+asc() so it can cope with non null    terminated strings whose length is passed in the passlen    parameter, for example from PEM callbacks. This was done    by adding an extra length parameter to asc2uni().     \texorpdfstring{$\ast$}{*}\+Steve Henson, reported by $<$oddissey@samsung.\+co.\+kr$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Fix C code generated by \textquotesingle{}openssl dsaparam -\/\+C\textquotesingle{}\+: If a BN\+\_\+bin2bn    call failed, free the DSA structure.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix to uni2asc() to cope with zero length Unicode strings.    These are present in some PKCS\#12 files.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Increase s2-\/$>$wbuf allocation by one byte in ssl2\+\_\+new (ssl/s2\+\_\+lib.\+c).    Otherwise do\+\_\+ssl\+\_\+write (ssl/s2\+\_\+pkt.\+c) will write beyond buffer limits    when writing a 32767 byte record.     \texorpdfstring{$\ast$}{*}\+Bodo Moeller; problem reported by Eric Day $<$eday@concentric.\+net$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} In $<$tt$>$\+RSA\+\_\+eay\+\_\+public\+\_\+\{en,ed\}crypt$<$/tt$>$ and RSA\+\_\+eay\+\_\+mod\+\_\+exp (rsa\+\_\+eay.\+c),    obtain lock CRYPTO\+\_\+\+LOCK\+\_\+\+RSA before setting $<$tt$>$rsa-\/\textbackslash{}$>$\+\_\+method\+\_\+mod\+\_\+\{n,p,q\}$<$/tt$>$.     (\+RSA objects have a reference count access to which is protected    by CRYPTO\+\_\+\+LOCK\+\_\+\+RSA \mbox{[}see rsa\+\_\+lib.\+c, s3\+\_\+srvr.\+c, ssl\+\_\+cert.\+c, ssl\+\_\+rsa.\+c\mbox{]},    so they are meant to be shared between threads.)    \texorpdfstring{$\ast$}{*}\+Bodo Moeller, Geoff Thorpe; original patch submitted by    "{}Reddie, Steven"{} $<$\+Steven.\+Reddie@ca.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Fix a deadlock in CRYPTO\+\_\+mem\+\_\+leaks().     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Use better test patterns in bntest.     $<$em$>$\+Ulf Möller$<$/em$>$   \texorpdfstring{$\ast$}{*} rand\+\_\+win.\+c fix for Borland C.     $<$em$>$\+Ulf Möller$<$/em$>$   \texorpdfstring{$\ast$}{*} BN\+\_\+rshift bugfix for n == 0.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Add a \textquotesingle{}bctest\textquotesingle{} script that checks for some known \textquotesingle{}bc\textquotesingle{} bugs    so that \textquotesingle{}make test\textquotesingle{} does not abort just because \textquotesingle{}bc\textquotesingle{} is broken.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Store verify\+\_\+result within SSL\+\_\+\+SESSION also for client side to    avoid potential security hole. (\+Re-\/used sessions on the client side    always resulted in verify\+\_\+result==\+X509\+\_\+\+V\+\_\+\+OK, not using the original    result of the server certificate verification.)     $<$em$>$\+Lutz Jaenicke$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix ssl3\+\_\+pending\+: If the record in s-\/$>$s3-\/$>$rrec is not of type    SSL3\+\_\+\+RT\+\_\+\+APPLICATION\+\_\+\+DATA, return 0.    Similarly, change ssl2\+\_\+pending to return 0 if SSL\+\_\+in\+\_\+init(s) is true.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix SSL\+\_\+peek\+:    Both ssl2\+\_\+peek and ssl3\+\_\+peek, which were totally broken in earlier    releases, have been re-\/implemented by renaming the previous    implementations of ssl2\+\_\+read and ssl3\+\_\+read to ssl2\+\_\+read\+\_\+internal    and ssl3\+\_\+read\+\_\+internal, respectively, and adding \textquotesingle{}peek\textquotesingle{} parameters    to them.  The new ssl\mbox{[}23\mbox{]}\+\_\+\{read,peek\} functions are calls to    ssl\mbox{[}23\mbox{]}\+\_\+read\+\_\+internal with the \textquotesingle{}peek\textquotesingle{} flag set appropriately.    A \textquotesingle{}peek\textquotesingle{} parameter has also been added to ssl3\+\_\+read\+\_\+bytes, which    does the actual work for ssl3\+\_\+read\+\_\+internal.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Initialise "{}ex\+\_\+data"{} member of RSA/\+DSA/\+DH structures prior to calling    the method-\/specific "{}init()"{} handler. Also clean up ex\+\_\+data after    calling the method-\/specific "{}finish()"{} handler. Previously, this was    happening the other way round.     $<$em$>$\+Geoff Thorpe$<$/em$>$   \texorpdfstring{$\ast$}{*} Increase BN\+\_\+\+CTX\+\_\+\+NUM (the number of BIGNUMs in a BN\+\_\+\+CTX) to 16.    The previous value, 12, was not always sufficient for BN\+\_\+mod\+\_\+exp().     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Make sure that shared libraries get the internal name engine with    the full version number and not just 0.  This should mark the    shared libraries as not backward compatible.  Of course, this should    be changed again when we can guarantee backward binary compatibility.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix typo in get\+\_\+cert\+\_\+by\+\_\+subject() in by\+\_\+dir.\+c     \texorpdfstring{$\ast$}{*}\+Jean-\/\+Marc Desperrier $<$jean-\/marc.\+desperrier@certplus.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Rework the system to generate shared libraries\+:     -\/ Make note of the expected extension for the shared libraries and      if there is a need for symbolic links from for example libcrypto.\+so.\+0      to libcrypto.\+so.\+0.\+9.\+7.  There is extended info in Configure for      that.     -\/ Make as few rebuilds of the shared libraries as possible.     -\/ Still avoid linking the Open\+SSL programs with the shared libraries.     -\/ When installing, install the shared libraries separately from the      static ones.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix SSL\+\_\+\+CTX\+\_\+set\+\_\+read\+\_\+ahead macro to actually use its argument.     Copy SSL\+\_\+\+CTX\textquotesingle{}s read\+\_\+ahead flag to SSL object directly in SSL\+\_\+new    and not in SSL\+\_\+clear because the latter is also used by the    accept/connect functions; previously, the settings made by    SSL\+\_\+set\+\_\+read\+\_\+ahead would be lost during the handshake.     \texorpdfstring{$\ast$}{*}\+Bodo Moeller; problems reported by Anders Gertz $<$gertz@epact.\+se$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Correct util/mkdef.\+pl to be selective about disabled algorithms.    Previously, it would create entries for disabled algorithms no    matter what.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Added several new manual pages for SSL\+\_\+\texorpdfstring{$\ast$}{*} function.     $<$em$>$\+Lutz Jaenicke$<$/em$>$  @subsection autotoc\+\_\+md162 Changes between 0.\+9.\+5a and 0.\+9.\+6  \mbox{[}24 Sep 2000\mbox{]}   \texorpdfstring{$\ast$}{*} In ssl23\+\_\+get\+\_\+client\+\_\+hello, generate an error message when faced    with an initial SSL 3.\+0/\+TLS record that is too small to contain the    first two bytes of the Client\+Hello message, i.\+e. client\+\_\+version.    (\+Note that this is a pathologic case that probably has never happened    in real life.)  The previous approach was to use the version number    from the record header as a substitute; but our protocol choice    should not depend on that one because it is not authenticated    by the Finished messages.     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} More robust randomness gathering functions for Windows.     \texorpdfstring{$\ast$}{*}\+Jeffrey Altman $<$jaltman@columbia.\+edu$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} For compatibility reasons if the flag X509\+\_\+\+V\+\_\+\+FLAG\+\_\+\+ISSUER\+\_\+\+CHECK is    not set then we don\textquotesingle{}t setup the error code for issuer check errors    to avoid possibly overwriting other errors which the callback does    handle. If an application does set the flag then we assume it knows    what it is doing and can handle the new informational codes    appropriately.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix for a nasty bug in ASN1\+\_\+\+TYPE handling. ASN1\+\_\+\+TYPE is used for    a general "{}ANY"{} type, as such it should be able to decode anything    including tagged types. However it didn\textquotesingle{}t check the class so it would    wrongly interpret tagged types in the same way as their universal    counterpart and unknown types were just rejected. Changed so that the    tagged and unknown types are handled in the same way as a SEQUENCE\+:    that is the encoding is stored intact. There is also a new type    "{}V\+\_\+\+ASN1\+\_\+\+OTHER"{} which is used when the class is not universal, in this    case we have no idea what the actual type is so we just lump them all    together.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} On VMS, stdout may very well lead to a file that is written to    in a record-\/oriented fashion.  That means that every write() will    write a separate record, which will be read separately by the    programs trying to read from it.  This can be very confusing.     The solution is to put a BIO filter in the way that will buffer    text until a linefeed is reached, and then write everything a    line at a time, so every record written will be an actual line,    not chunks of lines and not (usually doesn\textquotesingle{}t happen, but I\textquotesingle{}ve    seen it once) several lines in one record.  BIO\+\_\+f\+\_\+linebuffer() is    the answer.     Currently, it\textquotesingle{}s a VMS-\/only method, because that\textquotesingle{}s where it has    been tested well enough.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Remove \textquotesingle{}optimized\textquotesingle{} squaring variant in BN\+\_\+mod\+\_\+mul\+\_\+montgomery,    it can return incorrect results.    (\+Note\+: The buggy variant was not enabled in Open\+SSL 0.\+9.\+5a,    but it was in 0.\+9.\+6-\/beta\mbox{[}12\mbox{]}.)     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Disable the check for content being present when verifying detached    signatures in pk7\+\_\+smime.\+c. Some versions of Netscape (wrongly)    include zero length content when signing messages.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} New BIO\+\_\+shutdown\+\_\+wr macro, which invokes the BIO\+\_\+\+C\+\_\+\+SHUTDOWN\+\_\+\+WR    BIO\+\_\+ctrl (for BIO pairs).     $<$em$>$\+Bodo Möller$<$/em$>$   \texorpdfstring{$\ast$}{*} Add DSO method for VMS.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Bug fix\+: Montgomery multiplication could produce results with the    wrong sign.     $<$em$>$\+Ulf Möller$<$/em$>$   \texorpdfstring{$\ast$}{*} Add RPM specification openssl.\+spec and modify it to build three    packages.  The default package contains applications, application    documentation and run-\/time libraries.  The devel package contains    include files, static libraries and function documentation.  The    doc package contains the contents of the doc directory.  The original    openssl.\+spec was provided by Damien Miller $<$djm@mindrot.\+org$>$.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Add a large number of documentation files for many SSL routines.     \texorpdfstring{$\ast$}{*}\+Lutz Jaenicke $<$\+Lutz.\+Jaenicke@aet.\+TU-\/\+Cottbus.\+DE$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Add a configuration entry for Sony News 4.     \texorpdfstring{$\ast$}{*}\+NAKAJI Hiroyuki $<$nakaji@tutrp.\+tut.\+ac.\+jp$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Don\textquotesingle{}t set the two most significant bits to one when generating a    random number $<$ q in the DSA library.     $<$em$>$\+Ulf Möller$<$/em$>$   \texorpdfstring{$\ast$}{*} New SSL API mode \textquotesingle{}\+SSL\+\_\+\+MODE\+\_\+\+AUTO\+\_\+\+RETRY\textquotesingle{}.  This disables the default    behaviour that SSL\+\_\+read may result in SSL\+\_\+\+ERROR\+\_\+\+WANT\+\_\+\+READ (even if    the underlying transport is blocking) if a handshake took place.    (\+The default behaviour is needed by applications such as s\+\_\+client    and s\+\_\+server that use select() to determine when to use SSL\+\_\+read;    but for applications that know in advance when to expect data, it    just makes things more complicated.)     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Add RAND\+\_\+egd\+\_\+bytes(), which gives control over the number of bytes read    from EGD.     $<$em$>$\+Ben Laurie$<$/em$>$   \texorpdfstring{$\ast$}{*} Add a few more EBCDIC conditionals that make $<$tt$>$req$<$/tt$>$ and $<$tt$>$x509$<$/tt$>$    work better on such systems.     \texorpdfstring{$\ast$}{*}\+Martin Kraemer $<$\+Martin.\+Kraemer@\+Mch\+P.\+Siemens.\+De$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Add two demo programs for PKCS12\+\_\+parse() and PKCS12\+\_\+create().    Update PKCS12\+\_\+parse() so it copies the friendly\+Name and the    keyid to the certificates aux info.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix bug in PKCS7\+\_\+verify() which caused an infinite loop    if there was more than one signature.     \texorpdfstring{$\ast$}{*}\+Sven Uszpelkat $<$su@celocom.\+de$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Major change in util/mkdef.\+pl to include extra information    about each symbol, as well as presenting variables as well    as functions.  This change means that there\textquotesingle{}s n more need    to rebuild the .\+num files when some algorithms are excluded.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Allow the verify time to be set by an application,    rather than always using the current time.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Phase 2 verify code reorganisation. The certificate    verify code now looks up an issuer certificate by a    number of criteria\+: subject name, authority key id    and key usage. It also verifies self signed certificates    by the same criteria. The main comparison function is    X509\+\_\+check\+\_\+issued() which performs these checks.     Lot of changes were necessary in order to support this    without completely rewriting the lookup code.     Authority and subject key identifier are now cached.     The LHASH \textquotesingle{}certs\textquotesingle{} is X509\+\_\+\+STORE has now been replaced    by a STACK\+\_\+\+OF(\+X509\+\_\+\+OBJECT). This is mainly because an    LHASH can\textquotesingle{}t store or retrieve multiple objects with    the same hash value.     As a result various functions (which were all internal    use only) have changed to handle the new X509\+\_\+\+STORE    structure. This will break anything that messed round    with X509\+\_\+\+STORE internally.     The functions X509\+\_\+\+STORE\+\_\+add\+\_\+cert() now checks for an    exact match, rather than just subject name.     The X509\+\_\+\+STORE API doesn\textquotesingle{}t directly support the retrieval    of multiple certificates matching a given criteria, however    this can be worked round by performing a lookup first    (which will fill the cache with candidate certificates)    and then examining the cache for matches. This is probably    the best we can do without throwing out X509\+\_\+\+LOOKUP    entirely (maybe later...).     The X509\+\_\+\+VERIFY\+\_\+\+CTX structure has been enhanced considerably.     All certificate lookup operations now go via a get\+\_\+issuer()    callback. Although this currently uses an X509\+\_\+\+STORE it    can be replaced by custom lookups. This is a simple way    to bypass the X509\+\_\+\+STORE hackery necessary to make this    work and makes it possible to use more efficient techniques    in future. A very simple version which uses a simple    STACK for its trusted certificate store is also provided    using X509\+\_\+\+STORE\+\_\+\+CTX\+\_\+trusted\+\_\+stack().     The verify\+\_\+cb() and verify() callbacks now have equivalents    in the X509\+\_\+\+STORE\+\_\+\+CTX structure.     X509\+\_\+\+STORE\+\_\+\+CTX also has a \textquotesingle{}flags\textquotesingle{} field which can be used    to customise the verify behaviour.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Add new PKCS\#7 signing option PKCS7\+\_\+\+NOSMIMECAP which    excludes S/\+MIME capabilities.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} When a certificate request is read in keep a copy of the    original encoding of the signed data and use it when outputting    again. Signatures then use the original encoding rather than    a decoded, encoded version which may cause problems if the    request is improperly encoded.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} For consistency with other BIO\+\_\+puts implementations, call    buffer\+\_\+write(b, ...) directly in buffer\+\_\+puts instead of calling    BIO\+\_\+write(b, ...).     In BIO\+\_\+puts, increment b-\/$>$num\+\_\+write as in BIO\+\_\+write.     \texorpdfstring{$\ast$}{*}\+Peter.\+Sylvester@\+Edel\+Web.\+fr\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Fix BN\+\_\+mul\+\_\+word for the case where the word is 0. (\+We have to use    BN\+\_\+zero, we may not return a BIGNUM with an array consisting of    words set to zero.)     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} Avoid calling abort() from within the library when problems are    detected, except if preprocessor symbols have been defined    (such as REF\+\_\+\+CHECK, BN\+\_\+\+DEBUG etc.).     $<$em$>$\+Bodo Moeller$<$/em$>$   \texorpdfstring{$\ast$}{*} New openssl application \textquotesingle{}rsautl\textquotesingle{}. This utility can be    used for low-\/level RSA operations. DER public key    BIO/fp routines also added.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} New Configure entry and patches for compiling on QNX 4.     \texorpdfstring{$\ast$}{*}\+Andreas Schneider $<$andreas@ds3.\+etech.\+fh-\/hamburg.\+de$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} A demo state-\/machine implementation was sponsored by    Nuron ($<$http\+://www.\+nuron.\+com/$>$) and is now available in    demos/state\+\_\+machine.     $<$em$>$\+Ben Laurie$<$/em$>$   \texorpdfstring{$\ast$}{*} New options added to the \textquotesingle{}dgst\textquotesingle{} utility for signature    generation and verification.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Unrecognized PKCS\#7 content types are now handled via a    catch all ASN1\+\_\+\+TYPE structure. This allows unsupported    types to be stored as a "{}blob"{} and an application can    encode and decode it manually.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Fix various signed/unsigned issues to make a\+\_\+strex.\+c    compile under VC++.     \texorpdfstring{$\ast$}{*}\+Oscar Jacobsson $<$oscar.\+jacobsson@celocom.\+com$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} ASN1 fixes. i2d\+\_\+\+ASN1\+\_\+\+OBJECT was not returning the correct    length if passed a buffer. ASN1\+\_\+\+INTEGER\+\_\+to\+\_\+\+BN failed    if passed a NULL BN and its argument was negative.     \texorpdfstring{$\ast$}{*}\+Steve Henson, pointed out by Sven Heiberg $<$sven@tartu.\+cyber.\+ee$>$\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Modification to PKCS\#7 encoding routines to output definite    length encoding. Since currently the whole structures are in    memory there\textquotesingle{}s not real point in using indefinite length    constructed encoding. However if Open\+SSL is compiled with    the flag PKCS7\+\_\+\+INDEFINITE\+\_\+\+ENCODING the old form is used.     $<$em$>$\+Steve Henson$<$/em$>$   \texorpdfstring{$\ast$}{*} Added BIO\+\_\+vprintf() and BIO\+\_\+vsnprintf().     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Added more prefixes to parse for in the strings written    through a logging bio, to cover all the levels that are available    through syslog.  The prefixes are now\+: @iverbatim      PANIC, EMERG, EMR       =$>$      LOG\+\_\+\+EMERG     ALERT, ALR              =$>$      LOG\+\_\+\+ALERT     CRIT, CRI               =$>$      LOG\+\_\+\+CRIT     ERROR, ERR              =$>$      LOG\+\_\+\+ERR     WARNING, WARN, WAR      =$>$      LOG\+\_\+\+WARNING     NOTICE, NOTE, NOT       =$>$      LOG\+\_\+\+NOTICE     INFO, INF               =$>$      LOG\+\_\+\+INFO     DEBUG, DBG              =$>$      LOG\+\_\+\+DEBUG @endiverbatim    and as before, if none of those prefixes are present at the    beginning of the string, LOG\+\_\+\+ERR is chosen.     On Win32, the $<$tt$>$\+LOG\+\_\+\texorpdfstring{$\ast$}{*}$<$/tt$>$ levels are mapped according to this\+: @iverbatim      LOG\+\_\+\+EMERG, LOG\+\_\+\+ALERT, LOG\+\_\+\+CRIT, LOG\+\_\+\+ERR =$>$ EVENTLOG\+\_\+\+ERROR\+\_\+\+TYPE     LOG\+\_\+\+WARNING                             =$>$ EVENTLOG\+\_\+\+WARNING\+\_\+\+TYPE     LOG\+\_\+\+NOTICE, LOG\+\_\+\+INFO, LOG\+\_\+\+DEBUG         =$>$ EVENTLOG\+\_\+\+INFORMATION\+\_\+\+TYPE @endiverbatim    $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} Made it possible to reconfigure with just the configuration    argument "{}reconf"{} or "{}reconfigure"{}.  The command line arguments    are stored in Makefile.\+ssl in the variable CONFIGURE\+\_\+\+ARGS,    and are retrieved from there when reconfiguring.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} MD4 implemented.     \texorpdfstring{$\ast$}{*}\+Assar Westerlund $<$assar@sics.\+se$>$, Richard Levitte\texorpdfstring{$\ast$}{*}   \texorpdfstring{$\ast$}{*} Add the arguments -\/\+CAfile and -\/\+CApath to the pkcs12 utility.     $<$em$>$\+Richard Levitte$<$/em$>$   \texorpdfstring{$\ast$}{*} The obj\+\_\+dat.\+pl script was messing up the sorting of object    names. The reason was that it compared the quoted version    of strings as a result "{}OCSP"{} $>$ "{}OCSP Signing"{} because    "{} \texorpdfstring{$>$}{>} SPACE. Changed script to store unquoted versions of names and add quotes on output. It was also omitting some names from the lookup table if they were given a default value (that is if SN is missing it is given the same value as LN and vice versa), these are now added on the grounds that if an object has a name we should be able to look it up. Finally added warning output when duplicate short or long names are found.

{\itshape Steve Henson}
\item Changes needed for Tandem NSK.

\texorpdfstring{$\ast$}{*}\+Scott Uroff \href{mailto:scott@xypro.com}{\texttt{ scott@xypro.\+com}}\texorpdfstring{$\ast$}{*}
\item Fix SSL 2.\+0 rollback checking\+: Due to an off-\/by-\/one error in RSA\+\_\+padding\+\_\+check\+\_\+\+SSLv23(), special padding was never detected and thus the SSL 3.\+0/\+TLS 1.\+0 countermeasure against protocol version rollback attacks was not effective.

In s23\+\_\+clnt.\+c, don\textquotesingle{}t use special rollback-\/attack detection padding (RSA\+\_\+\+SSLV23\+\_\+\+PADDING) if SSL 2.\+0 is the only protocol enabled in the client; similarly, in s23\+\_\+srvr.\+c, don\textquotesingle{}t do the rollback check if SSL 2.\+0 is the only protocol enabled in the server.

{\itshape Bodo Moeller}
\item Make it possible to get hexdumps of unprintable data with \textquotesingle{}openssl asn1parse\textquotesingle{}. By implication, the functions ASN1\+\_\+parse\+\_\+dump() and BIO\+\_\+dump\+\_\+indent() are added.

{\itshape Richard Levitte}
\item New functions ASN1\+\_\+\+STRING\+\_\+print\+\_\+ex() and X509\+\_\+\+NAME\+\_\+print\+\_\+ex() these print out strings and name structures based on various flags including RFC2253 support and proper handling of multibyte characters. Added options to the \textquotesingle{}x509\textquotesingle{} utility to allow the various flags to be set.

{\itshape Steve Henson}
\item Various fixes to use ASN1\+\_\+\+TIME instead of ASN1\+\_\+\+UTCTIME. Also change the functions X509\+\_\+cmp\+\_\+current\+\_\+time() and X509\+\_\+gmtime\+\_\+adj() work with an ASN1\+\_\+\+TIME structure, this will enable certificates using Generalized\+Time in validity dates to be checked.

{\itshape Steve Henson}
\item Make the NEG\+\_\+\+PUBKEY\+\_\+\+BUG code (which tolerates invalid negative public key encodings) on by default, NO\+\_\+\+NEG\+\_\+\+PUBKEY\+\_\+\+BUG can be set to disable it.

{\itshape Steve Henson}
\item New function c2i\+\_\+\+ASN1\+\_\+\+OBJECT() which acts on ASN1\+\_\+\+OBJECT content octets. An i2c\+\_\+\+ASN1\+\_\+\+OBJECT is unnecessary because the encoding can be trivially obtained from the structure.

{\itshape Steve Henson}
\item crypto/err.\+c locking bugfix\+: Use write locks ({\ttfamily CRYPTO\+\_\+w\+\_\+\mbox{[}un\mbox{]}lock}), not read locks ({\ttfamily CRYPTO\+\_\+r\+\_\+\mbox{[}un\mbox{]}lock}).

{\itshape Bodo Moeller}
\item A first attempt at creating official support for shared libraries through configuration. I\textquotesingle{}ve kept it so the default is static libraries only, and the Open\+SSL programs are always statically linked for now, but there are preparations for dynamic linking in place. This has been tested on Linux and Tru64.

{\itshape Richard Levitte}
\item Randomness polling function for Win9x, as described in\+: Peter Gutmann, Software Generation of Practically Strong Random Numbers.

{\itshape Ulf Möller}
\item Fix so PRNG is seeded in req if using an already existing DSA key.

{\itshape Steve Henson}
\item New options to smime application. -\/inform and -\/outform allow alternative formats for the S/\+MIME message including PEM and DER. The -\/content option allows the content to be specified separately. This should allow things like Netscape form signing output easier to verify.

{\itshape Steve Henson}
\item Fix the ASN1 encoding of tags using the \textquotesingle{}long form\textquotesingle{}.

{\itshape Steve Henson}
\item New ASN1 functions, {\ttfamily i2c\+\_\+\texorpdfstring{$\ast$}{*}} and {\ttfamily c2i\+\_\+\texorpdfstring{$\ast$}{*}} for INTEGER and BIT STRING types. These convert content octets to and from the underlying type. The actual tag and length octets are already assumed to have been read in and checked. These are needed because all other string types have virtually identical handling apart from the tag. By having versions of the ASN1 functions that just operate on content octets IMPLICIT tagging can be handled properly. It also allows the ASN1\+\_\+\+ENUMERATED code to be cut down because ASN1\+\_\+\+ENUMERATED and ASN1\+\_\+\+INTEGER are identical apart from the tag.

{\itshape Steve Henson}
\item Change the handling of OID objects as follows\+:
\begin{DoxyItemize}
\item New object identifiers are inserted in objects.\+txt, following the syntax given in \doxysectlink{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2crypto_2objects_2_r_e_a_d_m_e}{crypto/objects/\+README.md}{0}.
\item objects.\+pl is used to process obj\+\_\+mac.\+num and create a new \doxylink{obj__mac_8h_source}{obj\+\_\+mac.\+h}.
\item obj\+\_\+dat.\+pl is used to create a new \doxylink{obj__dat_8h_source}{obj\+\_\+dat.\+h}, using the data in \doxylink{obj__mac_8h_source}{obj\+\_\+mac.\+h}.
\end{DoxyItemize}

This is currently kind of a hack, and the perl code in objects.\+pl isn\textquotesingle{}t very elegant, but it works as I intended. The simplest way to check that it worked correctly is to look in \doxylink{obj__dat_8h_source}{obj\+\_\+dat.\+h} and check the array nid\+\_\+objs and make sure the objects haven\textquotesingle{}t moved around (this is important!). Additions are OK, as well as consistent name changes.

{\itshape Richard Levitte}
\item Add BSD-\/style MD5-\/based passwords to \textquotesingle{}openssl passwd\textquotesingle{} (option \textquotesingle{}-\/1\textquotesingle{}).

{\itshape Bodo Moeller}
\item Addition of the command line parameter \textquotesingle{}-\/rand file\textquotesingle{} to \textquotesingle{}openssl req\textquotesingle{}. The given file adds to whatever has already been seeded into the random pool through the RANDFILE configuration file option or environment variable, or the default random state file.

{\itshape Richard Levitte}
\item mkstack.\+pl now sorts each macro group into lexical order. Previously the output order depended on the order the files appeared in the directory, resulting in needless rewriting of \doxylink{safestack_8h_source}{safestack.\+h} .

{\itshape Steve Henson}
\item Patches to make Open\+SSL compile under Win32 again. Mostly work arounds for the VC++ problem that it treats func() as func(void). Also stripped out the parts of mkdef.\+pl that added extra typesafe functions\+: these no longer exist.

{\itshape Steve Henson}
\item Reorganisation of the stack code. The macros are now all collected in \doxylink{safestack_8h_source}{safestack.\+h} . Each macro is defined in terms of a "{}stack macro"{} of the form {\ttfamily SKM\+\_\+\texorpdfstring{$<$}{<}name\texorpdfstring{$>$}{>}(type, a, b)}. The DEBUG\+\_\+\+SAFESTACK is now handled in terms of function casts, this has the advantage of retaining type safety without the use of additional functions. If DEBUG\+\_\+\+SAFESTACK is not defined then the non typesafe macros are used instead. Also modified the mkstack.\+pl script to handle the new form. Needs testing to see if which (if any) compilers it chokes and maybe make DEBUG\+\_\+\+SAFESTACK the default if no major problems. Similar behaviour for ASN1\+\_\+\+SET\+\_\+\+OF and PKCS12\+\_\+\+STACK\+\_\+\+OF.

{\itshape Steve Henson}
\item When some versions of IIS use the \textquotesingle{}NET\textquotesingle{} form of private key the key derivation algorithm is different. Normally MD5(password) is used as a 128 bit RC4 key. In the modified case MD5(MD5(password) + "{}\+SGCKEYSALT"{}) is used instead. Added some new functions i2d\+\_\+\+RSA\+\_\+\+NET(), d2i\+\_\+\+RSA\+\_\+\+NET() etc which are the same as the old Netscape\+\_\+\+RSA functions except they have an additional \textquotesingle{}sgckey\textquotesingle{} parameter which uses the modified algorithm. Also added an -\/sgckey command line option to the rsa utility. Thanks to Adrian Peck \href{mailto:bertie@ncipher.com}{\texttt{ bertie@ncipher.\+com}} for posting details of the modified algorithm to openssl-\/dev.

{\itshape Steve Henson}
\item The \doxylink{evp__local_8h_source}{evp\+\_\+local.\+h} macros were using \textquotesingle{}c.\#kname\textquotesingle{} which resulted in invalid expansion on some systems (SCO 5.\+0.\+5 for example). Corrected to \textquotesingle{}c.\+kname\textquotesingle{}.

\texorpdfstring{$\ast$}{*}\+Phillip Porch \href{mailto:root@theporch.com}{\texttt{ root@theporch.\+com}}\texorpdfstring{$\ast$}{*}
\item New X509\+\_\+get1\+\_\+email() and X509\+\_\+\+REQ\+\_\+get1\+\_\+email() functions that return a STACK of email addresses from a certificate or request, these look in the subject name and the subject alternative name extensions and omit any duplicate addresses.

{\itshape Steve Henson}
\item Re-\/implement BN\+\_\+mod\+\_\+exp2\+\_\+mont using independent (and larger) windows. This makes DSA verification about 2 \% faster.

{\itshape Bodo Moeller}
\item Increase maximum window size in {\ttfamily BN\+\_\+mod\+\_\+exp\+\_\+...} to 6 bits instead of 5 (meaning that now 2\texorpdfstring{$^\wedge$}{\string^}5 values will be precomputed, which is only 4 KB plus overhead for 1024 bit moduli). This makes exponentiations about 0.\+5 \% faster for 1024 bit exponents (as measured by "{}openssl speed rsa2048"{}).

{\itshape Bodo Moeller}
\item Rename memory handling macros to avoid conflicts with other software\+: Malloc =\texorpdfstring{$>$}{>} OPENSSL\+\_\+malloc Malloc\+\_\+locked =\texorpdfstring{$>$}{>} OPENSSL\+\_\+malloc\+\_\+locked Realloc =\texorpdfstring{$>$}{>} OPENSSL\+\_\+realloc Free =\texorpdfstring{$>$}{>} OPENSSL\+\_\+free

{\itshape Richard Levitte}
\item New function BN\+\_\+mod\+\_\+exp\+\_\+mont\+\_\+word for small bases (roughly 15\% faster than BN\+\_\+mod\+\_\+exp\+\_\+mont, i.\+e. 7\% for a full DH exchange).

{\itshape Bodo Moeller}
\item Cyg\+Win32 support.

\texorpdfstring{$\ast$}{*}\+John Jarvie \href{mailto:jjarvie@newsguy.com}{\texttt{ jjarvie@newsguy.\+com}}\texorpdfstring{$\ast$}{*}
\item The type-\/safe stack code has been rejigged. It is now only compiled in when Open\+SSL is configured with the DEBUG\+\_\+\+SAFESTACK option and by default all type-\/specific stack functions are "{}\#define"{}d back to standard stack functions. This results in more streamlined output but retains the type-\/safety checking possibilities of the original approach.

{\itshape Geoff Thorpe}
\item The STACK code has been cleaned up, and certain type declarations that didn\textquotesingle{}t make a lot of sense have been brought in line. This has also involved a cleanup of sorts in \doxylink{safestack_8h_source}{safestack.\+h} to more correctly map type-\/safe stack functions onto their plain stack counterparts. This work has also resulted in a variety of "{}const"{}ifications of lots of the code, especially {\ttfamily \+\_\+cmp} operations which should normally be prototyped with "{}const"{} parameters anyway.

{\itshape Geoff Thorpe}
\item When generating bytes for the first time in md\+\_\+rand.\+c, \textquotesingle{}stir the pool\textquotesingle{} by seeding with STATE\+\_\+\+SIZE dummy bytes (with zero entropy count). (The PRNG state consists of two parts, the large pool \textquotesingle{}state\textquotesingle{} and \textquotesingle{}md\textquotesingle{}, where all of \textquotesingle{}md\textquotesingle{} is used each time the PRNG is used, but \textquotesingle{}state\textquotesingle{} is used only indexed by a cyclic counter. As entropy may not be well distributed from the beginning, \textquotesingle{}md\textquotesingle{} is important as a chaining variable. However, the output function chains only half of \textquotesingle{}md\textquotesingle{}, i.\+e. 80 bits. ssleay\+\_\+rand\+\_\+add, on the other hand, chains all of \textquotesingle{}md\textquotesingle{}, and seeding with STATE\+\_\+\+SIZE dummy bytes will result in all of \textquotesingle{}state\textquotesingle{} being rewritten, with the new values depending on virtually all of \textquotesingle{}md\textquotesingle{}. This overcomes the 80 bit limitation.)

{\itshape Bodo Moeller}
\item In ssl/s2\+\_\+clnt.\+c and ssl/s3\+\_\+clnt.\+c, call ERR\+\_\+clear\+\_\+error() when the handshake is continued after ssl\+\_\+verify\+\_\+cert\+\_\+chain(); otherwise, if SSL\+\_\+\+VERIFY\+\_\+\+NONE is set, remaining error codes can lead to \textquotesingle{}unexplainable\textquotesingle{} connection aborts later.

{\itshape Bodo Moeller; problem tracked down by Lutz Jaenicke}
\item Major EVP API cipher revision. Add hooks for extra EVP features. This allows various cipher parameters to be set in the EVP interface. Support added for variable key length ciphers via the EVP\+\_\+\+CIPHER\+\_\+\+CTX\+\_\+set\+\_\+key\+\_\+length() function and setting of RC2 and RC5 parameters.

Modify EVP\+\_\+\+Open\+Init() and EVP\+\_\+\+Seal\+Init() to cope with variable key length ciphers.

Remove lots of duplicated code from the EVP library. For example {\itshape every} cipher init() function handles the \textquotesingle{}iv\textquotesingle{} in the same way according to the cipher mode. They also all do nothing if the \textquotesingle{}key\textquotesingle{} parameter is NULL and for CFB and OFB modes they zero ctx-\/\texorpdfstring{$>$}{>}num.

New functionality allows removal of S/\+MIME code RC2 hack.

Most of the routines have the same form and so can be declared in terms of macros.

By shifting this to the top level EVP\+\_\+\+Cipher\+Init() it can be removed from all individual ciphers. If the cipher wants to handle IVs or keys differently it can set the EVP\+\_\+\+CIPH\+\_\+\+CUSTOM\+\_\+\+IV or EVP\+\_\+\+CIPH\+\_\+\+ALWAYS\+\_\+\+CALL\+\_\+\+INIT flags.

Change lots of functions like EVP\+\_\+\+Encrypt\+Update() to now return a value\+: although software versions of the algorithms cannot fail any installed hardware versions can.

{\itshape Steve Henson}
\item Implement SSL\+\_\+\+OP\+\_\+\+TLS\+\_\+\+ROLLBACK\+\_\+\+BUG\+: In ssl3\+\_\+get\+\_\+client\+\_\+key\+\_\+exchange, if this option is set, tolerate broken clients that send the negotiated protocol version number instead of the requested protocol version number.

{\itshape Bodo Moeller}
\item Call dh\+\_\+tmp\+\_\+cb (set by {\ttfamily ...\+\_\+\+TMP\+\_\+\+DH\+\_\+\+CB}) with correct \textquotesingle{}is\+\_\+export\textquotesingle{} flag; i.\+e. non-\/zero for export ciphersuites, zero otherwise. Previous versions had this flag inverted, inconsistent with rsa\+\_\+tmp\+\_\+cb (...\+\_\+\+TMP\+\_\+\+RSA\+\_\+\+CB).

{\itshape Bodo Moeller; problem reported by Amit Chopra}
\item Add missing DSA library text string. Work around for some IIS key files with invalid SEQUENCE encoding.

{\itshape Steve Henson}
\item Add a document (doc/standards.\+txt) that list all kinds of standards and so on that are implemented in Open\+SSL.

{\itshape Richard Levitte}
\item Enhance c\+\_\+rehash script. Old version would mishandle certificates with the same subject name hash and wouldn\textquotesingle{}t handle CRLs at all. Added -\/fingerprint option to crl utility, to support new c\+\_\+rehash features.

{\itshape Steve Henson}
\item Eliminate non-\/\+ANSI declarations in \doxylink{crypto_8h_source}{crypto.\+h} and \doxylink{stack_8h_source}{stack.\+h}.

{\itshape Ulf Möller}
\item Fix for SSL server purpose checking. Server checking was rejecting certificates which had extended key usage present but no ssl client purpose.

\texorpdfstring{$\ast$}{*}\+Steve Henson, reported by Rene Grosser \href{mailto:grosser@hisolutions.com}{\texttt{ grosser@hisolutions.\+com}}\texorpdfstring{$\ast$}{*}
\item Make PKCS\#12 code work with no password. The PKCS\#12 spec is a little unclear about how a blank password is handled. Since the password in encoded as a BMPString with terminating double NULL a zero length password would end up as just the double NULL. However no password at all is different and is handled differently in the PKCS\#12 key generation code. NS treats a blank password as zero length. MSIE treats it as no password on export\+: but it will try both on import. We now do the same\+: PKCS12\+\_\+parse() tries zero length and no password if the password is set to "{}"{} or NULL (NULL is now a valid password\+: it wasn\textquotesingle{}t before) as does the pkcs12 application.

{\itshape Steve Henson}
\item Bugfixes in {\ttfamily apps/x509.\+c}\+: Avoid a memory leak; and don\textquotesingle{}t use perror when PEM\+\_\+read\+\_\+bio\+\_\+\+X509\+\_\+\+REQ fails, the error message must be obtained from the error queue.

{\itshape Bodo Moeller}
\item Avoid \textquotesingle{}thread\+\_\+hash\textquotesingle{} memory leak in crypto/err/err.\+c by freeing it in ERR\+\_\+remove\+\_\+state if appropriate, and change ERR\+\_\+get\+\_\+state accordingly to avoid race conditions (this is necessary because thread\+\_\+hash is no longer constant once set).

{\itshape Bodo Moeller}
\item Bugfix for linux-\/elf makefile.\+one.

{\itshape Ulf Möller}
\item RSA\+\_\+get\+\_\+default\+\_\+method() will now cause a default RSA\+\_\+\+METHOD to be chosen if one doesn\textquotesingle{}t exist already. Previously this was only set during a call to RSA\+\_\+new() or RSA\+\_\+new\+\_\+method(\+NULL) meaning it was possible for RSA\+\_\+get\+\_\+default\+\_\+method() to return NULL.

{\itshape Geoff Thorpe}
\item Added native name translation to the existing DSO code that will convert (if the flag to do so is set) filenames that are sufficiently small and have no path information into a canonical native form. Eg. "{}blah"{} converted to "{}libblah.\+so"{} or "{}blah.\+dll"{} etc.

{\itshape Geoff Thorpe}
\item New function ERR\+\_\+error\+\_\+string\+\_\+n(e, buf, len) which is like ERR\+\_\+error\+\_\+string(e, buf), but writes at most \textquotesingle{}len\textquotesingle{} bytes including the 0 terminator. For ERR\+\_\+error\+\_\+string\+\_\+n, \textquotesingle{}buf\textquotesingle{} may not be NULL.

\texorpdfstring{$\ast$}{*}\+Damien Miller \href{mailto:djm@mindrot.org}{\texttt{ djm@mindrot.\+org}}, Bodo Moeller\texorpdfstring{$\ast$}{*}
\item CONF library reworked to become more general. A new CONF configuration file reader "{}class"{} is implemented as well as a new functions ({\ttfamily NCONF\+\_\+\texorpdfstring{$\ast$}{*}}, for "{}\+New CONF"{}) to handle it. The now old {\ttfamily CONF\+\_\+\texorpdfstring{$\ast$}{*}} functions are still there, but are reimplemented to work in terms of the new functions. Also, a set of functions to handle the internal storage of the configuration data is provided to make it easier to write new configuration file reader "{}classes"{} (I can definitely see something reading a configuration file in XML format, for example), called {\ttfamily \+\_\+\+CONF\+\_\+\texorpdfstring{$\ast$}{*}}, or "{}the configuration storage API"{}...

The new configuration file reading functions are\+: \begin{DoxyVerb}    NCONF_new, NCONF_free, NCONF_load, NCONF_load_fp, NCONF_load_bio,
    NCONF_get_section, NCONF_get_string, NCONF_get_numbre

    NCONF_default, NCONF_WIN32

    NCONF_dump_fp, NCONF_dump_bio
\end{DoxyVerb}
 NCONF\+\_\+default and NCONF\+\_\+\+WIN32 are method (or "{}class"{}) choosers, NCONF\+\_\+new creates a new CONF object. This works in the same way as other interfaces in Open\+SSL, like the BIO interface. {\ttfamily NCONF\+\_\+dump\+\_\+\texorpdfstring{$\ast$}{*}} dump the internal storage of the configuration file, which is useful for debugging. All other functions take the same arguments as the old {\ttfamily CONF\+\_\+\texorpdfstring{$\ast$}{*}} functions with the exception of the first that must be a {\ttfamily CONF \texorpdfstring{$\ast$}{*}} instead of a {\ttfamily LHASH \texorpdfstring{$\ast$}{*}}.

To make it easier to use the new classes with the old {\ttfamily CONF\+\_\+\texorpdfstring{$\ast$}{*}} functions, the function CONF\+\_\+set\+\_\+default\+\_\+method is provided.

{\itshape Richard Levitte}
\item Add \textquotesingle{}-\/tls1\textquotesingle{} option to \textquotesingle{}openssl ciphers\textquotesingle{}, which was already mentioned in the documentation but had not been implemented. (This option is not yet really useful because even the additional experimental TLS 1.\+0 ciphers are currently treated as SSL 3.\+0 ciphers.)

{\itshape Bodo Moeller}
\item Initial DSO code added into libcrypto for letting Open\+SSL (and Open\+SSL-\/based applications) load shared libraries and bind to them in a portable way.

{\itshape Geoff Thorpe, with contributions from Richard Levitte}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md163}{}\doxysubsection{\texorpdfstring{Changes between 0.\+9.\+5 and 0.\+9.\+5a \mbox{[}1 Apr 2000\mbox{]}}{Changes between 0.\+9.\+5 and 0.\+9.\+5a \mbox{[}1 Apr 2000\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md163}

\begin{DoxyItemize}
\item Make sure \+\_\+lrotl and \+\_\+lrotr are only used with MSVC.
\item Use lock CRYPTO\+\_\+\+LOCK\+\_\+\+RAND correctly in ssleay\+\_\+rand\+\_\+status (the default implementation of RAND\+\_\+status).
\item Rename openssl x509 option \textquotesingle{}-\/crlext\textquotesingle{}, which was added in 0.\+9.\+5, to \textquotesingle{}-\/clrext\textquotesingle{} (= clear extensions), as intended and documented. \texorpdfstring{$\ast$}{*}\+Bodo Moeller; inconsistency pointed out by Michael Attili \href{mailto:attili@amaxo.com}{\texttt{ attili@amaxo.\+com}}\texorpdfstring{$\ast$}{*}
\item Fix for HMAC. It wasn\textquotesingle{}t zeroing the rest of the block if the key length was larger than the MD block size.

\texorpdfstring{$\ast$}{*}\+Steve Henson, pointed out by Yost William \href{mailto:YostW@tce.com}{\texttt{ Yost\+W@tce.\+com}}\texorpdfstring{$\ast$}{*}
\item Modernise PKCS12\+\_\+parse() so it uses STACK\+\_\+\+OF(\+X509) for its ca argument fix a leak when the ca argument was passed as NULL. Stop X509\+\_\+\+PUBKEY\+\_\+set() using the passed key\+: if the passed key was a private key the result of X509\+\_\+print(), for example, would be to print out all the private key components.

{\itshape Steve Henson}
\item des\+\_\+quad\+\_\+cksum() byte order bug fix. \texorpdfstring{$\ast$}{*}\+Ulf Möller, using the problem description in krb4-\/0.\+9.\+7, where the solution is attributed to Derrick J Brashear \href{mailto:shadow@DEMENTIA.ORG}{\texttt{ shadow@\+DEMENTIA.\+ORG}}\texorpdfstring{$\ast$}{*}
\item Fix so V\+\_\+\+ASN1\+\_\+\+APP\+\_\+\+CHOOSE works again\+: however its use is strongly discouraged.

\texorpdfstring{$\ast$}{*}\+Steve Henson, pointed out by Brian Korver \href{mailto:briank@cs.stanford.edu}{\texttt{ briank@cs.\+stanford.\+edu}}\texorpdfstring{$\ast$}{*}
\item For easily testing in shell scripts whether some command \textquotesingle{}openssl XXX\textquotesingle{} exists, the new pseudo-\/command \textquotesingle{}openssl no-\/\+XXX\textquotesingle{} returns with exit code 0 iff no command of the given name is available. \textquotesingle{}no-\/\+XXX\textquotesingle{} is printed in this case, \textquotesingle{}XXX\textquotesingle{} otherwise. In both cases, the output goes to stdout and nothing is printed to stderr. Additional arguments are always ignored.

Since for each cipher there is a command of the same name, the \textquotesingle{}no-\/cipher\textquotesingle{} compilation switches can be tested this way.

(\textquotesingle{}openssl no-\/\+XXX\textquotesingle{} is not able to detect pseudo-\/commands such as \textquotesingle{}quit\textquotesingle{}, \textquotesingle{}list-\/\+XXX-\/commands\textquotesingle{}, or \textquotesingle{}no-\/\+XXX\textquotesingle{} itself.)

{\itshape Bodo Moeller}
\item Update test suite so that \textquotesingle{}make test\textquotesingle{} succeeds in \textquotesingle{}no-\/rsa\textquotesingle{} configuration.

{\itshape Bodo Moeller}
\item For SSL\+\_\+\mbox{[}CTX\+\_\+\mbox{]}set\+\_\+tmp\+\_\+dh, don\textquotesingle{}t create a DH key if SSL\+\_\+\+OP\+\_\+\+SINGLE\+\_\+\+DH\+\_\+\+USE is set; it will be thrown away anyway because each handshake creates its own key. ssl\+\_\+cert\+\_\+dup, which is used by SSL\+\_\+new, now copies DH keys in addition to parameters -- in previous versions (since Open\+SSL 0.\+9.\+3) the \textquotesingle{}default key\textquotesingle{} from SSL\+\_\+\+CTX\+\_\+set\+\_\+tmp\+\_\+dh would always be lost, meaning you effectively got SSL\+\_\+\+OP\+\_\+\+SINGLE\+\_\+\+DH\+\_\+\+USE when using this macro.

{\itshape Bodo Moeller}
\item New s\+\_\+client option -\/ign\+\_\+eof\+: EOF at stdin is ignored, and \textquotesingle{}Q\textquotesingle{} and \textquotesingle{}R\textquotesingle{} lose their special meanings (quit/renegotiate). This is part of what -\/quiet does; unlike -\/quiet, -\/ign\+\_\+eof does not suppress any output.

{\itshape Richard Levitte}
\item Add compatibility options to the purpose and trust code. The purpose X509\+\_\+\+PURPOSE\+\_\+\+ANY is "{}any purpose"{} which automatically accepts a certificate or CA, this was the previous behaviour, with all the associated security issues.

X509\+\_\+\+TRUST\+\_\+\+COMPAT is the old trust behaviour\+: only and automatically trust self signed roots in certificate store. A new trust setting X509\+\_\+\+TRUST\+\_\+\+DEFAULT is used to specify that a purpose has no associated trust setting and it should instead use the value in the default purpose.

{\itshape Steve Henson}
\item Fix the PKCS\#8 DSA private key code so it decodes keys again and fix a memory leak.

{\itshape Steve Henson}
\item In util/mkerr.\+pl (which implements \textquotesingle{}make errors\textquotesingle{}), preserve reason strings from the previous version of the .c file, as the default to have only downcase letters (and digits) in automatically generated reasons codes is not always appropriate.

{\itshape Bodo Moeller}
\item In ERR\+\_\+load\+\_\+\+ERR\+\_\+strings(), build an ERR\+\_\+\+LIB\+\_\+\+SYS error reason table using strerror. Previously, ERR\+\_\+reason\+\_\+error\+\_\+string() returned library names as reason strings for SYSerr; but SYSerr is a special case where small numbers are errno values, not library numbers.

{\itshape Bodo Moeller}
\item Add \textquotesingle{}-\/dsaparam\textquotesingle{} option to \textquotesingle{}openssl dhparam\textquotesingle{} application. This converts DSA parameters into DH parameters. (When creating parameters, DSA\+\_\+generate\+\_\+parameters is used.)

{\itshape Bodo Moeller}
\item Include \textquotesingle{}length\textquotesingle{} (recommended exponent length) in C code generated by \textquotesingle{}openssl dhparam -\/C\textquotesingle{}.

{\itshape Bodo Moeller}
\item The second argument to set\+\_\+label in perlasm was already being used so couldn\textquotesingle{}t be used as a "{}file scope"{} flag. Moved to third argument which was free.

{\itshape Steve Henson}
\item In PEM\+\_\+\+ASN1\+\_\+write\+\_\+bio and some other functions, use RAND\+\_\+pseudo\+\_\+bytes instead of RAND\+\_\+bytes for encryption IVs and salts.

{\itshape Bodo Moeller}
\item Include RAND\+\_\+status() into RAND\+\_\+\+METHOD instead of implementing it only for md\+\_\+rand.\+c Otherwise replacing the PRNG by calling RAND\+\_\+set\+\_\+rand\+\_\+method would be impossible.

{\itshape Bodo Moeller}
\item Don\textquotesingle{}t let DSA\+\_\+generate\+\_\+key() enter an infinite loop if the random number generation fails.

{\itshape Bodo Moeller}
\item New \textquotesingle{}rand\textquotesingle{} application for creating pseudo-\/random output.

{\itshape Bodo Moeller}
\item Added configuration support for Linux/\+IA64

\texorpdfstring{$\ast$}{*}\+Rolf Haberrecker \href{mailto:rolf@suse.de}{\texttt{ rolf@suse.\+de}}\texorpdfstring{$\ast$}{*}
\item Assembler module support for Mingw32.

{\itshape Ulf Möller}
\item Shared library support for HPUX (in shlib/).

\texorpdfstring{$\ast$}{*}\+Lutz Jaenicke \href{mailto:Lutz.Jaenicke@aet.TU-Cottbus.DE}{\texttt{ Lutz.\+Jaenicke@aet.\+TU-\/\+Cottbus.\+DE}} and Anonymous\texorpdfstring{$\ast$}{*}
\item Shared library support for Solaris gcc.

\texorpdfstring{$\ast$}{*}\+Lutz Behnke \href{mailto:behnke@trustcenter.de}{\texttt{ behnke@trustcenter.\+de}}\texorpdfstring{$\ast$}{*}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md164}{}\doxysubsection{\texorpdfstring{Changes between 0.\+9.\+4 and 0.\+9.\+5 \mbox{[}28 Feb 2000\mbox{]}}{Changes between 0.\+9.\+4 and 0.\+9.\+5 \mbox{[}28 Feb 2000\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md164}

\begin{DoxyItemize}
\item PKCS7\+\_\+encrypt() was adding text MIME headers twice because they were added manually and by SMIME\+\_\+crlf\+\_\+copy().

{\itshape Steve Henson}
\item In bntest.\+c don\textquotesingle{}t call BN\+\_\+rand with zero bits argument.

\texorpdfstring{$\ast$}{*}\+Steve Henson, pointed out by Andrew W. Gray \href{mailto:agray@iconsinc.com}{\texttt{ agray@iconsinc.\+com}}\texorpdfstring{$\ast$}{*}
\item BN\+\_\+mul bugfix\+: In bn\+\_\+mul\+\_\+part\+\_\+recursion() only the a\texorpdfstring{$>$}{>}a\mbox{[}n\mbox{]} \&\& b\texorpdfstring{$>$}{>}b\mbox{[}n\mbox{]} case was implemented. This caused BN\+\_\+div\+\_\+recp() to fail occasionally.

{\itshape Ulf Möller}
\item Add an optional second argument to the set\+\_\+label() in the perl assembly language builder. If this argument exists and is set to 1 it signals that the assembler should use a symbol whose scope is the entire file, not just the current function. This is needed with MASM which uses the format label\+:\+: for this scope.

\texorpdfstring{$\ast$}{*}\+Steve Henson, pointed out by Peter Runestig \href{mailto:peter@runestig.com}{\texttt{ peter@runestig.\+com}}\texorpdfstring{$\ast$}{*}
\item Change the ASN1 types so they are typedefs by default. Before almost all types were define\textquotesingle{}d to ASN1\+\_\+\+STRING which was causing STACK\+\_\+\+OF() problems\+: you couldn\textquotesingle{}t declare STACK\+\_\+\+OF(\+ASN1\+\_\+\+UTF8\+STRING) for example.

{\itshape Steve Henson}
\item Change names of new functions to the new get1/get0 naming convention\+: After \textquotesingle{}get1\textquotesingle{}, the caller owns a reference count and has to call {\ttfamily ...\+\_\+free}; \textquotesingle{}get0\textquotesingle{} returns a pointer to some data structure without incrementing reference counters. (Some of the existing \textquotesingle{}get\textquotesingle{} functions increment a reference counter, some don\textquotesingle{}t.) Similarly, \textquotesingle{}set1\textquotesingle{} and \textquotesingle{}add1\textquotesingle{} functions increase reference counters or duplicate objects.

{\itshape Steve Henson}
\item Allow for the possibility of temp RSA key generation failure\+: the code used to assume it always worked and crashed on failure.

{\itshape Steve Henson}
\item Fix potential buffer overrun problem in BIO\+\_\+printf(). \texorpdfstring{$\ast$}{*}\+Ulf Möller, using public domain code by Patrick Powell; problem pointed out by David Sacerdote \href{mailto:das33@cornell.edu}{\texttt{ das33@cornell.\+edu}}\texorpdfstring{$\ast$}{*}
\item Support EGD \href{http://www.lothar.com/tech/crypto/}{\texttt{ http\+://www.\+lothar.\+com/tech/crypto/}}. New functions RAND\+\_\+egd() and RAND\+\_\+status(). In the command line application, the EGD socket can be specified like a seed file using RANDFILE or -\/rand.

{\itshape Ulf Möller}
\item Allow the string CERTIFICATE to be tolerated in PKCS\#7 structures. Some CAs (e.\+g. Verisign) distribute certificates in this form.

{\itshape Steve Henson}
\item Remove the SSL\+\_\+\+ALLOW\+\_\+\+ADH compile option and set the default cipher list to exclude them. This means that no special compilation option is needed to use anonymous DH\+: it just needs to be included in the cipher list.

{\itshape Steve Henson}
\item Change the EVP\+\_\+\+MD\+\_\+\+CTX\+\_\+type macro so its meaning consistent with EVP\+\_\+\+MD\+\_\+type. The old functionality is available in a new macro called EVP\+\_\+\+MD\+\_\+md(). Change code that uses it and update docs.

{\itshape Steve Henson}
\item {\ttfamily ...\+\_\+ctrl} functions now have corresponding {\ttfamily ...\+\_\+callback\+\_\+ctrl} functions where the {\ttfamily void \texorpdfstring{$\ast$}{*}} argument is replaced by a function pointer argument. Previously {\ttfamily void \texorpdfstring{$\ast$}{*}} was abused to point to functions, which works on many platforms, but is not correct. As these functions are usually called by macros defined in Open\+SSL header files, most source code should work without changes.

{\itshape Richard Levitte}
\item {\ttfamily \texorpdfstring{$<$}{<}\doxylink{opensslconf_8h_source}{openssl/opensslconf.\+h}\texorpdfstring{$>$}{>}} (which is created by Configure) now contains sections with information on -\/D... compiler switches used for compiling the library so that applications can see them. To enable one of these sections, a pre-\/processor symbol {\ttfamily OPENSSL\+\_\+...\+\_\+\+DEFINES} must be defined. E.\+g., define OPENSSL\+\_\+\+ALGORITHM\+\_\+\+DEFINES include \texorpdfstring{$<$}{<}\doxylink{opensslconf_8h_source}{openssl/opensslconf.\+h}\texorpdfstring{$>$}{>} defines all pertinent {\ttfamily NO\+\_\+\texorpdfstring{$<$}{<}algo\texorpdfstring{$>$}{>}} symbols, such as NO\+\_\+\+IDEA, NO\+\_\+\+RSA, etc.

{\itshape Richard Levitte, Ulf and Bodo Möller}
\item Bugfix\+: Tolerate fragmentation and interleaving in the SSL 3/\+TLS record layer.

{\itshape Bodo Moeller}
\item Change the \textquotesingle{}other\textquotesingle{} type in certificate aux info to a STACK\+\_\+\+OF X509\+\_\+\+ALGOR. Although not an Algorithm\+Identifier as such it has the required ASN1 format\+: arbitrary types determined by an OID.

{\itshape Steve Henson}
\item Add some PEM\+\_\+write\+\_\+\+X509\+\_\+\+REQ\+\_\+\+NEW() functions and a command line argument to \textquotesingle{}req\textquotesingle{}. This is not because the function is newer or better than others it just uses the work \textquotesingle{}NEW\textquotesingle{} in the certificate request header lines. Some software needs this.

{\itshape Steve Henson}
\item Reorganise password command line arguments\+: now passwords can be obtained from various sources. Delete the PEM\+\_\+cb function and make it the default behaviour\+: i.\+e. if the callback is NULL and the usrdata argument is not NULL interpret it as a null terminated pass phrase. If usrdata and the callback are NULL then the pass phrase is prompted for as usual.

{\itshape Steve Henson}
\item Add support for the Compaq Atalla crypto accelerator. If it is installed, the support is automatically enabled. The resulting binaries will autodetect the card and use it if present.

{\itshape Ben Laurie and Compaq Inc.}
\item Work around for Netscape hang bug. This sends certificate request and server done in one record. Since this is perfectly legal in the SSL/\+TLS protocol it isn\textquotesingle{}t a "{}bug"{} option and is on by default. See the bugs/\+SSLv3 entry for more info.

{\itshape Steve Henson}
\item HP-\/\+UX tune-\/up\+: new unified configs, HP C compiler bug workaround.

{\itshape Andy Polyakov}
\item Add -\/rand argument to smime and pkcs12 applications and read/write of seed file.

{\itshape Steve Henson}
\item New \textquotesingle{}passwd\textquotesingle{} tool for crypt(3) and apr1 password hashes.

{\itshape Bodo Moeller}
\item Add command line password options to the remaining applications.

{\itshape Steve Henson}
\item Bug fix for BN\+\_\+div\+\_\+recp() for numerators with an even number of bits.

{\itshape Ulf Möller}
\item More tests in bntest.\+c, and changed test\+\_\+bn output.

{\itshape Ulf Möller}
\item ./config recognizes Mac\+OS X now.

{\itshape Andy Polyakov}
\item Bug fix for BN\+\_\+div() when the first words of num and divisor are equal (it gave wrong results if {\ttfamily (rem=(n1-\/q\texorpdfstring{$\ast$}{*}d0)\&BN\+\_\+\+MASK2) \texorpdfstring{$<$}{<} d0)}.

{\itshape Ulf Möller}
\item Add support for various broken PKCS\#8 formats, and command line options to produce them.

{\itshape Steve Henson}
\item New functions BN\+\_\+\+CTX\+\_\+start(), BN\+\_\+\+CTX\+\_\+get() and BT\+\_\+\+CTX\+\_\+end() to get temporary BIGNUMs from a BN\+\_\+\+CTX.

{\itshape Ulf Möller}
\item Correct return values in BN\+\_\+mod\+\_\+exp\+\_\+mont() and BN\+\_\+mod\+\_\+exp2\+\_\+mont() for p == 0.

{\itshape Ulf Möller}
\item Change the {\ttfamily SSLeay\+\_\+add\+\_\+all\+\_\+\texorpdfstring{$\ast$}{*}()} functions to {\ttfamily Open\+SSL\+\_\+add\+\_\+all\+\_\+\texorpdfstring{$\ast$}{*}()} and include a define from the old name to the new. The original intent was that statically linked binaries could for example just call SSLeay\+\_\+add\+\_\+all\+\_\+ciphers() to just add ciphers to the table and not link with digests. This never worked because SSLeay\+\_\+add\+\_\+all\+\_\+digests() and SSLeay\+\_\+add\+\_\+all\+\_\+ciphers() were in the same source file so calling one would link with the other. They are now in separate source files.

{\itshape Steve Henson}
\item Add a new -\/notext option to \textquotesingle{}ca\textquotesingle{} and a -\/pubkey option to \textquotesingle{}spkac\textquotesingle{}.

{\itshape Steve Henson}
\item Use a less unusual form of the Miller-\/\+Rabin primality test (it used a binary algorithm for exponentiation integrated into the Miller-\/\+Rabin loop, our standard modexp algorithms are faster).

{\itshape Bodo Moeller}
\item Support for the EBCDIC character set completed.

\texorpdfstring{$\ast$}{*}\+Martin Kraemer \href{mailto:Martin.Kraemer@Mch.SNI.De}{\texttt{ Martin.\+Kraemer@\+Mch.\+SNI.\+De}}\texorpdfstring{$\ast$}{*}
\item Source code cleanups\+: use const where appropriate, eliminate casts, use {\ttfamily void \texorpdfstring{$\ast$}{*}} instead of {\ttfamily char \texorpdfstring{$\ast$}{*}} in lhash.

{\itshape Ulf Möller}
\item Bugfix\+: ssl3\+\_\+send\+\_\+server\+\_\+key\+\_\+exchange was not restartable (the state was not changed to SSL3\+\_\+\+ST\+\_\+\+SW\+\_\+\+KEY\+\_\+\+EXCH\+\_\+B, and because of this the server could overwrite ephemeral keys that the client has already seen).

{\itshape Bodo Moeller}
\item Turn DSA\+\_\+is\+\_\+prime into a macro that calls BN\+\_\+is\+\_\+prime, using 50 iterations of the Rabin-\/\+Miller test.

DSA\+\_\+generate\+\_\+parameters now uses BN\+\_\+is\+\_\+prime\+\_\+fasttest (with 50 iterations of the Rabin-\/\+Miller test as required by the appendix to FIPS PUB 186\mbox{[}-\/1\mbox{]}) instead of DSA\+\_\+is\+\_\+prime. As BN\+\_\+is\+\_\+prime\+\_\+fasttest includes trial division, DSA parameter generation becomes much faster.

This implies a change for the callback functions in DSA\+\_\+is\+\_\+prime and DSA\+\_\+generate\+\_\+parameters\+: The callback function is called once for each positive witness in the Rabin-\/\+Miller test, not just occasionally in the inner loop; and the parameters to the callback function now provide an iteration count for the outer loop rather than for the current invocation of the inner loop. DSA\+\_\+generate\+\_\+parameters additionally can call the callback function with an \textquotesingle{}iteration count\textquotesingle{} of -\/1, meaning that a candidate has passed the trial division test (when q is generated from an application-\/provided seed, trial division is skipped).

{\itshape Bodo Moeller}
\item New function BN\+\_\+is\+\_\+prime\+\_\+fasttest that optionally does trial division before starting the Rabin-\/\+Miller test and has an additional BN\+\_\+\+CTX \texorpdfstring{$\ast$}{*} argument (whereas BN\+\_\+is\+\_\+prime always has to allocate at least one BN\+\_\+\+CTX). \textquotesingle{}callback(1, -\/1, cb\+\_\+arg)\textquotesingle{} is called when a number has passed the trial division stage.

{\itshape Bodo Moeller}
\item Fix for bug in CRL encoding. The validity dates weren\textquotesingle{}t being handled as ASN1\+\_\+\+TIME.

{\itshape Steve Henson}
\item New -\/pkcs12 option to CA.\+pl script to write out a PKCS\#12 file.

{\itshape Steve Henson}
\item New function BN\+\_\+pseudo\+\_\+rand().

{\itshape Ulf Möller}
\item Clean up BN\+\_\+mod\+\_\+mul\+\_\+montgomery()\+: replace the broken (and unreadable) bignum version of BN\+\_\+from\+\_\+montgomery() with the working code from SSLeay 0.\+9.\+0 (the word based version is faster anyway), and clean up the comments.

{\itshape Ulf Möller}
\item Avoid a race condition in s2\+\_\+clnt.\+c (function get\+\_\+server\+\_\+hello) that made it impossible to use the same SSL\+\_\+\+SESSION data structure in SSL2 clients in multiple threads.

{\itshape Bodo Moeller}
\item The return value of RAND\+\_\+load\+\_\+file() no longer counts bytes obtained by stat(). RAND\+\_\+load\+\_\+file(..., -\/1) is new and uses the complete file to seed the PRNG (previously an explicit byte count was required).

{\itshape Ulf Möller, Bodo Möller}
\item Clean up CRYPTO\+\_\+\+EX\+\_\+\+DATA functions, some of these didn\textquotesingle{}t have prototypes used {\ttfamily char \texorpdfstring{$\ast$}{*}} instead of {\ttfamily void \texorpdfstring{$\ast$}{*}} and had casts all over the place.

{\itshape Steve Henson}
\item Make BN\+\_\+generate\+\_\+prime() return NULL on error if ret!=NULL.

{\itshape Ulf Möller}
\item Retain source code compatibility for BN\+\_\+prime\+\_\+checks macro\+: BN\+\_\+is\+\_\+prime(..., BN\+\_\+prime\+\_\+checks, ...) now uses BN\+\_\+prime\+\_\+checks\+\_\+for\+\_\+size to determine the appropriate number of Rabin-\/\+Miller iterations.

{\itshape Ulf Möller}
\item Diffie-\/\+Hellman uses "{}safe"{} primes\+: DH\+\_\+check() return code renamed to DH\+\_\+\+CHECK\+\_\+\+P\+\_\+\+NOT\+\_\+\+SAFE\+\_\+\+PRIME. (Check if this is true? Open\+PGP calls them "{}strong"{}.)

{\itshape Ulf Möller}
\item Merge the functionality of "{}dh"{} and "{}gendh"{} programs into a new program "{}dhparam"{}. The old programs are retained for now but will handle DH keys (instead of parameters) in future.

{\itshape Steve Henson}
\item Make the ciphers, s\+\_\+server and s\+\_\+client programs check the return values when a new cipher list is set.

{\itshape Steve Henson}
\item Enhance the SSL/\+TLS cipher mechanism to correctly handle the TLS 56bit ciphers. Before when the 56bit ciphers were enabled the sorting was wrong.

The syntax for the cipher sorting has been extended to support sorting by cipher-\/strength (using the strength\+\_\+bits hard coded in the tables). The new command is {\ttfamily @STRENGTH} (see also {\ttfamily doc/apps/ciphers.\+pod}).

Fix a bug in the cipher-\/command parser\+: when supplying a cipher command string with an "{}undefined"{} symbol (neither command nor alphanumeric {\itshape A-\/\+Za-\/z0-\/9}, ssl\+\_\+set\+\_\+cipher\+\_\+list used to hang in an endless loop. Now an error is flagged.

Due to the strength-\/sorting extension, the code of the ssl\+\_\+create\+\_\+cipher\+\_\+list() function was completely rearranged. I hope that the readability was also increased \+:-\/)

\texorpdfstring{$\ast$}{*}\+Lutz Jaenicke \href{mailto:Lutz.Jaenicke@aet.TU-Cottbus.DE}{\texttt{ Lutz.\+Jaenicke@aet.\+TU-\/\+Cottbus.\+DE}}\texorpdfstring{$\ast$}{*}
\item Minor change to \textquotesingle{}x509\textquotesingle{} utility. The -\/CAcreateserial option now uses 1 for the first serial number and places 2 in the serial number file. This avoids problems when the root CA is created with serial number zero and the first user certificate has the same issuer name and serial number as the root CA.

{\itshape Steve Henson}
\item Fixes to X509\+\_\+\+ATTRIBUTE utilities, change the \textquotesingle{}req\textquotesingle{} program so it uses the new code. Add documentation for this stuff.

{\itshape Steve Henson}
\item Changes to X509\+\_\+\+ATTRIBUTE utilities. These have been renamed from {\ttfamily X509\+\_\+\texorpdfstring{$\ast$}{*}()} to {\ttfamily X509at\+\_\+\texorpdfstring{$\ast$}{*}()} on the grounds that they don\textquotesingle{}t handle X509 structures and behave in an analogous way to the X509v3 functions\+: they shouldn\textquotesingle{}t be called directly but wrapper functions should be used instead.

So we also now have some wrapper functions that call the X509at functions when passed certificate requests. (TO DO\+: similar things can be done with PKCS\#7 signed and unsigned attributes, PKCS\#12 attributes and a few other things. Some of these need some d2i or i2d and print functionality because they handle more complex structures.)

{\itshape Steve Henson}
\item Add missing ifndefs that caused missing symbols when building libssl as a shared library without RSA. Use ifndef NO\+\_\+\+SSL2 instead of NO\+\_\+\+RSA in {\ttfamily ssl/s2\texorpdfstring{$\ast$}{*}.c}.

\texorpdfstring{$\ast$}{*}\+Kris Kennaway \href{mailto:kris@hub.freebsd.org}{\texttt{ kris@hub.\+freebsd.\+org}}, modified by Ulf Möller\texorpdfstring{$\ast$}{*}
\item Precautions against using the PRNG uninitialized\+: RAND\+\_\+bytes() now has a return value which indicates the quality of the random data (1 = ok, 0 = not seeded). Also an error is recorded on the thread\textquotesingle{}s error queue. New function RAND\+\_\+pseudo\+\_\+bytes() generates output that is guaranteed to be unique but not unpredictable. RAND\+\_\+add is like RAND\+\_\+seed, but takes an extra argument for an entropy estimate (RAND\+\_\+seed always assumes full entropy).

{\itshape Ulf Möller}
\item Do more iterations of Rabin-\/\+Miller probable prime test (specifically, 3 for 1024-\/bit primes, 6 for 512-\/bit primes, 12 for 256-\/bit primes instead of only 2 for all lengths; see BN\+\_\+prime\+\_\+checks\+\_\+for\+\_\+size definition in crypto/bn/bn\+\_\+prime.\+c for the complete table). This guarantees a false-\/positive rate of at most 2\texorpdfstring{$^\wedge$}{\string^}-\/80 for random input.

{\itshape Bodo Moeller}
\item Rewrite ssl3\+\_\+read\+\_\+n (ssl/s3\+\_\+pkt.\+c) avoiding a couple of bugs.

{\itshape Bodo Moeller}
\item New function X509\+\_\+\+CTX\+\_\+rget\+\_\+chain() (renamed to X509\+\_\+\+CTX\+\_\+get1\+\_\+chain in the 0.\+9.\+5 release), this returns the chain from an X509\+\_\+\+CTX structure with a dup of the stack and all the X509 reference counts upped\+: so the stack will exist after X509\+\_\+\+CTX\+\_\+cleanup() has been called. Modify pkcs12.\+c to use this.

Also make SSL\+\_\+\+SESSION\+\_\+print() print out the verify return code.

{\itshape Steve Henson}
\item Add manpage for the pkcs12 command. Also change the default behaviour so MAC iteration counts are used unless the new -\/nomaciter option is used. This improves file security and only older versions of MSIE (4.\+0 for example) need it.

{\itshape Steve Henson}
\item Honor the no-\/xxx Configure options when creating .DEF files.

{\itshape Ulf Möller}
\item Add PKCS\#10 attributes to field table\+: challenge\+Password, unstructured\+Name and unstructured\+Address. These are taken from draft PKCS\#9 v2.\+0 but are compatible with v1.\+2 provided no international characters are used.

More changes to X509\+\_\+\+ATTRIBUTE code\+: allow the setting of types based on strings. Remove the \textquotesingle{}loc\textquotesingle{} parameter when adding attributes because these will be a SET OF encoding which is sorted in ASN1 order.

{\itshape Steve Henson}
\item Initial changes to the \textquotesingle{}req\textquotesingle{} utility to allow request generation automation. This will allow an application to just generate a template file containing all the field values and have req construct the request.

Initial support for X509\+\_\+\+ATTRIBUTE handling. Stacks of these are used all over the place including certificate requests and PKCS\#7 structures. They are currently handled manually where necessary with some primitive wrappers for PKCS\#7. The new functions behave in a manner analogous to the X509 extension functions\+: they allow attributes to be looked up by NID and added.

Later something similar to the X509\+V3 code would be desirable to automatically handle the encoding, decoding and printing of the more complex types. The string types like challenge\+Password can be handled by the string table functions.

Also modified the multi byte string table handling. Now there is a \textquotesingle{}global mask\textquotesingle{} which masks out certain types. The table itself can use the flag STABLE\+\_\+\+NO\+\_\+\+MASK to ignore the mask setting\+: this is useful when for example there is only one permissible type (as in country\+Name) and using the mask might result in no valid types at all.

{\itshape Steve Henson}
\item Clean up \textquotesingle{}Finished\textquotesingle{} handling, and add functions SSL\+\_\+get\+\_\+finished and SSL\+\_\+get\+\_\+peer\+\_\+finished to allow applications to obtain the latest Finished messages sent to the peer or expected from the peer, respectively. (SSL\+\_\+get\+\_\+peer\+\_\+finished is usually the Finished message actually received from the peer, otherwise the protocol will be aborted.)

As the Finished message are message digests of the complete handshake (with a total of 192 bits for TLS 1.\+0 and more for SSL 3.\+0), they can be used for external authentication procedures when the authentication provided by SSL/\+TLS is not desired or is not enough.

{\itshape Bodo Moeller}
\item Enhanced support for Alpha Linux is added. Now ./config checks if the host supports BWX extension and if Compaq C is present on the \$\+PATH. Just exploiting of the BWX extension results in 20-\/30\% performance kick for some algorithms, e.\+g. DES and RC4 to mention a couple. Compaq C in turn generates \texorpdfstring{$\sim$}{\string~}20\% faster code for MD5 and SHA1.

{\itshape Andy Polyakov}
\item Add support for MS "{}fast SGC"{}. This is arguably a violation of the SSL3/\+TLS protocol. Netscape SGC does two handshakes\+: the first with weak crypto and after checking the certificate is SGC a second one with strong crypto. MS SGC stops the first handshake after receiving the server certificate message and sends a second client hello. Since a server will typically do all the time consuming operations before expecting any further messages from the client (server key exchange is the most expensive) there is little difference between the two.

To get Open\+SSL to support MS SGC we have to permit a second client hello message after we have sent server done. In addition we have to reset the MAC if we do get this second client hello.

{\itshape Steve Henson}
\item Add a function \textquotesingle{}d2i\+\_\+\+Auto\+Private\+Key()\textquotesingle{} this will automatically decide if a DER encoded private key is RSA or DSA traditional format. Changed d2i\+\_\+\+Private\+Key\+\_\+bio() to use it. This is only needed for the "{}traditional"{} format DER encoded private key. Newer code should use PKCS\#8 format which has the key type encoded in the ASN1 structure. Added DER private key support to pkcs8 application.

{\itshape Steve Henson}
\item SSL 3/\+TLS 1 servers now don\textquotesingle{}t request certificates when an anonymous ciphersuites has been selected (as required by the SSL 3/\+TLS 1 specifications). Exception\+: When SSL\+\_\+\+VERIFY\+\_\+\+FAIL\+\_\+\+IF\+\_\+\+NO\+\_\+\+PEER\+\_\+\+CERT is set, we interpret this as a request to violate the specification (the worst that can happen is a handshake failure, and \textquotesingle{}correct\textquotesingle{} behaviour would result in a handshake failure anyway).

{\itshape Bodo Moeller}
\item In SSL\+\_\+\+CTX\+\_\+add\+\_\+session, take into account that there might be multiple SSL\+\_\+\+SESSION structures with the same session ID (e.\+g. when two threads concurrently obtain them from an external cache). The internal cache can handle only one SSL\+\_\+\+SESSION with a given ID, so if there\textquotesingle{}s a conflict, we now throw out the old one to achieve consistency.

{\itshape Bodo Moeller}
\item Add OIDs for idea and blowfish in CBC mode. This will allow both to be used in PKCS\#5 v2.\+0 and S/\+MIME. Also add checking to some routines that use cipher OIDs\+: some ciphers do not have OIDs defined and so they cannot be used for S/\+MIME and PKCS\#5 v2.\+0 for example.

{\itshape Steve Henson}
\item Simplify the trust setting structure and code. Now we just have two sequences of OIDs for trusted and rejected settings. These will typically have values the same as the extended key usage extension and any application specific purposes.

The trust checking code now has a default behaviour\+: it will just check for an object with the same NID as the passed id. Functions can be provided to override either the default behaviour or the behaviour for a given id. SSL client, server and email already have functions in place for compatibility\+: they check the NID and also return "{}trusted"{} if the certificate is self signed.

{\itshape Steve Henson}
\item Add d2i,i2d bio/fp functions for Private\+Key\+: these convert the traditional format into an EVP\+\_\+\+PKEY structure.

{\itshape Steve Henson}
\item Add a password callback function PEM\+\_\+cb() which either prompts for a password if usr\+\_\+data is NULL or otherwise assumes it is a null terminated password. Allow passwords to be passed on command line environment or config files in a few more utilities.

{\itshape Steve Henson}
\item Add a bunch of DER and PEM functions to handle PKCS\#8 format private keys. Add some short names for PKCS\#8 PBE algorithms and allow them to be specified on the command line for the pkcs8 and pkcs12 utilities. Update documentation.

{\itshape Steve Henson}
\item Support for ASN1 "{}\+NULL"{} type. This could be handled before by using ASN1\+\_\+\+TYPE but there wasn\textquotesingle{}t any function that would try to read a NULL and produce an error if it couldn\textquotesingle{}t. For compatibility we also have ASN1\+\_\+\+NULL\+\_\+new() and ASN1\+\_\+\+NULL\+\_\+free() functions but these are faked and don\textquotesingle{}t allocate anything because they don\textquotesingle{}t need to.

{\itshape Steve Henson}
\item Initial support for Mac\+OS is now provided. Examine INSTALL.\+Mac\+OS for details.

\texorpdfstring{$\ast$}{*}\+Andy Polyakov, Roy Woods \href{mailto:roy@centicsystems.ca}{\texttt{ roy@centicsystems.\+ca}}\texorpdfstring{$\ast$}{*}
\item Rebuild of the memory allocation routines used by Open\+SSL code and possibly others as well. The purpose is to make an interface that provide hooks so anyone can build a separate set of allocation and deallocation routines to be used by Open\+SSL, for example memory pool implementations, or something else, which was previously hard since Malloc(), Realloc() and Free() were defined as macros having the values malloc, realloc and free, respectively (except for Win32 compilations). The same is provided for memory debugging code. Open\+SSL already comes with functionality to find memory leaks, but this gives people a chance to debug other memory problems.

With these changes, a new set of functions and macros have appeared\+:

CRYPTO\+\_\+set\+\_\+mem\+\_\+debug\+\_\+functions() \mbox{[}F\mbox{]} CRYPTO\+\_\+get\+\_\+mem\+\_\+debug\+\_\+functions() \mbox{[}F\mbox{]} CRYPTO\+\_\+dbg\+\_\+set\+\_\+options() \mbox{[}F\mbox{]} CRYPTO\+\_\+dbg\+\_\+get\+\_\+options() \mbox{[}F\mbox{]} CRYPTO\+\_\+malloc\+\_\+debug\+\_\+init() \mbox{[}M\mbox{]}

The memory debug functions are NULL by default, unless the library is compiled with CRYPTO\+\_\+\+MDEBUG or friends is defined. If someone wants to debug memory anyway, CRYPTO\+\_\+malloc\+\_\+debug\+\_\+init() (which gives the standard debugging functions that come with Open\+SSL) or CRYPTO\+\_\+set\+\_\+mem\+\_\+debug\+\_\+functions() (tells Open\+SSL to use functions provided by the library user) must be used. When the standard debugging functions are used, CRYPTO\+\_\+dbg\+\_\+set\+\_\+options can be used to request additional information\+: CRYPTO\+\_\+dbg\+\_\+set\+\_\+options(\+V\+\_\+\+CYRPTO\+\_\+\+MDEBUG\+\_\+xxx) corresponds to setting the CRYPTO\+\_\+\+MDEBUG\+\_\+xxx macro when compiling the library.

Also, things like CRYPTO\+\_\+set\+\_\+mem\+\_\+functions will always give the expected result (the new set of functions is used for allocation and deallocation) at all times, regardless of platform and compiler options.

To finish it up, some functions that were never use in any other way than through macros have a new API and new semantic\+:

CRYPTO\+\_\+dbg\+\_\+malloc() CRYPTO\+\_\+dbg\+\_\+realloc() CRYPTO\+\_\+dbg\+\_\+free()

All macros of value have retained their old syntax.

{\itshape Richard Levitte and Bodo Moeller}
\item Some S/\+MIME fixes. The OID for SMIMECapabilities was wrong, the ordering of SMIMECapabilities wasn\textquotesingle{}t in "{}strength order"{} and there was a missing NULL in the Algorithm\+Identifier for the SHA1 signature algorithm.

{\itshape Steve Henson}
\item Some ASN1 types with illegal zero length encoding (INTEGER, ENUMERATED and OBJECT IDENTIFIER) choked the ASN1 routines.

\texorpdfstring{$\ast$}{*}\+Frans Heymans \href{mailto:fheymans@isaserver.be}{\texttt{ fheymans@isaserver.\+be}}, modified by Steve Henson\texorpdfstring{$\ast$}{*}
\item Merge in my S/\+MIME library for Open\+SSL. This provides a simple S/\+MIME API on top of the PKCS\#7 code, a MIME parser (with enough functionality to handle multipart/signed properly) and a utility called \textquotesingle{}smime\textquotesingle{} to call all this stuff. This is based on code I originally wrote for Celo who have kindly allowed it to be included in Open\+SSL.

{\itshape Steve Henson}
\item Add variants des\+\_\+set\+\_\+key\+\_\+checked and des\+\_\+set\+\_\+key\+\_\+unchecked of des\+\_\+set\+\_\+key (aka des\+\_\+key\+\_\+sched). Global variable des\+\_\+check\+\_\+key decides which of these is called by des\+\_\+set\+\_\+key; this way des\+\_\+check\+\_\+key behaves as it always did, but applications and the library itself, which was buggy for des\+\_\+check\+\_\+key == 1, have a cleaner way to pick the version they need.

{\itshape Bodo Moeller}
\item New function PKCS12\+\_\+newpass() which changes the password of a PKCS12 structure.

{\itshape Steve Henson}
\item Modify X509\+\_\+\+TRUST and X509\+\_\+\+PURPOSE so it also uses a static and dynamic mix. In both cases the ids can be used as an index into the table. Also modified the X509\+\_\+\+TRUST\+\_\+add() and X509\+\_\+\+PURPOSE\+\_\+add() functions so they accept a list of the field values and the application doesn\textquotesingle{}t need to directly manipulate the X509\+\_\+\+TRUST structure.

{\itshape Steve Henson}
\item Modify the ASN1\+\_\+\+STRING\+\_\+\+TABLE stuff so it also uses bsearch and doesn\textquotesingle{}t need initialising.

{\itshape Steve Henson}
\item Modify the way the V3 extension code looks up extensions. This now works in a similar way to the object code\+: we have some "{}standard"{} extensions in a static table which is searched with OBJ\+\_\+bsearch() and the application can add dynamic ones if needed. The file crypto/x509v3/ext\+\_\+dat.\+h now has the info\+: this file needs to be updated whenever a new extension is added to the core code and kept in ext\+\_\+nid order. There is a simple program \textquotesingle{}tabtest.\+c\textquotesingle{} which checks this. New extensions are not added too often so this file can readily be maintained manually.

There are two big advantages in doing things this way. The extensions can be looked up immediately and no longer need to be "{}added"{} using X509\+V3\+\_\+add\+\_\+standard\+\_\+extensions()\+: this function now does nothing. Side note\+: I get {\itshape lots} of email saying the extension code doesn\textquotesingle{}t work because people forget to call this function. Also no dynamic allocation is done unless new extensions are added\+: so if we don\textquotesingle{}t add custom extensions there is no need to call X509\+V3\+\_\+\+EXT\+\_\+cleanup().

{\itshape Steve Henson}
\item Modify enc utility\textquotesingle{}s salting as follows\+: make salting the default. Add a magic header, so unsalted files fail gracefully instead of just decrypting to garbage. This is because not salting is a big security hole, so people should be discouraged from doing it.

{\itshape Ben Laurie}
\item Fixes and enhancements to the \textquotesingle{}x509\textquotesingle{} utility. It allowed a message digest to be passed on the command line but it only used this parameter when signing a certificate. Modified so all relevant operations are affected by the digest parameter including the -\/fingerprint and -\/x509toreq options. Also -\/x509toreq choked if a DSA key was used because it didn\textquotesingle{}t fix the digest.

{\itshape Steve Henson}
\item Initial certificate chain verify code. Currently tests the untrusted certificates for consistency with the verify purpose (which is set when the X509\+\_\+\+STORE\+\_\+\+CTX structure is set up) and checks the pathlength.

There is a NO\+\_\+\+CHAIN\+\_\+\+VERIFY compilation option to keep the old behaviour\+: this is because it will reject chains with invalid extensions whereas every previous version of Open\+SSL and SSLeay made no checks at all.

Trust code\+: checks the root CA for the relevant trust settings. Trust settings have an initial value consistent with the verify purpose\+: e.\+g. if the verify purpose is for SSL client use it expects the CA to be trusted for SSL client use. However the default value can be changed to permit custom trust settings\+: one example of this would be to only trust certificates from a specific "{}secure"{} set of CAs.

Also added X509\+\_\+\+STORE\+\_\+\+CTX\+\_\+new() and X509\+\_\+\+STORE\+\_\+\+CTX\+\_\+free() functions which should be used for version portability\+: especially since the verify structure is likely to change more often now.

SSL integration. Add purpose and trust to SSL\+\_\+\+CTX and SSL and functions to set them. If not set then assume SSL clients will verify SSL servers and vice versa.

Two new options to the verify program\+: -\/untrusted allows a set of untrusted certificates to be passed in and -\/purpose which sets the intended purpose of the certificate. If a purpose is set then the new chain verify code is used to check extension consistency.

{\itshape Steve Henson}
\item Support for the authority information access extension.

{\itshape Steve Henson}
\item Modify RSA and DSA PEM read routines to transparently handle PKCS\#8 format private keys. New \texorpdfstring{$\ast$}{*}\+\_\+\+PUBKEY\+\_\+\texorpdfstring{$\ast$}{*} functions that handle public keys in a format compatible with certificate Subject\+Public\+Key\+Info structures. Unfortunately there were already functions called \texorpdfstring{$\ast$}{*}\+\_\+\+Public\+Key\+\_\+\texorpdfstring{$\ast$}{*} which used various odd formats so these are retained for compatibility\+: however the DSA variants were never in a public release so they have been deleted. Changed dsa/rsa utilities to handle the new format\+: note no releases ever handled public keys so we should be OK.

The primary motivation for this change is to avoid the same fiasco that dogs private keys\+: there are several incompatible private key formats some of which are standard and some Open\+SSL specific and require various evil hacks to allow partial transparent handling and even then it doesn\textquotesingle{}t work with DER formats. Given the option anything other than PKCS\#8 should be dumped\+: but the other formats have to stay in the name of compatibility.

With public keys and the benefit of hindsight one standard format is used which works with EVP\+\_\+\+PKEY, RSA or DSA structures\+: though it clearly returns an error if you try to read the wrong kind of key.

Added a -\/pubkey option to the \textquotesingle{}x509\textquotesingle{} utility to output the public key. Also rename the {\ttfamily EVP\+\_\+\+PKEY\+\_\+get\+\_\+\texorpdfstring{$\ast$}{*}()} to {\ttfamily EVP\+\_\+\+PKEY\+\_\+rget\+\_\+\texorpdfstring{$\ast$}{*}()} (renamed to {\ttfamily EVP\+\_\+\+PKEY\+\_\+get1\+\_\+\texorpdfstring{$\ast$}{*}()} in the Open\+SSL 0.\+9.\+5 release) and add {\ttfamily EVP\+\_\+\+PKEY\+\_\+rset\+\_\+\texorpdfstring{$\ast$}{*}()} functions (renamed to {\ttfamily EVP\+\_\+\+PKEY\+\_\+set1\+\_\+\texorpdfstring{$\ast$}{*}()}) that do the same as the {\ttfamily EVP\+\_\+\+PKEY\+\_\+assign\+\_\+\texorpdfstring{$\ast$}{*}()} except they up the reference count of the added key (they don\textquotesingle{}t "{}swallow"{} the supplied key).

{\itshape Steve Henson}
\item Fixes to crypto/x509/by\+\_\+file.\+c the code to read in certificates and CRLs would fail if the file contained no certificates or no CRLs\+: added a new function to read in both types and return the number read\+: this means that if none are read it will be an error. The DER versions of the certificate and CRL reader would always fail because it isn\textquotesingle{}t possible to mix certificates and CRLs in DER format without choking one or the other routine. Changed this to just read a certificate\+: this is the best we can do. Also modified the code in {\ttfamily apps/verify.\+c} to take notice of return codes\+: it was previously attempting to read in certificates from NULL pointers and ignoring any errors\+: this is one reason why the cert and CRL reader seemed to work. It doesn\textquotesingle{}t check return codes from the default certificate routines\+: these may well fail if the certificates aren\textquotesingle{}t installed.

{\itshape Steve Henson}
\item Code to support other\+Name option in General\+Name.

{\itshape Steve Henson}
\item First update to verify code. Change the verify utility so it warns if it is passed a self signed certificate\+: for consistency with the normal behaviour. X509\+\_\+verify has been modified to it will now verify a self signed certificate if {\itshape exactly} the same certificate appears in the store\+: it was previously impossible to trust a single self signed certificate. This means that\+: openssl verify ss.\+pem now gives a warning about a self signed certificate but openssl verify -\/CAfile ss.\+pem ss.\+pem is OK.

{\itshape Steve Henson}
\item For servers, store verify\+\_\+result in SSL\+\_\+\+SESSION data structure (and add it to external session representation). This is needed when client certificate verifications fails, but an application-\/provided verification callback (set by SSL\+\_\+\+CTX\+\_\+set\+\_\+cert\+\_\+verify\+\_\+callback) allows accepting the session anyway (i.\+e. leaves x509\+\_\+store\+\_\+ctx-\/\texorpdfstring{$>$}{>}error != X509\+\_\+\+V\+\_\+\+OK but returns 1)\+: When the session is reused, we have to set ssl-\/\texorpdfstring{$>$}{>}verify\+\_\+result to the appropriate error code to avoid security holes.

{\itshape Bodo Moeller, problem pointed out by Lutz Jaenicke}
\item Fix a bug in the new PKCS\#7 code\+: it didn\textquotesingle{}t consider the case in PKCS7\+\_\+data\+Init() where the signed PKCS7 structure didn\textquotesingle{}t contain any existing data because it was being created.

\texorpdfstring{$\ast$}{*}\+Po-\/\+Cheng Chen \href{mailto:pocheng@nst.com.tw}{\texttt{ pocheng@nst.\+com.\+tw}}, slightly modified by Steve Henson\texorpdfstring{$\ast$}{*}
\item Add a salt to the key derivation routines in enc.\+c. This forms the first 8 bytes of the encrypted file. Also add a -\/S option to allow a salt to be input on the command line.

{\itshape Steve Henson}
\item New function X509\+\_\+cmp(). Oddly enough there wasn\textquotesingle{}t a function to compare two certificates. We do this by working out the SHA1 hash and comparing that. X509\+\_\+cmp() will be needed by the trust code.

{\itshape Steve Henson}
\item SSL\+\_\+get1\+\_\+session() is like SSL\+\_\+get\+\_\+session(), but increments the reference count in the SSL\+\_\+\+SESSION returned.

\texorpdfstring{$\ast$}{*}\+Geoff Thorpe \href{mailto:geoff@eu.c2.net}{\texttt{ geoff@eu.\+c2.\+net}}\texorpdfstring{$\ast$}{*}
\item Fix for \textquotesingle{}req\textquotesingle{}\+: it was adding a null to request attributes. Also change the X509\+\_\+\+LOOKUP and X509\+\_\+\+INFO code to handle certificate auxiliary information.

{\itshape Steve Henson}
\item Add support for 40 and 64 bit RC2 and RC4 algorithms\+: document the \textquotesingle{}enc\textquotesingle{} command.

{\itshape Steve Henson}
\item Add the possibility to add extra information to the memory leak detecting output, to form tracebacks, showing from where each allocation was originated\+: CRYPTO\+\_\+push\+\_\+info("{}constant string"{}) adds the string plus current file name and line number to a per-\/thread stack, CRYPTO\+\_\+pop\+\_\+info() does the obvious, CRYPTO\+\_\+remove\+\_\+all\+\_\+info() is like calling CYRPTO\+\_\+pop\+\_\+info() until the stack is empty. Also updated memory leak detection code to be multi-\/thread-\/safe.

{\itshape Richard Levitte}
\item Add options -\/text and -\/noout to pkcs7 utility and delete the encryption options which never did anything. Update docs.

{\itshape Steve Henson}
\item Add options to some of the utilities to allow the pass phrase to be included on either the command line (not recommended on OSes like Unix) or read from the environment. Update the manpages and fix a few bugs.

{\itshape Steve Henson}
\item Add a few manpages for some of the openssl commands.

{\itshape Steve Henson}
\item Fix the -\/revoke option in ca. It was freeing up memory twice, leaking and not finding already revoked certificates.

{\itshape Steve Henson}
\item Extensive changes to support certificate auxiliary information. This involves the use of X509\+\_\+\+CERT\+\_\+\+AUX structure and X509\+\_\+\+AUX functions. An X509\+\_\+\+AUX function such as PEM\+\_\+read\+\_\+\+X509\+\_\+\+AUX() can still read in a certificate file in the usual way but it will also read in any additional "{}auxiliary information"{}. By doing things this way a fair degree of compatibility can be retained\+: existing certificates can have this information added using the new \textquotesingle{}x509\textquotesingle{} options.

Current auxiliary information includes an "{}alias"{} and some trust settings. The trust settings will ultimately be used in enhanced certificate chain verification routines\+: currently a certificate can only be trusted if it is self signed and then it is trusted for all purposes.

{\itshape Steve Henson}
\item Fix assembler for Alpha (tested only on DEC OSF not Linux or {\ttfamily \texorpdfstring{$\ast$}{*}\+BSD}). The problem was that one of the replacement routines had not been working since SSLeay releases. For now the offending routine has been replaced with non-\/optimised assembler. Even so, this now gives around 95\% performance improvement for 1024 bit RSA signs.

{\itshape Mark Cox}
\item Hack to fix PKCS\#7 decryption when used with some unorthodox RC2 handling. Most clients have the effective key size in bits equal to the key length in bits\+: so a 40 bit RC2 key uses a 40 bit (5 byte) key. A few however don\textquotesingle{}t do this and instead use the size of the decrypted key to determine the RC2 key length and the Algorithm\+Identifier to determine the effective key length. In this case the effective key length can still be 40 bits but the key length can be 168 bits for example. This is fixed by manually forcing an RC2 key into the EVP\+\_\+\+PKEY structure because the EVP code can\textquotesingle{}t currently handle unusual RC2 key sizes\+: it always assumes the key length and effective key length are equal.

{\itshape Steve Henson}
\item Add a bunch of functions that should simplify the creation of X509\+\_\+\+NAME structures. Now you should be able to do\+: X509\+\_\+\+NAME\+\_\+add\+\_\+entry\+\_\+by\+\_\+txt(nm, "{}\+CN"{}, MBSTRING\+\_\+\+ASC, "{}\+Steve"{}, -\/1, -\/1, 0); and have it automatically work out the correct field type and fill in the structures. The more adventurous can try\+: X509\+\_\+\+NAME\+\_\+add\+\_\+entry\+\_\+by\+\_\+txt(nm, field, MBSTRING\+\_\+\+UTF8, str, -\/1, -\/1, 0); and it will (hopefully) work out the correct multibyte encoding.

{\itshape Steve Henson}
\item Change the \textquotesingle{}req\textquotesingle{} utility to use the new field handling and multibyte copy routines. Before the DN field creation was handled in an ad hoc way in req, ca, and x509 which was rather broken and didn\textquotesingle{}t support BMPStrings or UTF8\+Strings. Since some software doesn\textquotesingle{}t implement BMPStrings or UTF8\+Strings yet, they can be enabled using the config file using the dirstring\+\_\+type option. See the new comment in the default openssl.\+cnf for more info.

{\itshape Steve Henson}
\item Make crypto/rand/md\+\_\+rand.\+c more robust\+:
\begin{DoxyItemize}
\item Assure unique random numbers after fork().
\item Make sure that concurrent threads access the global counter and md serializably so that we never lose entropy in them or use exactly the same state in multiple threads. Access to the large state is not always serializable because the additional locking could be a performance killer, and md should be large enough anyway.
\end{DoxyItemize}

{\itshape Bodo Moeller}
\item New file {\ttfamily apps/app\+\_\+rand.\+c} with commonly needed functionality for handling the random seed file.

Use the random seed file in some applications that previously did not\+: ca, dsaparam -\/genkey (which also ignored its \textquotesingle{}-\/rand\textquotesingle{} option), s\+\_\+client, s\+\_\+server, x509 (when signing). Except on systems with /dev/urandom, it is crucial to have a random seed file at least for key creation, DSA signing, and for DH exchanges; for RSA signatures we could do without one.

gendh and gendsa (unlike genrsa) used to read only the first byte of each file listed in the \textquotesingle{}-\/rand\textquotesingle{} option. The function as previously found in genrsa is now in app\+\_\+rand.\+c and is used by all programs that support \textquotesingle{}-\/rand\textquotesingle{}.

{\itshape Bodo Moeller}
\item In RAND\+\_\+write\+\_\+file, use mode 0600 for creating files; don\textquotesingle{}t just chmod when it may be too late.

{\itshape Bodo Moeller}
\item Report an error from X509\+\_\+\+STORE\+\_\+load\+\_\+locations when X509\+\_\+\+LOOKUP\+\_\+load\+\_\+file or X509\+\_\+\+LOOKUP\+\_\+add\+\_\+dir failed.

{\itshape Bill Perry}
\item New function ASN1\+\_\+mbstring\+\_\+copy() this copies a string in either ASCII, Unicode, Universal (4 bytes per character) or UTF8 format into an ASN1\+\_\+\+STRING type. A mask of permissible types is passed and it chooses the "{}minimal"{} type to use or an error if not type is suitable.

{\itshape Steve Henson}
\item Add function equivalents to the various macros in asn1.\+h. The old macros are retained with an {\ttfamily M\+\_\+} prefix. Code inside the library can use the {\ttfamily M\+\_\+} macros. External code (including the openssl utility) should {\itshape NOT} in order to be "{}shared library friendly"{}.

{\itshape Steve Henson}
\item Add various functions that can check a certificate\textquotesingle{}s extensions to see if it usable for various purposes such as SSL client, server or S/\+MIME and CAs of these types. This is currently VERY EXPERIMENTAL but will ultimately be used for certificate chain verification. Also added a -\/purpose flag to x509 utility to print out all the purposes.

{\itshape Steve Henson}
\item Add a CRYPTO\+\_\+\+EX\+\_\+\+DATA to X509 certificate structure and associated functions.

{\itshape Steve Henson}
\item New {\ttfamily X509\+V3\+\_\+\{X509,CRL,REVOKED\}\+\_\+get\+\_\+d2i()} functions. These will search for, obtain and decode and extension and obtain its critical flag. This allows all the necessary extension code to be handled in a single function call.

{\itshape Steve Henson}
\item RC4 tune-\/up featuring 30-\/40\% performance improvement on most RISC platforms. See crypto/rc4/rc4\+\_\+enc.\+c for further details.

{\itshape Andy Polyakov}
\item New -\/noout option to asn1parse. This causes no output to be produced its main use is when combined with -\/strparse and -\/out to extract data from a file (which may not be in ASN.\+1 format).

{\itshape Steve Henson}
\item Fix for pkcs12 program. It was hashing an invalid certificate pointer when producing the local key id.

\texorpdfstring{$\ast$}{*}\+Richard Levitte \href{mailto:levitte@stacken.kth.se}{\texttt{ levitte@stacken.\+kth.\+se}}\texorpdfstring{$\ast$}{*}
\item New option -\/dhparam in s\+\_\+server. This allows a DH parameter file to be stated explicitly. If it is not stated then it tries the first server certificate file. The previous behaviour hard coded the filename "{}server.\+pem"{}.

{\itshape Steve Henson}
\item Add -\/pubin and -\/pubout options to the rsa and dsa commands. These allow a public key to be input or output. For example\+: openssl rsa -\/in key.\+pem -\/pubout -\/out pubkey.\+pem Also added necessary DSA public key functions to handle this.

{\itshape Steve Henson}
\item Fix so PKCS7\+\_\+data\+Verify() doesn\textquotesingle{}t crash if no certificates are contained in the message. This was handled by allowing X509\+\_\+find\+\_\+by\+\_\+issuer\+\_\+and\+\_\+serial() to tolerate a NULL passed to it.

\texorpdfstring{$\ast$}{*}\+Steve Henson, reported by Sampo Kellomaki \href{mailto:sampo@mail.neuronio.pt}{\texttt{ sampo@mail.\+neuronio.\+pt}}\texorpdfstring{$\ast$}{*}
\item Fix for bug in d2i\+\_\+\+ASN1\+\_\+bytes()\+: other ASN1 functions add an extra null to the end of the strings whereas this didn\textquotesingle{}t. This would cause problems if strings read with d2i\+\_\+\+ASN1\+\_\+bytes() were later modified.

\texorpdfstring{$\ast$}{*}\+Steve Henson, reported by Arne Ansper \href{mailto:arne@ats.cyber.ee}{\texttt{ arne@ats.\+cyber.\+ee}}\texorpdfstring{$\ast$}{*}
\item Fix for base64 decode bug. When a base64 bio reads only one line of data and it contains EOF it will end up returning an error. This is caused by input 46 bytes long. The cause is due to the way base64 BIOs find the start of base64 encoded data. They do this by trying a trial decode on each line until they find one that works. When they do a flag is set and it starts again knowing it can pass all the data directly through the decoder. Unfortunately it doesn\textquotesingle{}t reset the context it uses. This means that if EOF is reached an attempt is made to pass two EOFs through the context and this causes the resulting error. This can also cause other problems as well. As is usual with these problems it takes {\itshape ages} to find and the fix is trivial\+: move one line.

\texorpdfstring{$\ast$}{*}\+Steve Henson, reported by \href{mailto:ian@uns.ns.ac.yu}{\texttt{ ian@uns.\+ns.\+ac.\+yu}} (Ivan Nejgebauer)\texorpdfstring{$\ast$}{*}
\item Ugly workaround to get s\+\_\+client and s\+\_\+server working under Windows. The old code wouldn\textquotesingle{}t work because it needed to select() on sockets and the tty (for keypresses and to see if data could be written). Win32 only supports select() on sockets so we select() with a 1s timeout on the sockets and then see if any characters are waiting to be read, if none are present then we retry, we also assume we can always write data to the tty. This isn\textquotesingle{}t nice because the code then blocks until we\textquotesingle{}ve received a complete line of data and it is effectively polling the keyboard at 1s intervals\+: however it\textquotesingle{}s quite a bit better than not working at all \+:-\/) A dedicated Windows application might handle this with an event loop for example.

{\itshape Steve Henson}
\item Enhance RSA\+\_\+\+METHOD structure. Now there are two extra methods, rsa\+\_\+sign and rsa\+\_\+verify. When the RSA\+\_\+\+FLAGS\+\_\+\+SIGN\+\_\+\+VER option is set these functions will be called when RSA\+\_\+sign() and RSA\+\_\+verify() are used. This is useful if rsa\+\_\+pub\+\_\+dec() and rsa\+\_\+priv\+\_\+enc() equivalents are not available. For this to work properly RSA\+\_\+public\+\_\+decrypt() and RSA\+\_\+private\+\_\+encrypt() should {\itshape not} be used\+: RSA\+\_\+sign() and RSA\+\_\+verify() must be used instead. This necessitated the support of an extra signature type NID\+\_\+md5\+\_\+sha1 for SSL signatures and modifications to the SSL library to use it instead of calling RSA\+\_\+public\+\_\+decrypt() and RSA\+\_\+private\+\_\+encrypt().

{\itshape Steve Henson}
\item Add new -\/verify -\/CAfile and -\/CApath options to the crl program, these will lookup a CRL issuers certificate and verify the signature in a similar way to the verify program. Tidy up the crl program so it no longer accesses structures directly. Make the ASN1 CRL parsing a bit less strict. It will now permit CRL extensions even if it is not a V2 CRL\+: this will allow it to tolerate some broken CRLs.

{\itshape Steve Henson}
\item Initialize all non-\/automatic variables each time one of the openssl sub-\/programs is started (this is necessary as they may be started multiple times from the "{}\+Open\+SSL$>$"{} prompt).

{\itshape Lennart Bang, Bodo Moeller}
\item Preliminary compilation option RSA\+\_\+\+NULL which disables RSA crypto without removing all other RSA functionality (this is what NO\+\_\+\+RSA does). This is so (for example) those in the US can disable those operations covered by the RSA patent while allowing storage and parsing of RSA keys and RSA key generation.

{\itshape Steve Henson}
\item Non-\/copying interface to BIO pairs. (still largely untested)

{\itshape Bodo Moeller}
\item New function ASN1\+\_\+tag2str() to convert an ASN1 tag to a descriptive ASCII string. This was handled independently in various places before.

{\itshape Steve Henson}
\item New functions UTF8\+\_\+getc() and UTF8\+\_\+putc() that parse and generate UTF8 strings a character at a time.

{\itshape Steve Henson}
\item Use client\+\_\+version from client hello to select the protocol (s23\+\_\+srvr.\+c) and for RSA client key exchange verification (s3\+\_\+srvr.\+c), as required by the SSL 3.\+0/\+TLS 1.\+0 specifications.

{\itshape Bodo Moeller}
\item Add various utility functions to handle SPKACs, these were previously handled by poking round in the structure internals. Added new function NETSCAPE\+\_\+\+SPKI\+\_\+print() to print out SPKAC and a new utility \textquotesingle{}spkac\textquotesingle{} to print, verify and generate SPKACs. Based on an original idea from Massimiliano Pala \href{mailto:madwolf@comune.modena.it}{\texttt{ madwolf@comune.\+modena.\+it}} but extensively modified.

{\itshape Steve Henson}
\item RIPEMD160 is operational on all platforms and is back in \textquotesingle{}make test\textquotesingle{}.

{\itshape Andy Polyakov}
\item Allow the config file extension section to be overwritten on the command line. Based on an original idea from Massimiliano Pala \href{mailto:madwolf@comune.modena.it}{\texttt{ madwolf@comune.\+modena.\+it}}. The new option is called -\/extensions and can be applied to ca, req and x509. Also -\/reqexts to override the request extensions in req and -\/crlexts to override the crl extensions in ca.

{\itshape Steve Henson}
\item Add new feature to the SPKAC handling in ca. Now you can include the same field multiple times by preceding it by "{}\+XXXX."{} for example\+: 1.\+OU="{}\+Unit name 1"{} 2.\+OU="{}\+Unit name 2"{} this is the same syntax as used in the req config file.

{\itshape Steve Henson}
\item Allow certificate extensions to be added to certificate requests. These are specified in a \textquotesingle{}req\+\_\+extensions\textquotesingle{} option of the req section of the config file. They can be printed out with the -\/text option to req but are otherwise ignored at present.

{\itshape Steve Henson}
\item Fix a horrible bug in enc\+\_\+read() in crypto/evp/bio\+\_\+enc.\+c\+: if the first data read consists of only the final block it would not decrypted because EVP\+\_\+\+Cipher\+Update() would correctly report zero bytes had been decrypted. A misplaced \textquotesingle{}break\textquotesingle{} also meant the decrypted final block might not be copied until the next read.

{\itshape Steve Henson}
\item Initial support for DH\+\_\+\+METHOD. Again based on RSA\+\_\+\+METHOD. Also added a few extra parameters to the DH structure\+: these will be useful if for example we want the value of \textquotesingle{}q\textquotesingle{} or implement X9.\+42 DH.

{\itshape Steve Henson}
\item Initial support for DSA\+\_\+\+METHOD. This is based on the RSA\+\_\+\+METHOD and provides hooks that allow the default DSA functions or functions on a "{}per key"{} basis to be replaced. This allows hardware acceleration and hardware key storage to be handled without major modification to the library. Also added low-\/level modexp hooks and CRYPTO\+\_\+\+EX structure and associated functions.

{\itshape Steve Henson}
\item Add a new flag to memory BIOs, BIO\+\_\+\+FLAG\+\_\+\+MEM\+\_\+\+RDONLY. This marks the BIO as "{}read only"{}\+: it can\textquotesingle{}t be written to and the buffer it points to will not be freed. Reading from a read only BIO is much more efficient than a normal memory BIO. This was added because there are several times when an area of memory needs to be read from a BIO. The previous method was to create a memory BIO and write the data to it, this results in two copies of the data and an O(n\texorpdfstring{$^\wedge$}{\string^}2) reading algorithm. There is a new function BIO\+\_\+new\+\_\+mem\+\_\+buf() which creates a read only memory BIO from an area of memory. Also modified the PKCS\#7 routines to use read only memory BIOs.

{\itshape Steve Henson}
\item Bugfix\+: ssl23\+\_\+get\+\_\+client\+\_\+hello did not work properly when called in state SSL23\+\_\+\+ST\+\_\+\+SR\+\_\+\+CLNT\+\_\+\+HELLO\+\_\+B, i.\+e. when the first 7 bytes of a SSLv2-\/compatible client hello for SSLv3 or TLSv1 could be read, but a retry condition occurred while trying to read the rest.

{\itshape Bodo Moeller}
\item The PKCS7\+\_\+\+ENC\+\_\+\+CONTENT\+\_\+new() function was setting the content type as NID\+\_\+pkcs7\+\_\+encrypted by default\+: this was wrong since this should almost always be NID\+\_\+pkcs7\+\_\+data. Also modified the PKCS7\+\_\+set\+\_\+type() to handle the encrypted data type\+: this is a more sensible place to put it and it allows the PKCS\#12 code to be tidied up that duplicated this functionality.

{\itshape Steve Henson}
\item Changed obj\+\_\+dat.\+pl script so it takes its input and output files on the command line. This should avoid shell escape redirection problems under Win32.

{\itshape Steve Henson}
\item Initial support for certificate extension requests, these are included in things like Xenroll certificate requests. Included functions to allow extensions to be obtained and added.

{\itshape Steve Henson}
\item -\/crlf option to s\+\_\+client and s\+\_\+server for sending newlines as CRLF (as required by many protocols).

{\itshape Bodo Moeller}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md165}{}\doxysubsection{\texorpdfstring{Changes between 0.\+9.\+3a and 0.\+9.\+4 \mbox{[}09 Aug 1999\mbox{]}}{Changes between 0.\+9.\+3a and 0.\+9.\+4 \mbox{[}09 Aug 1999\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md165}

\begin{DoxyItemize}
\item Install lib\+RSAglue.\+a when Open\+SSL is built with RSAref.

{\itshape Ralf S. Engelschall}
\item A few more {\ttfamily \#ifndef NO\+\_\+\+FP\+\_\+\+API / \#endif} pairs for consistency.

\texorpdfstring{$\ast$}{*}\+Andrija Antonijevic \href{mailto:TheAntony2@bigfoot.com}{\texttt{ The\+Antony2@bigfoot.\+com}}\texorpdfstring{$\ast$}{*}
\item Fix -\/startdate and -\/enddate (which was missing) arguments to \textquotesingle{}ca\textquotesingle{} program.

{\itshape Steve Henson}
\item New function DSA\+\_\+dup\+\_\+\+DH, which duplicates DSA parameters/keys as DH parameters/keys (q is lost during that conversion, but the resulting DH parameters contain its length).

For 1024-\/bit p, DSA\+\_\+generate\+\_\+parameters followed by DSA\+\_\+dup\+\_\+\+DH is much faster than DH\+\_\+generate\+\_\+parameters (which creates parameters where {\ttfamily p = 2\texorpdfstring{$\ast$}{*}q + 1}), and also the smaller q makes DH computations much more efficient (160-\/bit exponentiation instead of 1024-\/bit exponentiation); so this provides a convenient way to support DHE ciphersuites in SSL/\+TLS servers (see ssl/ssltest.\+c). It is of utter importance to use SSL\+\_\+\+CTX\+\_\+set\+\_\+options(s\+\_\+ctx, SSL\+\_\+\+OP\+\_\+\+SINGLE\+\_\+\+DH\+\_\+\+USE); or SSL\+\_\+set\+\_\+options(s\+\_\+ctx, SSL\+\_\+\+OP\+\_\+\+SINGLE\+\_\+\+DH\+\_\+\+USE); when such DH parameters are used, because otherwise small subgroup attacks may become possible!

{\itshape Bodo Moeller}
\item Avoid memory leak in i2d\+\_\+\+DHparams.

{\itshape Bodo Moeller}
\item Allow the -\/k option to be used more than once in the enc program\+: this allows the same encrypted message to be read by multiple recipients.

{\itshape Steve Henson}
\item New function OBJ\+\_\+obj2txt(buf, buf\+\_\+len, a, no\+\_\+name), this converts an ASN1\+\_\+\+OBJECT to a text string. If the "{}no\+\_\+name"{} parameter is set then it will always use the numerical form of the OID, even if it has a short or long name.

{\itshape Steve Henson}
\item Added an extra RSA flag\+: RSA\+\_\+\+FLAG\+\_\+\+EXT\+\_\+\+PKEY. Previously the rsa\+\_\+mod\+\_\+exp method only got called if p,q,dmp1,dmq1,iqmp components were present, otherwise bn\+\_\+mod\+\_\+exp was called. In the case of hardware keys for example no private key components need be present and it might store extra data in the RSA structure, which cannot be accessed from bn\+\_\+mod\+\_\+exp. By setting RSA\+\_\+\+FLAG\+\_\+\+EXT\+\_\+\+PKEY rsa\+\_\+mod\+\_\+exp will always be called for private key operations.

{\itshape Steve Henson}
\item Added support for SPARC Linux.

{\itshape Andy Polyakov}
\item pem\+\_\+password\+\_\+cb function type incompatibly changed from typedef int pem\+\_\+password\+\_\+cb(char \texorpdfstring{$\ast$}{*}buf, int size, int rwflag); to ....(char \texorpdfstring{$\ast$}{*}buf, int size, int rwflag, void \texorpdfstring{$\ast$}{*}userdata); so that applications can pass data to their callbacks\+: The {\ttfamily PEM\mbox{[}\+\_\+\+ASN1\mbox{]}\+\_\+\{read,write\}...} functions and macros now take an additional void \texorpdfstring{$\ast$}{*} argument, which is just handed through whenever the password callback is called.

\texorpdfstring{$\ast$}{*}\+Damien Miller \href{mailto:dmiller@ilogic.com.au}{\texttt{ dmiller@ilogic.\+com.\+au}}; tiny changes by Bodo Moeller\texorpdfstring{$\ast$}{*}

New function SSL\+\_\+\+CTX\+\_\+set\+\_\+default\+\_\+passwd\+\_\+cb\+\_\+userdata.

Compatibility note\+: As many C implementations push function arguments onto the stack in reverse order, the new library version is likely to interoperate with programs that have been compiled with the old pem\+\_\+password\+\_\+cb definition (PEM\+\_\+whatever takes some data that happens to be on the stack as its last argument, and the callback just ignores this garbage); but there is no guarantee whatsoever that this will work.
\item The -\/DPLATFORM="{}\textbackslash{}"{}\$(\+PLATFORM)\textbackslash{}"{}"{} definition and the similar -\/DCFLAGS=... (both in crypto/\+Makefile.\+ssl for use by crypto/cversion.\+c) caused problems not only on Windows, but also on some Unix platforms. To avoid problematic command lines, these definitions are now in an auto-\/generated file \doxylink{buildinf_8h_source}{crypto/buildinf.\+h} (created by crypto/\+Makefile.\+ssl for standard "{}make"{} builds, by util/mk1mf.\+pl for "{}mk1mf"{} builds).

{\itshape Bodo Moeller}
\item MIPS III/\+IV assembler module is reimplemented.

{\itshape Andy Polyakov}
\item More DES library cleanups\+: remove references to srand/rand and delete an unused file.

{\itshape Ulf Möller}
\item Add support for the free Netwide assembler (NASM) under Win32, since not many people have MASM (ml) and it can be hard to obtain. This is currently experimental but it seems to work OK and pass all the tests. Check out INSTALL.\+W32 for info.

{\itshape Steve Henson}
\item Fix memory leaks in s3\+\_\+clnt.\+c\+: All non-\/anonymous SSL3/\+TLS1 connections without temporary keys kept an extra copy of the server key, and connections with temporary keys did not free everything in case of an error.

{\itshape Bodo Moeller}
\item New function RSA\+\_\+check\+\_\+key and new openssl rsa option -\/check for verifying the consistency of RSA keys.

{\itshape Ulf Moeller, Bodo Moeller}
\item Various changes to make Win32 compile work\+:
\begin{DoxyEnumerate}
\item Casts to avoid "{}loss of data"{} warnings in p5\+\_\+crpt2.\+c
\item Change unsigned int to int in b\+\_\+dump.\+c to avoid "{}signed/unsigned       comparison"{} warnings.
\item Add {\ttfamily sk\+\_\+\texorpdfstring{$<$}{<}TYPE\texorpdfstring{$>$}{>}\+\_\+sort} to DEF file generator and do make update.
\end{DoxyEnumerate}

{\itshape Steve Henson}
\item Add a debugging option to PKCS\#5 v2 key generation function\+: when you define DEBUG\+\_\+\+PKCS5\+V2 passwords, salts, iteration counts and derived keys are printed to stderr.

{\itshape Steve Henson}
\item Copy the flags in ASN1\+\_\+\+STRING\+\_\+dup().

\texorpdfstring{$\ast$}{*}\+Roman E. Pavlov \href{mailto:pre@mo.msk.ru}{\texttt{ pre@mo.\+msk.\+ru}}\texorpdfstring{$\ast$}{*}
\item The x509 application mishandled signing requests containing DSA keys when the signing key was also DSA and the parameters didn\textquotesingle{}t match.

It was supposed to omit the parameters when they matched the signing key\+: the verifying software was then supposed to automatically use the CA\textquotesingle{}s parameters if they were absent from the end user certificate.

Omitting parameters is no longer recommended. The test was also the wrong way round! This was probably due to unusual behaviour in EVP\+\_\+cmp\+\_\+parameters() which returns 1 if the parameters match. This meant that parameters were omitted when they {\itshape didn\textquotesingle{}t} match and the certificate was useless. Certificates signed with \textquotesingle{}ca\textquotesingle{} didn\textquotesingle{}t have this bug.

\texorpdfstring{$\ast$}{*}\+Steve Henson, reported by Doug Erickson \href{mailto:Doug.Erickson@Part.NET}{\texttt{ Doug.\+Erickson@\+Part.\+NET}}\texorpdfstring{$\ast$}{*}
\item Memory leak checking (-\/DCRYPTO\+\_\+\+MDEBUG) had some problems. The interface is as follows\+: Applications can use CRYPTO\+\_\+mem\+\_\+ctrl(\+CRYPTO\+\_\+\+MEM\+\_\+\+CHECK\+\_\+\+ON) aka Mem\+Check\+\_\+start(), CRYPTO\+\_\+mem\+\_\+ctrl(\+CRYPTO\+\_\+\+MEM\+\_\+\+CHECK\+\_\+\+OFF) aka Mem\+Check\+\_\+stop(); "{}off"{} is now the default. The library internally uses CRYPTO\+\_\+mem\+\_\+ctrl(\+CRYPTO\+\_\+\+MEM\+\_\+\+CHECK\+\_\+\+DISABLE) aka Mem\+Check\+\_\+off(), CRYPTO\+\_\+mem\+\_\+ctrl(\+CRYPTO\+\_\+\+MEM\+\_\+\+CHECK\+\_\+\+ENABLE) aka Mem\+Check\+\_\+on() to disable memory-\/checking temporarily.

Some inconsistent states that previously were possible (and were even the default) are now avoided.

-\/DCRYPTO\+\_\+\+MDEBUG\+\_\+\+TIME is new and additionally stores the current time with each memory chunk allocated; this is occasionally more helpful than just having a counter.

-\/DCRYPTO\+\_\+\+MDEBUG\+\_\+\+THREAD is also new and adds the thread ID.

-\/DCRYPTO\+\_\+\+MDEBUG\+\_\+\+ALL enables all of the above, plus any future extensions.

{\itshape Bodo Moeller}
\item Introduce "{}mode"{} for SSL structures (with defaults in SSL\+\_\+\+CTX), which largely parallels "{}options"{}, but is for changing API behaviour, whereas "{}options"{} are about protocol behaviour. Initial "{}mode"{} flags are\+:

SSL\+\_\+\+MODE\+\_\+\+ENABLE\+\_\+\+PARTIAL\+\_\+\+WRITE Allow SSL\+\_\+write to report success when a single record has been written. SSL\+\_\+\+MODE\+\_\+\+ACCEPT\+\_\+\+MOVING\+\_\+\+WRITE\+\_\+\+BUFFER Don\textquotesingle{}t insist that SSL\+\_\+write retries use the same buffer location. (But all of the contents must be copied!)

{\itshape Bodo Moeller}
\item Bugfix\+: SSL\+\_\+set\+\_\+options ignored its parameter, only SSL\+\_\+\+CTX\+\_\+set\+\_\+options worked.
\item Fix problems with no-\/hmac etc.

\texorpdfstring{$\ast$}{*}\+Ulf Möller, pointed out by Brian Wellington \href{mailto:bwelling@tislabs.com}{\texttt{ bwelling@tislabs.\+com}}\texorpdfstring{$\ast$}{*}
\item New functions RSA\+\_\+get\+\_\+default\+\_\+method(), RSA\+\_\+set\+\_\+method() and RSA\+\_\+get\+\_\+method(). These allows replacement of RSA\+\_\+\+METHODs without having to mess around with the internals of an RSA structure.

{\itshape Steve Henson}
\item Fix memory leaks in DSA\+\_\+do\+\_\+sign and DSA\+\_\+is\+\_\+prime. Also really enable memory leak checks in openssl.\+c and in some test programs.

{\itshape Chad C. Mulligan, Bodo Moeller}
\item Fix a bug in d2i\+\_\+\+ASN1\+\_\+\+INTEGER() and i2d\+\_\+\+ASN1\+\_\+\+INTEGER() which can mess up the length of negative integers. This has now been simplified to just store the length when it is first determined and use it later, rather than trying to keep track of where data is copied and updating it to point to the end. \texorpdfstring{$\ast$}{*}\+Steve Henson, reported by Brien Wheeler \href{mailto:bwheeler@authentica-security.com}{\texttt{ bwheeler@authentica-\/security.\+com}}\texorpdfstring{$\ast$}{*}
\item Add a new function PKCS7\+\_\+signature\+Verify. This allows the verification of a PKCS\#7 signature but with the signing certificate passed to the function itself. This contrasts with PKCS7\+\_\+data\+Verify which assumes the certificate is present in the PKCS\#7 structure. This isn\textquotesingle{}t always the case\+: certificates can be omitted from a PKCS\#7 structure and be distributed by "{}out of band"{} means (such as a certificate database).

{\itshape Steve Henson}
\item Complete the {\ttfamily PEM\+\_\+\texorpdfstring{$\ast$}{*}} macros with DECLARE\+\_\+\+PEM versions to replace the function prototypes in pem.\+h, also change util/mkdef.\+pl to add the necessary function names.

{\itshape Steve Henson}
\item mk1mf.\+pl (used by Windows builds) did not properly read the options set by Configure in the top level Makefile, and Configure was not even able to write more than one option correctly. Fixed, now "{}no-\/idea no-\/rc5 -\/\+DCRYPTO\+\_\+\+MDEBUG"{} etc. works as intended.

{\itshape Bodo Moeller}
\item New functions CONF\+\_\+load\+\_\+bio() and CONF\+\_\+load\+\_\+fp() to allow a config file to be loaded from a BIO or FILE pointer. The BIO version will for example allow memory BIOs to contain config info.

{\itshape Steve Henson}
\item New function "{}\+CRYPTO\+\_\+num\+\_\+locks"{} that returns CRYPTO\+\_\+\+NUM\+\_\+\+LOCKS. Whoever hopes to achieve shared-\/library compatibility across versions must use this, not the compile-\/time macro. (Exercise 0.\+9.\+4\+: Which is the minimum library version required by such programs?) Note\+: All this applies only to multi-\/threaded programs, others don\textquotesingle{}t need locks.

{\itshape Bodo Moeller}
\item Add missing case to s3\+\_\+clnt.\+c state machine -- one of the new SSL tests through a BIO pair triggered the default case, i.\+e. SSLerr(...,\+SSL\+\_\+\+R\+\_\+\+UNKNOWN\+\_\+\+STATE).

{\itshape Bodo Moeller}
\item New "{}\+BIO pair"{} concept (crypto/bio/bss\+\_\+bio.\+c) so that applications can use the SSL library even if none of the specific BIOs is appropriate.

{\itshape Bodo Moeller}
\item Fix a bug in i2d\+\_\+\+DSAPublic\+Key() which meant it returned the wrong value for the encoded length.

\texorpdfstring{$\ast$}{*}\+Jeon Kyoung\+Ho \href{mailto:khjeon@sds.samsung.co.kr}{\texttt{ khjeon@sds.\+samsung.\+co.\+kr}}\texorpdfstring{$\ast$}{*}
\item Add initial documentation of the X509\+V3 functions.

{\itshape Steve Henson}
\item Add a new pair of functions PEM\+\_\+write\+\_\+\+PKCS8\+Private\+Key() and PEM\+\_\+write\+\_\+bio\+\_\+\+PKCS8\+Private\+Key() that are equivalent to PEM\+\_\+write\+\_\+\+Private\+Key() and PEM\+\_\+write\+\_\+bio\+\_\+\+Private\+Key() but use the more secure PKCS\#8 private key format with a high iteration count.

{\itshape Steve Henson}
\item Fix determination of Perl interpreter\+: A perl or perl5 {\itshape directory} in \$\+PATH was also accepted as the interpreter.

{\itshape Ralf S. Engelschall}
\item Fix demos/sign/sign.\+c\+: well there wasn\textquotesingle{}t anything strictly speaking wrong with it but it was very old and did things like calling PEM\+\_\+\+ASN1\+\_\+read() directly and used MD5 for the hash not to mention some unusual formatting.

{\itshape Steve Henson}
\item Fix demos/selfsign.\+c\+: it used obsolete and deleted functions, changed to use the new extension code.

{\itshape Steve Henson}
\item Implement the PEM\+\_\+read/\+PEM\+\_\+write functions in crypto/pem/pem\+\_\+all.\+c with macros. This should make it easier to change their form, add extra arguments etc. Fix a few PEM prototypes which didn\textquotesingle{}t have cipher as a constant.

{\itshape Steve Henson}
\item Add to configuration table a new entry that can specify an alternative name for unistd.\+h (for pre-\/\+POSIX systems); we need this for Ne\+XTstep, according to Mark Crispin \href{mailto:MRC@Panda.COM}{\texttt{ MRC@\+Panda.\+COM}}.

{\itshape Bodo Moeller}
\item DES CBC did not update the IV. Weird.

{\itshape Ben Laurie} lse des\+\_\+cbc\+\_\+encrypt does not update the IV, but des\+\_\+ncbc\+\_\+encrypt does. Changing the behaviour of the former might break existing programs -- where IV updating is needed, des\+\_\+ncbc\+\_\+encrypt can be used. ndif
\item When bntest is run from "{}make test"{} it drives bc to check its calculations, as well as internally checking them. If an internal check fails, it needs to cause bc to give a non-\/zero result or make test carries on without noticing the failure. Fixed.

{\itshape Ben Laurie}
\item DES library cleanups.

{\itshape Ulf Möller}
\item Add support for PKCS\#5 v2.\+0 PBE algorithms. This will permit PKCS\#8 to be used with any cipher unlike PKCS\#5 v1.\+5 which can at most handle 64 bit ciphers. NOTE\+: although the key derivation function has been verified against some published test vectors it has not been extensively tested yet. Added a -\/v2 "{}cipher"{} option to pkcs8 application to allow the use of v2.\+0.

{\itshape Steve Henson}
\item Instead of "{}mkdir -\/p"{}, which is not fully portable, use new Perl script "{}util/mkdir-\/p.\+pl"{}.

{\itshape Bodo Moeller}
\item Rewrite the way password based encryption (PBE) is handled. It used to assume that the ASN1 Algorithm\+Identifier parameter was a PBEParameter structure. This was true for the PKCS\#5 v1.\+5 and PKCS\#12 PBE algorithms but doesn\textquotesingle{}t apply to PKCS\#5 v2.\+0 where it can be something else. Now the \textquotesingle{}parameter\textquotesingle{} field of the Algorithm\+Identifier is passed to the underlying key generation function so it must do its own ASN1 parsing. This has also changed the EVP\+\_\+\+PBE\+\_\+\+Cipher\+Init() function which now has a \textquotesingle{}parameter\textquotesingle{} argument instead of literal salt and iteration count values and the function EVP\+\_\+\+PBE\+\_\+\+ALGOR\+\_\+\+Cipher\+Init() has been deleted.

{\itshape Steve Henson}
\item Support for PKCS\#5 v1.\+5 compatible password based encryption algorithms and PKCS\#8 functionality. New \textquotesingle{}pkcs8\textquotesingle{} application linked to openssl. Needed to change the PEM\+\_\+\+STRING\+\_\+\+EVP\+\_\+\+PKEY value which was just "{}\+PRIVATE    KEY"{} because this clashed with PKCS\#8 unencrypted string. Since this value was just used as a "{}magic string"{} and not used directly its value doesn\textquotesingle{}t matter.

{\itshape Steve Henson}
\item Introduce some semblance of const correctness to BN. Shame C doesn\textquotesingle{}t support mutable.

{\itshape Ben Laurie}
\item "{}linux-\/sparc64"{} configuration (ultrapenguin).

\texorpdfstring{$\ast$}{*}\+Ray Miller \href{mailto:ray.miller@oucs.ox.ac.uk}{\texttt{ ray.\+miller@oucs.\+ox.\+ac.\+uk}}\texorpdfstring{$\ast$}{*} "{}linux-\/sparc"{} configuration.

\texorpdfstring{$\ast$}{*}\+Christian Forster \href{mailto:fo@hawo.stw.uni-erlangen.de}{\texttt{ fo@hawo.\+stw.\+uni-\/erlangen.\+de}}\texorpdfstring{$\ast$}{*}
\item config now generates no-\/xxx options for missing ciphers.

{\itshape Ulf Möller}
\item Support the EBCDIC character set (work in progress). File ebcdic.\+c not yet included because it has a different license.

\texorpdfstring{$\ast$}{*}\+Martin Kraemer \href{mailto:Martin.Kraemer@MchP.Siemens.De}{\texttt{ Martin.\+Kraemer@\+Mch\+P.\+Siemens.\+De}}\texorpdfstring{$\ast$}{*}
\item Support BS2000/\+OSD-\/\+POSIX.

\texorpdfstring{$\ast$}{*}\+Martin Kraemer \href{mailto:Martin.Kraemer@MchP.Siemens.De}{\texttt{ Martin.\+Kraemer@\+Mch\+P.\+Siemens.\+De}}\texorpdfstring{$\ast$}{*}
\item Make callbacks for key generation use {\ttfamily void \texorpdfstring{$\ast$}{*}} instead of {\ttfamily char \texorpdfstring{$\ast$}{*}}.

{\itshape Ben Laurie}
\item Make S/\+MIME samples compile (not yet tested).

{\itshape Ben Laurie}
\item Additional typesafe stacks.

{\itshape Ben Laurie}
\item New configuration variants "{}bsdi-\/elf-\/gcc"{} (BSD/\+OS 4.\+x).

{\itshape Bodo Moeller}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md166}{}\doxysubsection{\texorpdfstring{Changes between 0.\+9.\+3 and 0.\+9.\+3a \mbox{[}29 May 1999\mbox{]}}{Changes between 0.\+9.\+3 and 0.\+9.\+3a \mbox{[}29 May 1999\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md166}

\begin{DoxyItemize}
\item New configuration variant "{}sco5-\/gcc"{}.
\item Updated some demos.

{\itshape Sean O Riordain, Wade Scholine}
\item Add missing BIO\+\_\+free at exit of pkcs12 application.

{\itshape Wu Zhigang}
\item Fix memory leak in conf.\+c.

{\itshape Steve Henson}
\item Updates for Win32 to assembler version of MD5.

{\itshape Steve Henson}
\item Set \#! path to perl in {\ttfamily apps/der\+\_\+chop} to where we found it instead of using a fixed path.

{\itshape Bodo Moeller}
\item SHA library changes for irix64-\/mips4-\/cc.

{\itshape Andy Polyakov}
\item Improvements for VMS support.

{\itshape Richard Levitte}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md167}{}\doxysubsection{\texorpdfstring{Changes between 0.\+9.\+2b and 0.\+9.\+3 \mbox{[}24 May 1999\mbox{]}}{Changes between 0.\+9.\+2b and 0.\+9.\+3 \mbox{[}24 May 1999\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md167}

\begin{DoxyItemize}
\item Bignum library bug fix. IRIX 6 passes "{}make test"{} now! This also avoids the problems with SC4.\+2 and unpatched SC5.

\texorpdfstring{$\ast$}{*}\+Andy Polyakov \href{mailto:appro@fy.chalmers.se}{\texttt{ appro@fy.\+chalmers.\+se}}\texorpdfstring{$\ast$}{*}
\item New functions sk\+\_\+num, sk\+\_\+value and sk\+\_\+set to replace the previous macros. These are required because of the typesafe stack would otherwise break existing code. If old code used a structure member which used to be STACK and is now STACK\+\_\+\+OF (for example cert in a PKCS7\+\_\+\+SIGNED structure) with sk\+\_\+num or sk\+\_\+value it would produce an error because the num, data members are not present in STACK\+\_\+\+OF. Now it just produces a warning. sk\+\_\+set replaces the old method of assigning a value to sk\+\_\+value (e.\+g. sk\+\_\+value(x, i) = y) which the library used in a few cases. Any code that does this will no longer work (and should use sk\+\_\+set instead) but this could be regarded as a "{}questionable"{} behaviour anyway.

{\itshape Steve Henson}
\item Fix most of the other PKCS\#7 bugs. The "{}experimental"{} code can now correctly handle encrypted S/\+MIME data.

{\itshape Steve Henson}
\item Change type of various DES function arguments from des\+\_\+cblock (which means, in function argument declarations, pointer to char) to des\+\_\+cblock \texorpdfstring{$\ast$}{*} (meaning pointer to array with 8 char elements), which allows the compiler to do more typechecking; it was like that back in SSLeay, but with lots of ugly casts.

Introduce new type const\+\_\+des\+\_\+cblock.

{\itshape Bodo Moeller}
\item Reorganise the PKCS\#7 library and get rid of some of the more obvious problems\+: find Recipient\+Info structure that matches recipient certificate and initialise the ASN1 structures properly based on passed cipher.

{\itshape Steve Henson}
\item Belatedly make the BN tests actually check the results.

{\itshape Ben Laurie}
\item Fix the encoding and decoding of negative ASN1 INTEGERS and conversion to and from BNs\+: it was completely broken. New compilation option NEG\+\_\+\+PUBKEY\+\_\+\+BUG to allow for some broken certificates that encode public key elements as negative integers.

{\itshape Steve Henson}
\item Reorganize and speed up MD5.

\texorpdfstring{$\ast$}{*}\+Andy Polyakov \href{mailto:appro@fy.chalmers.se}{\texttt{ appro@fy.\+chalmers.\+se}}\texorpdfstring{$\ast$}{*}
\item VMS support.

\texorpdfstring{$\ast$}{*}\+Richard Levitte \href{mailto:richard@levitte.org}{\texttt{ richard@levitte.\+org}}\texorpdfstring{$\ast$}{*}
\item New option -\/out to asn1parse to allow the parsed structure to be output to a file. This is most useful when combined with the -\/strparse option to examine the output of things like OCTET STRINGS.

{\itshape Steve Henson}
\item Make SSL library a little more fool-\/proof by not requiring any longer that {\ttfamily SSL\+\_\+set\+\_\+\{accept,connect\}\+\_\+state} be called before {\ttfamily SSL\+\_\+\{accept,connect\}} may be used ({\ttfamily SSL\+\_\+set\+\_\+...\+\_\+state} is omitted in many applications because usually everything {\itshape appeared} to work as intended anyway -- now it really works as intended).

{\itshape Bodo Moeller}
\item Move openssl.\+cnf out of lib/.

{\itshape Ulf Möller}
\item Fix various things to let Open\+SSL even pass "{}egcc -\/pipe -\/\+O2 -\/\+Wall    -\/\+Wshadow -\/\+Wpointer-\/arith -\/\+Wcast-\/align -\/\+Wmissing-\/prototypes    -\/\+Wmissing-\/declarations -\/\+Wnested-\/externs -\/\+Winline"{} with EGCS 1.\+1.\+2+

{\itshape Ralf S. Engelschall}
\item Various fixes to the EVP and PKCS\#7 code. It may now be able to handle PKCS\#7 enveloped data properly.

\texorpdfstring{$\ast$}{*}\+Sebastian Akerman \href{mailto:sak@parallelconsulting.com}{\texttt{ sak@parallelconsulting.\+com}}, modified by Steve\texorpdfstring{$\ast$}{*}
\item Create a duplicate of the SSL\+\_\+\+CTX\textquotesingle{}s CERT in SSL\+\_\+new instead of copying pointers. The \doxylink{structcert__st}{cert\+\_\+st} handling is changed by this in various ways (and thus what used to be known as ctx-\/\texorpdfstring{$>$}{>}default\+\_\+cert is now called ctx-\/\texorpdfstring{$>$}{>}cert, since we don\textquotesingle{}t resort to {\ttfamily s-\/\texorpdfstring{$>$}{>}ctx-\/\texorpdfstring{$>$}{>}\mbox{[}default\+\_\+\mbox{]}cert} any longer when s-\/\texorpdfstring{$>$}{>}cert does not give us what we need). ssl\+\_\+cert\+\_\+instantiate becomes obsolete by this change. As soon as we\textquotesingle{}ve got the new code right (possibly it already is?), we have solved a couple of bugs of the earlier code where s-\/\texorpdfstring{$>$}{>}cert was used as if it could not have been shared with other SSL structures.

Note that using the SSL API in certain dirty ways now will result in different behaviour than observed with earlier library versions\+: Changing settings for an {\ttfamily SSL\+\_\+\+CTX \texorpdfstring{$\ast$}{*}ctx} after having done s = SSL\+\_\+new(ctx) does not influence s as it used to.

In order to clean up things more thoroughly, inside SSL\+\_\+\+SESSION we don\textquotesingle{}t use CERT any longer, but a new structure SESS\+\_\+\+CERT that holds per-\/session data (if available); currently, this is the peer\textquotesingle{}s certificate chain and, for clients, the server\textquotesingle{}s certificate and temporary key. CERT holds only those values that can have meaningful defaults in an SSL\+\_\+\+CTX.

{\itshape Bodo Moeller}
\item New function X509\+V3\+\_\+\+EXT\+\_\+i2d() to create an X509\+\_\+\+EXTENSION structure from the internal representation. Various PKCS\#7 fixes\+: remove some evil casts and set the enc\+\_\+dig\+\_\+alg field properly based on the signing key type.

{\itshape Steve Henson}
\item Allow PKCS\#12 password to be set from the command line or the environment. Let \textquotesingle{}ca\textquotesingle{} get its config file name from the environment variables "{}\+OPENSSL\+\_\+\+CONF"{} or "{}\+SSLEAY\+\_\+\+CONF"{} (for consistency with \textquotesingle{}req\textquotesingle{} and \textquotesingle{}x509\textquotesingle{}).

{\itshape Steve Henson}
\item Allow certificate policies extension to use an IA5\+STRING for the organization field. This is contrary to the PKIX definition but Veri\+Sign uses it and IE5 only recognises this form. Document \textquotesingle{}x509\textquotesingle{} extension option.

{\itshape Steve Henson}
\item Add PEDANTIC compiler flag to allow compilation with gcc -\/pedantic, without disallowing inline assembler and the like for non-\/pedantic builds.

{\itshape Ben Laurie}
\item Support Borland C++ builder.

\texorpdfstring{$\ast$}{*}\+Janez Jere \href{mailto:jj@void.si}{\texttt{ jj@void.\+si}}, modified by Ulf Möller\texorpdfstring{$\ast$}{*}
\item Support Mingw32.

{\itshape Ulf Möller}
\item SHA-\/1 cleanups and performance enhancements.

\texorpdfstring{$\ast$}{*}\+Andy Polyakov \href{mailto:appro@fy.chalmers.se}{\texttt{ appro@fy.\+chalmers.\+se}}\texorpdfstring{$\ast$}{*}
\item Sparc v8plus assembler for the bignum library.

\texorpdfstring{$\ast$}{*}\+Andy Polyakov \href{mailto:appro@fy.chalmers.se}{\texttt{ appro@fy.\+chalmers.\+se}}\texorpdfstring{$\ast$}{*}
\item Accept any -\/xxx and +xxx compiler options in Configure.

{\itshape Ulf Möller}
\item Update HPUX configuration.

{\itshape Anonymous}
\item Add missing {\ttfamily sk\+\_\+\texorpdfstring{$<$}{<}type\texorpdfstring{$>$}{>}\+\_\+unshift()} function to \doxylink{safestack_8h_source}{safestack.\+h}

{\itshape Ralf S. Engelschall}
\item New function SSL\+\_\+\+CTX\+\_\+use\+\_\+certificate\+\_\+chain\+\_\+file that sets the "{}extra\+\_\+cert"{}s in addition to the certificate. (This makes sense only for "{}\+PEM"{} format files, as chains as a whole are not DER-\/encoded.)

{\itshape Bodo Moeller}
\item Support verify\+\_\+depth from the SSL API. x509\+\_\+vfy.\+c had what can be considered an off-\/by-\/one-\/error\+: Its depth (which was not part of the external interface) was actually counting the number of certificates in a chain; now it really counts the depth.

{\itshape Bodo Moeller}
\item Bugfix in crypto/x509/x509\+\_\+cmp.\+c\+: The SSLerr macro was used instead of X509err, which often resulted in confusing error messages since the error codes are not globally unique (e.\+g. an alleged error in ssl3\+\_\+accept when a certificate didn\textquotesingle{}t match the private key).
\item New function SSL\+\_\+\+CTX\+\_\+set\+\_\+session\+\_\+id\+\_\+context that allows to set a default value (so that you don\textquotesingle{}t need SSL\+\_\+set\+\_\+session\+\_\+id\+\_\+context for each connection using the SSL\+\_\+\+CTX).

{\itshape Bodo Moeller}
\item OAEP decoding bug fix.

{\itshape Ulf Möller}
\item Support INSTALL\+\_\+\+PREFIX for package builders, as proposed by David Harris.

{\itshape Bodo Moeller}
\item New Configure options "{}threads"{} and "{}no-\/threads"{}. For systems where the proper compiler options are known (currently Solaris and Linux), "{}threads"{} is the default.

{\itshape Bodo Moeller}
\item New script util/mklink.\+pl as a faster substitute for util/mklink.\+sh.

{\itshape Bodo Moeller}
\item Install various scripts to /misc, not to /bin -- they shouldn\textquotesingle{}t clutter directories such as /usr/local/bin.

{\itshape Bodo Moeller}
\item "{}make linux-\/shared"{} to build shared libraries.

\texorpdfstring{$\ast$}{*}\+Niels Poppe \href{mailto:niels@netbox.org}{\texttt{ niels@netbox.\+org}}\texorpdfstring{$\ast$}{*}
\item New Configure option {\ttfamily no-\/\texorpdfstring{$<$}{<}cipher\texorpdfstring{$>$}{>}} (rsa, idea, rc5, ...).

{\itshape Ulf Möller}
\item Add the PKCS\#12 API documentation to openssl.\+txt. Preliminary support for extension adding in x509 utility.

{\itshape Steve Henson}
\item Remove NOPROTO sections and error code comments.

{\itshape Ulf Möller}
\item Partial rewrite of the DEF file generator to now parse the ANSI prototypes.

{\itshape Steve Henson}
\item New Configure options --prefix=DIR and --openssldir=DIR.

{\itshape Ulf Möller}
\item Complete rewrite of the error code script(s). It is all now handled by one script at the top level which handles error code gathering, header rewriting and C source file generation. It should be much better than the old method\+: it now uses a modified version of Ulf\textquotesingle{}s parser to read the ANSI prototypes in all header files (thus the old K\&R definitions aren\textquotesingle{}t needed for error creation any more) and do a better job of translating function codes into names. The old \textquotesingle{}ASN1 error code embedded in a comment\textquotesingle{} is no longer necessary and it doesn\textquotesingle{}t use .err files which have now been deleted. Also the error code call doesn\textquotesingle{}t have to appear all on one line (which resulted in some large lines...).

{\itshape Steve Henson}
\item Change include filenames from {\ttfamily \texorpdfstring{$<$}{<}foo.\+h\texorpdfstring{$>$}{>}} to {\ttfamily \texorpdfstring{$<$}{<}openssl/foo.\+h\texorpdfstring{$>$}{>}}.

{\itshape Bodo Moeller}
\item Change behaviour of ssl2\+\_\+read when facing length-\/0 packets\+: Don\textquotesingle{}t return 0 (which usually indicates a closed connection), but continue reading.

{\itshape Bodo Moeller}
\item Fix some race conditions.

{\itshape Bodo Moeller}
\item Add support for CRL distribution points extension. Add Certificate Policies and CRL distribution points documentation.

{\itshape Steve Henson}
\item Move the autogenerated header file parts to crypto/opensslconf.\+h.

{\itshape Ulf Möller}
\item Fix new 56-\/bit DES export ciphersuites\+: they were using 7 bytes instead of 8 of keying material. Merlin has also confirmed interop with this fix between Open\+SSL and Baltimore C/\+SSL 2.\+0 and J/\+SSL 2.\+0.

\texorpdfstring{$\ast$}{*}\+Merlin Hughes \href{mailto:merlin@baltimore.ie}{\texttt{ merlin@baltimore.\+ie}}\texorpdfstring{$\ast$}{*}
\item Fix lots of warnings.

\texorpdfstring{$\ast$}{*}\+Richard Levitte \href{mailto:levitte@stacken.kth.se}{\texttt{ levitte@stacken.\+kth.\+se}}\texorpdfstring{$\ast$}{*}
\item In add\+\_\+cert\+\_\+dir() in crypto/x509/by\+\_\+dir.\+c, break out of the loop if the directory spec didn\textquotesingle{}t end with a LIST\+\_\+\+SEPARATOR\+\_\+\+CHAR.

\texorpdfstring{$\ast$}{*}\+Richard Levitte \href{mailto:levitte@stacken.kth.se}{\texttt{ levitte@stacken.\+kth.\+se}}\texorpdfstring{$\ast$}{*}
\item Fix problems with sizeof(long) == 8.

\texorpdfstring{$\ast$}{*}\+Andy Polyakov \href{mailto:appro@fy.chalmers.se}{\texttt{ appro@fy.\+chalmers.\+se}}\texorpdfstring{$\ast$}{*}
\item Change functions to ANSI C.

{\itshape Ulf Möller}
\item Fix typos in error codes.

\texorpdfstring{$\ast$}{*}\+Martin Kraemer \href{mailto:Martin.Kraemer@MchP.Siemens.De}{\texttt{ Martin.\+Kraemer@\+Mch\+P.\+Siemens.\+De}}, Ulf Möller\texorpdfstring{$\ast$}{*}
\item Remove defunct assembler files from Configure.

{\itshape Ulf Möller}
\item SPARC v8 assembler BIGNUM implementation.

\texorpdfstring{$\ast$}{*}\+Andy Polyakov \href{mailto:appro@fy.chalmers.se}{\texttt{ appro@fy.\+chalmers.\+se}}\texorpdfstring{$\ast$}{*}
\item Support for Certificate Policies extension\+: both print and set. Various additions to support the r2i method this uses.

{\itshape Steve Henson}
\item A lot of constification, and fix a bug in X509\+\_\+\+NAME\+\_\+oneline() that could return a const string when you are expecting an allocated buffer.

{\itshape Ben Laurie}
\item Add support for ASN1 types UTF8\+String and VISIBLESTRING, also the CHOICE types Directory\+String and Display\+Text.

{\itshape Steve Henson}
\item Add code to allow r2i extensions to access the configuration database, add an LHASH database driver and add several ctx helper functions.

{\itshape Steve Henson}
\item Fix an evil bug in bn\+\_\+expand2() which caused various BN functions to fail when they extended the size of a BIGNUM.

{\itshape Steve Henson}
\item Various utility functions to handle SXNet extension. Modify mkdef.\+pl to support typesafe stack.

{\itshape Steve Henson}
\item Fix typo in SSL\+\_\+\mbox{[}gs\mbox{]}et\+\_\+options().

\texorpdfstring{$\ast$}{*}\+Nils Frostberg \href{mailto:nils@medcom.se}{\texttt{ nils@medcom.\+se}}\texorpdfstring{$\ast$}{*}
\item Delete various functions and files that belonged to the (now obsolete) old X509\+V3 handling code.

{\itshape Steve Henson}
\item New Configure option "{}rsaref"{}.

{\itshape Ulf Möller}
\item Don\textquotesingle{}t auto-\/generate pem.\+h.

{\itshape Bodo Moeller}
\item Introduce type-\/safe ASN.\+1 SETs.

{\itshape Ben Laurie}
\item Convert various additional casted stacks to type-\/safe STACK\+\_\+\+OF() variants.

{\itshape Ben Laurie, Ralf S. Engelschall, Steve Henson}
\item Introduce type-\/safe STACKs. This will almost certainly break lots of code that links with Open\+SSL (well at least cause lots of warnings), but fear not\+: the conversion is trivial, and it eliminates loads of evil casts. A few STACKed things have been converted already. Feel free to convert more. In the fullness of time, I\textquotesingle{}ll do away with the STACK type altogether.

{\itshape Ben Laurie}
\item Add {\ttfamily openssl ca -\/revoke \texorpdfstring{$<$}{<}certfile\texorpdfstring{$>$}{>}} facility which revokes a certificate specified in {\ttfamily \texorpdfstring{$<$}{<}certfile\texorpdfstring{$>$}{>}} by updating the entry in the index.\+txt file. This way one no longer has to edit the index.\+txt file manually for revoking a certificate. The -\/revoke option does the gory details now.

\texorpdfstring{$\ast$}{*}\+Massimiliano Pala \href{mailto:madwolf@openca.org}{\texttt{ madwolf@openca.\+org}}, Ralf S. Engelschall\texorpdfstring{$\ast$}{*}
\item Fix {\ttfamily openssl crl -\/noout -\/text} combination where {\ttfamily -\/noout} killed the {\ttfamily -\/text} option at all and this way the {\ttfamily -\/noout -\/text} combination was inconsistent in {\ttfamily openssl crl} with the friends in {\ttfamily openssl x509\texorpdfstring{$\vert$}{|}rsa\texorpdfstring{$\vert$}{|}dsa}.

{\itshape Ralf S. Engelschall}
\item Make sure a corresponding plain text error message exists for the X509\+\_\+\+V\+\_\+\+ERR\+\_\+\+CERT\+\_\+\+REVOKED/23 error number which can occur when a verify callback function determined that a certificate was revoked.

{\itshape Ralf S. Engelschall}
\item Bugfix\+: In test/testenc, don\textquotesingle{}t test {\ttfamily openssl \texorpdfstring{$<$}{<}cipher\texorpdfstring{$>$}{>}} for ciphers that were excluded, e.\+g. by -\/DNO\+\_\+\+IDEA. Also, test all available ciphers including rc5, which was forgotten until now. In order to let the testing shell script know which algorithms are available, a new (up to now undocumented) command {\ttfamily openssl list-\/cipher-\/commands} is used.

{\itshape Bodo Moeller}
\item Bugfix\+: s\+\_\+client occasionally would sleep in select() when it should have checked SSL\+\_\+pending() first.

{\itshape Bodo Moeller}
\item New functions DSA\+\_\+do\+\_\+sign and DSA\+\_\+do\+\_\+verify to provide access to the raw DSA values prior to ASN.\+1 encoding.

{\itshape Ulf Möller}
\item Tweaks to Configure

\texorpdfstring{$\ast$}{*}\+Niels Poppe \href{mailto:niels@netbox.org}{\texttt{ niels@netbox.\+org}}\texorpdfstring{$\ast$}{*}
\item Add support for PKCS\#5 v2.\+0 ASN1 PBES2 structures. No other support, yet...

{\itshape Steve Henson}
\item New variables  and  in the Makefiles.

{\itshape Ulf Möller}
\item New config option to avoid instructions that are illegal on the 80386. The default code is faster, but requires at least a 486.

{\itshape Ulf Möller}
\item Got rid of old SSL2\+\_\+\+CLIENT\+\_\+\+VERSION (inconsistently used) and SSL2\+\_\+\+SERVER\+\_\+\+VERSION (not used at all) macros, which are now the same as SSL2\+\_\+\+VERSION anyway.

{\itshape Bodo Moeller}
\item New "{}-\/showcerts"{} option for s\+\_\+client.

{\itshape Bodo Moeller}
\item Still more PKCS\#12 integration. Add pkcs12 application to openssl application. Various cleanups and fixes.

{\itshape Steve Henson}
\item More PKCS\#12 integration. Add new pkcs12 directory with Makefile.\+ssl and modify error routines to work internally. Add error codes and PBE init to library startup routines.

{\itshape Steve Henson}
\item Further PKCS\#12 integration. Added password based encryption, PKCS\#8 and packing functions to asn1 and evp. Changed function names and error codes along the way.

{\itshape Steve Henson}
\item PKCS12 integration\+: and so it begins... First of several patches to slowly integrate PKCS\#12 functionality into Open\+SSL. Add PKCS\#12 objects to objects.\+h

{\itshape Steve Henson}
\item Add a new \textquotesingle{}indent\textquotesingle{} option to some X509\+V3 extension code. Initial ASN1 and display support for Thawte strong extranet extension.

{\itshape Steve Henson}
\item Add Linux\+PPC support.

\texorpdfstring{$\ast$}{*}\+Jeff Dubrule \href{mailto:igor@pobox.org}{\texttt{ igor@pobox.\+org}}\texorpdfstring{$\ast$}{*}
\item Get rid of redundant BN file bn\+\_\+mulw.\+c, and rename bn\+\_\+div64 to bn\+\_\+div\+\_\+words in alpha.\+s.

\texorpdfstring{$\ast$}{*}\+Hannes Reinecke \href{mailto:H.Reinecke@hw.ac.uk}{\texttt{ H.\+Reinecke@hw.\+ac.\+uk}} and Ben Laurie\texorpdfstring{$\ast$}{*}
\item Make sure the RSA OAEP test is skipped under -\/DRSAref because OAEP isn\textquotesingle{}t supported when Open\+SSL is built with RSAref.

\texorpdfstring{$\ast$}{*}\+Ulf Moeller \href{mailto:ulf@fitug.de}{\texttt{ ulf@fitug.\+de}}\texorpdfstring{$\ast$}{*}
\item Move definitions of IS\+\_\+\+SET/\+IS\+\_\+\+SEQUENCE inside crypto/asn1/asn1.\+h so they no longer are missing under -\/DNOPROTO.

\texorpdfstring{$\ast$}{*}\+Soren S. Jorvang \href{mailto:soren@t.dk}{\texttt{ soren@t.\+dk}}\texorpdfstring{$\ast$}{*}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md168}{}\doxysubsection{\texorpdfstring{Changes between 0.\+9.\+1c and 0.\+9.\+2b \mbox{[}22 Mar 1999\mbox{]}}{Changes between 0.\+9.\+1c and 0.\+9.\+2b \mbox{[}22 Mar 1999\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md168}

\begin{DoxyItemize}
\item Make SSL\+\_\+get\+\_\+peer\+\_\+cert\+\_\+chain() work in servers. Unfortunately, it still doesn\textquotesingle{}t work when the session is reused. Coming soon!

{\itshape Ben Laurie}
\item Fix a security hole, that allows sessions to be reused in the wrong context thus bypassing client cert protection! All software that uses client certs and session caches in multiple contexts NEEDS PATCHING to allow session reuse! A fuller solution is in the works.

{\itshape Ben Laurie, problem pointed out by Holger Reif, Bodo Moeller (and ???)}
\item Some more source tree cleanups (removed obsolete files crypto/bf/asm/bf586.\+pl, test/test.\+txt and crypto/sha/asm/f.\+s; changed permission on "{}config"{} script to be executable) and a fix for the INSTALL document.

\texorpdfstring{$\ast$}{*}\+Ulf Moeller \href{mailto:ulf@fitug.de}{\texttt{ ulf@fitug.\+de}}\texorpdfstring{$\ast$}{*}
\item Remove some legacy and erroneous uses of malloc, free instead of Malloc, Free.

\texorpdfstring{$\ast$}{*}\+Lennart Bang \href{mailto:lob@netstream.se}{\texttt{ lob@netstream.\+se}}, with minor changes by Steve\texorpdfstring{$\ast$}{*}
\item Make rsa\+\_\+oaep\+\_\+test return non-\/zero on error.

\texorpdfstring{$\ast$}{*}\+Ulf Moeller \href{mailto:ulf@fitug.de}{\texttt{ ulf@fitug.\+de}}\texorpdfstring{$\ast$}{*}
\item Add support for native Solaris shared libraries. Configure solaris-\/sparc-\/sc4-\/pic, make, then run shlib/solaris-\/sc4.\+sh. It\textquotesingle{}d be nice if someone would make that last step automatic.

\texorpdfstring{$\ast$}{*}\+Matthias Loepfe \href{mailto:Matthias.Loepfe@AdNovum.CH}{\texttt{ Matthias.\+Loepfe@\+Ad\+Novum.\+CH}}\texorpdfstring{$\ast$}{*}
\item ctx\+\_\+size was not built with the right compiler during "{}make links"{}. Fixed.

{\itshape Ben Laurie}
\item Change the meaning of \textquotesingle{}ALL\textquotesingle{} in the cipher list. It now means "{}everything    except NULL ciphers"{}. This means the default cipher list will no longer enable NULL ciphers. They need to be specifically enabled e.\+g. with the string "{}\+DEFAULT\+:e\+NULL"{}.

{\itshape Steve Henson}
\item Fix to RSA private encryption routines\+: if p \texorpdfstring{$<$}{<} q then it would occasionally produce an invalid result. This will only happen with externally generated keys because Open\+SSL (and SSLeay) ensure p \texorpdfstring{$>$}{>} q.

{\itshape Steve Henson}
\item Be less restrictive and allow also {\ttfamily perl util/perlpath.\+pl /path/to/bin/perl} in addition to {\ttfamily perl util/perlpath.\+pl /path/to/bin}, because this way one can also use an interpreter named {\ttfamily perl5} (which is usually the name of Perl 5.\+xxx on platforms where an Perl 4.\+x is still installed as {\ttfamily perl}).

\texorpdfstring{$\ast$}{*}\+Matthias Loepfe \href{mailto:Matthias.Loepfe@adnovum.ch}{\texttt{ Matthias.\+Loepfe@adnovum.\+ch}}\texorpdfstring{$\ast$}{*}
\item Let util/clean-\/depend.\+pl work also with older Perl 5.\+00x versions.

\texorpdfstring{$\ast$}{*}\+Matthias Loepfe \href{mailto:Matthias.Loepfe@adnovum.ch}{\texttt{ Matthias.\+Loepfe@adnovum.\+ch}}\texorpdfstring{$\ast$}{*}
\item Fix Makefile.\+org so CC,CFLAG etc are passed to \textquotesingle{}make links\textquotesingle{} add advapi32.\+lib to Win32 build and change the pem test comparison to fc.\+exe (thanks to Ulrich Kroener \href{mailto:kroneru@yahoo.com}{\texttt{ kroneru@yahoo.\+com}} for the suggestion). Fix misplaced ASNI prototypes and declarations in evp.\+h and crypto/des/ede\+\_\+cbcm\+\_\+enc.\+c.

{\itshape Steve Henson}
\item DES quad checksum was broken on big-\/endian architectures. Fixed.

{\itshape Ben Laurie}
\item Comment out two functions in bio.\+h that aren\textquotesingle{}t implemented. Fix up the Win32 test batch file so it (might) work again. The Win32 test batch file is horrible\+: I feel ill....

{\itshape Steve Henson}
\item Move various ifdefs around so NO\+\_\+\+SYSLOG, NO\+\_\+\+DIRENT etc are now selected in \doxylink{e__os_8h_source}{e\+\_\+os.\+h}. Audit of header files to check ANSI and non ANSI sections\+: 10 functions were absent from non ANSI section and not exported from Windows DLLs. Fixed up libeay.\+num for new functions.

{\itshape Steve Henson}
\item Make {\ttfamily openssl version} output lines consistent.

{\itshape Ralf S. Engelschall}
\item Fix Win32 symbol export lists for BIO functions\+: Added BIO\+\_\+get\+\_\+ex\+\_\+new\+\_\+index, BIO\+\_\+get\+\_\+ex\+\_\+num, BIO\+\_\+get\+\_\+ex\+\_\+data and BIO\+\_\+set\+\_\+ex\+\_\+data to ms/libeay\{16,32\}.def.

{\itshape Ralf S. Engelschall}
\item Second round of fixing the Open\+SSL perl/ stuff. It now at least compiled fine under Unix and passes some trivial tests I\textquotesingle{}ve now added. But the whole stuff is horribly incomplete, so a README.\+1\+ST with a disclaimer was added to make sure no one expects that this stuff really works in the Open\+SSL 0.\+9.\+2 release. Additionally I\textquotesingle{}ve started to clean the XS sources up and fixed a few little bugs and inconsistencies in Open\+SSL.\{pm,xs\} and openssl\+\_\+bio.\+xs.

{\itshape Ralf S. Engelschall}
\item Fix the generation of two part addresses in perl.

\texorpdfstring{$\ast$}{*}\+Kenji Miyake \href{mailto:kenji@miyake.org}{\texttt{ kenji@miyake.\+org}}, integrated by Ben Laurie\texorpdfstring{$\ast$}{*}
\item Add config entry for Linux on MIPS.

\texorpdfstring{$\ast$}{*}\+John Tobey \href{mailto:jtobey@channel1.com}{\texttt{ jtobey@channel1.\+com}}\texorpdfstring{$\ast$}{*}
\item Make links whenever Configure is run, unless we are on Windoze.

{\itshape Ben Laurie}
\item Permit extensions to be added to CRLs using crl\+\_\+section in openssl.\+cnf. Currently only issuer\+Alt\+Name and Authority\+Key\+Identifier make any sense in CRLs.

{\itshape Steve Henson}
\item Add a useful kludge to allow package maintainers to specify compiler and other platforms details on the command line without having to patch the Configure script every time\+: One now can use {\ttfamily perl Configure \texorpdfstring{$<$}{<}id\texorpdfstring{$>$}{>}\+:\texorpdfstring{$<$}{<}details\texorpdfstring{$>$}{>}}, i.\+e. platform ids are allowed to have details appended to them (separated by colons). This is treated as there would be a static pre-\/configured entry in Configure\textquotesingle{}s table under key {\ttfamily \texorpdfstring{$<$}{<}id\texorpdfstring{$>$}{>}} with value {\ttfamily \texorpdfstring{$<$}{<}details\texorpdfstring{$>$}{>}} and {\ttfamily perl Configure \texorpdfstring{$<$}{<}id\texorpdfstring{$>$}{>}} is called. So, when you want to perform a quick test-\/compile under Free\+BSD 3.\+1 with pgcc and without assembler stuff you can use {\ttfamily perl Configure "{}\+Free\+BSD-\/elf\+:pgcc\+:-\/\+O6\+:::"{}} now, which overrides the Free\+BSD-\/elf entry on-\/the-\/fly.

{\itshape Ralf S. Engelschall}
\item Disable new TLS1 ciphersuites by default\+: they aren\textquotesingle{}t official yet.

{\itshape Ben Laurie}
\item Allow DSO flags like -\/fpic, -\/f\+PIC, -\/KPIC etc. to be specified on the {\ttfamily perl Configure ...} command line. This way one can compile Open\+SSL libraries with Position Independent Code (PIC) which is needed for linking it into DSOs.

{\itshape Ralf S. Engelschall}
\item Remarkably, export ciphers were totally broken and no-\/one had noticed! Fixed.

{\itshape Ben Laurie}
\item Cleaned up the LICENSE document\+: The official contact for any license questions now is the Open\+SSL core team under \href{mailto:openssl-core@openssl.org}{\texttt{ openssl-\/core@openssl.\+org}}. And add a paragraph about the dual-\/license situation to make sure people recognize that {\itshape BOTH} the Open\+SSL license {\itshape AND} the SSLeay license apply to the Open\+SSL toolkit.

{\itshape Ralf S. Engelschall}
\item General source tree makefile cleanups\+: Made {\ttfamily making xxx in yyy...} display consistent in the source tree and replaced {\ttfamily /bin/rm} by {\ttfamily rm}. Additionally cleaned up the {\ttfamily make links} target\+: Remove unnecessary semicolons, subsequent redundant removes, inline point.\+sh into mklink.\+sh to speed processing and no longer clutter the display with confusing stuff. Instead only the actually done links are displayed.

{\itshape Ralf S. Engelschall}
\item Permit null encryption ciphersuites, used for authentication only. It used to be necessary to set the preprocessor define SSL\+\_\+\+ALLOW\+\_\+\+ENULL to do this. It is now necessary to set SSL\+\_\+\+FORBID\+\_\+\+ENULL to prevent the use of null encryption.

{\itshape Ben Laurie}
\item Add a bunch of fixes to the PKCS\#7 stuff. It used to sometimes reorder signed attributes when verifying signatures (this would break them), the detached data encoding was wrong and public keys obtained using X509\+\_\+get\+\_\+pubkey() weren\textquotesingle{}t freed.

{\itshape Steve Henson}
\item Add text documentation for the BUFFER functions. Also added a work around to a Win95 console bug. This was triggered by the password read stuff\+: the last character typed gets carried over to the next fread(). If you were generating a new cert request using \textquotesingle{}req\textquotesingle{} for example then the last character of the passphrase would be CR which would then enter the first field as blank.

{\itshape Steve Henson}
\item Added the new \textquotesingle{}Includes Open\+SSL Cryptography Software\textquotesingle{} button as doc/openssl\+\_\+button.\{gif,html\} which is similar in style to the old SSLeay button and can be used by applications based on Open\+SSL to show the relationship to the Open\+SSL project.

{\itshape Ralf S. Engelschall}
\item Remove confusing variables in function signatures in files ssl/ssl\+\_\+lib.\+c and \doxylink{openssl_2ssl_8h_source}{ssl/ssl.\+h}.

\texorpdfstring{$\ast$}{*}\+Lennart Bong \href{mailto:lob@kulthea.stacken.kth.se}{\texttt{ lob@kulthea.\+stacken.\+kth.\+se}}\texorpdfstring{$\ast$}{*}
\item Don\textquotesingle{}t install bss\+\_\+file.\+c under PREFIX/include/

\texorpdfstring{$\ast$}{*}\+Lennart Bong \href{mailto:lob@kulthea.stacken.kth.se}{\texttt{ lob@kulthea.\+stacken.\+kth.\+se}}\texorpdfstring{$\ast$}{*}
\item Get the Win32 compile working again. Modify mkdef.\+pl so it can handle functions that return function pointers and has support for NT specific stuff. Fix mk1mf.\+pl and VC-\/32.\+pl to support NT differences also. Various ifdef WIN32 and WINNTs sprinkled about the place and some changes from unsigned to signed types\+: this was killing the Win32 compile.

{\itshape Steve Henson}
\item Add new certificate file to stack functions, SSL\+\_\+add\+\_\+dir\+\_\+cert\+\_\+subjects\+\_\+to\+\_\+stack() and SSL\+\_\+add\+\_\+file\+\_\+cert\+\_\+subjects\+\_\+to\+\_\+stack(). These largely supplant SSL\+\_\+load\+\_\+client\+\_\+\+CA\+\_\+file(), and can be used to add multiple certs easily to a stack (usually this is then handed to SSL\+\_\+\+CTX\+\_\+set\+\_\+client\+\_\+\+CA\+\_\+list()). This means that Apache-\/\+SSL and similar packages don\textquotesingle{}t have to mess around to add as many CAs as they want to the preferred list.

{\itshape Ben Laurie}
\item Experiment with doxygen documentation. Currently only partially applied to ssl/ssl\+\_\+lib.\+c. See \href{http://www.stack.nl/~dimitri/doxygen/index.html}{\texttt{ http\+://www.\+stack.\+nl/\texorpdfstring{$\sim$}{\string~}dimitri/doxygen/index.\+html}}, and run doxygen with openssl.\+doxy as the configuration file.

{\itshape Ben Laurie}
\item Get rid of remaining C++-\/style comments which strict C compilers hate.

{\itshape Ralf S. Engelschall, pointed out by Carlos Amengual}
\item Changed BN\+\_\+\+RECURSION in bn\+\_\+mont.\+c to BN\+\_\+\+RECURSION\+\_\+\+MONT so it is not compiled in by default\+: it has problems with large keys.

{\itshape Steve Henson}
\item Add a bunch of SSL\+\_\+xxx() functions for configuring the temporary RSA and DH private keys and/or callback functions which directly correspond to their SSL\+\_\+\+CTX\+\_\+xxx() counterparts but work on a per-\/connection basis. This is needed for applications which have to configure certificates on a per-\/connection basis (e.\+g. Apache+mod\+\_\+ssl) instead of a per-\/context basis (e.\+g. s\+\_\+server). For the RSA certificate situation is makes no difference, but for the DSA certificate situation this fixes the "{}no shared cipher"{} problem where the Open\+SSL cipher selection procedure failed because the temporary keys were not overtaken from the context and the API provided no way to reconfigure them. The new functions now let applications reconfigure the stuff and they are in detail\+: SSL\+\_\+need\+\_\+tmp\+\_\+\+RSA, SSL\+\_\+set\+\_\+tmp\+\_\+rsa, SSL\+\_\+set\+\_\+tmp\+\_\+dh, SSL\+\_\+set\+\_\+tmp\+\_\+rsa\+\_\+callback and SSL\+\_\+set\+\_\+tmp\+\_\+dh\+\_\+callback. Additionally a new non-\/public-\/\+API function ssl\+\_\+cert\+\_\+instantiate() is used as a helper function and also to reduce code redundancy inside ssl\+\_\+rsa.\+c.

{\itshape Ralf S. Engelschall}
\item Move s\+\_\+server -\/dcert and -\/dkey options out of the undocumented feature area because they are useful for the DSA situation and should be recognized by the users.

{\itshape Ralf S. Engelschall}
\item Fix the cipher decision scheme for export ciphers\+: the export bits are {\itshape not} within SSL\+\_\+\+MKEY\+\_\+\+MASK or SSL\+\_\+\+AUTH\+\_\+\+MASK, they are within SSL\+\_\+\+EXP\+\_\+\+MASK. So, the original variable has to be used instead of the already masked variable.

\texorpdfstring{$\ast$}{*}\+Richard Levitte \href{mailto:levitte@stacken.kth.se}{\texttt{ levitte@stacken.\+kth.\+se}}\texorpdfstring{$\ast$}{*}
\item Fix {\ttfamily port} variable from {\ttfamily int} to {\ttfamily unsigned int} in crypto/bio/b\+\_\+sock.\+c

\texorpdfstring{$\ast$}{*}\+Richard Levitte \href{mailto:levitte@stacken.kth.se}{\texttt{ levitte@stacken.\+kth.\+se}}\texorpdfstring{$\ast$}{*}
\item Change type of another md\+\_\+len variable in pk7\+\_\+doit.\+c\+:PKCS7\+\_\+data\+Final() from {\ttfamily int} to {\ttfamily unsigned int} because it is a length and initialized by EVP\+\_\+\+Digest\+Final() which expects an {\ttfamily unsigned int \texorpdfstring{$\ast$}{*}}.

\texorpdfstring{$\ast$}{*}\+Richard Levitte \href{mailto:levitte@stacken.kth.se}{\texttt{ levitte@stacken.\+kth.\+se}}\texorpdfstring{$\ast$}{*}
\item Don\textquotesingle{}t hard-\/code path to Perl interpreter on shebang line of Configure script. Instead use the usual Shell-\/\texorpdfstring{$>$}{>}Perl transition trick.

{\itshape Ralf S. Engelschall}
\item Make {\ttfamily openssl x509 -\/noout -\/modulus}\textquotesingle{} functional also for DSA certificates (in addition to RSA certificates) to match the behaviour of {\ttfamily openssl dsa -\/noout -\/modulus} as it\textquotesingle{}s already the case for {\ttfamily openssl rsa -\/noout -\/modulus}. For RSA the -\/modulus is the real "{}modulus"{} while for DSA currently the public key is printed (a decision which was already done by {\ttfamily openssl dsa -\/modulus} in the past) which serves a similar purpose. Additionally the NO\+\_\+\+RSA no longer completely removes the whole -\/modulus option; it now only avoids using the RSA stuff. Same applies to NO\+\_\+\+DSA now, too.

{\itshape Ralf S. Engelschall}
\item Add Arne Ansper\textquotesingle{}s reliable BIO -\/ this is an encrypted, block-\/digested BIO. See the source (crypto/evp/bio\+\_\+ok.\+c) for more info.

\texorpdfstring{$\ast$}{*}\+Arne Ansper \href{mailto:arne@ats.cyber.ee}{\texttt{ arne@ats.\+cyber.\+ee}}\texorpdfstring{$\ast$}{*}
\item Dump the old yucky req code that tried (and failed) to allow raw OIDs to be added. Now both \textquotesingle{}req\textquotesingle{} and \textquotesingle{}ca\textquotesingle{} can use new objects defined in the config file.

{\itshape Steve Henson}
\item Add cool BIO that does syslog (or event log on NT).

\texorpdfstring{$\ast$}{*}\+Arne Ansper \href{mailto:arne@ats.cyber.ee}{\texttt{ arne@ats.\+cyber.\+ee}}, integrated by Ben Laurie\texorpdfstring{$\ast$}{*}
\item Add support for new TLS ciphersuites, TLS\+\_\+\+RSA\+\_\+\+EXPORT56\+\_\+\+WITH\+\_\+\+RC4\+\_\+56\+\_\+\+MD5, TLS\+\_\+\+RSA\+\_\+\+EXPORT56\+\_\+\+WITH\+\_\+\+RC2\+\_\+\+CBC\+\_\+56\+\_\+\+MD5 and TLS\+\_\+\+RSA\+\_\+\+EXPORT56\+\_\+\+WITH\+\_\+\+DES\+\_\+\+CBC\+\_\+\+SHA, as specified in "{}56-\/bit Export Cipher    Suites For TLS"{}, draft-\/ietf-\/tls-\/56-\/bit-\/ciphersuites-\/00.\+txt.

{\itshape Ben Laurie}
\item Add preliminary config info for new extension code.

{\itshape Steve Henson}
\item Make RSA\+\_\+\+NO\+\_\+\+PADDING really use no padding.

\texorpdfstring{$\ast$}{*}\+Ulf Moeller \href{mailto:ulf@fitug.de}{\texttt{ ulf@fitug.\+de}}\texorpdfstring{$\ast$}{*}
\item Generate errors when private/public key check is done.

{\itshape Ben Laurie}
\item Overhaul for \textquotesingle{}crl\textquotesingle{} utility. New function X509\+\_\+\+CRL\+\_\+print. Partial support for some CRL extensions and new objects added.

{\itshape Steve Henson}
\item Really fix the ASN1 IMPLICIT bug this time... Partial support for private key usage extension and fuller support for authority key id.

{\itshape Steve Henson}
\item Add OAEP encryption for the Open\+SSL crypto library. OAEP is the improved padding method for RSA, which is recommended for new applications in PKCS \#1 v2.\+0 (RFC 2437, October 1998). OAEP (Optimal Asymmetric Encryption Padding) has better theoretical foundations than the ad-\/hoc padding used in PKCS \#1 v1.\+5. It is secure against Bleichbacher\textquotesingle{}s attack on RSA. \texorpdfstring{$\ast$}{*}\+Ulf Moeller \href{mailto:ulf@fitug.de}{\texttt{ ulf@fitug.\+de}}, reformatted, corrected and integrated by Ben Laurie\texorpdfstring{$\ast$}{*}
\item Updates to the new SSL compression code

{\itshape Eric A. Young, (from changes to C2\+Net SSLeay, integrated by Mark Cox)}
\item Fix so that the version number in the master secret, when passed via RSA, checks that if TLS was proposed, but we roll back to SSLv3 (because the server will not accept higher), that the version number is 0x03,0x01, not 0x03,0x00

{\itshape Eric A. Young, (from changes to C2\+Net SSLeay, integrated by Mark Cox)}
\item Run extensive memory leak checks on SSL commands. Fixed {\itshape lots} of memory leaks in {\ttfamily ssl/} relating to new {\ttfamily X509\+\_\+get\+\_\+pubkey()} behaviour. Also fixes in {\ttfamily apps/} and an unrelated leak in {\ttfamily crypto/dsa/dsa\+\_\+vrf.\+c}.

{\itshape Steve Henson}
\item Support for RAW extensions where an arbitrary extension can be created by including its DER encoding. See {\ttfamily apps/openssl.\+cnf} for an example.

{\itshape Steve Henson}
\item Make sure latest Perl versions don\textquotesingle{}t interpret some generated C array code as Perl array code in the crypto/err/err\+\_\+genc.\+pl script.

\texorpdfstring{$\ast$}{*}\+Lars Weber \href{mailto:3weber@informatik.uni-hamburg.de}{\texttt{ 3weber@informatik.\+uni-\/hamburg.\+de}}\texorpdfstring{$\ast$}{*}
\item Modify ms/do\+\_\+ms.\+bat to not generate assembly language makefiles since not many people have the assembler. Various Win32 compilation fixes and update to the INSTALL.\+W32 file with (hopefully) more accurate Win32 build instructions.

{\itshape Steve Henson}
\item Modify configure script \textquotesingle{}Configure\textquotesingle{} to automatically create crypto/date.\+h file under Win32 and also build pem.\+h from pem.\+org. New script util/mkfiles.\+pl to create the MINFO file on environments that can\textquotesingle{}t do a \textquotesingle{}make files\textquotesingle{}\+: perl util/mkfiles.\+pl \texorpdfstring{$>$}{>}MINFO should work.

{\itshape Steve Henson}
\item Major rework of DES function declarations, in the pursuit of correctness and purity. As a result, many evil casts evaporated, and some weirdness, too. You may find this causes warnings in your code. Zapping your evil casts will probably fix them. Mostly.

{\itshape Ben Laurie}
\item Fix for a typo in asn1.\+h. Bug fix to object creation script obj\+\_\+dat.\+pl. It considered a zero in an object definition to mean "{}end of object"{}\+: none of the objects in objects.\+h have any zeros so it wasn\textquotesingle{}t spotted.

\texorpdfstring{$\ast$}{*}\+Steve Henson, reported by Erwann ABALEA \href{mailto:eabalea@certplus.com}{\texttt{ eabalea@certplus.\+com}}\texorpdfstring{$\ast$}{*}
\item Add support for Triple DES Cipher Block Chaining with Output Feedback Masking (CBCM). In the absence of test vectors, the best I have been able to do is check that the decrypt undoes the encrypt, so far. Send me test vectors if you have them.

{\itshape Ben Laurie}
\item Correct calculation of key length for export ciphers (too much space was allocated for null ciphers). This has not been tested!

{\itshape Ben Laurie}
\item Modifications to the mkdef.\+pl for Win32 DEF file creation. The usage message is now correct (it understands "{}crypto"{} and "{}ssl"{} on its command line). There is also now an "{}update"{} option. This will update the util/ssleay.\+num and util/libeay.\+num files with any new functions. If you do a\+: perl util/mkdef.\+pl crypto ssl update it will update them.

{\itshape Steve Henson}
\item Overhauled the Perl interface\+:
\begin{DoxyItemize}
\item ported BN stuff to Open\+SSL\textquotesingle{}s different BN library
\item made the perl/ source tree CVS-\/aware
\item renamed the package from SSLeay to Open\+SSL (the files still contain their history because I\textquotesingle{}ve copied them in the repository)
\item removed obsolete files (the test scripts will be replaced by better Test\+::\+Harness variants in the future)
\end{DoxyItemize}

{\itshape Ralf S. Engelschall}
\item First cut for a very conservative source tree cleanup\+:
\begin{DoxyEnumerate}
\item merge various obsolete readme texts into doc/ssleay.\+txt where we collect the old documents and readme texts.
\item remove the first part of files where I\textquotesingle{}m already sure that we no longer need them because of three reasons\+: either they are just temporary files which were left by Eric or they are preserved original files where I\textquotesingle{}ve verified that the diff is also available in the CVS via "{}cvs diff    -\/r\+SSLeay\+\_\+0\+\_\+8\+\_\+1b"{} or they were renamed (as it was definitely the case for the crypto/md/ stuff).
\end{DoxyEnumerate}

{\itshape Ralf S. Engelschall}
\item More extension code. Incomplete support for subject and issuer alt name, issuer and authority key id. Change the i2v function parameters and add an extra \textquotesingle{}crl\textquotesingle{} parameter in the X509\+V3\+\_\+\+CTX structure\+: guess what that\textquotesingle{}s for \+:-\/) Fix to ASN1 macro which messed up IMPLICIT tag and add f\+\_\+enum.\+c which adds a2i, i2a for ENUMERATED.

{\itshape Steve Henson}
\item Preliminary support for ENUMERATED type. This is largely copied from the INTEGER code.

{\itshape Steve Henson}
\item Add new function, EVP\+\_\+\+MD\+\_\+\+CTX\+\_\+copy() to replace frequent use of memcpy.

{\itshape Eric A. Young, (from changes to C2\+Net SSLeay, integrated by Mark Cox)}
\item Make sure {\ttfamily make rehash} target really finds the {\ttfamily openssl} program.

\texorpdfstring{$\ast$}{*}\+Ralf S. Engelschall, Matthias Loepfe \href{mailto:Matthias.Loepfe@adnovum.ch}{\texttt{ Matthias.\+Loepfe@adnovum.\+ch}}\texorpdfstring{$\ast$}{*}
\item Squeeze another 7\% of speed out of MD5 assembler, at least on a P2. I\textquotesingle{}d like to hear about it if this slows down other processors.

{\itshape Ben Laurie}
\item Add Cyg\+Win32 platform information to Configure script.

\texorpdfstring{$\ast$}{*}\+Alan Batie \href{mailto:batie@aahz.jf.intel.com}{\texttt{ batie@aahz.\+jf.\+intel.\+com}}\texorpdfstring{$\ast$}{*}
\item Fixed ms/32all.\+bat script\+: {\ttfamily no\+\_\+asm} -\/\texorpdfstring{$>$}{>} {\ttfamily no-\/asm}

\texorpdfstring{$\ast$}{*}\+Rainer W. Gerling \href{mailto:gerling@mpg-gv.mpg.de}{\texttt{ gerling@mpg-\/gv.\+mpg.\+de}}\texorpdfstring{$\ast$}{*}
\item New program nseq to manipulate netscape certificate sequences

{\itshape Steve Henson}
\item Modify crl2pkcs7 so it supports multiple -\/certfile arguments. Fix a few typos.

{\itshape Steve Henson}
\item Fixes to BN code. Previously the default was to define BN\+\_\+\+RECURSION but the BN code had some problems that would cause failures when doing certificate verification and some other functions.

{\itshape Eric A. Young, (from changes to C2\+Net SSLeay, integrated by Mark Cox)}
\item Add ASN1 and PEM code to support netscape certificate sequences.

{\itshape Steve Henson}
\item Add ASN1 and PEM code to support netscape certificate sequences.

{\itshape Steve Henson}
\item Add several PKIX and private extended key usage OIDs.

{\itshape Steve Henson}
\item Modify the \textquotesingle{}ca\textquotesingle{} program to handle the new extension code. Modify openssl.\+cnf for new extension format, add comments.

{\itshape Steve Henson}
\item More X509 V3 changes. Fix typo in v3\+\_\+bitstr.\+c. Add support to \textquotesingle{}req\textquotesingle{} and add a sample to openssl.\+cnf so req -\/x509 now adds appropriate CA extensions.

{\itshape Steve Henson}
\item Continued X509 V3 changes. Add to other makefiles, integrate with the error code, add initial support to X509\+\_\+print() and x509 application.

{\itshape Steve Henson}
\item Takes a deep breath and start adding X509 V3 extension support code. Add files in crypto/x509v3. Move original stuff to crypto/x509v3/old. All this stuff is currently isolated and isn\textquotesingle{}t even compiled yet.

{\itshape Steve Henson}
\item Continuing patches for Generalized\+Time. Fix up certificate and CRL ASN1 to use ASN1\+\_\+\+TIME and modify print routines to use ASN1\+\_\+\+TIME\+\_\+print. Removed the versions check from X509 routines when loading extensions\+: this allows certain broken certificates that don\textquotesingle{}t set the version properly to be processed.

{\itshape Steve Henson}
\item Deal with irritating shit to do with dependencies, in YAAHW (Yet Another Ad Hoc Way) -\/ Makefile.\+ssls now all contain local dependencies, which can still be regenerated with "{}make depend"{}.

{\itshape Ben Laurie}
\item Spelling mistake in C version of CAST-\/128.

\texorpdfstring{$\ast$}{*}\+Ben Laurie, reported by Jeremy Hylton \href{mailto:jeremy@cnri.reston.va.us}{\texttt{ jeremy@cnri.\+reston.\+va.\+us}}\texorpdfstring{$\ast$}{*}
\item Changes to the error generation code. The perl script err-\/code.\+pl now reads in the old error codes and retains the old numbers, only adding new ones if necessary. It also only changes the .err files if new codes are added. The makefiles have been modified to only insert errors when needed (to avoid needlessly modifying header files). This is done by only inserting errors if the .err file is newer than the auto generated C file. To rebuild all the error codes from scratch (the old behaviour) either modify crypto/\+Makefile.\+ssl to pass the -\/regen flag to err\+\_\+code.\+pl or delete all the .err files.

{\itshape Steve Henson}
\item CAST-\/128 was incorrectly implemented for short keys. The C version has been fixed, but is untested. The assembler versions are also fixed, but new assembler HAS NOT BEEN GENERATED FOR WIN32 -\/ the Makefile needs fixing to regenerate it if needed. \texorpdfstring{$\ast$}{*}\+Ben Laurie, reported (with fix for C version) by Jun-\/ichiro itojun Hagino \href{mailto:itojun@kame.net}{\texttt{ itojun@kame.\+net}}\texorpdfstring{$\ast$}{*}
\item File was opened incorrectly in randfile.\+c.

\texorpdfstring{$\ast$}{*}\+Ulf Möller \href{mailto:ulf@fitug.de}{\texttt{ ulf@fitug.\+de}}\texorpdfstring{$\ast$}{*}
\item Beginning of support for Generalized\+Time. d2i, i2d, check and print functions. Also ASN1\+\_\+\+TIME suite which is a CHOICE of UTCTime or Generalized\+Time. ASN1\+\_\+\+TIME is the proper type used in certificates et al\+: it\textquotesingle{}s just almost always a UTCTime. Note this patch adds new error codes so do a "{}make errors"{} if there are problems.

{\itshape Steve Henson}
\item Correct Linux 1 recognition in config.

\texorpdfstring{$\ast$}{*}\+Ulf Möller \href{mailto:ulf@fitug.de}{\texttt{ ulf@fitug.\+de}}\texorpdfstring{$\ast$}{*}
\item Remove pointless MD5 hash when using DSA keys in ca.

\texorpdfstring{$\ast$}{*}\+Anonymous \href{mailto:nobody@replay.com}{\texttt{ nobody@replay.\+com}}\texorpdfstring{$\ast$}{*}
\item Generate an error if given an empty string as a cert directory. Also generate an error if handed NULL (previously returned 0 to indicate an error, but didn\textquotesingle{}t set one).

\texorpdfstring{$\ast$}{*}\+Ben Laurie, reported by Anonymous \href{mailto:nobody@replay.com}{\texttt{ nobody@replay.\+com}}\texorpdfstring{$\ast$}{*}
\item Add prototypes to SSL methods. Make SSL\+\_\+write\textquotesingle{}s buffer const, at last.

{\itshape Ben Laurie}
\item Fix the dummy function BN\+\_\+ref\+\_\+mod\+\_\+exp() in rsaref.\+c to have the correct parameters. This was causing a warning which killed off the Win32 compile.

{\itshape Steve Henson}
\item Remove C++ style comments from \doxylink{bn__local_8h_source}{crypto/bn/bn\+\_\+local.\+h}.

\texorpdfstring{$\ast$}{*}\+Neil Costigan \href{mailto:neil.costigan@celocom.com}{\texttt{ neil.\+costigan@celocom.\+com}}\texorpdfstring{$\ast$}{*}
\item The function OBJ\+\_\+txt2nid was broken. It was supposed to return a nid based on a text string, looking up short and long names and finally "{}dot"{} format. The "{}dot"{} format stuff didn\textquotesingle{}t work. Added new function OBJ\+\_\+txt2obj to do the same but return an ASN1\+\_\+\+OBJECT and rewrote OBJ\+\_\+txt2nid to use it. OBJ\+\_\+txt2obj can also return objects even if the OID is not part of the table.

{\itshape Steve Henson}
\item Add prototypes to X509 lookup/verify methods, fixing a bug in X509\+\_\+\+LOOKUP\+\_\+by\+\_\+alias().

{\itshape Ben Laurie}
\item Sort openssl functions by name.

{\itshape Ben Laurie}
\item Get the {\ttfamily gendsa} command working and add it to the {\ttfamily list} command. Remove encryption from sample DSA keys (in case anyone is interested the password was "{}1234"{}).

{\itshape Steve Henson}
\item Make {\itshape all} {\ttfamily \texorpdfstring{$\ast$}{*}\+\_\+free} functions accept a NULL pointer.

\texorpdfstring{$\ast$}{*}\+Frans Heymans \href{mailto:fheymans@isaserver.be}{\texttt{ fheymans@isaserver.\+be}}\texorpdfstring{$\ast$}{*}
\item If a DH key is generated in s3\+\_\+srvr.\+c, don\textquotesingle{}t blow it by trying to use NULL pointers.

\texorpdfstring{$\ast$}{*}\+Anonymous \href{mailto:nobody@replay.com}{\texttt{ nobody@replay.\+com}}\texorpdfstring{$\ast$}{*}
\item s\+\_\+server should send the CAfile as acceptable CAs, not its own cert.

\texorpdfstring{$\ast$}{*}\+Bodo Moeller \href{mailto:3moeller@informatik.uni-hamburg.de}{\texttt{ 3moeller@informatik.\+uni-\/hamburg.\+de}}\texorpdfstring{$\ast$}{*}
\item Don\textquotesingle{}t blow it for numeric {\ttfamily -\/newkey} arguments to {\ttfamily apps/req}.

\texorpdfstring{$\ast$}{*}\+Bodo Moeller \href{mailto:3moeller@informatik.uni-hamburg.de}{\texttt{ 3moeller@informatik.\+uni-\/hamburg.\+de}}\texorpdfstring{$\ast$}{*}
\item Temp key "{}for export"{} tests were wrong in s3\+\_\+srvr.\+c.

\texorpdfstring{$\ast$}{*}\+Anonymous \href{mailto:nobody@replay.com}{\texttt{ nobody@replay.\+com}}\texorpdfstring{$\ast$}{*}
\item Add prototype for temp key callback functions SSL\+\_\+\+CTX\+\_\+set\+\_\+tmp\+\_\+\{rsa,dh\}\+\_\+callback().

{\itshape Ben Laurie}
\item Make DH\+\_\+free() tolerate being passed a NULL pointer (like RSA\+\_\+free() and DSA\+\_\+free()). Make X509\+\_\+\+PUBKEY\+\_\+set() check for errors in d2i\+\_\+\+Public\+Key().

{\itshape Steve Henson}
\item X509\+\_\+name\+\_\+add\+\_\+entry() freed the wrong thing after an error.

\texorpdfstring{$\ast$}{*}\+Arne Ansper \href{mailto:arne@ats.cyber.ee}{\texttt{ arne@ats.\+cyber.\+ee}}\texorpdfstring{$\ast$}{*}
\item rsa\+\_\+eay.\+c would attempt to free a NULL context.

\texorpdfstring{$\ast$}{*}\+Arne Ansper \href{mailto:arne@ats.cyber.ee}{\texttt{ arne@ats.\+cyber.\+ee}}\texorpdfstring{$\ast$}{*}
\item BIO\+\_\+s\+\_\+socket() had a broken should\+\_\+retry() on Windoze.

\texorpdfstring{$\ast$}{*}\+Arne Ansper \href{mailto:arne@ats.cyber.ee}{\texttt{ arne@ats.\+cyber.\+ee}}\texorpdfstring{$\ast$}{*}
\item BIO\+\_\+f\+\_\+buffer() didn\textquotesingle{}t pass on BIO\+\_\+\+CTRL\+\_\+\+FLUSH.

\texorpdfstring{$\ast$}{*}\+Arne Ansper \href{mailto:arne@ats.cyber.ee}{\texttt{ arne@ats.\+cyber.\+ee}}\texorpdfstring{$\ast$}{*}
\item Make sure the already existing X509\+\_\+\+STORE-\/\texorpdfstring{$>$}{>}depth variable is initialized in X509\+\_\+\+STORE\+\_\+new(), but document the fact that this variable is still unused in the certificate verification process.

{\itshape Ralf S. Engelschall}
\item Fix the various library and {\ttfamily apps/} files to free up pkeys obtained from X509\+\_\+\+PUBKEY\+\_\+get() et al. Also allow x509.\+c to handle netscape extensions.

{\itshape Steve Henson}
\item Fix reference counting in X509\+\_\+\+PUBKEY\+\_\+get(). This makes demos/maurice/example2.\+c work, amongst others, probably.

{\itshape Steve Henson and Ben Laurie}
\item First cut of a cleanup for {\ttfamily apps/}. First the {\ttfamily ssleay} program is now named {\ttfamily openssl} and second, the shortcut symlinks for the {\ttfamily openssl \texorpdfstring{$<$}{<}command\texorpdfstring{$>$}{>}} are no longer created. This way we have a single and consistent command line interface {\ttfamily openssl \texorpdfstring{$<$}{<}command\texorpdfstring{$>$}{>}}, similar to {\ttfamily cvs \texorpdfstring{$<$}{<}command\texorpdfstring{$>$}{>}}.

{\itshape Ralf S. Engelschall, Paul Sutton and Ben Laurie}
\item ca.\+c\+: move test for DSA keys inside ifndef NO\+\_\+\+DSA. Make pubkey BIT STRING wrapper always have zero unused bits.

{\itshape Steve Henson}
\item Add CA.\+pl, perl version of CA.\+sh, add extended key usage OID.

{\itshape Steve Henson}
\item Make the top-\/level INSTALL documentation easier to understand.

{\itshape Paul Sutton}
\item Makefiles updated to exit if an error occurs in a sub-\/directory make (including if user presses \texorpdfstring{$^\wedge$}{\string^}C) \mbox{[}Paul Sutton\mbox{]}
\item Make Montgomery context stuff explicit in RSA data structure.

{\itshape Ben Laurie}
\item Fix build order of pem and err to allow for generated pem.\+h.

{\itshape Ben Laurie}
\item Fix renumbering bug in X509\+\_\+\+NAME\+\_\+delete\+\_\+entry().

{\itshape Ben Laurie}
\item Enhanced the err-\/ins.\+pl script so it makes the error library number global and can add a library name. This is needed for external ASN1 and other error libraries.

{\itshape Steve Henson}
\item Fixed sk\+\_\+insert which never worked properly.

{\itshape Steve Henson}
\item Fix ASN1 macros so they can handle indefinite length constructed EXPLICIT tags. Some non standard certificates use these\+: they can now be read in.

{\itshape Steve Henson}
\item Merged the various old/obsolete SSLeay documentation files (doc/xxx.\+doc) into a single doc/ssleay.\+txt bundle. This way the information is still preserved but no longer messes up this directory. Now it\textquotesingle{}s new room for the new set of documentation files.

{\itshape Ralf S. Engelschall}
\item SETs were incorrectly DER encoded. This was a major pain, because they shared code with SEQUENCEs, which aren\textquotesingle{}t coded the same. This means that almost everything to do with SETs or SEQUENCEs has either changed name or number of arguments.

\texorpdfstring{$\ast$}{*}\+Ben Laurie, based on a partial fix by GP Jayan \href{mailto:gp@nsj.co.jp}{\texttt{ gp@nsj.\+co.\+jp}}\texorpdfstring{$\ast$}{*}
\item Fix test data to work with the above.

{\itshape Ben Laurie}
\item Fix the RSA header declarations that hid a bug I fixed in 0.\+9.\+0b but was already fixed by Eric for 0.\+9.\+1 it seems.

\texorpdfstring{$\ast$}{*}\+Ben Laurie -\/ pointed out by Ulf Möller \href{mailto:ulf@fitug.de}{\texttt{ ulf@fitug.\+de}}\texorpdfstring{$\ast$}{*}
\item Autodetect Free\+BSD3.

{\itshape Ben Laurie}
\item Fix various bugs in Configure. This affects the following platforms\+: nextstep ncr-\/scde unixware-\/2.\+0 unixware-\/2.\+0-\/pentium sco5-\/cc.

{\itshape Ben Laurie}
\item Eliminate generated files from CVS. Reorder tests to regenerate files before they are needed.

{\itshape Ben Laurie}
\item Generate Makefile.\+ssl from Makefile.\+org (to keep CVS happy).

{\itshape Ben Laurie}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md169}{}\doxysubsection{\texorpdfstring{Changes between 0.\+9.\+1b and 0.\+9.\+1c \mbox{[}23-\/Dec-\/1998\mbox{]}}{Changes between 0.\+9.\+1b and 0.\+9.\+1c \mbox{[}23-\/Dec-\/1998\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md169}

\begin{DoxyItemize}
\item Added OPENSSL\+\_\+\+VERSION\+\_\+\+NUMBER to crypto/crypto.\+h and changed SSLeay to Open\+SSL in version strings.

{\itshape Ralf S. Engelschall}
\item Some fixups to the top-\/level documents.

{\itshape Paul Sutton}
\item Fixed the nasty bug where rsaref.\+h was not found under compile-\/time because the symlink to include/ was missing.

{\itshape Ralf S. Engelschall}
\item Incorporated the popular no-\/\+RSA/\+DSA-\/only patches which allow to compile an RSA-\/free SSLeay.

{\itshape Andrew Cooke / Interrader Ldt., Ralf S. Engelschall}
\item Fixed nasty rehash problem under {\ttfamily make -\/f Makefile.\+ssl links} when "{}ssleay"{} is still not found.

{\itshape Ralf S. Engelschall}
\item Added more platforms to Configure\+: Cray T3E, HPUX 11,

\texorpdfstring{$\ast$}{*}\+Ralf S. Engelschall, Beckmann \href{mailto:beckman@acl.lanl.gov}{\texttt{ beckman@acl.\+lanl.\+gov}}\texorpdfstring{$\ast$}{*}
\item Updated the README file.

{\itshape Ralf S. Engelschall}
\item Added various .cvsignore files in the CVS repository subdirs to make a "{}cvs update"{} really silent.

{\itshape Ralf S. Engelschall}
\item Recompiled the error-\/definition header files and added missing symbols to the Win32 linker tables.

{\itshape Ralf S. Engelschall}
\item Cleaned up the top-\/level documents; o new files\+: CHANGES and LICENSE o merged VERSION, HISTORY\texorpdfstring{$\ast$}{*} and README\texorpdfstring{$\ast$}{*} files a CHANGES.\+SSLeay o merged COPYRIGHT into LICENSE o removed obsolete TODO file o renamed MICROSOFT to INSTALL.\+W32

{\itshape Ralf S. Engelschall}
\item Removed dummy files from the 0.\+9.\+1b source tree\+: crypto/asn1/x crypto/bio/cd crypto/bio/fg crypto/bio/grep crypto/bio/vi crypto/bn/asm/......add.\+c crypto/bn/asm/a.\+out crypto/dsa/f crypto/md5/f crypto/pem/gmon.\+out crypto/perlasm/f crypto/pkcs7/build crypto/rsa/f crypto/sha/asm/f crypto/threads/f ms/zzz ssl/f ssl/f.\+mak test/f util/f.\+mak util/pl/f util/pl/f.\+mak crypto/bf/bf\+\_\+locl.\+old apps/f

{\itshape Ralf S. Engelschall}
\item Added various platform portability fixes.

{\itshape Mark J. Cox}
\item The Genesis of the Open\+SSL rpject\+: We start with the latest (unreleased) SSLeay version 0.\+9.\+1b which Eric A. Young and Tim J. Hudson created while they were working for C2\+Net until summer 1998.

{\itshape The Open\+SSL Project}
\end{DoxyItemize}\hypertarget{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md170}{}\doxysubsection{\texorpdfstring{Changes between 0.\+9.\+0b and 0.\+9.\+1b \mbox{[}not released\mbox{]}}{Changes between 0.\+9.\+0b and 0.\+9.\+1b \mbox{[}not released\mbox{]}}}\label{md__c_1_2_users_2namph_2_downloads_2openssl_2openssl-3_82_81_2_c_h_a_n_g_e_s_autotoc_md170}

\begin{DoxyItemize}
\item Updated a few CA certificates under certs/

{\itshape Eric A. Young}
\item Changed some BIGNUM api stuff.

{\itshape Eric A. Young}
\item Various platform ports\+: Open\+BSD, Ultrix, IRIX 64bit, Net\+BSD, DGUX x86, Linux Alpha, etc.

{\itshape Eric A. Young}
\item New COMP library \mbox{[}crypto/comp/\mbox{]} for SSL Record Layer Compression\+: RLE (dummy implemented) and ZLIB (really implemented when ZLIB is available).

{\itshape Eric A. Young}
\item Add -\/strparse option to asn1pars program which parses nested binary structures

\texorpdfstring{$\ast$}{*}\+Dr Stephen Henson \href{mailto:shenson@bigfoot.com}{\texttt{ shenson@bigfoot.\+com}}\texorpdfstring{$\ast$}{*}
\item Added "{}oid\+\_\+file"{} to ssleay.\+cnf for "{}ca"{} and "{}req"{} programs.

{\itshape Eric A. Young}
\item DSA fix for "{}ca"{} program.

{\itshape Eric A. Young}
\item Added "{}-\/genkey"{} option to "{}dsaparam"{} program.

{\itshape Eric A. Young}
\item Added RIPE MD160 (rmd160) message digest.

{\itshape Eric A. Young}
\item Added -\/a (all) option to "{}ssleay version"{} command.

{\itshape Eric A. Young}
\item Added PLATFORM define which is the id given to Configure.

{\itshape Eric A. Young}
\item Added Mem\+Check\+\_\+\+XXXX functions to crypto/mem.\+c for memory checking.

{\itshape Eric A. Young}
\item Extended the ASN.\+1 parser routines.

{\itshape Eric A. Young}
\item Extended BIO routines to support REUSEADDR, seek, tell, etc.

{\itshape Eric A. Young}
\item Added a BN\+\_\+\+CTX to the BN library.

{\itshape Eric A. Young}
\item Fixed the weak key values in DES library

{\itshape Eric A. Young}
\item Changed API in EVP library for cipher aliases.

{\itshape Eric A. Young}
\item Added support for RC2/64bit cipher.

{\itshape Eric A. Young}
\item Converted the lhash library to the crypto/mem.\+c functions.

{\itshape Eric A. Young}
\item Added more recognized ASN.\+1 object ids.

{\itshape Eric A. Young}
\item Added more RSA padding checks for SSL/\+TLS.

{\itshape Eric A. Young}
\item Added BIO proxy/filter functionality.

{\itshape Eric A. Young}
\item Added extra\+\_\+certs to SSL\+\_\+\+CTX which can be used send extra CA certificates to the client in the CA cert chain sending process. It can be configured with SSL\+\_\+\+CTX\+\_\+add\+\_\+extra\+\_\+chain\+\_\+cert().

{\itshape Eric A. Young}
\item Now Fortezza is denied in the authentication phase because this is key exchange mechanism is not supported by SSLeay at all.

{\itshape Eric A. Young}
\item Additional PKCS1 checks.

{\itshape Eric A. Young}
\item Support the string "{}\+TLSv1"{} for all TLS v1 ciphers.

{\itshape Eric A. Young}
\item Added function SSL\+\_\+get\+\_\+ex\+\_\+data\+\_\+\+X509\+\_\+\+STORE\+\_\+\+CTX\+\_\+idx() which gives the ex\+\_\+data index of the SSL context in the X509\+\_\+\+STORE\+\_\+\+CTX ex\+\_\+data.

{\itshape Eric A. Young}
\item Fixed a few memory leaks.

{\itshape Eric A. Young}
\item Fixed various code and comment typos.

{\itshape Eric A. Young}
\item A minor bug in ssl/s3\+\_\+clnt.\+c where there would always be 4 0 bytes sent in the client random.

\texorpdfstring{$\ast$}{*}\+Edward Bishop \href{mailto:ebishop@spyglass.com}{\texttt{ ebishop@spyglass.\+com}}\texorpdfstring{$\ast$}{*} 
\end{DoxyItemize}