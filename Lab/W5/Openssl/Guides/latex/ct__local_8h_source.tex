\doxysection{ct\+\_\+local.\+h}
\hypertarget{ct__local_8h_source}{}\label{ct__local_8h_source}\index{C:/Users/namph/Downloads/openssl/openssl-\/3.2.1/crypto/ct/ct\_local.h@{C:/Users/namph/Downloads/openssl/openssl-\/3.2.1/crypto/ct/ct\_local.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ *\ Copyright\ 2015-\/2021\ The\ OpenSSL\ Project\ Authors.\ All\ Rights\ Reserved.}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *\ Licensed\ under\ the\ Apache\ License\ 2.0\ (the\ "{}License"{}).\ \ You\ may\ not\ use}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ *\ this\ file\ except\ in\ compliance\ with\ the\ License.\ \ You\ can\ obtain\ a\ copy}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ *\ in\ the\ file\ LICENSE\ in\ the\ source\ distribution\ or\ at}}
\DoxyCodeLine{00007\ \textcolor{comment}{\ *\ https://www.openssl.org/source/license.html}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <stddef.h>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <openssl/ct.h>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <openssl/evp.h>}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <openssl/x509.h>}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ <openssl/x509v3.h>}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ <openssl/safestack.h>}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{comment}{/*}}
\DoxyCodeLine{00018\ \textcolor{comment}{\ *\ From\ RFC6962:\ opaque\ SerializedSCT<1..2\string^16-\/1>;\ struct\ \{\ SerializedSCT}}
\DoxyCodeLine{00019\ \textcolor{comment}{\ *\ sct\_list\ <1..2\string^16-\/1>;\ \}\ SignedCertificateTimestampList;}}
\DoxyCodeLine{00020\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#\ define\ MAX\_SCT\_SIZE\ \ \ \ \ \ \ \ \ \ \ \ 65535}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#\ define\ MAX\_SCT\_LIST\_SIZE\ \ \ \ \ \ \ MAX\_SCT\_SIZE}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{comment}{/*}}
\DoxyCodeLine{00025\ \textcolor{comment}{\ *\ Macros\ to\ read\ and\ write\ integers\ in\ network-\/byte\ order.}}
\DoxyCodeLine{00026\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#define\ n2s(c,s)\ \ \ \ \ \ \ \ ((s=(((unsigned\ int)((c)[0]))<<\ 8)|\ \(\backslash\)}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (((unsigned\ int)((c)[1]))\ \ \ \ )),c+=2)}}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#define\ s2n(s,c)\ \ \ \ \ \ \ \ ((c[0]=(unsigned\ char)(((s)>>\ 8)\&0xff),\ \(\backslash\)}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c[1]=(unsigned\ char)(((s)\ \ \ \ )\&0xff)),c+=2)}}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#define\ l2n3(l,c)\ \ \ \ \ \ \ ((c[0]=(unsigned\ char)(((l)>>16)\&0xff),\ \(\backslash\)}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c[1]=(unsigned\ char)(((l)>>\ 8)\&0xff),\ \(\backslash\)}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c[2]=(unsigned\ char)(((l)\ \ \ \ )\&0xff)),c+=3)}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#define\ n2l8(c,l)\ \ \ \ \ \ \ (l\ =((uint64\_t)(*((c)++)))<<56,\ \(\backslash\)}}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ l|=((uint64\_t)(*((c)++)))<<48,\ \(\backslash\)}}
\DoxyCodeLine{00040\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ l|=((uint64\_t)(*((c)++)))<<40,\ \(\backslash\)}}
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ l|=((uint64\_t)(*((c)++)))<<32,\ \(\backslash\)}}
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ l|=((uint64\_t)(*((c)++)))<<24,\ \(\backslash\)}}
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ l|=((uint64\_t)(*((c)++)))<<16,\ \(\backslash\)}}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ l|=((uint64\_t)(*((c)++)))<<\ 8,\ \(\backslash\)}}
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ l|=((uint64\_t)(*((c)++))))}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \textcolor{preprocessor}{\#define\ l2n8(l,c)\ \ \ \ \ \ \ (*((c)++)=(unsigned\ char)(((l)>>56)\&0xff),\ \(\backslash\)}}
\DoxyCodeLine{00048\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *((c)++)=(unsigned\ char)(((l)>>48)\&0xff),\ \(\backslash\)}}
\DoxyCodeLine{00049\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *((c)++)=(unsigned\ char)(((l)>>40)\&0xff),\ \(\backslash\)}}
\DoxyCodeLine{00050\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *((c)++)=(unsigned\ char)(((l)>>32)\&0xff),\ \(\backslash\)}}
\DoxyCodeLine{00051\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *((c)++)=(unsigned\ char)(((l)>>24)\&0xff),\ \(\backslash\)}}
\DoxyCodeLine{00052\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *((c)++)=(unsigned\ char)(((l)>>16)\&0xff),\ \(\backslash\)}}
\DoxyCodeLine{00053\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *((c)++)=(unsigned\ char)(((l)>>\ 8)\&0xff),\ \(\backslash\)}}
\DoxyCodeLine{00054\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *((c)++)=(unsigned\ char)(((l)\ \ \ \ )\&0xff))}}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \textcolor{comment}{/*\ Signed\ Certificate\ Timestamp\ */}}
\DoxyCodeLine{00057\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structsct__st}{sct\_st}}\ \{}
\DoxyCodeLine{00058\ \ \ \ \ sct\_version\_t\ version;}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{comment}{/*\ If\ version\ is\ not\ SCT\_VERSION\_V1,\ this\ contains\ the\ encoded\ SCT\ */}}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *sct;}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ sct\_len;}
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{comment}{/*\ If\ version\ is\ SCT\_VERSION\_V1,\ fields\ below\ contain\ components\ of\ the\ SCT\ */}}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *log\_id;}
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ log\_id\_len;}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00066\ \textcolor{comment}{\ \ \ \ *\ Note,\ we\ cannot\ distinguish\ between\ an\ unset\ timestamp,\ and\ one}}
\DoxyCodeLine{00067\ \textcolor{comment}{\ \ \ \ *\ that\ is\ set\ to\ 0.\ \ However\ since\ CT\ didn't\ exist\ in\ 1970,\ no\ real}}
\DoxyCodeLine{00068\ \textcolor{comment}{\ \ \ \ *\ SCT\ should\ ever\ be\ set\ as\ such.}}
\DoxyCodeLine{00069\ \textcolor{comment}{\ \ \ \ */}}
\DoxyCodeLine{00070\ \ \ \ \ uint64\_t\ timestamp;}
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *ext;}
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ ext\_len;}
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ hash\_alg;}
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ sig\_alg;}
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *sig;}
\DoxyCodeLine{00076\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ sig\_len;}
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{comment}{/*\ Log\ entry\ type\ */}}
\DoxyCodeLine{00078\ \ \ \ \ ct\_log\_entry\_type\_t\ entry\_type;}
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{comment}{/*\ Where\ this\ SCT\ was\ found,\ e.g.\ certificate,\ OCSP\ response,\ etc.\ */}}
\DoxyCodeLine{00080\ \ \ \ \ sct\_source\_t\ source;}
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{comment}{/*\ The\ result\ of\ the\ last\ attempt\ to\ validate\ this\ SCT.\ */}}
\DoxyCodeLine{00082\ \ \ \ \ sct\_validation\_status\_t\ validation\_status;}
\DoxyCodeLine{00083\ \};}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \textcolor{comment}{/*\ Miscellaneous\ data\ that\ is\ useful\ when\ verifying\ an\ SCT\ \ */}}
\DoxyCodeLine{00086\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structsct__ctx__st}{sct\_ctx\_st}}\ \{}
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{comment}{/*\ Public\ key\ */}}
\DoxyCodeLine{00088\ \ \ \ \ EVP\_PKEY\ *pkey;}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{comment}{/*\ Hash\ of\ public\ key\ */}}
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *pkeyhash;}
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ pkeyhashlen;}
\DoxyCodeLine{00092\ \ \ \ \ \textcolor{comment}{/*\ For\ pre-\/certificate:\ issuer\ public\ key\ hash\ */}}
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *ihash;}
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ ihashlen;}
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{comment}{/*\ certificate\ encoding\ */}}
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *certder;}
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ certderlen;}
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{comment}{/*\ pre-\/certificate\ encoding\ */}}
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *preder;}
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ prederlen;}
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{comment}{/*\ milliseconds\ since\ epoch\ (to\ check\ that\ the\ SCT\ isn't\ from\ the\ future)\ */}}
\DoxyCodeLine{00102\ \ \ \ \ uint64\_t\ epoch\_time\_in\_ms;}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ \ \ OSSL\_LIB\_CTX\ *libctx;}
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{keywordtype}{char}\ *propq;}
\DoxyCodeLine{00106\ \};}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ \textcolor{comment}{/*\ Context\ when\ evaluating\ whether\ a\ Certificate\ Transparency\ policy\ is\ met\ */}}
\DoxyCodeLine{00109\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structct__policy__eval__ctx__st}{ct\_policy\_eval\_ctx\_st}}\ \{}
\DoxyCodeLine{00110\ \ \ \ \ X509\ *cert;}
\DoxyCodeLine{00111\ \ \ \ \ X509\ *issuer;}
\DoxyCodeLine{00112\ \ \ \ \ CTLOG\_STORE\ *log\_store;}
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{comment}{/*\ milliseconds\ since\ epoch\ (to\ check\ that\ SCTs\ aren't\ from\ the\ future)\ */}}
\DoxyCodeLine{00114\ \ \ \ \ uint64\_t\ epoch\_time\_in\_ms;}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \ \ \ \ OSSL\_LIB\_CTX\ *libctx;}
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{keywordtype}{char}\ *propq;}
\DoxyCodeLine{00118\ \};}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \textcolor{comment}{/*}}
\DoxyCodeLine{00121\ \textcolor{comment}{\ *\ Creates\ a\ new\ context\ for\ verifying\ an\ SCT.}}
\DoxyCodeLine{00122\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00123\ SCT\_CTX\ *SCT\_CTX\_new(OSSL\_LIB\_CTX\ *ctx,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *propq);}
\DoxyCodeLine{00124\ \textcolor{comment}{/*}}
\DoxyCodeLine{00125\ \textcolor{comment}{\ *\ Deletes\ an\ SCT\ verification\ context.}}
\DoxyCodeLine{00126\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00127\ \textcolor{keywordtype}{void}\ SCT\_CTX\_free(SCT\_CTX\ *sctx);}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \textcolor{comment}{/*}}
\DoxyCodeLine{00130\ \textcolor{comment}{\ *\ Sets\ the\ certificate\ that\ the\ SCT\ was\ created\ for.}}
\DoxyCodeLine{00131\ \textcolor{comment}{\ *\ If\ *cert\ does\ not\ have\ a\ poison\ extension,\ presigner\ must\ be\ NULL.}}
\DoxyCodeLine{00132\ \textcolor{comment}{\ *\ If\ *cert\ does\ not\ have\ a\ poison\ extension,\ it\ may\ have\ a\ single\ SCT}}
\DoxyCodeLine{00133\ \textcolor{comment}{\ *\ (NID\_ct\_precert\_scts)\ extension.}}
\DoxyCodeLine{00134\ \textcolor{comment}{\ *\ If\ either\ *cert\ or\ *presigner\ have\ an\ AKID\ (NID\_authority\_key\_identifier)}}
\DoxyCodeLine{00135\ \textcolor{comment}{\ *\ extension,\ both\ must\ have\ one.}}
\DoxyCodeLine{00136\ \textcolor{comment}{\ *\ Returns\ 1\ on\ success,\ 0\ on\ failure.}}
\DoxyCodeLine{00137\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00138\ \_\_owur\ \textcolor{keywordtype}{int}\ SCT\_CTX\_set1\_cert(SCT\_CTX\ *sctx,\ X509\ *cert,\ X509\ *presigner);}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00140\ \textcolor{comment}{/*}}
\DoxyCodeLine{00141\ \textcolor{comment}{\ *\ Sets\ the\ issuer\ of\ the\ certificate\ that\ the\ SCT\ was\ created\ for.}}
\DoxyCodeLine{00142\ \textcolor{comment}{\ *\ This\ is\ just\ a\ convenience\ method\ to\ save\ extracting\ the\ public\ key\ and}}
\DoxyCodeLine{00143\ \textcolor{comment}{\ *\ calling\ SCT\_CTX\_set1\_issuer\_pubkey().}}
\DoxyCodeLine{00144\ \textcolor{comment}{\ *\ Issuer\ must\ not\ be\ NULL.}}
\DoxyCodeLine{00145\ \textcolor{comment}{\ *\ Returns\ 1\ on\ success,\ 0\ on\ failure.}}
\DoxyCodeLine{00146\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00147\ \_\_owur\ \textcolor{keywordtype}{int}\ SCT\_CTX\_set1\_issuer(SCT\_CTX\ *sctx,\ \textcolor{keyword}{const}\ X509\ *issuer);}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00149\ \textcolor{comment}{/*}}
\DoxyCodeLine{00150\ \textcolor{comment}{\ *\ Sets\ the\ public\ key\ of\ the\ issuer\ of\ the\ certificate\ that\ the\ SCT\ was\ created}}
\DoxyCodeLine{00151\ \textcolor{comment}{\ *\ for.}}
\DoxyCodeLine{00152\ \textcolor{comment}{\ *\ The\ public\ key\ must\ not\ be\ NULL.}}
\DoxyCodeLine{00153\ \textcolor{comment}{\ *\ Returns\ 1\ on\ success,\ 0\ on\ failure.}}
\DoxyCodeLine{00154\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00155\ \_\_owur\ \textcolor{keywordtype}{int}\ SCT\_CTX\_set1\_issuer\_pubkey(SCT\_CTX\ *sctx,\ X509\_PUBKEY\ *\mbox{\hyperlink{structpubkey}{pubkey}});}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00157\ \textcolor{comment}{/*}}
\DoxyCodeLine{00158\ \textcolor{comment}{\ *\ Sets\ the\ public\ key\ of\ the\ CT\ log\ that\ the\ SCT\ is\ from.}}
\DoxyCodeLine{00159\ \textcolor{comment}{\ *\ Returns\ 1\ on\ success,\ 0\ on\ failure.}}
\DoxyCodeLine{00160\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00161\ \_\_owur\ \textcolor{keywordtype}{int}\ SCT\_CTX\_set1\_pubkey(SCT\_CTX\ *sctx,\ X509\_PUBKEY\ *\mbox{\hyperlink{structpubkey}{pubkey}});}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00163\ \textcolor{comment}{/*}}
\DoxyCodeLine{00164\ \textcolor{comment}{\ *\ Sets\ the\ time\ to\ evaluate\ the\ SCT\ against,\ in\ milliseconds\ since\ the\ Unix}}
\DoxyCodeLine{00165\ \textcolor{comment}{\ *\ epoch.\ If\ the\ SCT's\ timestamp\ is\ after\ this\ time,\ it\ will\ be\ interpreted\ as}}
\DoxyCodeLine{00166\ \textcolor{comment}{\ *\ having\ been\ issued\ in\ the\ future.\ RFC6962\ states\ that\ "{}TLS\ clients\ MUST}}
\DoxyCodeLine{00167\ \textcolor{comment}{\ *\ reject\ SCTs\ whose\ timestamp\ is\ in\ the\ future"{},\ so\ an\ SCT\ will\ not\ validate}}
\DoxyCodeLine{00168\ \textcolor{comment}{\ *\ in\ this\ case.}}
\DoxyCodeLine{00169\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00170\ \textcolor{keywordtype}{void}\ SCT\_CTX\_set\_time(SCT\_CTX\ *sctx,\ uint64\_t\ time\_in\_ms);}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \textcolor{comment}{/*}}
\DoxyCodeLine{00173\ \textcolor{comment}{\ *\ Verifies\ an\ SCT\ with\ the\ given\ context.}}
\DoxyCodeLine{00174\ \textcolor{comment}{\ *\ Returns\ 1\ if\ the\ SCT\ verifies\ successfully;\ any\ other\ value\ indicates}}
\DoxyCodeLine{00175\ \textcolor{comment}{\ *\ failure.\ See\ EVP\_DigestVerifyFinal()\ for\ the\ meaning\ of\ those\ values.}}
\DoxyCodeLine{00176\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00177\ \_\_owur\ \textcolor{keywordtype}{int}\ SCT\_CTX\_verify(\textcolor{keyword}{const}\ SCT\_CTX\ *sctx,\ \textcolor{keyword}{const}\ SCT\ *sct);}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \textcolor{comment}{/*}}
\DoxyCodeLine{00180\ \textcolor{comment}{\ *\ Does\ this\ SCT\ have\ the\ minimum\ fields\ populated\ to\ be\ usable?}}
\DoxyCodeLine{00181\ \textcolor{comment}{\ *\ Returns\ 1\ if\ so,\ 0\ otherwise.}}
\DoxyCodeLine{00182\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00183\ \_\_owur\ \textcolor{keywordtype}{int}\ SCT\_is\_complete(\textcolor{keyword}{const}\ SCT\ *sct);}
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00185\ \textcolor{comment}{/*}}
\DoxyCodeLine{00186\ \textcolor{comment}{\ *\ Does\ this\ SCT\ have\ the\ signature-\/related\ fields\ populated?}}
\DoxyCodeLine{00187\ \textcolor{comment}{\ *\ Returns\ 1\ if\ so,\ 0\ otherwise.}}
\DoxyCodeLine{00188\ \textcolor{comment}{\ *\ This\ checks\ that\ the\ signature\ and\ hash\ algorithms\ are\ set\ to\ supported}}
\DoxyCodeLine{00189\ \textcolor{comment}{\ *\ values\ and\ that\ the\ signature\ field\ is\ set.}}
\DoxyCodeLine{00190\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00191\ \_\_owur\ \textcolor{keywordtype}{int}\ SCT\_signature\_is\_complete(\textcolor{keyword}{const}\ SCT\ *sct);}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \textcolor{comment}{/*}}
\DoxyCodeLine{00194\ \textcolor{comment}{*\ Serialize\ (to\ TLS\ format)\ an\ |sct|\ signature\ and\ write\ it\ to\ |out|.}}
\DoxyCodeLine{00195\ \textcolor{comment}{*\ If\ |out|\ is\ null,\ no\ signature\ will\ be\ output\ but\ the\ length\ will\ be\ returned.}}
\DoxyCodeLine{00196\ \textcolor{comment}{*\ If\ |out|\ points\ to\ a\ null\ pointer,\ a\ string\ will\ be\ allocated\ to\ hold\ the}}
\DoxyCodeLine{00197\ \textcolor{comment}{*\ TLS-\/format\ signature.\ It\ is\ the\ responsibility\ of\ the\ caller\ to\ free\ it.}}
\DoxyCodeLine{00198\ \textcolor{comment}{*\ If\ |out|\ points\ to\ an\ allocated\ string,\ the\ signature\ will\ be\ written\ to\ it.}}
\DoxyCodeLine{00199\ \textcolor{comment}{*\ The\ length\ of\ the\ signature\ in\ TLS\ format\ will\ be\ returned.}}
\DoxyCodeLine{00200\ \textcolor{comment}{*/}}
\DoxyCodeLine{00201\ \_\_owur\ \textcolor{keywordtype}{int}\ i2o\_SCT\_signature(\textcolor{keyword}{const}\ SCT\ *sct,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ **out);}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ \textcolor{comment}{/*}}
\DoxyCodeLine{00204\ \textcolor{comment}{*\ Parses\ an\ SCT\ signature\ in\ TLS\ format\ and\ populates\ the\ |sct|\ with\ it.}}
\DoxyCodeLine{00205\ \textcolor{comment}{*\ |in|\ should\ be\ a\ pointer\ to\ a\ string\ containing\ the\ TLS-\/format\ signature.}}
\DoxyCodeLine{00206\ \textcolor{comment}{*\ |in|\ will\ be\ advanced\ to\ the\ end\ of\ the\ signature\ if\ parsing\ succeeds.}}
\DoxyCodeLine{00207\ \textcolor{comment}{*\ |len|\ should\ be\ the\ length\ of\ the\ signature\ in\ |in|.}}
\DoxyCodeLine{00208\ \textcolor{comment}{*\ Returns\ the\ number\ of\ bytes\ parsed,\ or\ a\ negative\ integer\ if\ an\ error\ occurs.}}
\DoxyCodeLine{00209\ \textcolor{comment}{*\ If\ an\ error\ occurs,\ the\ SCT's\ signature\ NID\ may\ be\ updated\ whilst\ the}}
\DoxyCodeLine{00210\ \textcolor{comment}{*\ signature\ field\ itself\ remains\ unset.}}
\DoxyCodeLine{00211\ \textcolor{comment}{*/}}
\DoxyCodeLine{00212\ \_\_owur\ \textcolor{keywordtype}{int}\ o2i\_SCT\_signature(SCT\ *sct,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ **in,\ \textcolor{keywordtype}{size\_t}\ len);}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00214\ \textcolor{comment}{/*}}
\DoxyCodeLine{00215\ \textcolor{comment}{\ *\ Handlers\ for\ Certificate\ Transparency\ X509v3/OCSP\ extensions}}
\DoxyCodeLine{00216\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00217\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ X509V3\_EXT\_METHOD\ ossl\_v3\_ct\_scts[3];}

\end{DoxyCode}
