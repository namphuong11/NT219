\doxysection{ssl\+\_\+local.\+h}
\hypertarget{ssl__local_8h_source}{}\label{ssl__local_8h_source}\index{C:/Users/namph/Downloads/openssl/openssl-\/3.2.1/ssl/ssl\_local.h@{C:/Users/namph/Downloads/openssl/openssl-\/3.2.1/ssl/ssl\_local.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ *\ Copyright\ 1995-\/2023\ The\ OpenSSL\ Project\ Authors.\ All\ Rights\ Reserved.}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *\ Copyright\ (c)\ 2002,\ Oracle\ and/or\ its\ affiliates.\ All\ rights\ reserved}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *\ Copyright\ 2005\ Nokia.\ All\ rights\ reserved.}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ *\ Licensed\ under\ the\ Apache\ License\ 2.0\ (the\ "{}License"{}).\ \ You\ may\ not\ use}}
\DoxyCodeLine{00007\ \textcolor{comment}{\ *\ this\ file\ except\ in\ compliance\ with\ the\ License.\ \ You\ can\ obtain\ a\ copy}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ *\ in\ the\ file\ LICENSE\ in\ the\ source\ distribution\ or\ at}}
\DoxyCodeLine{00009\ \textcolor{comment}{\ *\ https://www.openssl.org/source/license.html}}
\DoxyCodeLine{00010\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#ifndef\ OSSL\_SSL\_LOCAL\_H}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#\ define\ OSSL\_SSL\_LOCAL\_H}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#\ include\ "{}internal/e\_os.h"{}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ struct\ timeval\ for\ DTLS\ */}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#\ include\ <stdlib.h>}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#\ include\ <time.h>}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#\ include\ <errno.h>}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#\ include\ "{}internal/common.h"{}}\ \textcolor{comment}{/*\ for\ HAS\_PREFIX\ */}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#\ include\ <openssl/buffer.h>}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#\ include\ <openssl/bio.h>}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#\ include\ <openssl/comp.h>}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#\ include\ <openssl/dsa.h>}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#\ include\ <openssl/err.h>}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#\ include\ <openssl/ssl.h>}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#\ include\ <openssl/async.h>}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#\ include\ <openssl/symhacks.h>}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#\ include\ <openssl/ct.h>}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#\ include\ "{}internal/recordmethod.h"{}}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#\ include\ "{}internal/statem.h"{}}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#\ include\ "{}internal/packet.h"{}}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#\ include\ "{}internal/dane.h"{}}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#\ include\ "{}internal/refcount.h"{}}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#\ include\ "{}internal/tsan\_assist.h"{}}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#\ include\ "{}internal/bio.h"{}}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#\ include\ "{}internal/ktls.h"{}}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#\ include\ "{}internal/time.h"{}}}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#\ include\ "{}internal/ssl.h"{}}}
\DoxyCodeLine{00040\ \textcolor{preprocessor}{\#\ include\ "{}record/record.h"{}}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#\ ifdef\ OPENSSL\_BUILD\_SHLIBSSL}}
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\#\ \ undef\ OPENSSL\_EXTERN}}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#\ \ define\ OPENSSL\_EXTERN\ OPENSSL\_EXPORT}}
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \textcolor{preprocessor}{\#\ define\ TLS\_MAX\_VERSION\_INTERNAL\ TLS1\_3\_VERSION}}
\DoxyCodeLine{00048\ \textcolor{preprocessor}{\#\ define\ DTLS\_MAX\_VERSION\_INTERNAL\ DTLS1\_2\_VERSION}}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \textcolor{comment}{/*}}
\DoxyCodeLine{00051\ \textcolor{comment}{\ *\ DTLS\ version\ numbers\ are\ strange\ because\ they're\ inverted.\ Except\ for}}
\DoxyCodeLine{00052\ \textcolor{comment}{\ *\ DTLS1\_BAD\_VER,\ which\ should\ be\ considered\ "{}lower"{}\ than\ the\ rest.}}
\DoxyCodeLine{00053\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00054\ \textcolor{preprocessor}{\#\ define\ dtls\_ver\_ordinal(v1)\ (((v1)\ ==\ DTLS1\_BAD\_VER)\ ?\ 0xff00\ :\ (v1))}}
\DoxyCodeLine{00055\ \textcolor{preprocessor}{\#\ define\ DTLS\_VERSION\_GT(v1,\ v2)\ (dtls\_ver\_ordinal(v1)\ <\ dtls\_ver\_ordinal(v2))}}
\DoxyCodeLine{00056\ \textcolor{preprocessor}{\#\ define\ DTLS\_VERSION\_GE(v1,\ v2)\ (dtls\_ver\_ordinal(v1)\ <=\ dtls\_ver\_ordinal(v2))}}
\DoxyCodeLine{00057\ \textcolor{preprocessor}{\#\ define\ DTLS\_VERSION\_LT(v1,\ v2)\ (dtls\_ver\_ordinal(v1)\ >\ dtls\_ver\_ordinal(v2))}}
\DoxyCodeLine{00058\ \textcolor{preprocessor}{\#\ define\ DTLS\_VERSION\_LE(v1,\ v2)\ (dtls\_ver\_ordinal(v1)\ >=\ dtls\_ver\_ordinal(v2))}}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \textcolor{preprocessor}{\#\ define\ SSL\_AD\_NO\_ALERT\ \ \ \ -\/1}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \textcolor{comment}{/*}}
\DoxyCodeLine{00063\ \textcolor{comment}{\ *\ Define\ the\ Bitmasks\ for\ SSL\_CIPHER.algorithms.}}
\DoxyCodeLine{00064\ \textcolor{comment}{\ *\ This\ bits\ are\ used\ packed\ as\ dense\ as\ possible.\ If\ new\ methods/ciphers}}
\DoxyCodeLine{00065\ \textcolor{comment}{\ *\ etc\ will\ be\ added,\ the\ bits\ a\ likely\ to\ change,\ so\ this\ information}}
\DoxyCodeLine{00066\ \textcolor{comment}{\ *\ is\ for\ internal\ library\ use\ only,\ even\ though\ SSL\_CIPHER.algorithms}}
\DoxyCodeLine{00067\ \textcolor{comment}{\ *\ can\ be\ publicly\ accessed.}}
\DoxyCodeLine{00068\ \textcolor{comment}{\ *\ Use\ the\ according\ functions\ for\ cipher\ management\ instead.}}
\DoxyCodeLine{00069\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00070\ \textcolor{comment}{\ *\ The\ bit\ mask\ handling\ in\ the\ selection\ and\ sorting\ scheme\ in}}
\DoxyCodeLine{00071\ \textcolor{comment}{\ *\ ssl\_create\_cipher\_list()\ has\ only\ limited\ capabilities,\ reflecting}}
\DoxyCodeLine{00072\ \textcolor{comment}{\ *\ that\ the\ different\ entities\ within\ are\ mutually\ exclusive:}}
\DoxyCodeLine{00073\ \textcolor{comment}{\ *\ ONLY\ ONE\ BIT\ PER\ MASK\ CAN\ BE\ SET\ AT\ A\ TIME.}}
\DoxyCodeLine{00074\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \textcolor{comment}{/*\ Bits\ for\ algorithm\_mkey\ (key\ exchange\ algorithm)\ */}}
\DoxyCodeLine{00077\ \textcolor{comment}{/*\ RSA\ key\ exchange\ */}}
\DoxyCodeLine{00078\ \textcolor{preprocessor}{\#\ define\ SSL\_kRSA\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000001U}}
\DoxyCodeLine{00079\ \textcolor{comment}{/*\ tmp\ DH\ key\ no\ DH\ cert\ */}}
\DoxyCodeLine{00080\ \textcolor{preprocessor}{\#\ define\ SSL\_kDHE\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000002U}}
\DoxyCodeLine{00081\ \textcolor{comment}{/*\ synonym\ */}}
\DoxyCodeLine{00082\ \textcolor{preprocessor}{\#\ define\ SSL\_kEDH\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SSL\_kDHE}}
\DoxyCodeLine{00083\ \textcolor{comment}{/*\ ephemeral\ ECDH\ */}}
\DoxyCodeLine{00084\ \textcolor{preprocessor}{\#\ define\ SSL\_kECDHE\ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000004U}}
\DoxyCodeLine{00085\ \textcolor{comment}{/*\ synonym\ */}}
\DoxyCodeLine{00086\ \textcolor{preprocessor}{\#\ define\ SSL\_kEECDH\ \ \ \ \ \ \ \ \ \ \ \ \ \ SSL\_kECDHE}}
\DoxyCodeLine{00087\ \textcolor{comment}{/*\ PSK\ */}}
\DoxyCodeLine{00088\ \textcolor{preprocessor}{\#\ define\ SSL\_kPSK\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000008U}}
\DoxyCodeLine{00089\ \textcolor{comment}{/*\ GOST\ key\ exchange\ */}}
\DoxyCodeLine{00090\ \textcolor{preprocessor}{\#\ define\ SSL\_kGOST\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000010U}}
\DoxyCodeLine{00091\ \textcolor{comment}{/*\ SRP\ */}}
\DoxyCodeLine{00092\ \textcolor{preprocessor}{\#\ define\ SSL\_kSRP\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000020U}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \textcolor{preprocessor}{\#\ define\ SSL\_kRSAPSK\ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000040U}}
\DoxyCodeLine{00095\ \textcolor{preprocessor}{\#\ define\ SSL\_kECDHEPSK\ \ \ \ \ \ \ \ \ \ \ 0x00000080U}}
\DoxyCodeLine{00096\ \textcolor{preprocessor}{\#\ define\ SSL\_kDHEPSK\ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000100U}}
\DoxyCodeLine{00097\ \textcolor{comment}{/*\ GOST\ KDF\ key\ exchange,\ draft-\/smyshlyaev-\/tls12-\/gost-\/suites\ */}}
\DoxyCodeLine{00098\ \textcolor{preprocessor}{\#\ define\ SSL\_kGOST18\ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000200U}}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \textcolor{comment}{/*\ all\ PSK\ */}}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \textcolor{preprocessor}{\#\ define\ SSL\_PSK\ \ \ \ \ (SSL\_kPSK\ |\ SSL\_kRSAPSK\ |\ SSL\_kECDHEPSK\ |\ SSL\_kDHEPSK)}}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \textcolor{comment}{/*\ Any\ appropriate\ key\ exchange\ algorithm\ (for\ TLS\ 1.3\ ciphersuites)\ */}}
\DoxyCodeLine{00105\ \textcolor{preprocessor}{\#\ define\ SSL\_kANY\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000000U}}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \textcolor{comment}{/*\ Bits\ for\ algorithm\_auth\ (server\ authentication)\ */}}
\DoxyCodeLine{00108\ \textcolor{comment}{/*\ RSA\ auth\ */}}
\DoxyCodeLine{00109\ \textcolor{preprocessor}{\#\ define\ SSL\_aRSA\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000001U}}
\DoxyCodeLine{00110\ \textcolor{comment}{/*\ DSS\ auth\ */}}
\DoxyCodeLine{00111\ \textcolor{preprocessor}{\#\ define\ SSL\_aDSS\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000002U}}
\DoxyCodeLine{00112\ \textcolor{comment}{/*\ no\ auth\ (i.e.\ use\ ADH\ or\ AECDH)\ */}}
\DoxyCodeLine{00113\ \textcolor{preprocessor}{\#\ define\ SSL\_aNULL\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000004U}}
\DoxyCodeLine{00114\ \textcolor{comment}{/*\ ECDSA\ auth*/}}
\DoxyCodeLine{00115\ \textcolor{preprocessor}{\#\ define\ SSL\_aECDSA\ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000008U}}
\DoxyCodeLine{00116\ \textcolor{comment}{/*\ PSK\ auth\ */}}
\DoxyCodeLine{00117\ \textcolor{preprocessor}{\#\ define\ SSL\_aPSK\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000010U}}
\DoxyCodeLine{00118\ \textcolor{comment}{/*\ GOST\ R\ 34.10-\/2001\ signature\ auth\ */}}
\DoxyCodeLine{00119\ \textcolor{preprocessor}{\#\ define\ SSL\_aGOST01\ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000020U}}
\DoxyCodeLine{00120\ \textcolor{comment}{/*\ SRP\ auth\ */}}
\DoxyCodeLine{00121\ \textcolor{preprocessor}{\#\ define\ SSL\_aSRP\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000040U}}
\DoxyCodeLine{00122\ \textcolor{comment}{/*\ GOST\ R\ 34.10-\/2012\ signature\ auth\ */}}
\DoxyCodeLine{00123\ \textcolor{preprocessor}{\#\ define\ SSL\_aGOST12\ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000080U}}
\DoxyCodeLine{00124\ \textcolor{comment}{/*\ Any\ appropriate\ signature\ auth\ (for\ TLS\ 1.3\ ciphersuites)\ */}}
\DoxyCodeLine{00125\ \textcolor{preprocessor}{\#\ define\ SSL\_aANY\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000000U}}
\DoxyCodeLine{00126\ \textcolor{comment}{/*\ All\ bits\ requiring\ a\ certificate\ */}}
\DoxyCodeLine{00127\ \textcolor{preprocessor}{\#define\ SSL\_aCERT\ \(\backslash\)}}
\DoxyCodeLine{00128\ \textcolor{preprocessor}{\ \ \ \ (SSL\_aRSA\ |\ SSL\_aDSS\ |\ SSL\_aECDSA\ |\ SSL\_aGOST01\ |\ SSL\_aGOST12)}}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \textcolor{comment}{/*\ Bits\ for\ algorithm\_enc\ (symmetric\ encryption)\ */}}
\DoxyCodeLine{00131\ \textcolor{preprocessor}{\#\ define\ SSL\_DES\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000001U}}
\DoxyCodeLine{00132\ \textcolor{preprocessor}{\#\ define\ SSL\_3DES\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000002U}}
\DoxyCodeLine{00133\ \textcolor{preprocessor}{\#\ define\ SSL\_RC4\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000004U}}
\DoxyCodeLine{00134\ \textcolor{preprocessor}{\#\ define\ SSL\_RC2\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000008U}}
\DoxyCodeLine{00135\ \textcolor{preprocessor}{\#\ define\ SSL\_IDEA\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000010U}}
\DoxyCodeLine{00136\ \textcolor{preprocessor}{\#\ define\ SSL\_eNULL\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000020U}}
\DoxyCodeLine{00137\ \textcolor{preprocessor}{\#\ define\ SSL\_AES128\ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000040U}}
\DoxyCodeLine{00138\ \textcolor{preprocessor}{\#\ define\ SSL\_AES256\ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000080U}}
\DoxyCodeLine{00139\ \textcolor{preprocessor}{\#\ define\ SSL\_CAMELLIA128\ \ \ \ \ \ \ \ \ 0x00000100U}}
\DoxyCodeLine{00140\ \textcolor{preprocessor}{\#\ define\ SSL\_CAMELLIA256\ \ \ \ \ \ \ \ \ 0x00000200U}}
\DoxyCodeLine{00141\ \textcolor{preprocessor}{\#\ define\ SSL\_eGOST2814789CNT\ \ \ \ \ 0x00000400U}}
\DoxyCodeLine{00142\ \textcolor{preprocessor}{\#\ define\ SSL\_SEED\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000800U}}
\DoxyCodeLine{00143\ \textcolor{preprocessor}{\#\ define\ SSL\_AES128GCM\ \ \ \ \ \ \ \ \ \ \ 0x00001000U}}
\DoxyCodeLine{00144\ \textcolor{preprocessor}{\#\ define\ SSL\_AES256GCM\ \ \ \ \ \ \ \ \ \ \ 0x00002000U}}
\DoxyCodeLine{00145\ \textcolor{preprocessor}{\#\ define\ SSL\_AES128CCM\ \ \ \ \ \ \ \ \ \ \ 0x00004000U}}
\DoxyCodeLine{00146\ \textcolor{preprocessor}{\#\ define\ SSL\_AES256CCM\ \ \ \ \ \ \ \ \ \ \ 0x00008000U}}
\DoxyCodeLine{00147\ \textcolor{preprocessor}{\#\ define\ SSL\_AES128CCM8\ \ \ \ \ \ \ \ \ \ 0x00010000U}}
\DoxyCodeLine{00148\ \textcolor{preprocessor}{\#\ define\ SSL\_AES256CCM8\ \ \ \ \ \ \ \ \ \ 0x00020000U}}
\DoxyCodeLine{00149\ \textcolor{preprocessor}{\#\ define\ SSL\_eGOST2814789CNT12\ \ \ 0x00040000U}}
\DoxyCodeLine{00150\ \textcolor{preprocessor}{\#\ define\ SSL\_CHACHA20POLY1305\ \ \ \ 0x00080000U}}
\DoxyCodeLine{00151\ \textcolor{preprocessor}{\#\ define\ SSL\_ARIA128GCM\ \ \ \ \ \ \ \ \ \ 0x00100000U}}
\DoxyCodeLine{00152\ \textcolor{preprocessor}{\#\ define\ SSL\_ARIA256GCM\ \ \ \ \ \ \ \ \ \ 0x00200000U}}
\DoxyCodeLine{00153\ \textcolor{preprocessor}{\#\ define\ SSL\_MAGMA\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00400000U}}
\DoxyCodeLine{00154\ \textcolor{preprocessor}{\#\ define\ SSL\_KUZNYECHIK\ \ \ \ \ \ \ \ \ \ 0x00800000U}}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \textcolor{preprocessor}{\#\ define\ SSL\_AESGCM\ \ \ \ \ \ \ \ \ \ \ \ \ \ (SSL\_AES128GCM\ |\ SSL\_AES256GCM)}}
\DoxyCodeLine{00157\ \textcolor{preprocessor}{\#\ define\ SSL\_AESCCM\ \ \ \ \ \ \ \ \ \ \ \ \ \ (SSL\_AES128CCM\ |\ SSL\_AES256CCM\ |\ SSL\_AES128CCM8\ |\ SSL\_AES256CCM8)}}
\DoxyCodeLine{00158\ \textcolor{preprocessor}{\#\ define\ SSL\_AES\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (SSL\_AES128|SSL\_AES256|SSL\_AESGCM|SSL\_AESCCM)}}
\DoxyCodeLine{00159\ \textcolor{preprocessor}{\#\ define\ SSL\_CAMELLIA\ \ \ \ \ \ \ \ \ \ \ \ (SSL\_CAMELLIA128|SSL\_CAMELLIA256)}}
\DoxyCodeLine{00160\ \textcolor{preprocessor}{\#\ define\ SSL\_CHACHA20\ \ \ \ \ \ \ \ \ \ \ \ (SSL\_CHACHA20POLY1305)}}
\DoxyCodeLine{00161\ \textcolor{preprocessor}{\#\ define\ SSL\_ARIAGCM\ \ \ \ \ \ \ \ \ \ \ \ \ (SSL\_ARIA128GCM\ |\ SSL\_ARIA256GCM)}}
\DoxyCodeLine{00162\ \textcolor{preprocessor}{\#\ define\ SSL\_ARIA\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (SSL\_ARIAGCM)}}
\DoxyCodeLine{00163\ \textcolor{preprocessor}{\#\ define\ SSL\_CBC\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (SSL\_DES\ |\ SSL\_3DES\ |\ SSL\_RC2\ |\ SSL\_IDEA\ \(\backslash\)}}
\DoxyCodeLine{00164\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ SSL\_AES128\ |\ SSL\_AES256\ |\ SSL\_CAMELLIA128\ \(\backslash\)}}
\DoxyCodeLine{00165\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ SSL\_CAMELLIA256\ |\ SSL\_SEED)}}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \textcolor{comment}{/*\ Bits\ for\ algorithm\_mac\ (symmetric\ authentication)\ */}}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \textcolor{preprocessor}{\#\ define\ SSL\_MD5\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000001U}}
\DoxyCodeLine{00170\ \textcolor{preprocessor}{\#\ define\ SSL\_SHA1\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000002U}}
\DoxyCodeLine{00171\ \textcolor{preprocessor}{\#\ define\ SSL\_GOST94\ \ \ \ \ \ 0x00000004U}}
\DoxyCodeLine{00172\ \textcolor{preprocessor}{\#\ define\ SSL\_GOST89MAC\ \ \ 0x00000008U}}
\DoxyCodeLine{00173\ \textcolor{preprocessor}{\#\ define\ SSL\_SHA256\ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000010U}}
\DoxyCodeLine{00174\ \textcolor{preprocessor}{\#\ define\ SSL\_SHA384\ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000020U}}
\DoxyCodeLine{00175\ \textcolor{comment}{/*\ Not\ a\ real\ MAC,\ just\ an\ indication\ it\ is\ part\ of\ cipher\ */}}
\DoxyCodeLine{00176\ \textcolor{preprocessor}{\#\ define\ SSL\_AEAD\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000040U}}
\DoxyCodeLine{00177\ \textcolor{preprocessor}{\#\ define\ SSL\_GOST12\_256\ \ \ \ \ \ \ \ \ \ 0x00000080U}}
\DoxyCodeLine{00178\ \textcolor{preprocessor}{\#\ define\ SSL\_GOST89MAC12\ \ \ \ \ \ \ \ \ 0x00000100U}}
\DoxyCodeLine{00179\ \textcolor{preprocessor}{\#\ define\ SSL\_GOST12\_512\ \ \ \ \ \ \ \ \ \ 0x00000200U}}
\DoxyCodeLine{00180\ \textcolor{preprocessor}{\#\ define\ SSL\_MAGMAOMAC\ \ \ \ \ \ \ \ \ \ \ 0x00000400U}}
\DoxyCodeLine{00181\ \textcolor{preprocessor}{\#\ define\ SSL\_KUZNYECHIKOMAC\ \ \ \ \ \ 0x00000800U}}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \textcolor{comment}{/*}}
\DoxyCodeLine{00184\ \textcolor{comment}{\ *\ When\ adding\ new\ digest\ in\ the\ ssl\_ciph.c\ and\ increment\ SSL\_MD\_NUM\_IDX\ make}}
\DoxyCodeLine{00185\ \textcolor{comment}{\ *\ sure\ to\ update\ this\ constant\ too}}
\DoxyCodeLine{00186\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \textcolor{preprocessor}{\#\ define\ SSL\_MD\_MD5\_IDX\ \ 0}}
\DoxyCodeLine{00189\ \textcolor{preprocessor}{\#\ define\ SSL\_MD\_SHA1\_IDX\ 1}}
\DoxyCodeLine{00190\ \textcolor{preprocessor}{\#\ define\ SSL\_MD\_GOST94\_IDX\ 2}}
\DoxyCodeLine{00191\ \textcolor{preprocessor}{\#\ define\ SSL\_MD\_GOST89MAC\_IDX\ 3}}
\DoxyCodeLine{00192\ \textcolor{preprocessor}{\#\ define\ SSL\_MD\_SHA256\_IDX\ 4}}
\DoxyCodeLine{00193\ \textcolor{preprocessor}{\#\ define\ SSL\_MD\_SHA384\_IDX\ 5}}
\DoxyCodeLine{00194\ \textcolor{preprocessor}{\#\ define\ SSL\_MD\_GOST12\_256\_IDX\ \ 6}}
\DoxyCodeLine{00195\ \textcolor{preprocessor}{\#\ define\ SSL\_MD\_GOST89MAC12\_IDX\ 7}}
\DoxyCodeLine{00196\ \textcolor{preprocessor}{\#\ define\ SSL\_MD\_GOST12\_512\_IDX\ \ 8}}
\DoxyCodeLine{00197\ \textcolor{preprocessor}{\#\ define\ SSL\_MD\_MD5\_SHA1\_IDX\ 9}}
\DoxyCodeLine{00198\ \textcolor{preprocessor}{\#\ define\ SSL\_MD\_SHA224\_IDX\ 10}}
\DoxyCodeLine{00199\ \textcolor{preprocessor}{\#\ define\ SSL\_MD\_SHA512\_IDX\ 11}}
\DoxyCodeLine{00200\ \textcolor{preprocessor}{\#\ define\ SSL\_MD\_MAGMAOMAC\_IDX\ 12}}
\DoxyCodeLine{00201\ \textcolor{preprocessor}{\#\ define\ SSL\_MD\_KUZNYECHIKOMAC\_IDX\ 13}}
\DoxyCodeLine{00202\ \textcolor{preprocessor}{\#\ define\ SSL\_MAX\_DIGEST\ 14}}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ \textcolor{preprocessor}{\#define\ SSL\_MD\_NUM\_IDX\ \ SSL\_MAX\_DIGEST}}
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00206\ \textcolor{comment}{/*\ Bits\ for\ algorithm2\ (handshake\ digests\ and\ other\ extra\ flags)\ */}}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \textcolor{comment}{/*\ Bits\ 0-\/7\ are\ handshake\ MAC\ */}}
\DoxyCodeLine{00209\ \textcolor{preprocessor}{\#\ define\ SSL\_HANDSHAKE\_MAC\_MASK\ \ 0xFF}}
\DoxyCodeLine{00210\ \textcolor{preprocessor}{\#\ define\ SSL\_HANDSHAKE\_MAC\_MD5\_SHA1\ SSL\_MD\_MD5\_SHA1\_IDX}}
\DoxyCodeLine{00211\ \textcolor{preprocessor}{\#\ define\ SSL\_HANDSHAKE\_MAC\_SHA256\ \ \ SSL\_MD\_SHA256\_IDX}}
\DoxyCodeLine{00212\ \textcolor{preprocessor}{\#\ define\ SSL\_HANDSHAKE\_MAC\_SHA384\ \ \ SSL\_MD\_SHA384\_IDX}}
\DoxyCodeLine{00213\ \textcolor{preprocessor}{\#\ define\ SSL\_HANDSHAKE\_MAC\_GOST94\ SSL\_MD\_GOST94\_IDX}}
\DoxyCodeLine{00214\ \textcolor{preprocessor}{\#\ define\ SSL\_HANDSHAKE\_MAC\_GOST12\_256\ SSL\_MD\_GOST12\_256\_IDX}}
\DoxyCodeLine{00215\ \textcolor{preprocessor}{\#\ define\ SSL\_HANDSHAKE\_MAC\_GOST12\_512\ SSL\_MD\_GOST12\_512\_IDX}}
\DoxyCodeLine{00216\ \textcolor{preprocessor}{\#\ define\ SSL\_HANDSHAKE\_MAC\_DEFAULT\ \ SSL\_HANDSHAKE\_MAC\_MD5\_SHA1}}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00218\ \textcolor{comment}{/*\ Bits\ 8-\/15\ bits\ are\ PRF\ */}}
\DoxyCodeLine{00219\ \textcolor{preprocessor}{\#\ define\ TLS1\_PRF\_DGST\_SHIFT\ 8}}
\DoxyCodeLine{00220\ \textcolor{preprocessor}{\#\ define\ TLS1\_PRF\_SHA1\_MD5\ (SSL\_MD\_MD5\_SHA1\_IDX\ <<\ TLS1\_PRF\_DGST\_SHIFT)}}
\DoxyCodeLine{00221\ \textcolor{preprocessor}{\#\ define\ TLS1\_PRF\_SHA256\ (SSL\_MD\_SHA256\_IDX\ <<\ TLS1\_PRF\_DGST\_SHIFT)}}
\DoxyCodeLine{00222\ \textcolor{preprocessor}{\#\ define\ TLS1\_PRF\_SHA384\ (SSL\_MD\_SHA384\_IDX\ <<\ TLS1\_PRF\_DGST\_SHIFT)}}
\DoxyCodeLine{00223\ \textcolor{preprocessor}{\#\ define\ TLS1\_PRF\_GOST94\ (SSL\_MD\_GOST94\_IDX\ <<\ TLS1\_PRF\_DGST\_SHIFT)}}
\DoxyCodeLine{00224\ \textcolor{preprocessor}{\#\ define\ TLS1\_PRF\_GOST12\_256\ (SSL\_MD\_GOST12\_256\_IDX\ <<\ TLS1\_PRF\_DGST\_SHIFT)}}
\DoxyCodeLine{00225\ \textcolor{preprocessor}{\#\ define\ TLS1\_PRF\_GOST12\_512\ (SSL\_MD\_GOST12\_512\_IDX\ <<\ TLS1\_PRF\_DGST\_SHIFT)}}
\DoxyCodeLine{00226\ \textcolor{preprocessor}{\#\ define\ TLS1\_PRF\ \ \ \ \ \ \ \ \ \ \ \ (SSL\_MD\_MD5\_SHA1\_IDX\ <<\ TLS1\_PRF\_DGST\_SHIFT)}}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00228\ \textcolor{comment}{/*}}
\DoxyCodeLine{00229\ \textcolor{comment}{\ *\ Stream\ MAC\ for\ GOST\ ciphersuites\ from\ cryptopro\ draft\ (currently\ this\ also}}
\DoxyCodeLine{00230\ \textcolor{comment}{\ *\ goes\ into\ algorithm2)}}
\DoxyCodeLine{00231\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00232\ \textcolor{preprocessor}{\#\ define\ TLS1\_STREAM\_MAC\ 0x10000}}
\DoxyCodeLine{00233\ \textcolor{comment}{/*}}
\DoxyCodeLine{00234\ \textcolor{comment}{\ *\ TLSTREE\ cipher/mac\ key\ derivation\ from\ draft-\/smyshlyaev-\/tls12-\/gost-\/suites}}
\DoxyCodeLine{00235\ \textcolor{comment}{\ *\ (currently\ this\ also\ \ goes\ into\ algorithm2)}}
\DoxyCodeLine{00236\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00237\ \textcolor{preprocessor}{\#\ define\ TLS1\_TLSTREE\ 0x20000}}
\DoxyCodeLine{00238\ }
\DoxyCodeLine{00239\ \textcolor{comment}{/*\ Ciphersuite\ supported\ in\ QUIC\ */}}
\DoxyCodeLine{00240\ \textcolor{preprocessor}{\#\ define\ SSL\_QUIC\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00040000U}}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00242\ \textcolor{preprocessor}{\#\ define\ SSL\_STRONG\_MASK\ \ \ \ \ \ \ \ \ 0x0000001FU}}
\DoxyCodeLine{00243\ \textcolor{preprocessor}{\#\ define\ SSL\_DEFAULT\_MASK\ \ \ \ \ \ \ \ 0X00000020U}}
\DoxyCodeLine{00244\ }
\DoxyCodeLine{00245\ \textcolor{preprocessor}{\#\ define\ SSL\_STRONG\_NONE\ \ \ \ \ \ \ \ \ 0x00000001U}}
\DoxyCodeLine{00246\ \textcolor{preprocessor}{\#\ define\ SSL\_LOW\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000002U}}
\DoxyCodeLine{00247\ \textcolor{preprocessor}{\#\ define\ SSL\_MEDIUM\ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000004U}}
\DoxyCodeLine{00248\ \textcolor{preprocessor}{\#\ define\ SSL\_HIGH\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000008U}}
\DoxyCodeLine{00249\ \textcolor{preprocessor}{\#\ define\ SSL\_FIPS\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000010U}}
\DoxyCodeLine{00250\ \textcolor{preprocessor}{\#\ define\ SSL\_NOT\_DEFAULT\ \ \ \ \ \ \ \ \ 0x00000020U}}
\DoxyCodeLine{00251\ }
\DoxyCodeLine{00252\ \textcolor{comment}{/*\ we\ have\ used\ 0000003f\ -\/\ 26\ bits\ left\ to\ go\ */}}
\DoxyCodeLine{00253\ }
\DoxyCodeLine{00254\ \textcolor{comment}{/*\ Flag\ used\ on\ OpenSSL\ ciphersuite\ ids\ to\ indicate\ they\ are\ for\ SSLv3+\ */}}
\DoxyCodeLine{00255\ \textcolor{preprocessor}{\#\ define\ SSL3\_CK\_CIPHERSUITE\_FLAG\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x03000000}}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ \textcolor{comment}{/*\ Check\ if\ an\ SSL\ structure\ is\ using\ DTLS\ */}}
\DoxyCodeLine{00258\ \textcolor{preprocessor}{\#\ define\ SSL\_CONNECTION\_IS\_DTLS(s)\ \(\backslash\)}}
\DoxyCodeLine{00259\ \textcolor{preprocessor}{\ \ \ \ (SSL\_CONNECTION\_GET\_SSL(s)-\/>method-\/>ssl3\_enc-\/>enc\_flags\ \&\ SSL\_ENC\_FLAG\_DTLS)}}
\DoxyCodeLine{00260\ }
\DoxyCodeLine{00261\ \textcolor{comment}{/*\ Check\ if\ we\ are\ using\ TLSv1.3\ */}}
\DoxyCodeLine{00262\ \textcolor{preprocessor}{\#\ define\ SSL\_CONNECTION\_IS\_TLS13(s)\ (!SSL\_CONNECTION\_IS\_DTLS(s)\ \(\backslash\)}}
\DoxyCodeLine{00263\ \textcolor{preprocessor}{\ \ \ \ \&\&\ SSL\_CONNECTION\_GET\_SSL(s)-\/>method-\/>version\ >=\ TLS1\_3\_VERSION\ \(\backslash\)}}
\DoxyCodeLine{00264\ \textcolor{preprocessor}{\ \ \ \ \&\&\ SSL\_CONNECTION\_GET\_SSL(s)-\/>method-\/>version\ !=\ TLS\_ANY\_VERSION)}}
\DoxyCodeLine{00265\ }
\DoxyCodeLine{00266\ \textcolor{preprocessor}{\#\ define\ SSL\_CONNECTION\_TREAT\_AS\_TLS13(s)\ \(\backslash\)}}
\DoxyCodeLine{00267\ \textcolor{preprocessor}{\ \ \ \ (SSL\_CONNECTION\_IS\_TLS13(s)\ \(\backslash\)}}
\DoxyCodeLine{00268\ \textcolor{preprocessor}{\ \ \ \ \ ||\ (s)-\/>early\_data\_state\ ==\ SSL\_EARLY\_DATA\_CONNECTING\ \(\backslash\)}}
\DoxyCodeLine{00269\ \textcolor{preprocessor}{\ \ \ \ \ ||\ (s)-\/>early\_data\_state\ ==\ SSL\_EARLY\_DATA\_CONNECT\_RETRY\ \(\backslash\)}}
\DoxyCodeLine{00270\ \textcolor{preprocessor}{\ \ \ \ \ ||\ (s)-\/>early\_data\_state\ ==\ SSL\_EARLY\_DATA\_WRITING\ \(\backslash\)}}
\DoxyCodeLine{00271\ \textcolor{preprocessor}{\ \ \ \ \ ||\ (s)-\/>early\_data\_state\ ==\ SSL\_EARLY\_DATA\_WRITE\_RETRY\ \(\backslash\)}}
\DoxyCodeLine{00272\ \textcolor{preprocessor}{\ \ \ \ \ ||\ (s)-\/>hello\_retry\_request\ ==\ SSL\_HRR\_PENDING)}}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ \textcolor{preprocessor}{\#\ define\ SSL\_IS\_FIRST\_HANDSHAKE(s)\ ((s)-\/>s3.tmp.finish\_md\_len\ ==\ 0\ \(\backslash\)}}
\DoxyCodeLine{00275\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ||\ (s)-\/>s3.tmp.peer\_finish\_md\_len\ ==\ 0)}}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \textcolor{comment}{/*\ See\ if\ we\ need\ explicit\ IV\ */}}
\DoxyCodeLine{00278\ \textcolor{preprocessor}{\#\ define\ SSL\_USE\_EXPLICIT\_IV(s)\ \ \(\backslash\)}}
\DoxyCodeLine{00279\ \textcolor{preprocessor}{\ \ \ \ (SSL\_CONNECTION\_GET\_SSL(s)-\/>method-\/>ssl3\_enc-\/>enc\_flags\ \&\ SSL\_ENC\_FLAG\_EXPLICIT\_IV)}}
\DoxyCodeLine{00280\ \textcolor{comment}{/*}}
\DoxyCodeLine{00281\ \textcolor{comment}{\ *\ See\ if\ we\ use\ signature\ algorithms\ extension\ and\ signature\ algorithm}}
\DoxyCodeLine{00282\ \textcolor{comment}{\ *\ before\ signatures.}}
\DoxyCodeLine{00283\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00284\ \textcolor{preprocessor}{\#\ define\ SSL\_USE\_SIGALGS(s)\ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00285\ \textcolor{preprocessor}{\ \ \ \ (SSL\_CONNECTION\_GET\_SSL(s)-\/>method-\/>ssl3\_enc-\/>enc\_flags\ \&\ SSL\_ENC\_FLAG\_SIGALGS)}}
\DoxyCodeLine{00286\ \textcolor{comment}{/*}}
\DoxyCodeLine{00287\ \textcolor{comment}{\ *\ Allow\ TLS\ 1.2\ ciphersuites:\ applies\ to\ DTLS\ 1.2\ as\ well\ as\ TLS\ 1.2:\ may}}
\DoxyCodeLine{00288\ \textcolor{comment}{\ *\ apply\ to\ others\ in\ future.}}
\DoxyCodeLine{00289\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00290\ \textcolor{preprocessor}{\#\ define\ SSL\_USE\_TLS1\_2\_CIPHERS(s)\ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00291\ \textcolor{preprocessor}{\ \ \ \ (SSL\_CONNECTION\_GET\_SSL(s)-\/>method-\/>ssl3\_enc-\/>enc\_flags\ \&\ SSL\_ENC\_FLAG\_TLS1\_2\_CIPHERS)}}
\DoxyCodeLine{00292\ \textcolor{comment}{/*}}
\DoxyCodeLine{00293\ \textcolor{comment}{\ *\ Determine\ if\ a\ client\ can\ use\ TLS\ 1.2\ ciphersuites:\ can't\ rely\ on\ method}}
\DoxyCodeLine{00294\ \textcolor{comment}{\ *\ flags\ because\ it\ may\ not\ be\ set\ to\ correct\ version\ yet.}}
\DoxyCodeLine{00295\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00296\ \textcolor{preprocessor}{\#\ define\ SSL\_CLIENT\_USE\_TLS1\_2\_CIPHERS(s)\ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00297\ \textcolor{preprocessor}{\ \ \ \ ((!SSL\_CONNECTION\_IS\_DTLS(s)\ \&\&\ s-\/>client\_version\ >=\ TLS1\_2\_VERSION)\ ||\ \(\backslash\)}}
\DoxyCodeLine{00298\ \textcolor{preprocessor}{\ \ \ \ \ (SSL\_CONNECTION\_IS\_DTLS(s)\ \&\&\ DTLS\_VERSION\_GE(s-\/>client\_version,\ DTLS1\_2\_VERSION)))}}
\DoxyCodeLine{00299\ \textcolor{comment}{/*}}
\DoxyCodeLine{00300\ \textcolor{comment}{\ *\ Determine\ if\ a\ client\ should\ send\ signature\ algorithms\ extension:}}
\DoxyCodeLine{00301\ \textcolor{comment}{\ *\ as\ with\ TLS1.2\ cipher\ we\ can't\ rely\ on\ method\ flags.}}
\DoxyCodeLine{00302\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00303\ \textcolor{preprocessor}{\#\ define\ SSL\_CLIENT\_USE\_SIGALGS(s)\ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00304\ \textcolor{preprocessor}{\ \ \ \ SSL\_CLIENT\_USE\_TLS1\_2\_CIPHERS(s)}}
\DoxyCodeLine{00305\ }
\DoxyCodeLine{00306\ \textcolor{preprocessor}{\#\ define\ IS\_MAX\_FRAGMENT\_LENGTH\_EXT\_VALID(value)\ \(\backslash\)}}
\DoxyCodeLine{00307\ \textcolor{preprocessor}{\ \ \ \ (((value)\ >=\ TLSEXT\_max\_fragment\_length\_512)\ \&\&\ \(\backslash\)}}
\DoxyCodeLine{00308\ \textcolor{preprocessor}{\ \ \ \ \ ((value)\ <=\ TLSEXT\_max\_fragment\_length\_4096))}}
\DoxyCodeLine{00309\ \textcolor{preprocessor}{\#\ define\ USE\_MAX\_FRAGMENT\_LENGTH\_EXT(session)\ \(\backslash\)}}
\DoxyCodeLine{00310\ \textcolor{preprocessor}{\ \ \ \ IS\_MAX\_FRAGMENT\_LENGTH\_EXT\_VALID(session-\/>ext.max\_fragment\_len\_mode)}}
\DoxyCodeLine{00311\ \textcolor{preprocessor}{\#\ define\ GET\_MAX\_FRAGMENT\_LENGTH(session)\ \(\backslash\)}}
\DoxyCodeLine{00312\ \textcolor{preprocessor}{\ \ \ \ (512U\ <<\ (session-\/>ext.max\_fragment\_len\_mode\ -\/\ 1))}}
\DoxyCodeLine{00313\ }
\DoxyCodeLine{00314\ \textcolor{preprocessor}{\#\ define\ SSL\_READ\_ETM(s)\ (s-\/>s3.flags\ \&\ TLS1\_FLAGS\_ENCRYPT\_THEN\_MAC\_READ)}}
\DoxyCodeLine{00315\ \textcolor{preprocessor}{\#\ define\ SSL\_WRITE\_ETM(s)\ (s-\/>s3.flags\ \&\ TLS1\_FLAGS\_ENCRYPT\_THEN\_MAC\_WRITE)}}
\DoxyCodeLine{00316\ }
\DoxyCodeLine{00317\ \textcolor{preprocessor}{\#\ define\ SSL\_IS\_QUIC\_HANDSHAKE(s)\ (((s)-\/>s3.flags\ \&\ TLS1\_FLAGS\_QUIC)\ !=\ 0)}}
\DoxyCodeLine{00318\ }
\DoxyCodeLine{00319\ \textcolor{comment}{/*\ alert\_dispatch\ values\ */}}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ \textcolor{comment}{/*\ No\ alert\ pending\ */}}
\DoxyCodeLine{00322\ \textcolor{preprocessor}{\#\ define\ SSL\_ALERT\_DISPATCH\_NONE\ \ \ \ 0}}
\DoxyCodeLine{00323\ \textcolor{comment}{/*\ Alert\ pending\ */}}
\DoxyCodeLine{00324\ \textcolor{preprocessor}{\#\ define\ SSL\_ALERT\_DISPATCH\_PENDING\ 1}}
\DoxyCodeLine{00325\ \textcolor{comment}{/*\ Pending\ alert\ write\ needs\ to\ be\ retried\ */}}
\DoxyCodeLine{00326\ \textcolor{preprocessor}{\#\ define\ SSL\_ALERT\_DISPATCH\_RETRY\ \ \ 2}}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \textcolor{comment}{/*\ Mostly\ for\ SSLv3\ */}}
\DoxyCodeLine{00329\ \textcolor{preprocessor}{\#\ define\ SSL\_PKEY\_RSA\ \ \ \ \ \ \ \ \ \ \ \ 0}}
\DoxyCodeLine{00330\ \textcolor{preprocessor}{\#\ define\ SSL\_PKEY\_RSA\_PSS\_SIGN\ \ \ 1}}
\DoxyCodeLine{00331\ \textcolor{preprocessor}{\#\ define\ SSL\_PKEY\_DSA\_SIGN\ \ \ \ \ \ \ 2}}
\DoxyCodeLine{00332\ \textcolor{preprocessor}{\#\ define\ SSL\_PKEY\_ECC\ \ \ \ \ \ \ \ \ \ \ \ 3}}
\DoxyCodeLine{00333\ \textcolor{preprocessor}{\#\ define\ SSL\_PKEY\_GOST01\ \ \ \ \ \ \ \ \ 4}}
\DoxyCodeLine{00334\ \textcolor{preprocessor}{\#\ define\ SSL\_PKEY\_GOST12\_256\ \ \ \ \ 5}}
\DoxyCodeLine{00335\ \textcolor{preprocessor}{\#\ define\ SSL\_PKEY\_GOST12\_512\ \ \ \ \ 6}}
\DoxyCodeLine{00336\ \textcolor{preprocessor}{\#\ define\ SSL\_PKEY\_ED25519\ \ \ \ \ \ \ \ 7}}
\DoxyCodeLine{00337\ \textcolor{preprocessor}{\#\ define\ SSL\_PKEY\_ED448\ \ \ \ \ \ \ \ \ \ 8}}
\DoxyCodeLine{00338\ \textcolor{preprocessor}{\#\ define\ SSL\_PKEY\_NUM\ \ \ \ \ \ \ \ \ \ \ \ 9}}
\DoxyCodeLine{00339\ }
\DoxyCodeLine{00340\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_DES\_IDX\ \ \ \ \ \ \ \ \ 0}}
\DoxyCodeLine{00341\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_3DES\_IDX\ \ \ \ \ \ \ \ 1}}
\DoxyCodeLine{00342\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_RC4\_IDX\ \ \ \ \ \ \ \ \ 2}}
\DoxyCodeLine{00343\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_RC2\_IDX\ \ \ \ \ \ \ \ \ 3}}
\DoxyCodeLine{00344\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_IDEA\_IDX\ \ \ \ \ \ \ \ 4}}
\DoxyCodeLine{00345\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_NULL\_IDX\ \ \ \ \ \ \ \ 5}}
\DoxyCodeLine{00346\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_AES128\_IDX\ \ \ \ \ \ 6}}
\DoxyCodeLine{00347\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_AES256\_IDX\ \ \ \ \ \ 7}}
\DoxyCodeLine{00348\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_CAMELLIA128\_IDX\ 8}}
\DoxyCodeLine{00349\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_CAMELLIA256\_IDX\ 9}}
\DoxyCodeLine{00350\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_GOST89\_IDX\ \ \ \ \ \ 10}}
\DoxyCodeLine{00351\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_SEED\_IDX\ \ \ \ \ \ \ \ 11}}
\DoxyCodeLine{00352\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_AES128GCM\_IDX\ \ \ 12}}
\DoxyCodeLine{00353\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_AES256GCM\_IDX\ \ \ 13}}
\DoxyCodeLine{00354\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_AES128CCM\_IDX\ \ \ 14}}
\DoxyCodeLine{00355\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_AES256CCM\_IDX\ \ \ 15}}
\DoxyCodeLine{00356\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_AES128CCM8\_IDX\ \ 16}}
\DoxyCodeLine{00357\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_AES256CCM8\_IDX\ \ 17}}
\DoxyCodeLine{00358\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_GOST8912\_IDX\ \ \ \ 18}}
\DoxyCodeLine{00359\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_CHACHA\_IDX\ \ \ \ \ \ 19}}
\DoxyCodeLine{00360\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_ARIA128GCM\_IDX\ \ 20}}
\DoxyCodeLine{00361\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_ARIA256GCM\_IDX\ \ 21}}
\DoxyCodeLine{00362\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_MAGMA\_IDX\ \ \ \ \ \ \ 22}}
\DoxyCodeLine{00363\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_KUZNYECHIK\_IDX\ \ 23}}
\DoxyCodeLine{00364\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_NUM\_IDX\ \ \ \ \ \ \ \ \ 24}}
\DoxyCodeLine{00365\ }
\DoxyCodeLine{00366\ \textcolor{comment}{/*-\/}}
\DoxyCodeLine{00367\ \textcolor{comment}{\ *\ SSL\_kRSA\ <-\/\ RSA\_ENC}}
\DoxyCodeLine{00368\ \textcolor{comment}{\ *\ SSL\_kDH\ \ <-\/\ DH\_ENC\ \&\ (RSA\_ENC\ |\ RSA\_SIGN\ |\ DSA\_SIGN)}}
\DoxyCodeLine{00369\ \textcolor{comment}{\ *\ SSL\_kDHE\ <-\/\ RSA\_ENC\ |\ RSA\_SIGN\ |\ DSA\_SIGN}}
\DoxyCodeLine{00370\ \textcolor{comment}{\ *\ SSL\_aRSA\ <-\/\ RSA\_ENC\ |\ RSA\_SIGN}}
\DoxyCodeLine{00371\ \textcolor{comment}{\ *\ SSL\_aDSS\ <-\/\ DSA\_SIGN}}
\DoxyCodeLine{00372\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00373\ }
\DoxyCodeLine{00374\ \textcolor{comment}{/*-\/}}
\DoxyCodeLine{00375\ \textcolor{comment}{\#define\ CERT\_INVALID\ \ \ \ \ \ \ \ \ \ \ \ 0}}
\DoxyCodeLine{00376\ \textcolor{comment}{\#define\ CERT\_PUBLIC\_KEY\ \ \ \ \ \ \ \ \ 1}}
\DoxyCodeLine{00377\ \textcolor{comment}{\#define\ CERT\_PRIVATE\_KEY\ \ \ \ \ \ \ \ 2}}
\DoxyCodeLine{00378\ \textcolor{comment}{*/}}
\DoxyCodeLine{00379\ }
\DoxyCodeLine{00380\ \textcolor{comment}{/*\ Certificate\ Type\ State\ */}}
\DoxyCodeLine{00381\ \textcolor{preprocessor}{\#\ define\ OSSL\_CERT\_TYPE\_CTOS\_NONE\ \ \ \ 0}}
\DoxyCodeLine{00382\ \textcolor{preprocessor}{\#\ define\ OSSL\_CERT\_TYPE\_CTOS\_GOOD\ \ \ \ 1}}
\DoxyCodeLine{00383\ \textcolor{preprocessor}{\#\ define\ OSSL\_CERT\_TYPE\_CTOS\_ERROR\ \ \ 2}}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00385\ \textcolor{comment}{/*\ Post-\/Handshake\ Authentication\ state\ */}}
\DoxyCodeLine{00386\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00387\ \ \ \ \ SSL\_PHA\_NONE\ =\ 0,}
\DoxyCodeLine{00388\ \ \ \ \ SSL\_PHA\_EXT\_SENT,\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ client-\/side\ only:\ extension\ sent\ */}}
\DoxyCodeLine{00389\ \ \ \ \ SSL\_PHA\_EXT\_RECEIVED,\ \ \ \ \textcolor{comment}{/*\ server-\/side\ only:\ extension\ received\ */}}
\DoxyCodeLine{00390\ \ \ \ \ SSL\_PHA\_REQUEST\_PENDING,\ \textcolor{comment}{/*\ server-\/side\ only:\ request\ pending\ */}}
\DoxyCodeLine{00391\ \ \ \ \ SSL\_PHA\_REQUESTED\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ request\ received\ by\ client,\ or\ sent\ by\ server\ */}}
\DoxyCodeLine{00392\ \}\ SSL\_PHA\_STATE;}
\DoxyCodeLine{00393\ }
\DoxyCodeLine{00394\ \textcolor{comment}{/*\ CipherSuite\ length.\ SSLv3\ and\ all\ TLS\ versions.\ */}}
\DoxyCodeLine{00395\ \textcolor{preprocessor}{\#\ define\ TLS\_CIPHER\_LEN\ 2}}
\DoxyCodeLine{00396\ \textcolor{comment}{/*\ used\ to\ hold\ info\ on\ the\ particular\ ciphers\ used\ */}}
\DoxyCodeLine{00397\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structssl__cipher__st}{ssl\_cipher\_st}}\ \{}
\DoxyCodeLine{00398\ \ \ \ \ uint32\_t\ valid;}
\DoxyCodeLine{00399\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *name;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ text\ name\ */}}
\DoxyCodeLine{00400\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *stdname;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ RFC\ name\ */}}
\DoxyCodeLine{00401\ \ \ \ \ uint32\_t\ id;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ id,\ 4\ bytes,\ first\ is\ version\ */}}
\DoxyCodeLine{00402\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00403\ \textcolor{comment}{\ \ \ \ \ *\ changed\ in\ 1.0.0:\ these\ four\ used\ to\ be\ portions\ of\ a\ single\ value}}
\DoxyCodeLine{00404\ \textcolor{comment}{\ \ \ \ \ *\ 'algorithms'}}
\DoxyCodeLine{00405\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00406\ \ \ \ \ uint32\_t\ algorithm\_mkey;\ \ \ \ \textcolor{comment}{/*\ key\ exchange\ algorithm\ */}}
\DoxyCodeLine{00407\ \ \ \ \ uint32\_t\ algorithm\_auth;\ \ \ \ \textcolor{comment}{/*\ server\ authentication\ */}}
\DoxyCodeLine{00408\ \ \ \ \ uint32\_t\ algorithm\_enc;\ \ \ \ \ \textcolor{comment}{/*\ symmetric\ encryption\ */}}
\DoxyCodeLine{00409\ \ \ \ \ uint32\_t\ algorithm\_mac;\ \ \ \ \ \textcolor{comment}{/*\ symmetric\ authentication\ */}}
\DoxyCodeLine{00410\ \ \ \ \ \textcolor{keywordtype}{int}\ min\_tls;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ minimum\ SSL/TLS\ protocol\ version\ */}}
\DoxyCodeLine{00411\ \ \ \ \ \textcolor{keywordtype}{int}\ max\_tls;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ maximum\ SSL/TLS\ protocol\ version\ */}}
\DoxyCodeLine{00412\ \ \ \ \ \textcolor{keywordtype}{int}\ min\_dtls;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ minimum\ DTLS\ protocol\ version\ */}}
\DoxyCodeLine{00413\ \ \ \ \ \textcolor{keywordtype}{int}\ max\_dtls;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ maximum\ DTLS\ protocol\ version\ */}}
\DoxyCodeLine{00414\ \ \ \ \ uint32\_t\ algo\_strength;\ \ \ \ \ \textcolor{comment}{/*\ strength\ and\ export\ flags\ */}}
\DoxyCodeLine{00415\ \ \ \ \ uint32\_t\ algorithm2;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Extra\ flags\ */}}
\DoxyCodeLine{00416\ \ \ \ \ int32\_t\ strength\_bits;\ \ \ \ \ \ \textcolor{comment}{/*\ Number\ of\ bits\ really\ used\ */}}
\DoxyCodeLine{00417\ \ \ \ \ uint32\_t\ alg\_bits;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Number\ of\ bits\ for\ algorithm\ */}}
\DoxyCodeLine{00418\ \};}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \textcolor{comment}{/*\ Used\ to\ hold\ SSL/TLS\ functions\ */}}
\DoxyCodeLine{00421\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structssl__method__st}{ssl\_method\_st}}\ \{}
\DoxyCodeLine{00422\ \ \ \ \ \textcolor{keywordtype}{int}\ version;}
\DoxyCodeLine{00423\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ flags;}
\DoxyCodeLine{00424\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ mask;}
\DoxyCodeLine{00425\ \ \ \ \ SSL\ *(*ssl\_new)\ (SSL\_CTX\ *ctx);}
\DoxyCodeLine{00426\ \ \ \ \ void\ (*ssl\_free)\ (SSL\ *s);}
\DoxyCodeLine{00427\ \ \ \ \ int\ (*ssl\_reset)\ (SSL\ *s);}
\DoxyCodeLine{00428\ \ \ \ \ int\ (*ssl\_init)\ (SSL\ *s);}
\DoxyCodeLine{00429\ \ \ \ \ int\ (*ssl\_clear)\ (SSL\ *s);}
\DoxyCodeLine{00430\ \ \ \ \ void\ (*ssl\_deinit)\ (SSL\ *s);}
\DoxyCodeLine{00431\ \ \ \ \ int\ (*ssl\_accept)\ (SSL\ *s);}
\DoxyCodeLine{00432\ \ \ \ \ int\ (*ssl\_connect)\ (SSL\ *s);}
\DoxyCodeLine{00433\ \ \ \ \ int\ (*ssl\_read)\ (SSL\ *s,\ \textcolor{keywordtype}{void}\ *buf,\ \textcolor{keywordtype}{size\_t}\ len,\ \textcolor{keywordtype}{size\_t}\ *readbytes);}
\DoxyCodeLine{00434\ \ \ \ \ int\ (*ssl\_peek)\ (SSL\ *s,\ \textcolor{keywordtype}{void}\ *buf,\ \textcolor{keywordtype}{size\_t}\ len,\ \textcolor{keywordtype}{size\_t}\ *readbytes);}
\DoxyCodeLine{00435\ \ \ \ \ int\ (*ssl\_write)\ (SSL\ *s,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *buf,\ \textcolor{keywordtype}{size\_t}\ len,\ \textcolor{keywordtype}{size\_t}\ *written);}
\DoxyCodeLine{00436\ \ \ \ \ int\ (*ssl\_shutdown)\ (SSL\ *s);}
\DoxyCodeLine{00437\ \ \ \ \ int\ (*ssl\_renegotiate)\ (SSL\ *s);}
\DoxyCodeLine{00438\ \ \ \ \ int\ (*ssl\_renegotiate\_check)\ (SSL\ *s,\ int);}
\DoxyCodeLine{00439\ \ \ \ \ int\ (*ssl\_read\_bytes)\ (SSL\ *s,\ uint8\_t\ type,\ uint8\_t\ *recvd\_type,}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *buf,\ \textcolor{keywordtype}{size\_t}\ len,\ \textcolor{keywordtype}{int}\ peek,}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ *readbytes);}
\DoxyCodeLine{00442\ \ \ \ \ int\ (*ssl\_write\_bytes)\ (SSL\ *s,\ uint8\_t\ type,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *buf\_,\ \textcolor{keywordtype}{size\_t}\ len,}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ *written);}
\DoxyCodeLine{00444\ \ \ \ \ int\ (*ssl\_dispatch\_alert)\ (SSL\ *s);}
\DoxyCodeLine{00445\ \ \ \ \ long\ (*ssl\_ctrl)\ (SSL\ *s,\ \textcolor{keywordtype}{int}\ cmd,\ \textcolor{keywordtype}{long}\ larg,\ \textcolor{keywordtype}{void}\ *parg);}
\DoxyCodeLine{00446\ \ \ \ \ long\ (*ssl\_ctx\_ctrl)\ (SSL\_CTX\ *ctx,\ \textcolor{keywordtype}{int}\ cmd,\ \textcolor{keywordtype}{long}\ larg,\ \textcolor{keywordtype}{void}\ *parg);}
\DoxyCodeLine{00447\ \ \ \ \ \textcolor{keyword}{const}\ SSL\_CIPHER\ *(*get\_cipher\_by\_char)\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *ptr);}
\DoxyCodeLine{00448\ \ \ \ \ int\ (*put\_cipher\_by\_char)\ (\textcolor{keyword}{const}\ SSL\_CIPHER\ *cipher,\ \mbox{\hyperlink{structwpacket__st}{WPACKET}}\ *pkt,}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ *len);}
\DoxyCodeLine{00450\ \ \ \ \ size\_t\ (*ssl\_pending)\ (\textcolor{keyword}{const}\ SSL\ *s);}
\DoxyCodeLine{00451\ \ \ \ \ int\ (*num\_ciphers)\ (void);}
\DoxyCodeLine{00452\ \ \ \ \ \textcolor{keyword}{const}\ SSL\_CIPHER\ *(*get\_cipher)\ (\textcolor{keywordtype}{unsigned}\ ncipher);}
\DoxyCodeLine{00453\ \ \ \ \ \mbox{\hyperlink{struct_o_s_s_l___t_i_m_e}{OSSL\_TIME}}\ (*get\_timeout)\ (void);}
\DoxyCodeLine{00454\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structssl3__enc__method}{ssl3\_enc\_method}}\ *ssl3\_enc;\ \textcolor{comment}{/*\ Extra\ SSLv3/TLS\ stuff\ */}}
\DoxyCodeLine{00455\ \ \ \ \ int\ (*ssl\_version)\ (void);}
\DoxyCodeLine{00456\ \ \ \ \ long\ (*ssl\_callback\_ctrl)\ (SSL\ *s,\ \textcolor{keywordtype}{int}\ cb\_id,\ void\ (*fp)\ (void));}
\DoxyCodeLine{00457\ \ \ \ \ long\ (*ssl\_ctx\_callback\_ctrl)\ (SSL\_CTX\ *s,\ \textcolor{keywordtype}{int}\ cb\_id,\ void\ (*fp)\ (void));}
\DoxyCodeLine{00458\ \};}
\DoxyCodeLine{00459\ }
\DoxyCodeLine{00460\ \textcolor{comment}{/*}}
\DoxyCodeLine{00461\ \textcolor{comment}{\ *\ Matches\ the\ length\ of\ PSK\_MAX\_PSK\_LEN.\ We\ keep\ it\ the\ same\ value\ for}}
\DoxyCodeLine{00462\ \textcolor{comment}{\ *\ consistency,\ even\ in\ the\ event\ of\ OPENSSL\_NO\_PSK\ being\ defined.}}
\DoxyCodeLine{00463\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00464\ \textcolor{preprocessor}{\#\ define\ TLS13\_MAX\_RESUMPTION\_PSK\_LENGTH\ \ \ \ \ \ 512}}
\DoxyCodeLine{00465\ }
\DoxyCodeLine{00466\ \textcolor{comment}{/*-\/}}
\DoxyCodeLine{00467\ \textcolor{comment}{\ *\ Lets\ make\ this\ into\ an\ ASN.1\ type\ structure\ as\ follows}}
\DoxyCodeLine{00468\ \textcolor{comment}{\ *\ SSL\_SESSION\_ID\ ::=\ SEQUENCE\ \{}}
\DoxyCodeLine{00469\ \textcolor{comment}{\ *\ \ \ \ \ \ version\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ INTEGER,\ \ \ \ \ \ \ \ -\/-\/\ structure\ version\ number}}
\DoxyCodeLine{00470\ \textcolor{comment}{\ *\ \ \ \ \ \ SSLversion\ \ \ \ \ \ \ \ \ \ \ \ \ \ INTEGER,\ \ \ \ \ \ \ \ -\/-\/\ SSL\ version\ number}}
\DoxyCodeLine{00471\ \textcolor{comment}{\ *\ \ \ \ \ \ Cipher\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ OCTET\ STRING,\ \ \ -\/-\/\ the\ 3\ byte\ cipher\ ID}}
\DoxyCodeLine{00472\ \textcolor{comment}{\ *\ \ \ \ \ \ Session\_ID\ \ \ \ \ \ \ \ \ \ \ \ \ \ OCTET\ STRING,\ \ \ -\/-\/\ the\ Session\ ID}}
\DoxyCodeLine{00473\ \textcolor{comment}{\ *\ \ \ \ \ \ Master\_key\ \ \ \ \ \ \ \ \ \ \ \ \ \ OCTET\ STRING,\ \ \ -\/-\/\ the\ master\ key}}
\DoxyCodeLine{00474\ \textcolor{comment}{\ *\ \ \ \ \ \ Key\_Arg\ [\ 0\ ]\ IMPLICIT\ \ OCTET\ STRING,\ \ \ -\/-\/\ the\ optional\ Key\ argument}}
\DoxyCodeLine{00475\ \textcolor{comment}{\ *\ \ \ \ \ \ Time\ [\ 1\ ]\ EXPLICIT\ \ \ \ \ INTEGER,\ \ \ \ \ \ \ \ -\/-\/\ optional\ Start\ Time}}
\DoxyCodeLine{00476\ \textcolor{comment}{\ *\ \ \ \ \ \ Timeout\ [\ 2\ ]\ EXPLICIT\ \ INTEGER,\ \ \ \ \ \ \ \ -\/-\/\ optional\ Timeout\ ins\ seconds}}
\DoxyCodeLine{00477\ \textcolor{comment}{\ *\ \ \ \ \ \ Peer\ [\ 3\ ]\ EXPLICIT\ \ \ \ \ X509,\ \ \ \ \ \ \ \ \ \ \ -\/-\/\ optional\ Peer\ Certificate}}
\DoxyCodeLine{00478\ \textcolor{comment}{\ *\ \ \ \ \ \ Session\_ID\_context\ [\ 4\ ]\ EXPLICIT\ OCTET\ STRING,\ \ \ -\/-\/\ the\ Session\ ID\ context}}
\DoxyCodeLine{00479\ \textcolor{comment}{\ *\ \ \ \ \ \ Verify\_result\ [\ 5\ ]\ EXPLICIT\ INTEGER,\ \ \ -\/-\/\ X509\_V\_...\ code\ for\ \`{}Peer'}}
\DoxyCodeLine{00480\ \textcolor{comment}{\ *\ \ \ \ \ \ HostName\ [\ 6\ ]\ EXPLICIT\ OCTET\ STRING,\ \ \ -\/-\/\ optional\ HostName\ from\ servername\ TLS\ extension}}
\DoxyCodeLine{00481\ \textcolor{comment}{\ *\ \ \ \ \ \ PSK\_identity\_hint\ [\ 7\ ]\ EXPLICIT\ OCTET\ STRING,\ -\/-\/\ optional\ PSK\ identity\ hint}}
\DoxyCodeLine{00482\ \textcolor{comment}{\ *\ \ \ \ \ \ PSK\_identity\ [\ 8\ ]\ EXPLICIT\ OCTET\ STRING,\ \ -\/-\/\ optional\ PSK\ identity}}
\DoxyCodeLine{00483\ \textcolor{comment}{\ *\ \ \ \ \ \ Ticket\_lifetime\_hint\ [9]\ EXPLICIT\ INTEGER,\ -\/-\/\ server's\ lifetime\ hint\ for\ session\ ticket}}
\DoxyCodeLine{00484\ \textcolor{comment}{\ *\ \ \ \ \ \ Ticket\ [10]\ \ \ \ \ \ \ \ \ \ \ \ \ EXPLICIT\ OCTET\ STRING,\ -\/-\/\ session\ ticket\ (clients\ only)}}
\DoxyCodeLine{00485\ \textcolor{comment}{\ *\ \ \ \ \ \ Compression\_meth\ [11]\ \ \ EXPLICIT\ OCTET\ STRING,\ -\/-\/\ optional\ compression\ method}}
\DoxyCodeLine{00486\ \textcolor{comment}{\ *\ \ \ \ \ \ SRP\_username\ [\ 12\ ]\ EXPLICIT\ OCTET\ STRING\ -\/-\/\ optional\ SRP\ username}}
\DoxyCodeLine{00487\ \textcolor{comment}{\ *\ \ \ \ \ \ flags\ [\ 13\ ]\ EXPLICIT\ INTEGER\ -\/-\/\ optional\ flags}}
\DoxyCodeLine{00488\ \textcolor{comment}{\ *\ \ \ \ \ \ \}}}
\DoxyCodeLine{00489\ \textcolor{comment}{\ *\ Look\ in\ ssl/ssl\_asn1.c\ for\ more\ details}}
\DoxyCodeLine{00490\ \textcolor{comment}{\ *\ I'm\ using\ EXPLICIT\ tags\ so\ I\ can\ read\ the\ damn\ things\ using\ asn1parse\ :-\/).}}
\DoxyCodeLine{00491\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00492\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structssl__session__st}{ssl\_session\_st}}\ \{}
\DoxyCodeLine{00493\ \ \ \ \ \textcolor{keywordtype}{int}\ ssl\_version;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ what\ ssl\ version\ session\ info\ is\ being\ kept}}
\DoxyCodeLine{00494\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ in\ here?\ */}}
\DoxyCodeLine{00495\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ master\_key\_length;}
\DoxyCodeLine{00496\ }
\DoxyCodeLine{00497\ \ \ \ \ \textcolor{comment}{/*\ TLSv1.3\ early\_secret\ used\ for\ external\ PSKs\ */}}
\DoxyCodeLine{00498\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ early\_secret[EVP\_MAX\_MD\_SIZE];}
\DoxyCodeLine{00499\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00500\ \textcolor{comment}{\ \ \ \ \ *\ For\ <=TLS1.2\ this\ is\ the\ master\_key.\ For\ TLS1.3\ this\ is\ the\ resumption}}
\DoxyCodeLine{00501\ \textcolor{comment}{\ \ \ \ \ *\ PSK}}
\DoxyCodeLine{00502\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00503\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ master\_key[TLS13\_MAX\_RESUMPTION\_PSK\_LENGTH];}
\DoxyCodeLine{00504\ \ \ \ \ \textcolor{comment}{/*\ session\_id\ -\/\ valid?\ */}}
\DoxyCodeLine{00505\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ session\_id\_length;}
\DoxyCodeLine{00506\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ session\_id[SSL\_MAX\_SSL\_SESSION\_ID\_LENGTH];}
\DoxyCodeLine{00507\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00508\ \textcolor{comment}{\ \ \ \ \ *\ this\ is\ used\ to\ determine\ whether\ the\ session\ is\ being\ reused\ in\ the}}
\DoxyCodeLine{00509\ \textcolor{comment}{\ \ \ \ \ *\ appropriate\ context.\ It\ is\ up\ to\ the\ application\ to\ set\ this,\ via}}
\DoxyCodeLine{00510\ \textcolor{comment}{\ \ \ \ \ *\ SSL\_new}}
\DoxyCodeLine{00511\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00512\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ sid\_ctx\_length;}
\DoxyCodeLine{00513\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ sid\_ctx[SSL\_MAX\_SID\_CTX\_LENGTH];}
\DoxyCodeLine{00514\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_PSK}}
\DoxyCodeLine{00515\ \ \ \ \ \textcolor{keywordtype}{char}\ *psk\_identity\_hint;}
\DoxyCodeLine{00516\ \ \ \ \ \textcolor{keywordtype}{char}\ *psk\_identity;}
\DoxyCodeLine{00517\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{00518\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00519\ \textcolor{comment}{\ \ \ \ \ *\ Used\ to\ indicate\ that\ session\ resumption\ is\ not\ allowed.\ Applications}}
\DoxyCodeLine{00520\ \textcolor{comment}{\ \ \ \ \ *\ can\ also\ set\ this\ bit\ for\ a\ new\ session\ via\ not\_resumable\_session\_cb}}
\DoxyCodeLine{00521\ \textcolor{comment}{\ \ \ \ \ *\ to\ disable\ session\ caching\ and\ tickets.}}
\DoxyCodeLine{00522\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00523\ \ \ \ \ \textcolor{keywordtype}{int}\ not\_resumable;}
\DoxyCodeLine{00524\ \ \ \ \ \textcolor{comment}{/*\ Peer\ raw\ public\ key,\ if\ available\ */}}
\DoxyCodeLine{00525\ \ \ \ \ EVP\_PKEY\ *peer\_rpk;}
\DoxyCodeLine{00526\ \ \ \ \ \textcolor{comment}{/*\ This\ is\ the\ cert\ and\ type\ for\ the\ other\ end.\ */}}
\DoxyCodeLine{00527\ \ \ \ \ X509\ *peer;}
\DoxyCodeLine{00528\ \ \ \ \ \textcolor{comment}{/*\ Certificate\ chain\ peer\ sent.\ */}}
\DoxyCodeLine{00529\ \ \ \ \ STACK\_OF(X509)\ *peer\_chain;}
\DoxyCodeLine{00530\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00531\ \textcolor{comment}{\ \ \ \ \ *\ when\ app\_verify\_callback\ accepts\ a\ session\ where\ the\ peer's}}
\DoxyCodeLine{00532\ \textcolor{comment}{\ \ \ \ \ *\ certificate\ is\ not\ ok,\ we\ must\ remember\ the\ error\ for\ session\ reuse:}}
\DoxyCodeLine{00533\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00534\ \ \ \ \ \textcolor{keywordtype}{long}\ verify\_result;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ only\ for\ servers\ */}}
\DoxyCodeLine{00535\ \ \ \ \ \mbox{\hyperlink{struct_c_r_y_p_t_o___r_e_f___c_o_u_n_t}{CRYPTO\_REF\_COUNT}}\ references;}
\DoxyCodeLine{00536\ \ \ \ \ \mbox{\hyperlink{struct_o_s_s_l___t_i_m_e}{OSSL\_TIME}}\ timeout;}
\DoxyCodeLine{00537\ \ \ \ \ \mbox{\hyperlink{struct_o_s_s_l___t_i_m_e}{OSSL\_TIME}}\ time;}
\DoxyCodeLine{00538\ \ \ \ \ \mbox{\hyperlink{struct_o_s_s_l___t_i_m_e}{OSSL\_TIME}}\ calc\_timeout;}
\DoxyCodeLine{00539\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ compress\_meth;\ \textcolor{comment}{/*\ Need\ to\ lookup\ the\ method\ */}}
\DoxyCodeLine{00540\ \ \ \ \ \textcolor{keyword}{const}\ SSL\_CIPHER\ *cipher;}
\DoxyCodeLine{00541\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ cipher\_id;\ \ \ \ \textcolor{comment}{/*\ when\ ASN.1\ loaded,\ this\ needs\ to\ be\ used\ to}}
\DoxyCodeLine{00542\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ load\ the\ 'cipher'\ structure\ */}}
\DoxyCodeLine{00543\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ kex\_group;\ \ \ \ \ \ \textcolor{comment}{/*\ TLS\ group\ from\ key\ exchange\ */}}
\DoxyCodeLine{00544\ \ \ \ \ CRYPTO\_EX\_DATA\ ex\_data;\ \ \ \ \ \textcolor{comment}{/*\ application\ specific\ data\ */}}
\DoxyCodeLine{00545\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00546\ \textcolor{comment}{\ \ \ \ \ *\ These\ are\ used\ to\ make\ removal\ of\ session-\/ids\ more\ efficient\ and\ to}}
\DoxyCodeLine{00547\ \textcolor{comment}{\ \ \ \ \ *\ implement\ a\ maximum\ cache\ size.}}
\DoxyCodeLine{00548\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00549\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structssl__session__st}{ssl\_session\_st}}\ *prev,\ *next;}
\DoxyCodeLine{00550\ }
\DoxyCodeLine{00551\ \ \ \ \ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{00552\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ *hostname;}
\DoxyCodeLine{00553\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ RFC4507\ info\ */}}
\DoxyCodeLine{00554\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *tick;\ \textcolor{comment}{/*\ Session\ ticket\ */}}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ ticklen;\ \ \ \ \ \ \textcolor{comment}{/*\ Session\ ticket\ length\ */}}
\DoxyCodeLine{00556\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Session\ lifetime\ hint\ in\ seconds\ */}}
\DoxyCodeLine{00557\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ tick\_lifetime\_hint;}
\DoxyCodeLine{00558\ \ \ \ \ \ \ \ \ uint32\_t\ tick\_age\_add;}
\DoxyCodeLine{00559\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Max\ number\ of\ bytes\ that\ can\ be\ sent\ as\ early\ data\ */}}
\DoxyCodeLine{00560\ \ \ \ \ \ \ \ \ uint32\_t\ max\_early\_data;}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ The\ ALPN\ protocol\ selected\ for\ this\ session\ */}}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *alpn\_selected;}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ alpn\_selected\_len;}
\DoxyCodeLine{00564\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00565\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ Maximum\ Fragment\ Length\ as\ per\ RFC\ 4366.}}
\DoxyCodeLine{00566\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ If\ this\ value\ does\ not\ contain\ RFC\ 4366\ allowed\ values\ (1-\/4)\ then}}
\DoxyCodeLine{00567\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ either\ the\ Maximum\ Fragment\ Length\ Negotiation\ failed\ or\ was\ not}}
\DoxyCodeLine{00568\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ performed\ at\ all.}}
\DoxyCodeLine{00569\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00570\ \ \ \ \ \ \ \ \ uint8\_t\ max\_fragment\_len\_mode;}
\DoxyCodeLine{00571\ \ \ \ \ \}\ ext;}
\DoxyCodeLine{00572\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_SRP}}
\DoxyCodeLine{00573\ \ \ \ \ \textcolor{keywordtype}{char}\ *srp\_username;}
\DoxyCodeLine{00574\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{00575\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *ticket\_appdata;}
\DoxyCodeLine{00576\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ ticket\_appdata\_len;}
\DoxyCodeLine{00577\ \ \ \ \ uint32\_t\ flags;}
\DoxyCodeLine{00578\ \ \ \ \ SSL\_CTX\ *owner;}
\DoxyCodeLine{00579\ \};}
\DoxyCodeLine{00580\ }
\DoxyCodeLine{00581\ \textcolor{comment}{/*\ Extended\ master\ secret\ support\ */}}
\DoxyCodeLine{00582\ \textcolor{preprocessor}{\#\ define\ SSL\_SESS\_FLAG\_EXTMS\ \ \ \ \ \ \ \ \ \ \ \ \ 0x1}}
\DoxyCodeLine{00583\ }
\DoxyCodeLine{00584\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_SRP}}
\DoxyCodeLine{00585\ }
\DoxyCodeLine{00586\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structsrp__ctx__st}{srp\_ctx\_st}}\ \{}
\DoxyCodeLine{00587\ \ \ \ \ \textcolor{comment}{/*\ param\ for\ all\ the\ callbacks\ */}}
\DoxyCodeLine{00588\ \ \ \ \ \textcolor{keywordtype}{void}\ *SRP\_cb\_arg;}
\DoxyCodeLine{00589\ \ \ \ \ \textcolor{comment}{/*\ set\ client\ Hello\ login\ callback\ */}}
\DoxyCodeLine{00590\ \ \ \ \ int\ (*TLS\_ext\_srp\_username\_callback)\ (SSL\ *,\ \textcolor{keywordtype}{int}\ *,\ \textcolor{keywordtype}{void}\ *);}
\DoxyCodeLine{00591\ \ \ \ \ \textcolor{comment}{/*\ set\ SRP\ N/g\ param\ callback\ for\ verification\ */}}
\DoxyCodeLine{00592\ \ \ \ \ int\ (*SRP\_verify\_param\_callback)\ (SSL\ *,\ \textcolor{keywordtype}{void}\ *);}
\DoxyCodeLine{00593\ \ \ \ \ \textcolor{comment}{/*\ set\ SRP\ client\ passwd\ callback\ */}}
\DoxyCodeLine{00594\ \ \ \ \ \textcolor{keywordtype}{char}\ *(*SRP\_give\_srp\_client\_pwd\_callback)\ (SSL\ *,\ \textcolor{keywordtype}{void}\ *);}
\DoxyCodeLine{00595\ \ \ \ \ \textcolor{keywordtype}{char}\ *login;}
\DoxyCodeLine{00596\ \ \ \ \ BIGNUM\ *N,\ *g,\ *s,\ *B,\ *A;}
\DoxyCodeLine{00597\ \ \ \ \ BIGNUM\ *a,\ *\mbox{\hyperlink{structb}{b}},\ *v;}
\DoxyCodeLine{00598\ \ \ \ \ \textcolor{keywordtype}{char}\ *info;}
\DoxyCodeLine{00599\ \ \ \ \ \textcolor{keywordtype}{int}\ strength;}
\DoxyCodeLine{00600\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ srp\_Mask;}
\DoxyCodeLine{00601\ \}\ \mbox{\hyperlink{structsrp__ctx__st}{SRP\_CTX}};}
\DoxyCodeLine{00602\ }
\DoxyCodeLine{00603\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{00604\ }
\DoxyCodeLine{00605\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00606\ \ \ \ \ SSL\_EARLY\_DATA\_NONE\ =\ 0,}
\DoxyCodeLine{00607\ \ \ \ \ SSL\_EARLY\_DATA\_CONNECT\_RETRY,}
\DoxyCodeLine{00608\ \ \ \ \ SSL\_EARLY\_DATA\_CONNECTING,}
\DoxyCodeLine{00609\ \ \ \ \ SSL\_EARLY\_DATA\_WRITE\_RETRY,}
\DoxyCodeLine{00610\ \ \ \ \ SSL\_EARLY\_DATA\_WRITING,}
\DoxyCodeLine{00611\ \ \ \ \ SSL\_EARLY\_DATA\_WRITE\_FLUSH,}
\DoxyCodeLine{00612\ \ \ \ \ SSL\_EARLY\_DATA\_UNAUTH\_WRITING,}
\DoxyCodeLine{00613\ \ \ \ \ SSL\_EARLY\_DATA\_FINISHED\_WRITING,}
\DoxyCodeLine{00614\ \ \ \ \ SSL\_EARLY\_DATA\_ACCEPT\_RETRY,}
\DoxyCodeLine{00615\ \ \ \ \ SSL\_EARLY\_DATA\_ACCEPTING,}
\DoxyCodeLine{00616\ \ \ \ \ SSL\_EARLY\_DATA\_READ\_RETRY,}
\DoxyCodeLine{00617\ \ \ \ \ SSL\_EARLY\_DATA\_READING,}
\DoxyCodeLine{00618\ \ \ \ \ SSL\_EARLY\_DATA\_FINISHED\_READING}
\DoxyCodeLine{00619\ \}\ SSL\_EARLY\_DATA\_STATE;}
\DoxyCodeLine{00620\ }
\DoxyCodeLine{00621\ \textcolor{comment}{/*}}
\DoxyCodeLine{00622\ \textcolor{comment}{\ *\ We\ check\ that\ the\ amount\ of\ unreadable\ early\ data\ doesn't\ exceed}}
\DoxyCodeLine{00623\ \textcolor{comment}{\ *\ max\_early\_data.\ max\_early\_data\ is\ given\ in\ plaintext\ bytes.\ However\ if\ it\ is}}
\DoxyCodeLine{00624\ \textcolor{comment}{\ *\ unreadable\ then\ we\ only\ know\ the\ number\ of\ ciphertext\ bytes.\ We\ also\ don't}}
\DoxyCodeLine{00625\ \textcolor{comment}{\ *\ know\ how\ much\ the\ overhead\ should\ be\ because\ it\ depends\ on\ the\ ciphersuite.}}
\DoxyCodeLine{00626\ \textcolor{comment}{\ *\ We\ make\ a\ small\ allowance.\ We\ assume\ 5\ records\ of\ actual\ data\ plus\ the\ end}}
\DoxyCodeLine{00627\ \textcolor{comment}{\ *\ of\ early\ data\ alert\ record.\ Each\ record\ has\ a\ tag\ and\ a\ content\ type\ byte.}}
\DoxyCodeLine{00628\ \textcolor{comment}{\ *\ The\ longest\ tag\ length\ we\ know\ of\ is\ EVP\_GCM\_TLS\_TAG\_LEN.\ We\ don't\ count\ the}}
\DoxyCodeLine{00629\ \textcolor{comment}{\ *\ content\ of\ the\ alert\ record\ either\ which\ is\ 2\ bytes.}}
\DoxyCodeLine{00630\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00631\ \textcolor{preprocessor}{\#\ define\ EARLY\_DATA\_CIPHERTEXT\_OVERHEAD\ ((6\ *\ (EVP\_GCM\_TLS\_TAG\_LEN\ +\ 1))\ +\ 2)}}
\DoxyCodeLine{00632\ }
\DoxyCodeLine{00633\ \textcolor{comment}{/*}}
\DoxyCodeLine{00634\ \textcolor{comment}{\ *\ The\ allowance\ we\ have\ between\ the\ client's\ calculated\ ticket\ age\ and\ our\ own.}}
\DoxyCodeLine{00635\ \textcolor{comment}{\ *\ We\ allow\ for\ 10\ seconds.\ If\ a\ ticket\ is\ presented\ and\ the}}
\DoxyCodeLine{00636\ \textcolor{comment}{\ *\ client's\ age\ calculation\ is\ different\ by\ more\ than\ this\ than\ our\ own\ then\ we}}
\DoxyCodeLine{00637\ \textcolor{comment}{\ *\ do\ not\ allow\ that\ ticket\ for\ early\_data.}}
\DoxyCodeLine{00638\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00639\ \textcolor{preprocessor}{\#\ define\ TICKET\_AGE\_ALLOWANCE\ \ \ ossl\_seconds2time(10)}}
\DoxyCodeLine{00640\ }
\DoxyCodeLine{00641\ \textcolor{preprocessor}{\#define\ MAX\_COMPRESSIONS\_SIZE\ \ \ 255}}
\DoxyCodeLine{00642\ }
\DoxyCodeLine{00643\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structssl__comp__st}{ssl\_comp\_st}}\ \{}
\DoxyCodeLine{00644\ \ \ \ \ \textcolor{keywordtype}{int}\ id;}
\DoxyCodeLine{00645\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *name;}
\DoxyCodeLine{00646\ \ \ \ \ COMP\_METHOD\ *method;}
\DoxyCodeLine{00647\ \};}
\DoxyCodeLine{00648\ }
\DoxyCodeLine{00649\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structraw__extension__st}{raw\_extension\_st}}\ \{}
\DoxyCodeLine{00650\ \ \ \ \ \textcolor{comment}{/*\ Raw\ packet\ data\ for\ the\ extension\ */}}
\DoxyCodeLine{00651\ \ \ \ \ \mbox{\hyperlink{struct_p_a_c_k_e_t}{PACKET}}\ data;}
\DoxyCodeLine{00652\ \ \ \ \ \textcolor{comment}{/*\ Set\ to\ 1\ if\ the\ extension\ is\ present\ or\ 0\ otherwise\ */}}
\DoxyCodeLine{00653\ \ \ \ \ \textcolor{keywordtype}{int}\ present;}
\DoxyCodeLine{00654\ \ \ \ \ \textcolor{comment}{/*\ Set\ to\ 1\ if\ we\ have\ already\ parsed\ the\ extension\ or\ 0\ otherwise\ */}}
\DoxyCodeLine{00655\ \ \ \ \ \textcolor{keywordtype}{int}\ parsed;}
\DoxyCodeLine{00656\ \ \ \ \ \textcolor{comment}{/*\ The\ type\ of\ this\ extension,\ i.e.\ a\ TLSEXT\_TYPE\_*\ value\ */}}
\DoxyCodeLine{00657\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ type;}
\DoxyCodeLine{00658\ \ \ \ \ \textcolor{comment}{/*\ Track\ what\ order\ extensions\ are\ received\ in\ (0-\/based).\ */}}
\DoxyCodeLine{00659\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ received\_order;}
\DoxyCodeLine{00660\ \}\ \mbox{\hyperlink{structraw__extension__st}{RAW\_EXTENSION}};}
\DoxyCodeLine{00661\ }
\DoxyCodeLine{00662\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{00663\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ isv2;}
\DoxyCodeLine{00664\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ legacy\_version;}
\DoxyCodeLine{00665\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ random[SSL3\_RANDOM\_SIZE];}
\DoxyCodeLine{00666\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ session\_id\_len;}
\DoxyCodeLine{00667\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ session\_id[SSL\_MAX\_SSL\_SESSION\_ID\_LENGTH];}
\DoxyCodeLine{00668\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ dtls\_cookie\_len;}
\DoxyCodeLine{00669\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ dtls\_cookie[DTLS1\_COOKIE\_LENGTH];}
\DoxyCodeLine{00670\ \ \ \ \ \mbox{\hyperlink{struct_p_a_c_k_e_t}{PACKET}}\ ciphersuites;}
\DoxyCodeLine{00671\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ compressions\_len;}
\DoxyCodeLine{00672\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ compressions[MAX\_COMPRESSIONS\_SIZE];}
\DoxyCodeLine{00673\ \ \ \ \ \mbox{\hyperlink{struct_p_a_c_k_e_t}{PACKET}}\ extensions;}
\DoxyCodeLine{00674\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ pre\_proc\_exts\_len;}
\DoxyCodeLine{00675\ \ \ \ \ \mbox{\hyperlink{structraw__extension__st}{RAW\_EXTENSION}}\ *pre\_proc\_exts;}
\DoxyCodeLine{00676\ \}\ \mbox{\hyperlink{struct_c_l_i_e_n_t_h_e_l_l_o___m_s_g}{CLIENTHELLO\_MSG}};}
\DoxyCodeLine{00677\ }
\DoxyCodeLine{00678\ \textcolor{comment}{/*}}
\DoxyCodeLine{00679\ \textcolor{comment}{\ *\ Extension\ index\ values\ NOTE:\ Any\ updates\ to\ these\ defines\ should\ be\ mirrored}}
\DoxyCodeLine{00680\ \textcolor{comment}{\ *\ with\ equivalent\ updates\ to\ ext\_defs\ in\ extensions.c}}
\DoxyCodeLine{00681\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00682\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{enum}\ tlsext\_index\_en\ \{}
\DoxyCodeLine{00683\ \ \ \ \ TLSEXT\_IDX\_renegotiate,}
\DoxyCodeLine{00684\ \ \ \ \ TLSEXT\_IDX\_server\_name,}
\DoxyCodeLine{00685\ \ \ \ \ TLSEXT\_IDX\_max\_fragment\_length,}
\DoxyCodeLine{00686\ \ \ \ \ TLSEXT\_IDX\_srp,}
\DoxyCodeLine{00687\ \ \ \ \ TLSEXT\_IDX\_ec\_point\_formats,}
\DoxyCodeLine{00688\ \ \ \ \ TLSEXT\_IDX\_supported\_groups,}
\DoxyCodeLine{00689\ \ \ \ \ TLSEXT\_IDX\_session\_ticket,}
\DoxyCodeLine{00690\ \ \ \ \ TLSEXT\_IDX\_status\_request,}
\DoxyCodeLine{00691\ \ \ \ \ TLSEXT\_IDX\_next\_proto\_neg,}
\DoxyCodeLine{00692\ \ \ \ \ TLSEXT\_IDX\_application\_layer\_protocol\_negotiation,}
\DoxyCodeLine{00693\ \ \ \ \ TLSEXT\_IDX\_use\_srtp,}
\DoxyCodeLine{00694\ \ \ \ \ TLSEXT\_IDX\_encrypt\_then\_mac,}
\DoxyCodeLine{00695\ \ \ \ \ TLSEXT\_IDX\_signed\_certificate\_timestamp,}
\DoxyCodeLine{00696\ \ \ \ \ TLSEXT\_IDX\_extended\_master\_secret,}
\DoxyCodeLine{00697\ \ \ \ \ TLSEXT\_IDX\_signature\_algorithms\_cert,}
\DoxyCodeLine{00698\ \ \ \ \ TLSEXT\_IDX\_post\_handshake\_auth,}
\DoxyCodeLine{00699\ \ \ \ \ TLSEXT\_IDX\_client\_cert\_type,}
\DoxyCodeLine{00700\ \ \ \ \ TLSEXT\_IDX\_server\_cert\_type,}
\DoxyCodeLine{00701\ \ \ \ \ TLSEXT\_IDX\_signature\_algorithms,}
\DoxyCodeLine{00702\ \ \ \ \ TLSEXT\_IDX\_supported\_versions,}
\DoxyCodeLine{00703\ \ \ \ \ TLSEXT\_IDX\_psk\_kex\_modes,}
\DoxyCodeLine{00704\ \ \ \ \ TLSEXT\_IDX\_key\_share,}
\DoxyCodeLine{00705\ \ \ \ \ TLSEXT\_IDX\_cookie,}
\DoxyCodeLine{00706\ \ \ \ \ TLSEXT\_IDX\_cryptopro\_bug,}
\DoxyCodeLine{00707\ \ \ \ \ TLSEXT\_IDX\_compress\_certificate,}
\DoxyCodeLine{00708\ \ \ \ \ TLSEXT\_IDX\_early\_data,}
\DoxyCodeLine{00709\ \ \ \ \ TLSEXT\_IDX\_certificate\_authorities,}
\DoxyCodeLine{00710\ \ \ \ \ TLSEXT\_IDX\_padding,}
\DoxyCodeLine{00711\ \ \ \ \ TLSEXT\_IDX\_psk,}
\DoxyCodeLine{00712\ \ \ \ \ \textcolor{comment}{/*\ Dummy\ index\ -\/\ must\ always\ be\ the\ last\ entry\ */}}
\DoxyCodeLine{00713\ \ \ \ \ TLSEXT\_IDX\_num\_builtins}
\DoxyCodeLine{00714\ \}\ TLSEXT\_INDEX;}
\DoxyCodeLine{00715\ }
\DoxyCodeLine{00716\ DEFINE\_LHASH\_OF\_EX(SSL\_SESSION);}
\DoxyCodeLine{00717\ \textcolor{comment}{/*\ Needed\ in\ ssl\_cert.c\ */}}
\DoxyCodeLine{00718\ DEFINE\_LHASH\_OF\_EX(X509\_NAME);}
\DoxyCodeLine{00719\ }
\DoxyCodeLine{00720\ \textcolor{preprocessor}{\#\ define\ TLSEXT\_KEYNAME\_LENGTH\ \ 16}}
\DoxyCodeLine{00721\ \textcolor{preprocessor}{\#\ define\ TLSEXT\_TICK\_KEY\_LENGTH\ 32}}
\DoxyCodeLine{00722\ }
\DoxyCodeLine{00723\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structssl__ctx__ext__secure__st}{ssl\_ctx\_ext\_secure\_st}}\ \{}
\DoxyCodeLine{00724\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tick\_hmac\_key[TLSEXT\_TICK\_KEY\_LENGTH];}
\DoxyCodeLine{00725\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tick\_aes\_key[TLSEXT\_TICK\_KEY\_LENGTH];}
\DoxyCodeLine{00726\ \}\ \mbox{\hyperlink{structssl__ctx__ext__secure__st}{SSL\_CTX\_EXT\_SECURE}};}
\DoxyCodeLine{00727\ }
\DoxyCodeLine{00728\ \textcolor{comment}{/*}}
\DoxyCodeLine{00729\ \textcolor{comment}{\ *\ Helper\ function\ for\ HMAC}}
\DoxyCodeLine{00730\ \textcolor{comment}{\ *\ The\ structure\ should\ be\ considered\ opaque,\ it\ will\ change\ once\ the\ low}}
\DoxyCodeLine{00731\ \textcolor{comment}{\ *\ level\ deprecated\ calls\ are\ removed.\ \ At\ that\ point\ it\ can\ be\ replaced}}
\DoxyCodeLine{00732\ \textcolor{comment}{\ *\ by\ EVP\_MAC\_CTX\ and\ most\ of\ the\ functions\ converted\ to\ macros\ or\ inlined}}
\DoxyCodeLine{00733\ \textcolor{comment}{\ *\ directly.}}
\DoxyCodeLine{00734\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00735\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structssl__hmac__st}{ssl\_hmac\_st}}\ \{}
\DoxyCodeLine{00736\ \ \ \ \ EVP\_MAC\_CTX\ *ctx;}
\DoxyCodeLine{00737\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_DEPRECATED\_3\_0}}
\DoxyCodeLine{00738\ \ \ \ \ HMAC\_CTX\ *old\_ctx;}
\DoxyCodeLine{00739\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{00740\ \}\ \mbox{\hyperlink{structssl__hmac__st}{SSL\_HMAC}};}
\DoxyCodeLine{00741\ }
\DoxyCodeLine{00742\ \mbox{\hyperlink{structssl__hmac__st}{SSL\_HMAC}}\ *ssl\_hmac\_new(\textcolor{keyword}{const}\ SSL\_CTX\ *ctx);}
\DoxyCodeLine{00743\ \textcolor{keywordtype}{void}\ ssl\_hmac\_free(\mbox{\hyperlink{structssl__hmac__st}{SSL\_HMAC}}\ *ctx);}
\DoxyCodeLine{00744\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_DEPRECATED\_3\_0}}
\DoxyCodeLine{00745\ HMAC\_CTX\ *ssl\_hmac\_get0\_HMAC\_CTX(\mbox{\hyperlink{structssl__hmac__st}{SSL\_HMAC}}\ *ctx);}
\DoxyCodeLine{00746\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{00747\ EVP\_MAC\_CTX\ *ssl\_hmac\_get0\_EVP\_MAC\_CTX(\mbox{\hyperlink{structssl__hmac__st}{SSL\_HMAC}}\ *ctx);}
\DoxyCodeLine{00748\ \textcolor{keywordtype}{int}\ ssl\_hmac\_init(\mbox{\hyperlink{structssl__hmac__st}{SSL\_HMAC}}\ *ctx,\ \textcolor{keywordtype}{void}\ *key,\ \textcolor{keywordtype}{size\_t}\ len,\ \textcolor{keywordtype}{char}\ *md);}
\DoxyCodeLine{00749\ \textcolor{keywordtype}{int}\ ssl\_hmac\_update(\mbox{\hyperlink{structssl__hmac__st}{SSL\_HMAC}}\ *ctx,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *data,\ \textcolor{keywordtype}{size\_t}\ len);}
\DoxyCodeLine{00750\ \textcolor{keywordtype}{int}\ ssl\_hmac\_final(\mbox{\hyperlink{structssl__hmac__st}{SSL\_HMAC}}\ *ctx,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *md,\ \textcolor{keywordtype}{size\_t}\ *len,}
\DoxyCodeLine{00751\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ max\_size);}
\DoxyCodeLine{00752\ \textcolor{keywordtype}{size\_t}\ ssl\_hmac\_size(\textcolor{keyword}{const}\ \mbox{\hyperlink{structssl__hmac__st}{SSL\_HMAC}}\ *ctx);}
\DoxyCodeLine{00753\ }
\DoxyCodeLine{00754\ \textcolor{keywordtype}{int}\ ssl\_get\_EC\_curve\_nid(\textcolor{keyword}{const}\ EVP\_PKEY\ *pkey);}
\DoxyCodeLine{00755\ \_\_owur\ \textcolor{keywordtype}{int}\ tls13\_set\_encoded\_pub\_key(EVP\_PKEY\ *pkey,}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *enckey,}
\DoxyCodeLine{00757\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ enckeylen);}
\DoxyCodeLine{00758\ }
\DoxyCodeLine{00759\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structtls__group__info__st}{tls\_group\_info\_st}}\ \{}
\DoxyCodeLine{00760\ \ \ \ \ \textcolor{keywordtype}{char}\ *tlsname;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Curve\ Name\ as\ in\ TLS\ specs\ */}}
\DoxyCodeLine{00761\ \ \ \ \ \textcolor{keywordtype}{char}\ *realname;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Curve\ Name\ according\ to\ provider\ */}}
\DoxyCodeLine{00762\ \ \ \ \ \textcolor{keywordtype}{char}\ *algorithm;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Algorithm\ name\ to\ fetch\ */}}
\DoxyCodeLine{00763\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ secbits;\ \ \ \ \textcolor{comment}{/*\ Bits\ of\ security\ (from\ SP800-\/57)\ */}}
\DoxyCodeLine{00764\ \ \ \ \ uint16\_t\ group\_id;\ \ \ \ \ \ \ \textcolor{comment}{/*\ Group\ ID\ */}}
\DoxyCodeLine{00765\ \ \ \ \ \textcolor{keywordtype}{int}\ mintls;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Minimum\ TLS\ version,\ -\/1\ unsupported\ */}}
\DoxyCodeLine{00766\ \ \ \ \ \textcolor{keywordtype}{int}\ maxtls;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Maximum\ TLS\ version\ (or\ 0\ for\ undefined)\ */}}
\DoxyCodeLine{00767\ \ \ \ \ \textcolor{keywordtype}{int}\ mindtls;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Minimum\ DTLS\ version,\ -\/1\ unsupported\ */}}
\DoxyCodeLine{00768\ \ \ \ \ \textcolor{keywordtype}{int}\ maxdtls;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Maximum\ DTLS\ version\ (or\ 0\ for\ undefined)\ */}}
\DoxyCodeLine{00769\ \ \ \ \ \textcolor{keywordtype}{char}\ is\_kem;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Mode\ for\ this\ Group:\ 0\ is\ KEX,\ 1\ is\ KEM\ */}}
\DoxyCodeLine{00770\ \}\ \mbox{\hyperlink{structtls__group__info__st}{TLS\_GROUP\_INFO}};}
\DoxyCodeLine{00771\ }
\DoxyCodeLine{00772\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structtls__sigalg__info__st}{tls\_sigalg\_info\_st}}\ \{}
\DoxyCodeLine{00773\ \ \ \ \ \textcolor{keywordtype}{char}\ *name;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ name\ as\ in\ IANA\ TLS\ specs\ */}}
\DoxyCodeLine{00774\ \ \ \ \ uint16\_t\ code\_point;\ \ \ \ \ \textcolor{comment}{/*\ IANA-\/specified\ code\ point\ of\ sigalg-\/name\ */}}
\DoxyCodeLine{00775\ \ \ \ \ \textcolor{keywordtype}{char}\ *sigalg\_name;\ \ \ \ \ \ \ \textcolor{comment}{/*\ (combined)\ sigalg\ name\ */}}
\DoxyCodeLine{00776\ \ \ \ \ \textcolor{keywordtype}{char}\ *sigalg\_oid;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ (combined)\ sigalg\ OID\ */}}
\DoxyCodeLine{00777\ \ \ \ \ \textcolor{keywordtype}{char}\ *sig\_name;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ pure\ signature\ algorithm\ name\ */}}
\DoxyCodeLine{00778\ \ \ \ \ \textcolor{keywordtype}{char}\ *sig\_oid;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ pure\ signature\ algorithm\ OID\ */}}
\DoxyCodeLine{00779\ \ \ \ \ \textcolor{keywordtype}{char}\ *hash\_name;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ hash\ algorithm\ name\ */}}
\DoxyCodeLine{00780\ \ \ \ \ \textcolor{keywordtype}{char}\ *hash\_oid;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ hash\ algorithm\ OID\ */}}
\DoxyCodeLine{00781\ \ \ \ \ \textcolor{keywordtype}{char}\ *keytype;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ keytype\ name\ */}}
\DoxyCodeLine{00782\ \ \ \ \ \textcolor{keywordtype}{char}\ *keytype\_oid;\ \ \ \ \ \ \ \textcolor{comment}{/*\ keytype\ OID\ */}}
\DoxyCodeLine{00783\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ secbits;\ \ \ \ \textcolor{comment}{/*\ Bits\ of\ security\ (from\ SP800-\/57)\ */}}
\DoxyCodeLine{00784\ \ \ \ \ \textcolor{keywordtype}{int}\ mintls;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Minimum\ TLS\ version,\ -\/1\ unsupported\ */}}
\DoxyCodeLine{00785\ \ \ \ \ \textcolor{keywordtype}{int}\ maxtls;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Maximum\ TLS\ version\ (or\ 0\ for\ undefined)\ */}}
\DoxyCodeLine{00786\ \}\ \mbox{\hyperlink{structtls__sigalg__info__st}{TLS\_SIGALG\_INFO}};}
\DoxyCodeLine{00787\ }
\DoxyCodeLine{00788\ \textcolor{comment}{/*}}
\DoxyCodeLine{00789\ \textcolor{comment}{\ *\ Structure\ containing\ table\ entry\ of\ certificate\ info\ corresponding\ to}}
\DoxyCodeLine{00790\ \textcolor{comment}{\ *\ CERT\_PKEY\ entries}}
\DoxyCodeLine{00791\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00792\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{00793\ \ \ \ \ \textcolor{keywordtype}{int}\ nid;\ \textcolor{comment}{/*\ NID\ of\ public\ key\ algorithm\ */}}
\DoxyCodeLine{00794\ \ \ \ \ uint32\_t\ amask;\ \textcolor{comment}{/*\ authmask\ corresponding\ to\ key\ type\ */}}
\DoxyCodeLine{00795\ \}\ \mbox{\hyperlink{struct_s_s_l___c_e_r_t___l_o_o_k_u_p}{SSL\_CERT\_LOOKUP}};}
\DoxyCodeLine{00796\ }
\DoxyCodeLine{00797\ \textcolor{comment}{/*\ flags\ values\ */}}
\DoxyCodeLine{00798\ \textcolor{preprocessor}{\#\ define\ TLS\_GROUP\_TYPE\ \ \ \ \ \ \ \ \ \ \ \ \ 0x0000000FU\ }\textcolor{comment}{/*\ Mask\ for\ group\ type\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{00799\ \textcolor{preprocessor}{\#\ define\ TLS\_GROUP\_CURVE\_PRIME\ \ \ \ \ \ 0x00000001U}}
\DoxyCodeLine{00800\ \textcolor{preprocessor}{\#\ define\ TLS\_GROUP\_CURVE\_CHAR2\ \ \ \ \ \ 0x00000002U}}
\DoxyCodeLine{00801\ \textcolor{preprocessor}{\#\ define\ TLS\_GROUP\_CURVE\_CUSTOM\ \ \ \ \ 0x00000004U}}
\DoxyCodeLine{00802\ \textcolor{preprocessor}{\#\ define\ TLS\_GROUP\_FFDHE\ \ \ \ \ \ \ \ \ \ \ \ 0x00000008U}}
\DoxyCodeLine{00803\ \textcolor{preprocessor}{\#\ define\ TLS\_GROUP\_ONLY\_FOR\_TLS1\_3\ \ 0x00000010U}}
\DoxyCodeLine{00804\ }
\DoxyCodeLine{00805\ \textcolor{preprocessor}{\#\ define\ TLS\_GROUP\_FFDHE\_FOR\_TLS1\_3\ (TLS\_GROUP\_FFDHE|TLS\_GROUP\_ONLY\_FOR\_TLS1\_3)}}
\DoxyCodeLine{00806\ }
\DoxyCodeLine{00807\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structssl__ctx__st}{ssl\_ctx\_st}}\ \{}
\DoxyCodeLine{00808\ \ \ \ \ OSSL\_LIB\_CTX\ *libctx;}
\DoxyCodeLine{00809\ }
\DoxyCodeLine{00810\ \ \ \ \ \textcolor{keyword}{const}\ SSL\_METHOD\ *method;}
\DoxyCodeLine{00811\ \ \ \ \ STACK\_OF(SSL\_CIPHER)\ *cipher\_list;}
\DoxyCodeLine{00812\ \ \ \ \ \textcolor{comment}{/*\ same\ as\ above\ but\ sorted\ for\ lookup\ */}}
\DoxyCodeLine{00813\ \ \ \ \ STACK\_OF(SSL\_CIPHER)\ *cipher\_list\_by\_id;}
\DoxyCodeLine{00814\ \ \ \ \ \textcolor{comment}{/*\ TLSv1.3\ specific\ ciphersuites\ */}}
\DoxyCodeLine{00815\ \ \ \ \ STACK\_OF(SSL\_CIPHER)\ *tls13\_ciphersuites;}
\DoxyCodeLine{00816\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structx509__store__st}{x509\_store\_st}}\ \textcolor{comment}{/*\ X509\_STORE\ */}\ *cert\_store;}
\DoxyCodeLine{00817\ \ \ \ \ LHASH\_OF(SSL\_SESSION)\ *sessions;}
\DoxyCodeLine{00818\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00819\ \textcolor{comment}{\ \ \ \ \ *\ Most\ session-\/ids\ that\ will\ be\ cached,\ default\ is}}
\DoxyCodeLine{00820\ \textcolor{comment}{\ \ \ \ \ *\ SSL\_SESSION\_CACHE\_MAX\_SIZE\_DEFAULT.\ 0\ is\ unlimited.}}
\DoxyCodeLine{00821\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00822\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ session\_cache\_size;}
\DoxyCodeLine{00823\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structssl__session__st}{ssl\_session\_st}}\ *session\_cache\_head;}
\DoxyCodeLine{00824\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structssl__session__st}{ssl\_session\_st}}\ *session\_cache\_tail;}
\DoxyCodeLine{00825\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00826\ \textcolor{comment}{\ \ \ \ \ *\ This\ can\ have\ one\ of\ 2\ values,\ ored\ together,\ SSL\_SESS\_CACHE\_CLIENT,}}
\DoxyCodeLine{00827\ \textcolor{comment}{\ \ \ \ \ *\ SSL\_SESS\_CACHE\_SERVER,\ Default\ is\ SSL\_SESSION\_CACHE\_SERVER,\ which}}
\DoxyCodeLine{00828\ \textcolor{comment}{\ \ \ \ \ *\ means\ only\ SSL\_accept\ will\ cache\ SSL\_SESSIONS.}}
\DoxyCodeLine{00829\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00830\ \ \ \ \ uint32\_t\ session\_cache\_mode;}
\DoxyCodeLine{00831\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00832\ \textcolor{comment}{\ \ \ \ \ *\ If\ timeout\ is\ not\ 0,\ it\ is\ the\ default\ timeout\ value\ set\ when}}
\DoxyCodeLine{00833\ \textcolor{comment}{\ \ \ \ \ *\ SSL\_new()\ is\ called.\ \ This\ has\ been\ put\ in\ to\ make\ life\ easier\ to\ set}}
\DoxyCodeLine{00834\ \textcolor{comment}{\ \ \ \ \ *\ things\ up}}
\DoxyCodeLine{00835\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00836\ \ \ \ \ \mbox{\hyperlink{struct_o_s_s_l___t_i_m_e}{OSSL\_TIME}}\ session\_timeout;}
\DoxyCodeLine{00837\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00838\ \textcolor{comment}{\ \ \ \ \ *\ If\ this\ callback\ is\ not\ null,\ it\ will\ be\ called\ each\ time\ a\ session\ id}}
\DoxyCodeLine{00839\ \textcolor{comment}{\ \ \ \ \ *\ is\ added\ to\ the\ cache.\ \ If\ this\ function\ returns\ 1,\ it\ means\ that\ the}}
\DoxyCodeLine{00840\ \textcolor{comment}{\ \ \ \ \ *\ callback\ will\ do\ a\ SSL\_SESSION\_free()\ when\ it\ has\ finished\ using\ it.}}
\DoxyCodeLine{00841\ \textcolor{comment}{\ \ \ \ \ *\ Otherwise,\ on\ 0,\ it\ means\ the\ callback\ has\ finished\ with\ it.\ If}}
\DoxyCodeLine{00842\ \textcolor{comment}{\ \ \ \ \ *\ remove\_session\_cb\ is\ not\ null,\ it\ will\ be\ called\ when\ a\ session-\/id\ is}}
\DoxyCodeLine{00843\ \textcolor{comment}{\ \ \ \ \ *\ removed\ from\ the\ cache.\ \ After\ the\ call,\ OpenSSL\ will}}
\DoxyCodeLine{00844\ \textcolor{comment}{\ \ \ \ \ *\ SSL\_SESSION\_free()\ it.}}
\DoxyCodeLine{00845\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00846\ \ \ \ \ int\ (*new\_session\_cb)\ (\textcolor{keyword}{struct\ }\mbox{\hyperlink{structssl__st}{ssl\_st}}\ *ssl,\ SSL\_SESSION\ *sess);}
\DoxyCodeLine{00847\ \ \ \ \ void\ (*remove\_session\_cb)\ (\textcolor{keyword}{struct\ }\mbox{\hyperlink{structssl__ctx__st}{ssl\_ctx\_st}}\ *ctx,\ SSL\_SESSION\ *sess);}
\DoxyCodeLine{00848\ \ \ \ \ SSL\_SESSION\ *(*get\_session\_cb)\ (\textcolor{keyword}{struct\ }\mbox{\hyperlink{structssl__st}{ssl\_st}}\ *ssl,}
\DoxyCodeLine{00849\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *data,\ \textcolor{keywordtype}{int}\ len,}
\DoxyCodeLine{00850\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *copy);}
\DoxyCodeLine{00851\ \ \ \ \ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{00852\ \ \ \ \ \ \ \ \ TSAN\_QUALIFIER\ \textcolor{keywordtype}{int}\ sess\_connect;\ \ \ \ \ \ \ \textcolor{comment}{/*\ SSL\ new\ conn\ -\/\ started\ */}}
\DoxyCodeLine{00853\ \ \ \ \ \ \ \ \ TSAN\_QUALIFIER\ \textcolor{keywordtype}{int}\ sess\_connect\_renegotiate;\ \textcolor{comment}{/*\ SSL\ reneg\ -\/\ requested\ */}}
\DoxyCodeLine{00854\ \ \ \ \ \ \ \ \ TSAN\_QUALIFIER\ \textcolor{keywordtype}{int}\ sess\_connect\_good;\ \ \textcolor{comment}{/*\ SSL\ new\ conne/reneg\ -\/\ finished\ */}}
\DoxyCodeLine{00855\ \ \ \ \ \ \ \ \ TSAN\_QUALIFIER\ \textcolor{keywordtype}{int}\ sess\_accept;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ SSL\ new\ accept\ -\/\ started\ */}}
\DoxyCodeLine{00856\ \ \ \ \ \ \ \ \ TSAN\_QUALIFIER\ \textcolor{keywordtype}{int}\ sess\_accept\_renegotiate;\ \textcolor{comment}{/*\ SSL\ reneg\ -\/\ requested\ */}}
\DoxyCodeLine{00857\ \ \ \ \ \ \ \ \ TSAN\_QUALIFIER\ \textcolor{keywordtype}{int}\ sess\_accept\_good;\ \ \ \textcolor{comment}{/*\ SSL\ accept/reneg\ -\/\ finished\ */}}
\DoxyCodeLine{00858\ \ \ \ \ \ \ \ \ TSAN\_QUALIFIER\ \textcolor{keywordtype}{int}\ sess\_miss;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ session\ lookup\ misses\ */}}
\DoxyCodeLine{00859\ \ \ \ \ \ \ \ \ TSAN\_QUALIFIER\ \textcolor{keywordtype}{int}\ sess\_timeout;\ \ \ \ \ \ \ \textcolor{comment}{/*\ reuse\ attempt\ on\ timeouted\ session\ */}}
\DoxyCodeLine{00860\ \ \ \ \ \ \ \ \ TSAN\_QUALIFIER\ \textcolor{keywordtype}{int}\ sess\_cache\_full;\ \ \ \ \textcolor{comment}{/*\ session\ removed\ due\ to\ full\ cache\ */}}
\DoxyCodeLine{00861\ \ \ \ \ \ \ \ \ TSAN\_QUALIFIER\ \textcolor{keywordtype}{int}\ sess\_hit;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ session\ reuse\ actually\ done\ */}}
\DoxyCodeLine{00862\ \ \ \ \ \ \ \ \ TSAN\_QUALIFIER\ \textcolor{keywordtype}{int}\ sess\_cb\_hit;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ session-\/id\ that\ was\ not\ in}}
\DoxyCodeLine{00863\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ the\ cache\ was\ passed\ back\ via}}
\DoxyCodeLine{00864\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ the\ callback.\ This\ indicates}}
\DoxyCodeLine{00865\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ that\ the\ application\ is}}
\DoxyCodeLine{00866\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ supplying\ session-\/id's\ from}}
\DoxyCodeLine{00867\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ other\ processes\ -\/\ spooky}}
\DoxyCodeLine{00868\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ :-\/)\ */}}
\DoxyCodeLine{00869\ \ \ \ \ \}\ stats;}
\DoxyCodeLine{00870\ \textcolor{preprocessor}{\#ifdef\ TSAN\_REQUIRES\_LOCKING}}
\DoxyCodeLine{00871\ \ \ \ \ CRYPTO\_RWLOCK\ *tsan\_lock;}
\DoxyCodeLine{00872\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00873\ }
\DoxyCodeLine{00874\ \ \ \ \ \mbox{\hyperlink{struct_c_r_y_p_t_o___r_e_f___c_o_u_n_t}{CRYPTO\_REF\_COUNT}}\ references;}
\DoxyCodeLine{00875\ }
\DoxyCodeLine{00876\ \ \ \ \ \textcolor{comment}{/*\ if\ defined,\ these\ override\ the\ X509\_verify\_cert()\ calls\ */}}
\DoxyCodeLine{00877\ \ \ \ \ int\ (*app\_verify\_callback)\ (X509\_STORE\_CTX\ *,\ \textcolor{keywordtype}{void}\ *);}
\DoxyCodeLine{00878\ \ \ \ \ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{structapp__verify__arg}{app\_verify\_arg}};}
\DoxyCodeLine{00879\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00880\ \textcolor{comment}{\ \ \ \ \ *\ before\ OpenSSL\ 0.9.7,\ 'app\_verify\_arg'\ was\ ignored}}
\DoxyCodeLine{00881\ \textcolor{comment}{\ \ \ \ \ *\ ('app\_verify\_callback'\ was\ called\ with\ just\ one\ argument)}}
\DoxyCodeLine{00882\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00883\ }
\DoxyCodeLine{00884\ \ \ \ \ \textcolor{comment}{/*\ Default\ password\ callback.\ */}}
\DoxyCodeLine{00885\ \ \ \ \ pem\_password\_cb\ *default\_passwd\_callback;}
\DoxyCodeLine{00886\ }
\DoxyCodeLine{00887\ \ \ \ \ \textcolor{comment}{/*\ Default\ password\ callback\ user\ data.\ */}}
\DoxyCodeLine{00888\ \ \ \ \ \textcolor{keywordtype}{void}\ *default\_passwd\_callback\_userdata;}
\DoxyCodeLine{00889\ }
\DoxyCodeLine{00890\ \ \ \ \ \textcolor{comment}{/*\ get\ client\ cert\ callback\ */}}
\DoxyCodeLine{00891\ \ \ \ \ int\ (*client\_cert\_cb)\ (SSL\ *ssl,\ X509\ **x509,\ EVP\_PKEY\ **pkey);}
\DoxyCodeLine{00892\ }
\DoxyCodeLine{00893\ \ \ \ \ \textcolor{comment}{/*\ cookie\ generate\ callback\ */}}
\DoxyCodeLine{00894\ \ \ \ \ int\ (*app\_gen\_cookie\_cb)\ (SSL\ *ssl,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *cookie,}
\DoxyCodeLine{00895\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *cookie\_len);}
\DoxyCodeLine{00896\ }
\DoxyCodeLine{00897\ \ \ \ \ \textcolor{comment}{/*\ verify\ cookie\ callback\ */}}
\DoxyCodeLine{00898\ \ \ \ \ int\ (*app\_verify\_cookie\_cb)\ (SSL\ *ssl,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *cookie,}
\DoxyCodeLine{00899\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ cookie\_len);}
\DoxyCodeLine{00900\ }
\DoxyCodeLine{00901\ \ \ \ \ \textcolor{comment}{/*\ TLS1.3\ app-\/controlled\ cookie\ generate\ callback\ */}}
\DoxyCodeLine{00902\ \ \ \ \ int\ (*gen\_stateless\_cookie\_cb)\ (SSL\ *ssl,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *cookie,}
\DoxyCodeLine{00903\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ *cookie\_len);}
\DoxyCodeLine{00904\ }
\DoxyCodeLine{00905\ \ \ \ \ \textcolor{comment}{/*\ TLS1.3\ verify\ app-\/controlled\ cookie\ callback\ */}}
\DoxyCodeLine{00906\ \ \ \ \ int\ (*verify\_stateless\_cookie\_cb)\ (SSL\ *ssl,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *cookie,}
\DoxyCodeLine{00907\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ cookie\_len);}
\DoxyCodeLine{00908\ }
\DoxyCodeLine{00909\ \ \ \ \ CRYPTO\_EX\_DATA\ ex\_data;}
\DoxyCodeLine{00910\ }
\DoxyCodeLine{00911\ \ \ \ \ \textcolor{keyword}{const}\ EVP\_MD\ *md5;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ For\ SSLv3/TLSv1\ 'ssl3-\/md5'\ */}}
\DoxyCodeLine{00912\ \ \ \ \ \textcolor{keyword}{const}\ EVP\_MD\ *sha1;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ For\ SSLv3/TLSv1\ 'ssl3-\/sha1'\ */}}
\DoxyCodeLine{00913\ }
\DoxyCodeLine{00914\ \ \ \ \ STACK\_OF(X509)\ *extra\_certs;}
\DoxyCodeLine{00915\ \ \ \ \ STACK\_OF(SSL\_COMP)\ *comp\_methods;\ \textcolor{comment}{/*\ stack\ of\ SSL\_COMP,\ SSLv3/TLSv1\ */}}
\DoxyCodeLine{00916\ }
\DoxyCodeLine{00917\ \ \ \ \ \textcolor{comment}{/*\ Default\ values\ used\ when\ no\ per-\/SSL\ value\ is\ defined\ follow\ */}}
\DoxyCodeLine{00918\ }
\DoxyCodeLine{00919\ \ \ \ \ \textcolor{comment}{/*\ used\ if\ SSL's\ info\_callback\ is\ NULL\ */}}
\DoxyCodeLine{00920\ \ \ \ \ void\ (*info\_callback)\ (\textcolor{keyword}{const}\ SSL\ *ssl,\ \textcolor{keywordtype}{int}\ type,\ \textcolor{keywordtype}{int}\ val);}
\DoxyCodeLine{00921\ }
\DoxyCodeLine{00922\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00923\ \textcolor{comment}{\ \ \ \ \ *\ What\ we\ put\ in\ certificate\_authorities\ extension\ for\ TLS\ 1.3}}
\DoxyCodeLine{00924\ \textcolor{comment}{\ \ \ \ \ *\ (ClientHello\ and\ CertificateRequest)\ or\ just\ client\ cert\ requests\ for}}
\DoxyCodeLine{00925\ \textcolor{comment}{\ \ \ \ \ *\ earlier\ versions.\ If\ client\_ca\_names\ is\ populated\ then\ it\ is\ only\ used}}
\DoxyCodeLine{00926\ \textcolor{comment}{\ \ \ \ \ *\ for\ client\ cert\ requests,\ and\ in\ preference\ to\ ca\_names.}}
\DoxyCodeLine{00927\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00928\ \ \ \ \ STACK\_OF(X509\_NAME)\ *ca\_names;}
\DoxyCodeLine{00929\ \ \ \ \ STACK\_OF(X509\_NAME)\ *client\_ca\_names;}
\DoxyCodeLine{00930\ }
\DoxyCodeLine{00931\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00932\ \textcolor{comment}{\ \ \ \ \ *\ Default\ values\ to\ use\ in\ SSL\ structures\ follow\ (these\ are\ copied\ by}}
\DoxyCodeLine{00933\ \textcolor{comment}{\ \ \ \ \ *\ SSL\_new)}}
\DoxyCodeLine{00934\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00935\ }
\DoxyCodeLine{00936\ \ \ \ \ uint64\_t\ options;}
\DoxyCodeLine{00937\ \ \ \ \ uint32\_t\ mode;}
\DoxyCodeLine{00938\ \ \ \ \ \textcolor{keywordtype}{int}\ min\_proto\_version;}
\DoxyCodeLine{00939\ \ \ \ \ \textcolor{keywordtype}{int}\ max\_proto\_version;}
\DoxyCodeLine{00940\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ max\_cert\_list;}
\DoxyCodeLine{00941\ }
\DoxyCodeLine{00942\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structcert__st}{cert\_st}}\ \textcolor{comment}{/*\ CERT\ */}\ *cert;}
\DoxyCodeLine{00943\ \ \ \ \ \mbox{\hyperlink{struct_s_s_l___c_e_r_t___l_o_o_k_u_p}{SSL\_CERT\_LOOKUP}}\ *ssl\_cert\_info;}
\DoxyCodeLine{00944\ \ \ \ \ \textcolor{keywordtype}{int}\ read\_ahead;}
\DoxyCodeLine{00945\ }
\DoxyCodeLine{00946\ \ \ \ \ \textcolor{comment}{/*\ callback\ that\ allows\ applications\ to\ peek\ at\ protocol\ messages\ */}}
\DoxyCodeLine{00947\ \ \ \ \ ossl\_msg\_cb\ msg\_callback;}
\DoxyCodeLine{00948\ \ \ \ \ \textcolor{keywordtype}{void}\ *msg\_callback\_arg;}
\DoxyCodeLine{00949\ }
\DoxyCodeLine{00950\ \ \ \ \ uint32\_t\ verify\_mode;}
\DoxyCodeLine{00951\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ sid\_ctx\_length;}
\DoxyCodeLine{00952\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ sid\_ctx[SSL\_MAX\_SID\_CTX\_LENGTH];}
\DoxyCodeLine{00953\ \ \ \ \ \textcolor{comment}{/*\ called\ 'verify\_callback'\ in\ the\ SSL\ */}}
\DoxyCodeLine{00954\ \ \ \ \ int\ (*default\_verify\_callback)\ (\textcolor{keywordtype}{int}\ ok,\ X509\_STORE\_CTX\ *ctx);}
\DoxyCodeLine{00955\ }
\DoxyCodeLine{00956\ \ \ \ \ \textcolor{comment}{/*\ Default\ generate\ session\ ID\ callback.\ */}}
\DoxyCodeLine{00957\ \ \ \ \ GEN\_SESSION\_CB\ generate\_session\_id;}
\DoxyCodeLine{00958\ }
\DoxyCodeLine{00959\ \ \ \ \ X509\_VERIFY\_PARAM\ *param;}
\DoxyCodeLine{00960\ }
\DoxyCodeLine{00961\ \ \ \ \ \textcolor{keywordtype}{int}\ quiet\_shutdown;}
\DoxyCodeLine{00962\ }
\DoxyCodeLine{00963\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_CT}}
\DoxyCodeLine{00964\ \ \ \ \ CTLOG\_STORE\ *ctlog\_store;\ \ \ \textcolor{comment}{/*\ CT\ Log\ Store\ */}}
\DoxyCodeLine{00965\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00966\ \textcolor{comment}{\ \ \ \ \ *\ Validates\ that\ the\ SCTs\ (Signed\ Certificate\ Timestamps)\ are\ sufficient.}}
\DoxyCodeLine{00967\ \textcolor{comment}{\ \ \ \ \ *\ If\ they\ are\ not,\ the\ connection\ should\ be\ aborted.}}
\DoxyCodeLine{00968\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00969\ \ \ \ \ ssl\_ct\_validation\_cb\ ct\_validation\_callback;}
\DoxyCodeLine{00970\ \ \ \ \ \textcolor{keywordtype}{void}\ *ct\_validation\_callback\_arg;}
\DoxyCodeLine{00971\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{00972\ }
\DoxyCodeLine{00973\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00974\ \textcolor{comment}{\ \ \ \ \ *\ If\ we're\ using\ more\ than\ one\ pipeline\ how\ should\ we\ divide\ the\ data}}
\DoxyCodeLine{00975\ \textcolor{comment}{\ \ \ \ \ *\ up\ between\ the\ pipes?}}
\DoxyCodeLine{00976\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00977\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ split\_send\_fragment;}
\DoxyCodeLine{00978\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00979\ \textcolor{comment}{\ \ \ \ \ *\ Maximum\ amount\ of\ data\ to\ send\ in\ one\ fragment.\ actual\ record\ size\ can}}
\DoxyCodeLine{00980\ \textcolor{comment}{\ \ \ \ \ *\ be\ more\ than\ this\ due\ to\ padding\ and\ MAC\ overheads.}}
\DoxyCodeLine{00981\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00982\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ max\_send\_fragment;}
\DoxyCodeLine{00983\ }
\DoxyCodeLine{00984\ \ \ \ \ \textcolor{comment}{/*\ Up\ to\ how\ many\ pipelines\ should\ we\ use?\ If\ 0\ then\ 1\ is\ assumed\ */}}
\DoxyCodeLine{00985\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ max\_pipelines;}
\DoxyCodeLine{00986\ }
\DoxyCodeLine{00987\ \ \ \ \ \textcolor{comment}{/*\ The\ default\ read\ buffer\ length\ to\ use\ (0\ means\ not\ set)\ */}}
\DoxyCodeLine{00988\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ default\_read\_buf\_len;}
\DoxyCodeLine{00989\ }
\DoxyCodeLine{00990\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_ENGINE}}
\DoxyCodeLine{00991\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00992\ \textcolor{comment}{\ \ \ \ \ *\ Engine\ to\ pass\ requests\ for\ client\ certs\ to}}
\DoxyCodeLine{00993\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00994\ \ \ \ \ ENGINE\ *client\_cert\_engine;}
\DoxyCodeLine{00995\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{00996\ }
\DoxyCodeLine{00997\ \ \ \ \ \textcolor{comment}{/*\ ClientHello\ callback.\ \ Mostly\ for\ extensions,\ but\ not\ entirely.\ */}}
\DoxyCodeLine{00998\ \ \ \ \ SSL\_client\_hello\_cb\_fn\ client\_hello\_cb;}
\DoxyCodeLine{00999\ \ \ \ \ \textcolor{keywordtype}{void}\ *client\_hello\_cb\_arg;}
\DoxyCodeLine{01000\ }
\DoxyCodeLine{01001\ \ \ \ \ \textcolor{comment}{/*\ TLS\ extensions.\ */}}
\DoxyCodeLine{01002\ \ \ \ \ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{01003\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ TLS\ extensions\ servername\ callback\ */}}
\DoxyCodeLine{01004\ \ \ \ \ \ \ \ \ int\ (*servername\_cb)\ (SSL\ *,\ \textcolor{keywordtype}{int}\ *,\ \textcolor{keywordtype}{void}\ *);}
\DoxyCodeLine{01005\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *servername\_arg;}
\DoxyCodeLine{01006\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ RFC\ 4507\ session\ ticket\ keys\ */}}
\DoxyCodeLine{01007\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tick\_key\_name[TLSEXT\_KEYNAME\_LENGTH];}
\DoxyCodeLine{01008\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structssl__ctx__ext__secure__st}{SSL\_CTX\_EXT\_SECURE}}\ *secure;}
\DoxyCodeLine{01009\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_DEPRECATED\_3\_0}}
\DoxyCodeLine{01010\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Callback\ to\ support\ customisation\ of\ ticket\ key\ setting\ */}}
\DoxyCodeLine{01011\ \ \ \ \ \ \ \ \ int\ (*ticket\_key\_cb)\ (SSL\ *ssl,}
\DoxyCodeLine{01012\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *name,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *iv,}
\DoxyCodeLine{01013\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ EVP\_CIPHER\_CTX\ *ectx,\ HMAC\_CTX\ *hctx,\ \textcolor{keywordtype}{int}\ enc);}
\DoxyCodeLine{01014\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01015\ \ \ \ \ \ \ \ \ int\ (*ticket\_key\_evp\_cb)\ (SSL\ *ssl,}
\DoxyCodeLine{01016\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *name,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *iv,}
\DoxyCodeLine{01017\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ EVP\_CIPHER\_CTX\ *ectx,\ EVP\_MAC\_CTX\ *hctx,}
\DoxyCodeLine{01018\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ enc);}
\DoxyCodeLine{01019\ }
\DoxyCodeLine{01020\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ certificate\ status\ request\ info\ */}}
\DoxyCodeLine{01021\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Callback\ for\ status\ request\ */}}
\DoxyCodeLine{01022\ \ \ \ \ \ \ \ \ int\ (*status\_cb)\ (SSL\ *ssl,\ \textcolor{keywordtype}{void}\ *arg);}
\DoxyCodeLine{01023\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *status\_arg;}
\DoxyCodeLine{01024\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ ext\ status\ type\ used\ for\ CSR\ extension\ (OCSP\ Stapling)\ */}}
\DoxyCodeLine{01025\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ status\_type;}
\DoxyCodeLine{01026\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ RFC\ 4366\ Maximum\ Fragment\ Length\ Negotiation\ */}}
\DoxyCodeLine{01027\ \ \ \ \ \ \ \ \ uint8\_t\ max\_fragment\_len\_mode;}
\DoxyCodeLine{01028\ }
\DoxyCodeLine{01029\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ EC\ extension\ values\ inherited\ by\ SSL\ structure\ */}}
\DoxyCodeLine{01030\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ ecpointformats\_len;}
\DoxyCodeLine{01031\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *ecpointformats;}
\DoxyCodeLine{01032\ }
\DoxyCodeLine{01033\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ supportedgroups\_len;}
\DoxyCodeLine{01034\ \ \ \ \ \ \ \ \ uint16\_t\ *supportedgroups;}
\DoxyCodeLine{01035\ }
\DoxyCodeLine{01036\ \ \ \ \ \ \ \ \ uint16\_t\ *supported\_groups\_default;}
\DoxyCodeLine{01037\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ supported\_groups\_default\_len;}
\DoxyCodeLine{01038\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01039\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ ALPN\ information\ (we\ are\ in\ the\ process\ of\ transitioning\ from\ NPN\ to}}
\DoxyCodeLine{01040\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ ALPN.)}}
\DoxyCodeLine{01041\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{01042\ }
\DoxyCodeLine{01043\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*-\/}}
\DoxyCodeLine{01044\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ For\ a\ server,\ this\ contains\ a\ callback\ function\ that\ allows\ the}}
\DoxyCodeLine{01045\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ server\ to\ select\ the\ protocol\ for\ the\ connection.}}
\DoxyCodeLine{01046\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ \ \ out:\ on\ successful\ return,\ this\ must\ point\ to\ the\ raw\ protocol}}
\DoxyCodeLine{01047\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ \ \ \ \ \ \ \ name\ (without\ the\ length\ prefix).}}
\DoxyCodeLine{01048\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ \ \ outlen:\ on\ successful\ return,\ this\ contains\ the\ length\ of\ |*out|.}}
\DoxyCodeLine{01049\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ \ \ in:\ points\ to\ the\ client's\ list\ of\ supported\ protocols\ in}}
\DoxyCodeLine{01050\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ \ \ \ \ \ \ wire-\/format.}}
\DoxyCodeLine{01051\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ \ \ inlen:\ the\ length\ of\ |in|.}}
\DoxyCodeLine{01052\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{01053\ \ \ \ \ \ \ \ \ int\ (*alpn\_select\_cb)\ (SSL\ *s,}
\DoxyCodeLine{01054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ **out,}
\DoxyCodeLine{01055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *outlen,}
\DoxyCodeLine{01056\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *in,}
\DoxyCodeLine{01057\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ inlen,\ \textcolor{keywordtype}{void}\ *arg);}
\DoxyCodeLine{01058\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *alpn\_select\_cb\_arg;}
\DoxyCodeLine{01059\ }
\DoxyCodeLine{01060\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01061\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ For\ a\ client,\ this\ contains\ the\ list\ of\ supported\ protocols\ in\ wire}}
\DoxyCodeLine{01062\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ format.}}
\DoxyCodeLine{01063\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{01064\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *alpn;}
\DoxyCodeLine{01065\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ alpn\_len;}
\DoxyCodeLine{01066\ }
\DoxyCodeLine{01067\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_NEXTPROTONEG}}
\DoxyCodeLine{01068\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Next\ protocol\ negotiation\ information\ */}}
\DoxyCodeLine{01069\ }
\DoxyCodeLine{01070\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01071\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ For\ a\ server,\ this\ contains\ a\ callback\ function\ by\ which\ the\ set\ of}}
\DoxyCodeLine{01072\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ advertised\ protocols\ can\ be\ provided.}}
\DoxyCodeLine{01073\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{01074\ \ \ \ \ \ \ \ \ SSL\_CTX\_npn\_advertised\_cb\_func\ npn\_advertised\_cb;}
\DoxyCodeLine{01075\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *npn\_advertised\_cb\_arg;}
\DoxyCodeLine{01076\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01077\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ For\ a\ client,\ this\ contains\ a\ callback\ function\ that\ selects\ the\ next}}
\DoxyCodeLine{01078\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ protocol\ from\ the\ list\ provided\ by\ the\ server.}}
\DoxyCodeLine{01079\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{01080\ \ \ \ \ \ \ \ \ SSL\_CTX\_npn\_select\_cb\_func\ npn\_select\_cb;}
\DoxyCodeLine{01081\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *npn\_select\_cb\_arg;}
\DoxyCodeLine{01082\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{01083\ }
\DoxyCodeLine{01084\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ cookie\_hmac\_key[SHA256\_DIGEST\_LENGTH];}
\DoxyCodeLine{01085\ \ \ \ \ \}\ ext;}
\DoxyCodeLine{01086\ }
\DoxyCodeLine{01087\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_PSK}}
\DoxyCodeLine{01088\ \ \ \ \ SSL\_psk\_client\_cb\_func\ psk\_client\_callback;}
\DoxyCodeLine{01089\ \ \ \ \ SSL\_psk\_server\_cb\_func\ psk\_server\_callback;}
\DoxyCodeLine{01090\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{01091\ \ \ \ \ SSL\_psk\_find\_session\_cb\_func\ psk\_find\_session\_cb;}
\DoxyCodeLine{01092\ \ \ \ \ SSL\_psk\_use\_session\_cb\_func\ psk\_use\_session\_cb;}
\DoxyCodeLine{01093\ }
\DoxyCodeLine{01094\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_SRP}}
\DoxyCodeLine{01095\ \ \ \ \ \mbox{\hyperlink{structsrp__ctx__st}{SRP\_CTX}}\ srp\_ctx;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ ctx\ for\ SRP\ authentication\ */}}
\DoxyCodeLine{01096\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{01097\ }
\DoxyCodeLine{01098\ \ \ \ \ \textcolor{comment}{/*\ Shared\ DANE\ context\ */}}
\DoxyCodeLine{01099\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structdane__ctx__st}{dane\_ctx\_st}}\ dane;}
\DoxyCodeLine{01100\ }
\DoxyCodeLine{01101\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_SRTP}}
\DoxyCodeLine{01102\ \ \ \ \ \textcolor{comment}{/*\ SRTP\ profiles\ we\ are\ willing\ to\ do\ from\ RFC\ 5764\ */}}
\DoxyCodeLine{01103\ \ \ \ \ STACK\_OF(SRTP\_PROTECTION\_PROFILE)\ *srtp\_profiles;}
\DoxyCodeLine{01104\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{01105\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01106\ \textcolor{comment}{\ \ \ \ \ *\ Callback\ for\ disabling\ session\ caching\ and\ ticket\ support\ on\ a\ session}}
\DoxyCodeLine{01107\ \textcolor{comment}{\ \ \ \ \ *\ basis,\ depending\ on\ the\ chosen\ cipher.}}
\DoxyCodeLine{01108\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01109\ \ \ \ \ int\ (*not\_resumable\_session\_cb)\ (SSL\ *ssl,\ \textcolor{keywordtype}{int}\ is\_forward\_secure);}
\DoxyCodeLine{01110\ }
\DoxyCodeLine{01111\ \ \ \ \ CRYPTO\_RWLOCK\ *lock;}
\DoxyCodeLine{01112\ }
\DoxyCodeLine{01113\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01114\ \textcolor{comment}{\ \ \ \ \ *\ Callback\ for\ logging\ key\ material\ for\ use\ with\ debugging\ tools\ like}}
\DoxyCodeLine{01115\ \textcolor{comment}{\ \ \ \ \ *\ Wireshark.\ The\ callback\ should\ log\ \`{}line`\ followed\ by\ a\ newline.}}
\DoxyCodeLine{01116\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01117\ \ \ \ \ SSL\_CTX\_keylog\_cb\_func\ keylog\_callback;}
\DoxyCodeLine{01118\ }
\DoxyCodeLine{01119\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01120\ \textcolor{comment}{\ \ \ \ \ *\ The\ maximum\ number\ of\ bytes\ advertised\ in\ session\ tickets\ that\ can\ be}}
\DoxyCodeLine{01121\ \textcolor{comment}{\ \ \ \ \ *\ sent\ as\ early\ data.}}
\DoxyCodeLine{01122\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01123\ \ \ \ \ uint32\_t\ max\_early\_data;}
\DoxyCodeLine{01124\ }
\DoxyCodeLine{01125\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01126\ \textcolor{comment}{\ \ \ \ \ *\ The\ maximum\ number\ of\ bytes\ of\ early\ data\ that\ a\ server\ will\ tolerate}}
\DoxyCodeLine{01127\ \textcolor{comment}{\ \ \ \ \ *\ (which\ should\ be\ at\ least\ as\ much\ as\ max\_early\_data).}}
\DoxyCodeLine{01128\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01129\ \ \ \ \ uint32\_t\ recv\_max\_early\_data;}
\DoxyCodeLine{01130\ }
\DoxyCodeLine{01131\ \ \ \ \ \textcolor{comment}{/*\ TLS1.3\ padding\ callback\ */}}
\DoxyCodeLine{01132\ \ \ \ \ size\_t\ (*record\_padding\_cb)(SSL\ *s,\ \textcolor{keywordtype}{int}\ type,\ \textcolor{keywordtype}{size\_t}\ len,\ \textcolor{keywordtype}{void}\ *arg);}
\DoxyCodeLine{01133\ \ \ \ \ \textcolor{keywordtype}{void}\ *record\_padding\_arg;}
\DoxyCodeLine{01134\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ block\_padding;}
\DoxyCodeLine{01135\ }
\DoxyCodeLine{01136\ \ \ \ \ \textcolor{comment}{/*\ Session\ ticket\ appdata\ */}}
\DoxyCodeLine{01137\ \ \ \ \ SSL\_CTX\_generate\_session\_ticket\_fn\ generate\_ticket\_cb;}
\DoxyCodeLine{01138\ \ \ \ \ SSL\_CTX\_decrypt\_session\_ticket\_fn\ decrypt\_ticket\_cb;}
\DoxyCodeLine{01139\ \ \ \ \ \textcolor{keywordtype}{void}\ *ticket\_cb\_data;}
\DoxyCodeLine{01140\ }
\DoxyCodeLine{01141\ \ \ \ \ \textcolor{comment}{/*\ The\ number\ of\ TLS1.3\ tickets\ to\ automatically\ send\ */}}
\DoxyCodeLine{01142\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ num\_tickets;}
\DoxyCodeLine{01143\ }
\DoxyCodeLine{01144\ \ \ \ \ \textcolor{comment}{/*\ Callback\ to\ determine\ if\ early\_data\ is\ acceptable\ or\ not\ */}}
\DoxyCodeLine{01145\ \ \ \ \ SSL\_allow\_early\_data\_cb\_fn\ allow\_early\_data\_cb;}
\DoxyCodeLine{01146\ \ \ \ \ \textcolor{keywordtype}{void}\ *allow\_early\_data\_cb\_data;}
\DoxyCodeLine{01147\ }
\DoxyCodeLine{01148\ \ \ \ \ \textcolor{comment}{/*\ Do\ we\ advertise\ Post-\/handshake\ auth\ support?\ */}}
\DoxyCodeLine{01149\ \ \ \ \ \textcolor{keywordtype}{int}\ pha\_enabled;}
\DoxyCodeLine{01150\ }
\DoxyCodeLine{01151\ \ \ \ \ \textcolor{comment}{/*\ Callback\ for\ SSL\ async\ handling\ */}}
\DoxyCodeLine{01152\ \ \ \ \ SSL\_async\_callback\_fn\ async\_cb;}
\DoxyCodeLine{01153\ \ \ \ \ \textcolor{keywordtype}{void}\ *async\_cb\_arg;}
\DoxyCodeLine{01154\ }
\DoxyCodeLine{01155\ \ \ \ \ \textcolor{keywordtype}{char}\ *propq;}
\DoxyCodeLine{01156\ }
\DoxyCodeLine{01157\ \ \ \ \ \textcolor{keywordtype}{int}\ ssl\_mac\_pkey\_id[SSL\_MD\_NUM\_IDX];}
\DoxyCodeLine{01158\ \ \ \ \ \textcolor{keyword}{const}\ EVP\_CIPHER\ *ssl\_cipher\_methods[SSL\_ENC\_NUM\_IDX];}
\DoxyCodeLine{01159\ \ \ \ \ \textcolor{keyword}{const}\ EVP\_MD\ *ssl\_digest\_methods[SSL\_MD\_NUM\_IDX];}
\DoxyCodeLine{01160\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ ssl\_mac\_secret\_size[SSL\_MD\_NUM\_IDX];}
\DoxyCodeLine{01161\ }
\DoxyCodeLine{01162\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ tls12\_sigalgs\_len;}
\DoxyCodeLine{01163\ \ \ \ \ \textcolor{comment}{/*\ Cache\ of\ all\ sigalgs\ we\ know\ and\ whether\ they\ are\ available\ or\ not\ */}}
\DoxyCodeLine{01164\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structsigalg__lookup__st}{sigalg\_lookup\_st}}\ *sigalg\_lookup\_cache;}
\DoxyCodeLine{01165\ \ \ \ \ \textcolor{comment}{/*\ List\ of\ all\ sigalgs\ (code\ points)\ available,\ incl.\ from\ providers\ */}}
\DoxyCodeLine{01166\ \ \ \ \ uint16\_t\ *tls12\_sigalgs;}
\DoxyCodeLine{01167\ }
\DoxyCodeLine{01168\ \ \ \ \ \mbox{\hyperlink{structtls__group__info__st}{TLS\_GROUP\_INFO}}\ *group\_list;}
\DoxyCodeLine{01169\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ group\_list\_len;}
\DoxyCodeLine{01170\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ group\_list\_max\_len;}
\DoxyCodeLine{01171\ }
\DoxyCodeLine{01172\ \ \ \ \ \mbox{\hyperlink{structtls__sigalg__info__st}{TLS\_SIGALG\_INFO}}\ *sigalg\_list;}
\DoxyCodeLine{01173\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ sigalg\_list\_len;}
\DoxyCodeLine{01174\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ sigalg\_list\_max\_len;}
\DoxyCodeLine{01175\ }
\DoxyCodeLine{01176\ \ \ \ \ \textcolor{comment}{/*\ masks\ of\ disabled\ algorithms\ */}}
\DoxyCodeLine{01177\ \ \ \ \ uint32\_t\ disabled\_enc\_mask;}
\DoxyCodeLine{01178\ \ \ \ \ uint32\_t\ disabled\_mac\_mask;}
\DoxyCodeLine{01179\ \ \ \ \ uint32\_t\ disabled\_mkey\_mask;}
\DoxyCodeLine{01180\ \ \ \ \ uint32\_t\ disabled\_auth\_mask;}
\DoxyCodeLine{01181\ }
\DoxyCodeLine{01182\ \textcolor{preprocessor}{\#ifndef\ OPENSSL\_NO\_COMP\_ALG}}
\DoxyCodeLine{01183\ \ \ \ \ \textcolor{comment}{/*\ certificate\ compression\ preferences\ */}}
\DoxyCodeLine{01184\ \ \ \ \ \textcolor{keywordtype}{int}\ cert\_comp\_prefs[TLSEXT\_comp\_cert\_limit];}
\DoxyCodeLine{01185\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01186\ }
\DoxyCodeLine{01187\ \ \ \ \ \textcolor{comment}{/*\ Certificate\ Type\ stuff\ -\/\ for\ RPK\ vs\ X.509\ */}}
\DoxyCodeLine{01188\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *client\_cert\_type;}
\DoxyCodeLine{01189\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ client\_cert\_type\_len;}
\DoxyCodeLine{01190\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *server\_cert\_type;}
\DoxyCodeLine{01191\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ server\_cert\_type\_len;}
\DoxyCodeLine{01192\ \};}
\DoxyCodeLine{01193\ }
\DoxyCodeLine{01194\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structcert__pkey__st}{cert\_pkey\_st}}\ \mbox{\hyperlink{structcert__pkey__st}{CERT\_PKEY}};}
\DoxyCodeLine{01195\ }
\DoxyCodeLine{01196\ \textcolor{preprocessor}{\#define\ SSL\_TYPE\_SSL\_CONNECTION\ \ 0}}
\DoxyCodeLine{01197\ \textcolor{preprocessor}{\#define\ SSL\_TYPE\_QUIC\_CONNECTION\ 1}}
\DoxyCodeLine{01198\ \textcolor{preprocessor}{\#define\ SSL\_TYPE\_QUIC\_XSO\ \ \ \ \ \ \ \ 2}}
\DoxyCodeLine{01199\ }
\DoxyCodeLine{01200\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structssl__st}{ssl\_st}}\ \{}
\DoxyCodeLine{01201\ \ \ \ \ \textcolor{keywordtype}{int}\ type;}
\DoxyCodeLine{01202\ \ \ \ \ SSL\_CTX\ *ctx;}
\DoxyCodeLine{01203\ \ \ \ \ \textcolor{keyword}{const}\ SSL\_METHOD\ *defltmeth;}
\DoxyCodeLine{01204\ \ \ \ \ \textcolor{keyword}{const}\ SSL\_METHOD\ *method;}
\DoxyCodeLine{01205\ \ \ \ \ \mbox{\hyperlink{struct_c_r_y_p_t_o___r_e_f___c_o_u_n_t}{CRYPTO\_REF\_COUNT}}\ references;}
\DoxyCodeLine{01206\ \ \ \ \ CRYPTO\_RWLOCK\ *lock;}
\DoxyCodeLine{01207\ \ \ \ \ \textcolor{comment}{/*\ extra\ application\ data\ */}}
\DoxyCodeLine{01208\ \ \ \ \ CRYPTO\_EX\_DATA\ ex\_data;}
\DoxyCodeLine{01209\ \};}
\DoxyCodeLine{01210\ }
\DoxyCodeLine{01211\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structssl__connection__st}{ssl\_connection\_st}}\ \{}
\DoxyCodeLine{01212\ \ \ \ \ \textcolor{comment}{/*\ type\ identifier\ and\ common\ data\ */}}
\DoxyCodeLine{01213\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structssl__st}{ssl\_st}}\ ssl;}
\DoxyCodeLine{01214\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01215\ \textcolor{comment}{\ \ \ \ \ *\ protocol\ version\ (one\ of\ SSL2\_VERSION,\ SSL3\_VERSION,\ TLS1\_VERSION,}}
\DoxyCodeLine{01216\ \textcolor{comment}{\ \ \ \ \ *\ DTLS1\_VERSION)}}
\DoxyCodeLine{01217\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01218\ \ \ \ \ \textcolor{keywordtype}{int}\ version;}
\DoxyCodeLine{01219\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01220\ \textcolor{comment}{\ \ \ \ \ *\ There\ are\ 2\ BIO's\ even\ though\ they\ are\ normally\ both\ the\ same.\ \ This}}
\DoxyCodeLine{01221\ \textcolor{comment}{\ \ \ \ \ *\ is\ so\ data\ can\ be\ read\ and\ written\ to\ different\ handlers}}
\DoxyCodeLine{01222\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01223\ \ \ \ \ \textcolor{comment}{/*\ used\ by\ SSL\_read\ */}}
\DoxyCodeLine{01224\ \ \ \ \ BIO\ *rbio;}
\DoxyCodeLine{01225\ \ \ \ \ \textcolor{comment}{/*\ used\ by\ SSL\_write\ */}}
\DoxyCodeLine{01226\ \ \ \ \ BIO\ *wbio;}
\DoxyCodeLine{01227\ \ \ \ \ \textcolor{comment}{/*\ used\ during\ session-\/id\ reuse\ to\ concatenate\ messages\ */}}
\DoxyCodeLine{01228\ \ \ \ \ BIO\ *bbio;}
\DoxyCodeLine{01229\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01230\ \textcolor{comment}{\ \ \ \ \ *\ This\ holds\ a\ variable\ that\ indicates\ what\ we\ were\ doing\ when\ a\ 0\ or\ -\/1}}
\DoxyCodeLine{01231\ \textcolor{comment}{\ \ \ \ \ *\ is\ returned.\ \ This\ is\ needed\ for\ non-\/blocking\ IO\ so\ we\ know\ what}}
\DoxyCodeLine{01232\ \textcolor{comment}{\ \ \ \ \ *\ request\ needs\ re-\/doing\ when\ in\ SSL\_accept\ or\ SSL\_connect}}
\DoxyCodeLine{01233\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01234\ \ \ \ \ \textcolor{keywordtype}{int}\ rwstate;}
\DoxyCodeLine{01235\ \ \ \ \ int\ (*handshake\_func)\ (SSL\ *);}
\DoxyCodeLine{01236\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01237\ \textcolor{comment}{\ \ \ \ \ *\ Imagine\ that\ here's\ a\ boolean\ member\ "{}init"{}\ that\ is\ switched\ as\ soon}}
\DoxyCodeLine{01238\ \textcolor{comment}{\ \ \ \ \ *\ as\ SSL\_set\_\{accept/connect\}\_state\ is\ called\ for\ the\ first\ time,\ so}}
\DoxyCodeLine{01239\ \textcolor{comment}{\ \ \ \ \ *\ that\ "{}state"{}\ and\ "{}handshake\_func"{}\ are\ properly\ initialized.\ \ But\ as}}
\DoxyCodeLine{01240\ \textcolor{comment}{\ \ \ \ \ *\ handshake\_func\ is\ ==\ 0\ until\ then,\ we\ use\ this\ test\ instead\ of\ an}}
\DoxyCodeLine{01241\ \textcolor{comment}{\ \ \ \ \ *\ "{}init"{}\ member.}}
\DoxyCodeLine{01242\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01243\ \ \ \ \ \textcolor{comment}{/*\ are\ we\ the\ server\ side?\ */}}
\DoxyCodeLine{01244\ \ \ \ \ \textcolor{keywordtype}{int}\ server;}
\DoxyCodeLine{01245\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01246\ \textcolor{comment}{\ \ \ \ \ *\ Generate\ a\ new\ session\ or\ reuse\ an\ old\ one.}}
\DoxyCodeLine{01247\ \textcolor{comment}{\ \ \ \ \ *\ NB:\ For\ servers,\ the\ 'new'\ session\ may\ actually\ be\ a\ previously}}
\DoxyCodeLine{01248\ \textcolor{comment}{\ \ \ \ \ *\ cached\ session\ or\ even\ the\ previous\ session\ unless}}
\DoxyCodeLine{01249\ \textcolor{comment}{\ \ \ \ \ *\ SSL\_OP\_NO\_SESSION\_RESUMPTION\_ON\_RENEGOTIATION\ is\ set}}
\DoxyCodeLine{01250\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01251\ \ \ \ \ \textcolor{keywordtype}{int}\ new\_session;}
\DoxyCodeLine{01252\ \ \ \ \ \textcolor{comment}{/*\ don't\ send\ shutdown\ packets\ */}}
\DoxyCodeLine{01253\ \ \ \ \ \textcolor{keywordtype}{int}\ quiet\_shutdown;}
\DoxyCodeLine{01254\ \ \ \ \ \textcolor{comment}{/*\ we\ have\ shut\ things\ down,\ 0x01\ sent,\ 0x02\ for\ received\ */}}
\DoxyCodeLine{01255\ \ \ \ \ \textcolor{keywordtype}{int}\ shutdown;}
\DoxyCodeLine{01256\ \ \ \ \ \textcolor{comment}{/*\ Timestamps\ used\ to\ calculate\ the\ handshake\ RTT\ */}}
\DoxyCodeLine{01257\ \ \ \ \ \mbox{\hyperlink{struct_o_s_s_l___t_i_m_e}{OSSL\_TIME}}\ ts\_msg\_write;}
\DoxyCodeLine{01258\ \ \ \ \ \mbox{\hyperlink{struct_o_s_s_l___t_i_m_e}{OSSL\_TIME}}\ ts\_msg\_read;}
\DoxyCodeLine{01259\ \ \ \ \ \textcolor{comment}{/*\ where\ we\ are\ */}}
\DoxyCodeLine{01260\ \ \ \ \ \mbox{\hyperlink{structossl__statem__st}{OSSL\_STATEM}}\ statem;}
\DoxyCodeLine{01261\ \ \ \ \ SSL\_EARLY\_DATA\_STATE\ early\_data\_state;}
\DoxyCodeLine{01262\ \ \ \ \ BUF\_MEM\ *init\_buf;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ buffer\ used\ during\ init\ */}}
\DoxyCodeLine{01263\ \ \ \ \ \textcolor{keywordtype}{void}\ *init\_msg;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ pointer\ to\ handshake\ message\ body,\ set\ by}}
\DoxyCodeLine{01264\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ tls\_get\_message\_header()\ */}}
\DoxyCodeLine{01265\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ init\_num;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ amount\ read/written\ */}}
\DoxyCodeLine{01266\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ init\_off;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ amount\ read/written\ */}}
\DoxyCodeLine{01267\ }
\DoxyCodeLine{01268\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ ssl\_pkey\_num;}
\DoxyCodeLine{01269\ }
\DoxyCodeLine{01270\ \ \ \ \ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{01271\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ flags;}
\DoxyCodeLine{01272\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ server\_random[SSL3\_RANDOM\_SIZE];}
\DoxyCodeLine{01273\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ client\_random[SSL3\_RANDOM\_SIZE];}
\DoxyCodeLine{01274\ }
\DoxyCodeLine{01275\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ used\ during\ startup,\ digest\ all\ incoming/outgoing\ packets\ */}}
\DoxyCodeLine{01276\ \ \ \ \ \ \ \ \ BIO\ *handshake\_buffer;}
\DoxyCodeLine{01277\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01278\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ When\ handshake\ digest\ is\ determined,\ buffer\ is\ hashed\ and}}
\DoxyCodeLine{01279\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ freed\ and\ MD\_CTX\ for\ the\ required\ digest\ is\ stored\ here.}}
\DoxyCodeLine{01280\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{01281\ \ \ \ \ \ \ \ \ EVP\_MD\_CTX\ *handshake\_dgst;}
\DoxyCodeLine{01282\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01283\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ Set\ whenever\ an\ expected\ ChangeCipherSpec\ message\ is\ processed.}}
\DoxyCodeLine{01284\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ Unset\ when\ the\ peer's\ Finished\ message\ is\ received.}}
\DoxyCodeLine{01285\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ Unexpected\ ChangeCipherSpec\ messages\ trigger\ a\ fatal\ alert.}}
\DoxyCodeLine{01286\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{01287\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ change\_cipher\_spec;}
\DoxyCodeLine{01288\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ warn\_alert;}
\DoxyCodeLine{01289\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ fatal\_alert;}
\DoxyCodeLine{01290\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01291\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ we\ allow\ one\ fatal\ and\ one\ warning\ alert\ to\ be\ outstanding,\ send\ close}}
\DoxyCodeLine{01292\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ alert\ via\ the\ warning\ alert}}
\DoxyCodeLine{01293\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{01294\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ alert\_dispatch;}
\DoxyCodeLine{01295\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ send\_alert[2];}
\DoxyCodeLine{01296\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01297\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ This\ flag\ is\ set\ when\ we\ should\ renegotiate\ ASAP,\ basically\ when\ there}}
\DoxyCodeLine{01298\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ is\ no\ more\ data\ in\ the\ read\ or\ write\ buffers}}
\DoxyCodeLine{01299\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{01300\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ renegotiate;}
\DoxyCodeLine{01301\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ total\_renegotiations;}
\DoxyCodeLine{01302\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_renegotiations;}
\DoxyCodeLine{01303\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ in\_read\_app\_data;}
\DoxyCodeLine{01304\ }
\DoxyCodeLine{01305\ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{01306\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ actually\ only\ need\ to\ be\ 16+20\ for\ SSLv3\ and\ 12\ for\ TLS\ */}}
\DoxyCodeLine{01307\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ finish\_md[EVP\_MAX\_MD\_SIZE\ *\ 2];}
\DoxyCodeLine{01308\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ finish\_md\_len;}
\DoxyCodeLine{01309\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ peer\_finish\_md[EVP\_MAX\_MD\_SIZE\ *\ 2];}
\DoxyCodeLine{01310\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ peer\_finish\_md\_len;}
\DoxyCodeLine{01311\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ message\_size;}
\DoxyCodeLine{01312\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ message\_type;}
\DoxyCodeLine{01313\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ used\ to\ hold\ the\ new\ cipher\ we\ are\ going\ to\ use\ */}}
\DoxyCodeLine{01314\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ SSL\_CIPHER\ *new\_cipher;}
\DoxyCodeLine{01315\ \ \ \ \ \ \ \ \ \ \ \ \ EVP\_PKEY\ *pkey;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ holds\ short\ lived\ key\ exchange\ key\ */}}
\DoxyCodeLine{01316\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ used\ for\ certificate\ requests\ */}}
\DoxyCodeLine{01317\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ cert\_req;}
\DoxyCodeLine{01318\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Certificate\ types\ in\ certificate\ request\ message.\ */}}
\DoxyCodeLine{01319\ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ *ctype;}
\DoxyCodeLine{01320\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ ctype\_len;}
\DoxyCodeLine{01321\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Certificate\ authorities\ list\ peer\ sent\ */}}
\DoxyCodeLine{01322\ \ \ \ \ \ \ \ \ \ \ \ \ STACK\_OF(X509\_NAME)\ *peer\_ca\_names;}
\DoxyCodeLine{01323\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ key\_block\_length;}
\DoxyCodeLine{01324\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *key\_block;}
\DoxyCodeLine{01325\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ EVP\_CIPHER\ *new\_sym\_enc;}
\DoxyCodeLine{01326\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ EVP\_MD\ *new\_hash;}
\DoxyCodeLine{01327\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ new\_mac\_pkey\_type;}
\DoxyCodeLine{01328\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ new\_mac\_secret\_size;}
\DoxyCodeLine{01329\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_COMP}}
\DoxyCodeLine{01330\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ SSL\_COMP\ *new\_compression;}
\DoxyCodeLine{01331\ \textcolor{preprocessor}{\#\ else}}
\DoxyCodeLine{01332\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ *new\_compression;}
\DoxyCodeLine{01333\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{01334\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ cert\_request;}
\DoxyCodeLine{01335\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Raw\ values\ of\ the\ cipher\ list\ from\ a\ client\ */}}
\DoxyCodeLine{01336\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *ciphers\_raw;}
\DoxyCodeLine{01337\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ ciphers\_rawlen;}
\DoxyCodeLine{01338\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Temporary\ storage\ for\ premaster\ secret\ */}}
\DoxyCodeLine{01339\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *pms;}
\DoxyCodeLine{01340\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ pmslen;}
\DoxyCodeLine{01341\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_PSK}}
\DoxyCodeLine{01342\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Temporary\ storage\ for\ PSK\ key\ */}}
\DoxyCodeLine{01343\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *psk;}
\DoxyCodeLine{01344\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ psklen;}
\DoxyCodeLine{01345\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{01346\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Signature\ algorithm\ we\ actually\ use\ */}}
\DoxyCodeLine{01347\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structsigalg__lookup__st}{sigalg\_lookup\_st}}\ *sigalg;}
\DoxyCodeLine{01348\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Pointer\ to\ certificate\ we\ use\ */}}
\DoxyCodeLine{01349\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structcert__pkey__st}{CERT\_PKEY}}\ *cert;}
\DoxyCodeLine{01350\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01351\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ signature\ algorithms\ peer\ reports:\ e.g.\ supported\ signature}}
\DoxyCodeLine{01352\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ algorithms\ extension\ for\ server\ or\ as\ part\ of\ a\ certificate}}
\DoxyCodeLine{01353\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ request\ for\ client.}}
\DoxyCodeLine{01354\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ Keep\ track\ of\ the\ algorithms\ for\ TLS\ and\ X.509\ usage\ separately.}}
\DoxyCodeLine{01355\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{01356\ \ \ \ \ \ \ \ \ \ \ \ \ uint16\_t\ *peer\_sigalgs;}
\DoxyCodeLine{01357\ \ \ \ \ \ \ \ \ \ \ \ \ uint16\_t\ *peer\_cert\_sigalgs;}
\DoxyCodeLine{01358\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Size\ of\ above\ arrays\ */}}
\DoxyCodeLine{01359\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ peer\_sigalgslen;}
\DoxyCodeLine{01360\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ peer\_cert\_sigalgslen;}
\DoxyCodeLine{01361\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Sigalg\ peer\ actually\ uses\ */}}
\DoxyCodeLine{01362\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structsigalg__lookup__st}{sigalg\_lookup\_st}}\ *peer\_sigalg;}
\DoxyCodeLine{01363\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01364\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ Set\ if\ corresponding\ CERT\_PKEY\ can\ be\ used\ with\ current}}
\DoxyCodeLine{01365\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ SSL\ session:\ e.g.\ appropriate\ curve,\ signature\ algorithms\ etc.}}
\DoxyCodeLine{01366\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ If\ zero\ it\ can't\ be\ used\ at\ all.}}
\DoxyCodeLine{01367\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{01368\ \ \ \ \ \ \ \ \ \ \ \ \ uint32\_t\ *valid\_flags;}
\DoxyCodeLine{01369\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01370\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ For\ servers\ the\ following\ masks\ are\ for\ the\ key\ and\ auth\ algorithms}}
\DoxyCodeLine{01371\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ that\ are\ supported\ by\ the\ certs\ below.\ For\ clients\ they\ are\ masks\ of}}
\DoxyCodeLine{01372\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ *disabled*\ algorithms\ based\ on\ the\ current\ session.}}
\DoxyCodeLine{01373\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{01374\ \ \ \ \ \ \ \ \ \ \ \ \ uint32\_t\ mask\_k;}
\DoxyCodeLine{01375\ \ \ \ \ \ \ \ \ \ \ \ \ uint32\_t\ mask\_a;}
\DoxyCodeLine{01376\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01377\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ The\ following\ are\ used\ by\ the\ client\ to\ see\ if\ a\ cipher\ is\ allowed\ or}}
\DoxyCodeLine{01378\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ not.\ \ It\ contains\ the\ minimum\ and\ maximum\ version\ the\ client's\ using}}
\DoxyCodeLine{01379\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ based\ on\ what\ it\ knows\ so\ far.}}
\DoxyCodeLine{01380\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{01381\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ min\_ver;}
\DoxyCodeLine{01382\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ max\_ver;}
\DoxyCodeLine{01383\ \ \ \ \ \ \ \ \ \}\ tmp;}
\DoxyCodeLine{01384\ }
\DoxyCodeLine{01385\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Connection\ binding\ to\ prevent\ renegotiation\ attacks\ */}}
\DoxyCodeLine{01386\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ previous\_client\_finished[EVP\_MAX\_MD\_SIZE];}
\DoxyCodeLine{01387\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ previous\_client\_finished\_len;}
\DoxyCodeLine{01388\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ previous\_server\_finished[EVP\_MAX\_MD\_SIZE];}
\DoxyCodeLine{01389\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ previous\_server\_finished\_len;}
\DoxyCodeLine{01390\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ send\_connection\_binding;}
\DoxyCodeLine{01391\ }
\DoxyCodeLine{01392\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_NEXTPROTONEG}}
\DoxyCodeLine{01393\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01394\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ Set\ if\ we\ saw\ the\ Next\ Protocol\ Negotiation\ extension\ from\ our\ peer.}}
\DoxyCodeLine{01395\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{01396\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ npn\_seen;}
\DoxyCodeLine{01397\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{01398\ }
\DoxyCodeLine{01399\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01400\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ ALPN\ information\ (we\ are\ in\ the\ process\ of\ transitioning\ from\ NPN\ to}}
\DoxyCodeLine{01401\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ ALPN.)}}
\DoxyCodeLine{01402\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{01403\ }
\DoxyCodeLine{01404\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01405\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ In\ a\ server\ these\ point\ to\ the\ selected\ ALPN\ protocol\ after\ the}}
\DoxyCodeLine{01406\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ ClientHello\ has\ been\ processed.\ In\ a\ client\ these\ contain\ the\ protocol}}
\DoxyCodeLine{01407\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ that\ the\ server\ selected\ once\ the\ ServerHello\ has\ been\ processed.}}
\DoxyCodeLine{01408\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{01409\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *alpn\_selected;}
\DoxyCodeLine{01410\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ alpn\_selected\_len;}
\DoxyCodeLine{01411\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ used\ by\ the\ server\ to\ know\ what\ options\ were\ proposed\ */}}
\DoxyCodeLine{01412\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *alpn\_proposed;}
\DoxyCodeLine{01413\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ alpn\_proposed\_len;}
\DoxyCodeLine{01414\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ used\ by\ the\ client\ to\ know\ if\ it\ actually\ sent\ alpn\ */}}
\DoxyCodeLine{01415\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ alpn\_sent;}
\DoxyCodeLine{01416\ }
\DoxyCodeLine{01417\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01418\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ This\ is\ set\ to\ true\ if\ we\ believe\ that\ this\ is\ a\ version\ of\ Safari}}
\DoxyCodeLine{01419\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ running\ on\ OS\ X\ 10.6\ or\ newer.\ We\ wish\ to\ know\ this\ because\ Safari\ on}}
\DoxyCodeLine{01420\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ 10.8\ ..\ 10.8.3\ has\ broken\ ECDHE-\/ECDSA\ support.}}
\DoxyCodeLine{01421\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{01422\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ is\_probably\_safari;}
\DoxyCodeLine{01423\ }
\DoxyCodeLine{01424\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01425\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ Track\ whether\ we\ did\ a\ key\ exchange\ this\ handshake\ or\ not,\ so}}
\DoxyCodeLine{01426\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ SSL\_get\_negotiated\_group()\ knows\ whether\ to\ fall\ back\ to\ the}}
\DoxyCodeLine{01427\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ value\ in\ the\ SSL\_SESSION.}}
\DoxyCodeLine{01428\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{01429\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ did\_kex;}
\DoxyCodeLine{01430\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ For\ clients:\ peer\ temporary\ key\ */}}
\DoxyCodeLine{01431\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ The\ group\_id\ for\ the\ key\ exchange\ key\ */}}
\DoxyCodeLine{01432\ \ \ \ \ \ \ \ \ uint16\_t\ group\_id;}
\DoxyCodeLine{01433\ \ \ \ \ \ \ \ \ EVP\_PKEY\ *peer\_tmp;}
\DoxyCodeLine{01434\ }
\DoxyCodeLine{01435\ \ \ \ \ \}\ s3;}
\DoxyCodeLine{01436\ }
\DoxyCodeLine{01437\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structdtls1__state__st}{dtls1\_state\_st}}\ *d1;\ \ \textcolor{comment}{/*\ DTLSv1\ variables\ */}}
\DoxyCodeLine{01438\ \ \ \ \ \textcolor{comment}{/*\ callback\ that\ allows\ applications\ to\ peek\ at\ protocol\ messages\ */}}
\DoxyCodeLine{01439\ \ \ \ \ void\ (*msg\_callback)\ (\textcolor{keywordtype}{int}\ write\_p,\ \textcolor{keywordtype}{int}\ version,\ \textcolor{keywordtype}{int}\ content\_type,}
\DoxyCodeLine{01440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *buf,\ \textcolor{keywordtype}{size\_t}\ len,\ SSL\ *ssl,\ \textcolor{keywordtype}{void}\ *arg);}
\DoxyCodeLine{01441\ \ \ \ \ \textcolor{keywordtype}{void}\ *msg\_callback\_arg;}
\DoxyCodeLine{01442\ \ \ \ \ \textcolor{keywordtype}{int}\ hit;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ reusing\ a\ previous\ session\ */}}
\DoxyCodeLine{01443\ \ \ \ \ X509\_VERIFY\_PARAM\ *param;}
\DoxyCodeLine{01444\ \ \ \ \ \textcolor{comment}{/*\ Per\ connection\ DANE\ state\ */}}
\DoxyCodeLine{01445\ \ \ \ \ SSL\_DANE\ dane;}
\DoxyCodeLine{01446\ \ \ \ \ \textcolor{comment}{/*\ crypto\ */}}
\DoxyCodeLine{01447\ \ \ \ \ STACK\_OF(SSL\_CIPHER)\ *peer\_ciphers;}
\DoxyCodeLine{01448\ \ \ \ \ STACK\_OF(SSL\_CIPHER)\ *cipher\_list;}
\DoxyCodeLine{01449\ \ \ \ \ STACK\_OF(SSL\_CIPHER)\ *cipher\_list\_by\_id;}
\DoxyCodeLine{01450\ \ \ \ \ \textcolor{comment}{/*\ TLSv1.3\ specific\ ciphersuites\ */}}
\DoxyCodeLine{01451\ \ \ \ \ STACK\_OF(SSL\_CIPHER)\ *tls13\_ciphersuites;}
\DoxyCodeLine{01452\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01453\ \textcolor{comment}{\ \ \ \ \ *\ These\ are\ the\ ones\ being\ used,\ the\ ones\ in\ SSL\_SESSION\ are\ the\ ones\ to}}
\DoxyCodeLine{01454\ \textcolor{comment}{\ \ \ \ \ *\ be\ 'copied'\ into\ these\ ones}}
\DoxyCodeLine{01455\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01456\ \ \ \ \ uint32\_t\ mac\_flags;}
\DoxyCodeLine{01457\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01458\ \textcolor{comment}{\ \ \ \ \ *\ The\ TLS1.3\ secrets.}}
\DoxyCodeLine{01459\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01460\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ early\_secret[EVP\_MAX\_MD\_SIZE];}
\DoxyCodeLine{01461\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ handshake\_secret[EVP\_MAX\_MD\_SIZE];}
\DoxyCodeLine{01462\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ master\_secret[EVP\_MAX\_MD\_SIZE];}
\DoxyCodeLine{01463\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ resumption\_master\_secret[EVP\_MAX\_MD\_SIZE];}
\DoxyCodeLine{01464\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ client\_finished\_secret[EVP\_MAX\_MD\_SIZE];}
\DoxyCodeLine{01465\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ server\_finished\_secret[EVP\_MAX\_MD\_SIZE];}
\DoxyCodeLine{01466\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ server\_finished\_hash[EVP\_MAX\_MD\_SIZE];}
\DoxyCodeLine{01467\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ handshake\_traffic\_hash[EVP\_MAX\_MD\_SIZE];}
\DoxyCodeLine{01468\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ client\_app\_traffic\_secret[EVP\_MAX\_MD\_SIZE];}
\DoxyCodeLine{01469\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ server\_app\_traffic\_secret[EVP\_MAX\_MD\_SIZE];}
\DoxyCodeLine{01470\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ exporter\_master\_secret[EVP\_MAX\_MD\_SIZE];}
\DoxyCodeLine{01471\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ early\_exporter\_master\_secret[EVP\_MAX\_MD\_SIZE];}
\DoxyCodeLine{01472\ }
\DoxyCodeLine{01473\ \ \ \ \ \textcolor{comment}{/*\ session\ info\ */}}
\DoxyCodeLine{01474\ \ \ \ \ \textcolor{comment}{/*\ client\ cert?\ */}}
\DoxyCodeLine{01475\ \ \ \ \ \textcolor{comment}{/*\ This\ is\ used\ to\ hold\ the\ server\ certificate\ used\ */}}
\DoxyCodeLine{01476\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structcert__st}{cert\_st}}\ \textcolor{comment}{/*\ CERT\ */}\ *cert;}
\DoxyCodeLine{01477\ }
\DoxyCodeLine{01478\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01479\ \textcolor{comment}{\ \ \ \ \ *\ The\ hash\ of\ all\ messages\ prior\ to\ the\ CertificateVerify,\ and\ the\ length}}
\DoxyCodeLine{01480\ \textcolor{comment}{\ \ \ \ \ *\ of\ that\ hash.}}
\DoxyCodeLine{01481\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01482\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ cert\_verify\_hash[EVP\_MAX\_MD\_SIZE];}
\DoxyCodeLine{01483\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ cert\_verify\_hash\_len;}
\DoxyCodeLine{01484\ }
\DoxyCodeLine{01485\ \ \ \ \ \textcolor{comment}{/*\ Flag\ to\ indicate\ whether\ we\ should\ send\ a\ HelloRetryRequest\ or\ not\ */}}
\DoxyCodeLine{01486\ \ \ \ \ \textcolor{keyword}{enum}\ \{SSL\_HRR\_NONE\ =\ 0,\ SSL\_HRR\_PENDING,\ SSL\_HRR\_COMPLETE\}}
\DoxyCodeLine{01487\ \ \ \ \ \ \ \ \ hello\_retry\_request;}
\DoxyCodeLine{01488\ }
\DoxyCodeLine{01489\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01490\ \textcolor{comment}{\ \ \ \ \ *\ the\ session\_id\_context\ is\ used\ to\ ensure\ sessions\ are\ only\ reused\ in}}
\DoxyCodeLine{01491\ \textcolor{comment}{\ \ \ \ \ *\ the\ appropriate\ context}}
\DoxyCodeLine{01492\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01493\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ sid\_ctx\_length;}
\DoxyCodeLine{01494\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ sid\_ctx[SSL\_MAX\_SID\_CTX\_LENGTH];}
\DoxyCodeLine{01495\ \ \ \ \ \textcolor{comment}{/*\ This\ can\ also\ be\ in\ the\ session\ once\ a\ session\ is\ established\ */}}
\DoxyCodeLine{01496\ \ \ \ \ SSL\_SESSION\ *session;}
\DoxyCodeLine{01497\ \ \ \ \ \textcolor{comment}{/*\ TLSv1.3\ PSK\ session\ */}}
\DoxyCodeLine{01498\ \ \ \ \ SSL\_SESSION\ *psksession;}
\DoxyCodeLine{01499\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *psksession\_id;}
\DoxyCodeLine{01500\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ psksession\_id\_len;}
\DoxyCodeLine{01501\ \ \ \ \ \textcolor{comment}{/*\ Default\ generate\ session\ ID\ callback.\ */}}
\DoxyCodeLine{01502\ \ \ \ \ GEN\_SESSION\_CB\ generate\_session\_id;}
\DoxyCodeLine{01503\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01504\ \textcolor{comment}{\ \ \ \ \ *\ The\ temporary\ TLSv1.3\ session\ id.\ This\ isn't\ really\ a\ session\ id\ at\ all}}
\DoxyCodeLine{01505\ \textcolor{comment}{\ \ \ \ \ *\ but\ is\ a\ random\ value\ sent\ in\ the\ legacy\ session\ id\ field.}}
\DoxyCodeLine{01506\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01507\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tmp\_session\_id[SSL\_MAX\_SSL\_SESSION\_ID\_LENGTH];}
\DoxyCodeLine{01508\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ tmp\_session\_id\_len;}
\DoxyCodeLine{01509\ \ \ \ \ \textcolor{comment}{/*\ Used\ in\ SSL3\ */}}
\DoxyCodeLine{01510\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01511\ \textcolor{comment}{\ \ \ \ \ *\ 0\ don't\ care\ about\ verify\ failure.}}
\DoxyCodeLine{01512\ \textcolor{comment}{\ \ \ \ \ *\ 1\ fail\ if\ verify\ fails}}
\DoxyCodeLine{01513\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01514\ \ \ \ \ uint32\_t\ verify\_mode;}
\DoxyCodeLine{01515\ \ \ \ \ \textcolor{comment}{/*\ fail\ if\ callback\ returns\ 0\ */}}
\DoxyCodeLine{01516\ \ \ \ \ int\ (*verify\_callback)\ (\textcolor{keywordtype}{int}\ ok,\ X509\_STORE\_CTX\ *ctx);}
\DoxyCodeLine{01517\ \ \ \ \ \textcolor{comment}{/*\ optional\ informational\ callback\ */}}
\DoxyCodeLine{01518\ \ \ \ \ void\ (*info\_callback)\ (\textcolor{keyword}{const}\ SSL\ *ssl,\ \textcolor{keywordtype}{int}\ type,\ \textcolor{keywordtype}{int}\ val);}
\DoxyCodeLine{01519\ \ \ \ \ \textcolor{comment}{/*\ error\ bytes\ to\ be\ written\ */}}
\DoxyCodeLine{01520\ \ \ \ \ \textcolor{keywordtype}{int}\ error;}
\DoxyCodeLine{01521\ \ \ \ \ \textcolor{comment}{/*\ actual\ code\ */}}
\DoxyCodeLine{01522\ \ \ \ \ \textcolor{keywordtype}{int}\ error\_code;}
\DoxyCodeLine{01523\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_PSK}}
\DoxyCodeLine{01524\ \ \ \ \ SSL\_psk\_client\_cb\_func\ psk\_client\_callback;}
\DoxyCodeLine{01525\ \ \ \ \ SSL\_psk\_server\_cb\_func\ psk\_server\_callback;}
\DoxyCodeLine{01526\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{01527\ \ \ \ \ SSL\_psk\_find\_session\_cb\_func\ psk\_find\_session\_cb;}
\DoxyCodeLine{01528\ \ \ \ \ SSL\_psk\_use\_session\_cb\_func\ psk\_use\_session\_cb;}
\DoxyCodeLine{01529\ }
\DoxyCodeLine{01530\ \ \ \ \ \textcolor{comment}{/*\ Verified\ chain\ of\ peer\ */}}
\DoxyCodeLine{01531\ \ \ \ \ STACK\_OF(X509)\ *verified\_chain;}
\DoxyCodeLine{01532\ \ \ \ \ \textcolor{keywordtype}{long}\ verify\_result;}
\DoxyCodeLine{01533\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01534\ \textcolor{comment}{\ \ \ \ \ *\ What\ we\ put\ in\ certificate\_authorities\ extension\ for\ TLS\ 1.3}}
\DoxyCodeLine{01535\ \textcolor{comment}{\ \ \ \ \ *\ (ClientHello\ and\ CertificateRequest)\ or\ just\ client\ cert\ requests\ for}}
\DoxyCodeLine{01536\ \textcolor{comment}{\ \ \ \ \ *\ earlier\ versions.\ If\ client\_ca\_names\ is\ populated\ then\ it\ is\ only\ used}}
\DoxyCodeLine{01537\ \textcolor{comment}{\ \ \ \ \ *\ for\ client\ cert\ requests,\ and\ in\ preference\ to\ ca\_names.}}
\DoxyCodeLine{01538\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01539\ \ \ \ \ STACK\_OF(X509\_NAME)\ *ca\_names;}
\DoxyCodeLine{01540\ \ \ \ \ STACK\_OF(X509\_NAME)\ *client\_ca\_names;}
\DoxyCodeLine{01541\ \ \ \ \ \textcolor{comment}{/*\ protocol\ behaviour\ */}}
\DoxyCodeLine{01542\ \ \ \ \ uint64\_t\ options;}
\DoxyCodeLine{01543\ \ \ \ \ \textcolor{comment}{/*\ API\ behaviour\ */}}
\DoxyCodeLine{01544\ \ \ \ \ uint32\_t\ mode;}
\DoxyCodeLine{01545\ \ \ \ \ \textcolor{keywordtype}{int}\ min\_proto\_version;}
\DoxyCodeLine{01546\ \ \ \ \ \textcolor{keywordtype}{int}\ max\_proto\_version;}
\DoxyCodeLine{01547\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ max\_cert\_list;}
\DoxyCodeLine{01548\ \ \ \ \ \textcolor{keywordtype}{int}\ first\_packet;}
\DoxyCodeLine{01549\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01550\ \textcolor{comment}{\ \ \ \ \ *\ What\ was\ passed\ in\ ClientHello.legacy\_version.\ Used\ for\ RSA\ pre-\/master}}
\DoxyCodeLine{01551\ \textcolor{comment}{\ \ \ \ \ *\ secret\ and\ SSLv3/TLS\ (<=1.2)\ rollback\ check}}
\DoxyCodeLine{01552\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01553\ \ \ \ \ \textcolor{keywordtype}{int}\ client\_version;}
\DoxyCodeLine{01554\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01555\ \textcolor{comment}{\ \ \ \ \ *\ If\ we're\ using\ more\ than\ one\ pipeline\ how\ should\ we\ divide\ the\ data}}
\DoxyCodeLine{01556\ \textcolor{comment}{\ \ \ \ \ *\ up\ between\ the\ pipes?}}
\DoxyCodeLine{01557\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01558\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ split\_send\_fragment;}
\DoxyCodeLine{01559\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01560\ \textcolor{comment}{\ \ \ \ \ *\ Maximum\ amount\ of\ data\ to\ send\ in\ one\ fragment.\ actual\ record\ size\ can}}
\DoxyCodeLine{01561\ \textcolor{comment}{\ \ \ \ \ *\ be\ more\ than\ this\ due\ to\ padding\ and\ MAC\ overheads.}}
\DoxyCodeLine{01562\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01563\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ max\_send\_fragment;}
\DoxyCodeLine{01564\ \ \ \ \ \textcolor{comment}{/*\ Up\ to\ how\ many\ pipelines\ should\ we\ use?\ If\ 0\ then\ 1\ is\ assumed\ */}}
\DoxyCodeLine{01565\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ max\_pipelines;}
\DoxyCodeLine{01566\ }
\DoxyCodeLine{01567\ \ \ \ \ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{01568\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Built-\/in\ extension\ flags\ */}}
\DoxyCodeLine{01569\ \ \ \ \ \ \ \ \ uint8\_t\ extflags[TLSEXT\_IDX\_num\_builtins];}
\DoxyCodeLine{01570\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ TLS\ extension\ debug\ callback\ */}}
\DoxyCodeLine{01571\ \ \ \ \ \ \ \ \ void\ (*debug\_cb)(SSL\ *s,\ \textcolor{keywordtype}{int}\ client\_server,\ \textcolor{keywordtype}{int}\ type,}
\DoxyCodeLine{01572\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *data,\ \textcolor{keywordtype}{int}\ len,\ \textcolor{keywordtype}{void}\ *arg);}
\DoxyCodeLine{01573\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *debug\_arg;}
\DoxyCodeLine{01574\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ *hostname;}
\DoxyCodeLine{01575\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ certificate\ status\ request\ info\ */}}
\DoxyCodeLine{01576\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Status\ type\ or\ -\/1\ if\ no\ status\ type\ */}}
\DoxyCodeLine{01577\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ status\_type;}
\DoxyCodeLine{01578\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Raw\ extension\ data,\ if\ seen\ */}}
\DoxyCodeLine{01579\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *scts;}
\DoxyCodeLine{01580\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Length\ of\ raw\ extension\ data,\ if\ seen\ */}}
\DoxyCodeLine{01581\ \ \ \ \ \ \ \ \ uint16\_t\ scts\_len;}
\DoxyCodeLine{01582\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Expect\ OCSP\ CertificateStatus\ message\ */}}
\DoxyCodeLine{01583\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ status\_expected;}
\DoxyCodeLine{01584\ }
\DoxyCodeLine{01585\ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{01586\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ OCSP\ status\ request\ only\ */}}
\DoxyCodeLine{01587\ \ \ \ \ \ \ \ \ \ \ \ \ STACK\_OF(OCSP\_RESPID)\ *ids;}
\DoxyCodeLine{01588\ \ \ \ \ \ \ \ \ \ \ \ \ X509\_EXTENSIONS\ *exts;}
\DoxyCodeLine{01589\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ OCSP\ response\ received\ or\ to\ be\ sent\ */}}
\DoxyCodeLine{01590\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *resp;}
\DoxyCodeLine{01591\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ resp\_len;}
\DoxyCodeLine{01592\ \ \ \ \ \ \ \ \ \}\ ocsp;}
\DoxyCodeLine{01593\ }
\DoxyCodeLine{01594\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ RFC4507\ session\ ticket\ expected\ to\ be\ received\ or\ sent\ */}}
\DoxyCodeLine{01595\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ ticket\_expected;}
\DoxyCodeLine{01596\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ TLS\ 1.3\ tickets\ requested\ by\ the\ application.\ */}}
\DoxyCodeLine{01597\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ extra\_tickets\_expected;}
\DoxyCodeLine{01598\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ ecpointformats\_len;}
\DoxyCodeLine{01599\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ our\ list\ */}}
\DoxyCodeLine{01600\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *ecpointformats;}
\DoxyCodeLine{01601\ }
\DoxyCodeLine{01602\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ peer\_ecpointformats\_len;}
\DoxyCodeLine{01603\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ peer's\ list\ */}}
\DoxyCodeLine{01604\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *peer\_ecpointformats;}
\DoxyCodeLine{01605\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ supportedgroups\_len;}
\DoxyCodeLine{01606\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ our\ list\ */}}
\DoxyCodeLine{01607\ \ \ \ \ \ \ \ \ uint16\_t\ *supportedgroups;}
\DoxyCodeLine{01608\ }
\DoxyCodeLine{01609\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ peer\_supportedgroups\_len;}
\DoxyCodeLine{01610\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ peer's\ list\ */}}
\DoxyCodeLine{01611\ \ \ \ \ \ \ \ \ uint16\_t\ *peer\_supportedgroups;}
\DoxyCodeLine{01612\ }
\DoxyCodeLine{01613\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ TLS\ Session\ Ticket\ extension\ override\ */}}
\DoxyCodeLine{01614\ \ \ \ \ \ \ \ \ TLS\_SESSION\_TICKET\_EXT\ *session\_ticket;}
\DoxyCodeLine{01615\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ TLS\ Session\ Ticket\ extension\ callback\ */}}
\DoxyCodeLine{01616\ \ \ \ \ \ \ \ \ tls\_session\_ticket\_ext\_cb\_fn\ session\_ticket\_cb;}
\DoxyCodeLine{01617\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *session\_ticket\_cb\_arg;}
\DoxyCodeLine{01618\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ TLS\ pre-\/shared\ secret\ session\ resumption\ */}}
\DoxyCodeLine{01619\ \ \ \ \ \ \ \ \ tls\_session\_secret\_cb\_fn\ session\_secret\_cb;}
\DoxyCodeLine{01620\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *session\_secret\_cb\_arg;}
\DoxyCodeLine{01621\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01622\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ For\ a\ client,\ this\ contains\ the\ list\ of\ supported\ protocols\ in\ wire}}
\DoxyCodeLine{01623\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ format.}}
\DoxyCodeLine{01624\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{01625\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *alpn;}
\DoxyCodeLine{01626\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ alpn\_len;}
\DoxyCodeLine{01627\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01628\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ Next\ protocol\ negotiation.\ For\ the\ client,\ this\ is\ the\ protocol\ that}}
\DoxyCodeLine{01629\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ we\ sent\ in\ NextProtocol\ and\ is\ set\ when\ handling\ ServerHello}}
\DoxyCodeLine{01630\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ extensions.\ For\ a\ server,\ this\ is\ the\ client's\ selected\_protocol\ from}}
\DoxyCodeLine{01631\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ NextProtocol\ and\ is\ set\ when\ handling\ the\ NextProtocol\ message,\ before}}
\DoxyCodeLine{01632\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ the\ Finished\ message.}}
\DoxyCodeLine{01633\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{01634\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *npn;}
\DoxyCodeLine{01635\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ npn\_len;}
\DoxyCodeLine{01636\ }
\DoxyCodeLine{01637\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ The\ available\ PSK\ key\ exchange\ modes\ */}}
\DoxyCodeLine{01638\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ psk\_kex\_mode;}
\DoxyCodeLine{01639\ }
\DoxyCodeLine{01640\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Set\ to\ one\ if\ we\ have\ negotiated\ ETM\ */}}
\DoxyCodeLine{01641\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ use\_etm;}
\DoxyCodeLine{01642\ }
\DoxyCodeLine{01643\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Are\ we\ expecting\ to\ receive\ early\ data?\ */}}
\DoxyCodeLine{01644\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ early\_data;}
\DoxyCodeLine{01645\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Is\ the\ session\ suitable\ for\ early\ data?\ */}}
\DoxyCodeLine{01646\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ early\_data\_ok;}
\DoxyCodeLine{01647\ }
\DoxyCodeLine{01648\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ May\ be\ sent\ by\ a\ server\ in\ HRR.\ Must\ be\ echoed\ back\ in\ ClientHello\ */}}
\DoxyCodeLine{01649\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *tls13\_cookie;}
\DoxyCodeLine{01650\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ tls13\_cookie\_len;}
\DoxyCodeLine{01651\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Have\ we\ received\ a\ cookie\ from\ the\ client?\ */}}
\DoxyCodeLine{01652\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ cookieok;}
\DoxyCodeLine{01653\ }
\DoxyCodeLine{01654\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01655\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ Maximum\ Fragment\ Length\ as\ per\ RFC\ 4366.}}
\DoxyCodeLine{01656\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ If\ this\ member\ contains\ one\ of\ the\ allowed\ values\ (1-\/4)}}
\DoxyCodeLine{01657\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ then\ we\ should\ include\ Maximum\ Fragment\ Length\ Negotiation}}
\DoxyCodeLine{01658\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ extension\ in\ Client\ Hello.}}
\DoxyCodeLine{01659\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ Please\ note\ that\ value\ of\ this\ member\ does\ not\ have\ direct}}
\DoxyCodeLine{01660\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ effect.\ The\ actual\ (binding)\ value\ is\ stored\ in\ SSL\_SESSION,}}
\DoxyCodeLine{01661\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ as\ this\ extension\ is\ optional\ on\ server\ side.}}
\DoxyCodeLine{01662\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{01663\ \ \ \ \ \ \ \ \ uint8\_t\ max\_fragment\_len\_mode;}
\DoxyCodeLine{01664\ }
\DoxyCodeLine{01665\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01666\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ On\ the\ client\ side\ the\ number\ of\ ticket\ identities\ we\ sent\ in\ the}}
\DoxyCodeLine{01667\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ ClientHello.\ On\ the\ server\ side\ the\ identity\ of\ the\ ticket\ we}}
\DoxyCodeLine{01668\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ selected.}}
\DoxyCodeLine{01669\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{01670\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ tick\_identity;}
\DoxyCodeLine{01671\ }
\DoxyCodeLine{01672\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ This\ is\ the\ list\ of\ algorithms\ the\ peer\ supports\ that\ we\ also\ support\ */}}
\DoxyCodeLine{01673\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ compress\_certificate\_from\_peer[TLSEXT\_comp\_cert\_limit];}
\DoxyCodeLine{01674\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ indicate\ that\ we\ sent\ the\ extension,\ so\ we'll\ accept\ it\ */}}
\DoxyCodeLine{01675\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ compress\_certificate\_sent;}
\DoxyCodeLine{01676\ }
\DoxyCodeLine{01677\ \ \ \ \ \ \ \ \ uint8\_t\ client\_cert\_type;}
\DoxyCodeLine{01678\ \ \ \ \ \ \ \ \ uint8\_t\ client\_cert\_type\_ctos;}
\DoxyCodeLine{01679\ \ \ \ \ \ \ \ \ uint8\_t\ server\_cert\_type;}
\DoxyCodeLine{01680\ \ \ \ \ \ \ \ \ uint8\_t\ server\_cert\_type\_ctos;}
\DoxyCodeLine{01681\ \ \ \ \ \}\ ext;}
\DoxyCodeLine{01682\ }
\DoxyCodeLine{01683\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01684\ \textcolor{comment}{\ \ \ \ \ *\ Parsed\ form\ of\ the\ ClientHello,\ kept\ around\ across\ client\_hello\_cb}}
\DoxyCodeLine{01685\ \textcolor{comment}{\ \ \ \ \ *\ calls.}}
\DoxyCodeLine{01686\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01687\ \ \ \ \ \mbox{\hyperlink{struct_c_l_i_e_n_t_h_e_l_l_o___m_s_g}{CLIENTHELLO\_MSG}}\ *clienthello;}
\DoxyCodeLine{01688\ }
\DoxyCodeLine{01689\ \ \ \ \ \textcolor{comment}{/*-\/}}
\DoxyCodeLine{01690\ \textcolor{comment}{\ \ \ \ \ *\ no\ further\ mod\ of\ servername}}
\DoxyCodeLine{01691\ \textcolor{comment}{\ \ \ \ \ *\ 0\ :\ call\ the\ servername\ extension\ callback.}}
\DoxyCodeLine{01692\ \textcolor{comment}{\ \ \ \ \ *\ 1\ :\ prepare\ 2,\ allow\ last\ ack\ just\ after\ in\ server\ callback.}}
\DoxyCodeLine{01693\ \textcolor{comment}{\ \ \ \ \ *\ 2\ :\ don't\ call\ servername\ callback,\ no\ ack\ in\ server\ hello}}
\DoxyCodeLine{01694\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01695\ \ \ \ \ \textcolor{keywordtype}{int}\ servername\_done;}
\DoxyCodeLine{01696\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_CT}}
\DoxyCodeLine{01697\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01698\ \textcolor{comment}{\ \ \ \ \ *\ Validates\ that\ the\ SCTs\ (Signed\ Certificate\ Timestamps)\ are\ sufficient.}}
\DoxyCodeLine{01699\ \textcolor{comment}{\ \ \ \ \ *\ If\ they\ are\ not,\ the\ connection\ should\ be\ aborted.}}
\DoxyCodeLine{01700\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01701\ \ \ \ \ ssl\_ct\_validation\_cb\ ct\_validation\_callback;}
\DoxyCodeLine{01702\ \ \ \ \ \textcolor{comment}{/*\ User-\/supplied\ argument\ that\ is\ passed\ to\ the\ ct\_validation\_callback\ */}}
\DoxyCodeLine{01703\ \ \ \ \ \textcolor{keywordtype}{void}\ *ct\_validation\_callback\_arg;}
\DoxyCodeLine{01704\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01705\ \textcolor{comment}{\ \ \ \ \ *\ Consolidated\ stack\ of\ SCTs\ from\ all\ sources.}}
\DoxyCodeLine{01706\ \textcolor{comment}{\ \ \ \ \ *\ Lazily\ populated\ by\ CT\_get\_peer\_scts(SSL*)}}
\DoxyCodeLine{01707\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01708\ \ \ \ \ STACK\_OF(SCT)\ *scts;}
\DoxyCodeLine{01709\ \ \ \ \ \textcolor{comment}{/*\ Have\ we\ attempted\ to\ find/parse\ SCTs\ yet?\ */}}
\DoxyCodeLine{01710\ \ \ \ \ \textcolor{keywordtype}{int}\ scts\_parsed;}
\DoxyCodeLine{01711\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{01712\ \ \ \ \ SSL\_CTX\ *session\_ctx;\ \ \ \ \ \ \ \textcolor{comment}{/*\ initial\ ctx,\ used\ to\ store\ sessions\ */}}
\DoxyCodeLine{01713\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_SRTP}}
\DoxyCodeLine{01714\ \ \ \ \ \textcolor{comment}{/*\ What\ we'll\ do\ */}}
\DoxyCodeLine{01715\ \ \ \ \ STACK\_OF(SRTP\_PROTECTION\_PROFILE)\ *srtp\_profiles;}
\DoxyCodeLine{01716\ \ \ \ \ \textcolor{comment}{/*\ What's\ been\ chosen\ */}}
\DoxyCodeLine{01717\ \ \ \ \ SRTP\_PROTECTION\_PROFILE\ *srtp\_profile;}
\DoxyCodeLine{01718\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{01719\ \ \ \ \ \textcolor{comment}{/*-\/}}
\DoxyCodeLine{01720\ \textcolor{comment}{\ \ \ \ \ *\ 1\ if\ we\ are\ renegotiating.}}
\DoxyCodeLine{01721\ \textcolor{comment}{\ \ \ \ \ *\ 2\ if\ we\ are\ a\ server\ and\ are\ inside\ a\ handshake}}
\DoxyCodeLine{01722\ \textcolor{comment}{\ \ \ \ \ *\ (i.e.\ not\ just\ sending\ a\ HelloRequest)}}
\DoxyCodeLine{01723\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01724\ \ \ \ \ \textcolor{keywordtype}{int}\ renegotiate;}
\DoxyCodeLine{01725\ \ \ \ \ \textcolor{comment}{/*\ If\ sending\ a\ KeyUpdate\ is\ pending\ */}}
\DoxyCodeLine{01726\ \ \ \ \ \textcolor{keywordtype}{int}\ key\_update;}
\DoxyCodeLine{01727\ \ \ \ \ \textcolor{comment}{/*\ Post-\/handshake\ authentication\ state\ */}}
\DoxyCodeLine{01728\ \ \ \ \ SSL\_PHA\_STATE\ post\_handshake\_auth;}
\DoxyCodeLine{01729\ \ \ \ \ \textcolor{keywordtype}{int}\ pha\_enabled;}
\DoxyCodeLine{01730\ \ \ \ \ uint8\_t*\ pha\_context;}
\DoxyCodeLine{01731\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ pha\_context\_len;}
\DoxyCodeLine{01732\ \ \ \ \ \textcolor{keywordtype}{int}\ certreqs\_sent;}
\DoxyCodeLine{01733\ \ \ \ \ EVP\_MD\_CTX\ *pha\_dgst;\ \textcolor{comment}{/*\ this\ is\ just\ the\ digest\ through\ ClientFinished\ */}}
\DoxyCodeLine{01734\ }
\DoxyCodeLine{01735\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_SRP}}
\DoxyCodeLine{01736\ \ \ \ \ \textcolor{comment}{/*\ ctx\ for\ SRP\ authentication\ */}}
\DoxyCodeLine{01737\ \ \ \ \ \mbox{\hyperlink{structsrp__ctx__st}{SRP\_CTX}}\ srp\_ctx;}
\DoxyCodeLine{01738\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{01739\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01740\ \textcolor{comment}{\ \ \ \ \ *\ Callback\ for\ disabling\ session\ caching\ and\ ticket\ support\ on\ a\ session}}
\DoxyCodeLine{01741\ \textcolor{comment}{\ \ \ \ \ *\ basis,\ depending\ on\ the\ chosen\ cipher.}}
\DoxyCodeLine{01742\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01743\ \ \ \ \ int\ (*not\_resumable\_session\_cb)\ (SSL\ *ssl,\ \textcolor{keywordtype}{int}\ is\_forward\_secure);}
\DoxyCodeLine{01744\ }
\DoxyCodeLine{01745\ \ \ \ \ \textcolor{comment}{/*\ Record\ layer\ data\ */}}
\DoxyCodeLine{01746\ \ \ \ \ \mbox{\hyperlink{structrecord__layer__st}{RECORD\_LAYER}}\ rlayer;}
\DoxyCodeLine{01747\ }
\DoxyCodeLine{01748\ \ \ \ \ \textcolor{comment}{/*\ Default\ password\ callback.\ */}}
\DoxyCodeLine{01749\ \ \ \ \ pem\_password\_cb\ *default\_passwd\_callback;}
\DoxyCodeLine{01750\ \ \ \ \ \textcolor{comment}{/*\ Default\ password\ callback\ user\ data.\ */}}
\DoxyCodeLine{01751\ \ \ \ \ \textcolor{keywordtype}{void}\ *default\_passwd\_callback\_userdata;}
\DoxyCodeLine{01752\ \ \ \ \ \textcolor{comment}{/*\ Async\ Job\ info\ */}}
\DoxyCodeLine{01753\ \ \ \ \ ASYNC\_JOB\ *job;}
\DoxyCodeLine{01754\ \ \ \ \ ASYNC\_WAIT\_CTX\ *waitctx;}
\DoxyCodeLine{01755\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ asyncrw;}
\DoxyCodeLine{01756\ }
\DoxyCodeLine{01757\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01758\ \textcolor{comment}{\ \ \ \ \ *\ The\ maximum\ number\ of\ bytes\ advertised\ in\ session\ tickets\ that\ can\ be}}
\DoxyCodeLine{01759\ \textcolor{comment}{\ \ \ \ \ *\ sent\ as\ early\ data.}}
\DoxyCodeLine{01760\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01761\ \ \ \ \ uint32\_t\ max\_early\_data;}
\DoxyCodeLine{01762\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01763\ \textcolor{comment}{\ \ \ \ \ *\ The\ maximum\ number\ of\ bytes\ of\ early\ data\ that\ a\ server\ will\ tolerate}}
\DoxyCodeLine{01764\ \textcolor{comment}{\ \ \ \ \ *\ (which\ should\ be\ at\ least\ as\ much\ as\ max\_early\_data).}}
\DoxyCodeLine{01765\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01766\ \ \ \ \ uint32\_t\ recv\_max\_early\_data;}
\DoxyCodeLine{01767\ }
\DoxyCodeLine{01768\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01769\ \textcolor{comment}{\ \ \ \ \ *\ The\ number\ of\ bytes\ of\ early\ data\ received\ so\ far.\ If\ we\ accepted\ early}}
\DoxyCodeLine{01770\ \textcolor{comment}{\ \ \ \ \ *\ data\ then\ this\ is\ a\ count\ of\ the\ plaintext\ bytes.\ If\ we\ rejected\ it\ then}}
\DoxyCodeLine{01771\ \textcolor{comment}{\ \ \ \ \ *\ this\ is\ a\ count\ of\ the\ ciphertext\ bytes.}}
\DoxyCodeLine{01772\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01773\ \ \ \ \ uint32\_t\ early\_data\_count;}
\DoxyCodeLine{01774\ }
\DoxyCodeLine{01775\ \ \ \ \ \textcolor{comment}{/*\ The\ number\ of\ TLS1.3\ tickets\ to\ automatically\ send\ */}}
\DoxyCodeLine{01776\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ num\_tickets;}
\DoxyCodeLine{01777\ \ \ \ \ \textcolor{comment}{/*\ The\ number\ of\ TLS1.3\ tickets\ actually\ sent\ so\ far\ */}}
\DoxyCodeLine{01778\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ sent\_tickets;}
\DoxyCodeLine{01779\ \ \ \ \ \textcolor{comment}{/*\ The\ next\ nonce\ value\ to\ use\ when\ we\ send\ a\ ticket\ on\ this\ connection\ */}}
\DoxyCodeLine{01780\ \ \ \ \ uint64\_t\ next\_ticket\_nonce;}
\DoxyCodeLine{01781\ }
\DoxyCodeLine{01782\ \ \ \ \ \textcolor{comment}{/*\ Callback\ to\ determine\ if\ early\_data\ is\ acceptable\ or\ not\ */}}
\DoxyCodeLine{01783\ \ \ \ \ SSL\_allow\_early\_data\_cb\_fn\ allow\_early\_data\_cb;}
\DoxyCodeLine{01784\ \ \ \ \ \textcolor{keywordtype}{void}\ *allow\_early\_data\_cb\_data;}
\DoxyCodeLine{01785\ }
\DoxyCodeLine{01786\ \ \ \ \ \textcolor{comment}{/*\ Callback\ for\ SSL\ async\ handling\ */}}
\DoxyCodeLine{01787\ \ \ \ \ SSL\_async\_callback\_fn\ async\_cb;}
\DoxyCodeLine{01788\ \ \ \ \ \textcolor{keywordtype}{void}\ *async\_cb\_arg;}
\DoxyCodeLine{01789\ }
\DoxyCodeLine{01790\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01791\ \textcolor{comment}{\ \ \ \ \ *\ Signature\ algorithms\ shared\ by\ client\ and\ server:\ cached\ because\ these}}
\DoxyCodeLine{01792\ \textcolor{comment}{\ \ \ \ \ *\ are\ used\ most\ often.}}
\DoxyCodeLine{01793\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01794\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structsigalg__lookup__st}{sigalg\_lookup\_st}}\ **shared\_sigalgs;}
\DoxyCodeLine{01795\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ shared\_sigalgslen;}
\DoxyCodeLine{01796\ }
\DoxyCodeLine{01797\ \textcolor{preprocessor}{\#ifndef\ OPENSSL\_NO\_COMP\_ALG}}
\DoxyCodeLine{01798\ \ \ \ \ \textcolor{comment}{/*\ certificate\ compression\ preferences\ */}}
\DoxyCodeLine{01799\ \ \ \ \ \textcolor{keywordtype}{int}\ cert\_comp\_prefs[TLSEXT\_comp\_cert\_limit];}
\DoxyCodeLine{01800\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01801\ }
\DoxyCodeLine{01802\ \ \ \ \ \textcolor{comment}{/*\ Certificate\ Type\ stuff\ -\/\ for\ RPK\ vs\ X.509\ */}}
\DoxyCodeLine{01803\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *client\_cert\_type;}
\DoxyCodeLine{01804\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ client\_cert\_type\_len;}
\DoxyCodeLine{01805\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *server\_cert\_type;}
\DoxyCodeLine{01806\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ server\_cert\_type\_len;}
\DoxyCodeLine{01807\ \};}
\DoxyCodeLine{01808\ }
\DoxyCodeLine{01809\ \textcolor{preprocessor}{\#\ define\ SSL\_CONNECTION\_FROM\_SSL\_ONLY\_int(ssl,\ c)\ \(\backslash\)}}
\DoxyCodeLine{01810\ \textcolor{preprocessor}{\ \ \ \ ((ssl)\ ==\ NULL\ ?\ NULL\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01811\ \textcolor{preprocessor}{\ \ \ \ \ :\ ((ssl)-\/>type\ ==\ SSL\_TYPE\_SSL\_CONNECTION\ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01812\ \textcolor{preprocessor}{\ \ \ \ \ \ \ ?\ (c\ SSL\_CONNECTION\ *)(ssl)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01813\ \textcolor{preprocessor}{\ \ \ \ \ \ \ :\ NULL))}}
\DoxyCodeLine{01814\ \textcolor{preprocessor}{\#\ define\ SSL\_CONNECTION\_NO\_CONST}}
\DoxyCodeLine{01815\ \textcolor{preprocessor}{\#\ define\ SSL\_CONNECTION\_FROM\_SSL\_ONLY(ssl)\ \(\backslash\)}}
\DoxyCodeLine{01816\ \textcolor{preprocessor}{\ \ \ \ SSL\_CONNECTION\_FROM\_SSL\_ONLY\_int(ssl,\ SSL\_CONNECTION\_NO\_CONST)}}
\DoxyCodeLine{01817\ \textcolor{preprocessor}{\#\ define\ SSL\_CONNECTION\_FROM\_CONST\_SSL\_ONLY(ssl)\ \(\backslash\)}}
\DoxyCodeLine{01818\ \textcolor{preprocessor}{\ \ \ \ SSL\_CONNECTION\_FROM\_SSL\_ONLY\_int(ssl,\ const)}}
\DoxyCodeLine{01819\ \textcolor{preprocessor}{\#\ define\ SSL\_CONNECTION\_GET\_CTX(sc)\ ((sc)-\/>ssl.ctx)}}
\DoxyCodeLine{01820\ \textcolor{preprocessor}{\#\ define\ SSL\_CONNECTION\_GET\_SSL(sc)\ (\&(sc)-\/>ssl)}}
\DoxyCodeLine{01821\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_QUIC}}
\DoxyCodeLine{01822\ \textcolor{preprocessor}{\#\ \ include\ "{}quic/quic\_local.h"{}}}
\DoxyCodeLine{01823\ \textcolor{preprocessor}{\#\ \ define\ SSL\_CONNECTION\_FROM\_SSL\_int(ssl,\ c)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01824\ \textcolor{preprocessor}{\ \ \ \ ((ssl)\ ==\ NULL\ ?\ NULL\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01825\ \textcolor{preprocessor}{\ \ \ \ \ :\ ((ssl)-\/>type\ ==\ SSL\_TYPE\_SSL\_CONNECTION\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01826\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ ?\ (c\ SSL\_CONNECTION\ *)(ssl)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01827\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ :\ ((ssl)-\/>type\ ==\ SSL\_TYPE\_QUIC\_CONNECTION\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{01828\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ ?\ (c\ SSL\_CONNECTION\ *)((c\ QUIC\_CONNECTION\ *)(ssl))-\/>tls\ \(\backslash\)}}
\DoxyCodeLine{01829\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ :\ NULL)))}}
\DoxyCodeLine{01830\ \textcolor{preprocessor}{\#\ \ define\ SSL\_CONNECTION\_FROM\_SSL(ssl)\ \(\backslash\)}}
\DoxyCodeLine{01831\ \textcolor{preprocessor}{\ \ \ \ SSL\_CONNECTION\_FROM\_SSL\_int(ssl,\ SSL\_CONNECTION\_NO\_CONST)}}
\DoxyCodeLine{01832\ \textcolor{preprocessor}{\#\ \ define\ SSL\_CONNECTION\_FROM\_CONST\_SSL(ssl)\ \(\backslash\)}}
\DoxyCodeLine{01833\ \textcolor{preprocessor}{\ \ \ \ SSL\_CONNECTION\_FROM\_SSL\_int(ssl,\ const)}}
\DoxyCodeLine{01834\ \textcolor{preprocessor}{\#\ else}}
\DoxyCodeLine{01835\ \textcolor{preprocessor}{\#\ \ define\ SSL\_CONNECTION\_FROM\_SSL(ssl)\ \(\backslash\)}}
\DoxyCodeLine{01836\ \textcolor{preprocessor}{\ \ \ \ SSL\_CONNECTION\_FROM\_SSL\_ONLY\_int(ssl,\ SSL\_CONNECTION\_NO\_CONST)}}
\DoxyCodeLine{01837\ \textcolor{preprocessor}{\#\ \ define\ SSL\_CONNECTION\_FROM\_CONST\_SSL(ssl)\ \(\backslash\)}}
\DoxyCodeLine{01838\ \textcolor{preprocessor}{\ \ \ \ SSL\_CONNECTION\_FROM\_SSL\_ONLY\_int(ssl,\ const)}}
\DoxyCodeLine{01839\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{01840\ }
\DoxyCodeLine{01841\ \textcolor{comment}{/*}}
\DoxyCodeLine{01842\ \textcolor{comment}{\ *\ Structure\ containing\ table\ entry\ of\ values\ associated\ with\ the\ signature}}
\DoxyCodeLine{01843\ \textcolor{comment}{\ *\ algorithms\ (signature\ scheme)\ extension}}
\DoxyCodeLine{01844\ \textcolor{comment}{*/}}
\DoxyCodeLine{01845\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structsigalg__lookup__st}{sigalg\_lookup\_st}}\ \{}
\DoxyCodeLine{01846\ \ \ \ \ \textcolor{comment}{/*\ TLS\ 1.3\ signature\ scheme\ name\ */}}
\DoxyCodeLine{01847\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *name;}
\DoxyCodeLine{01848\ \ \ \ \ \textcolor{comment}{/*\ Raw\ value\ used\ in\ extension\ */}}
\DoxyCodeLine{01849\ \ \ \ \ uint16\_t\ sigalg;}
\DoxyCodeLine{01850\ \ \ \ \ \textcolor{comment}{/*\ NID\ of\ hash\ algorithm\ or\ NID\_undef\ if\ no\ hash\ */}}
\DoxyCodeLine{01851\ \ \ \ \ \textcolor{keywordtype}{int}\ hash;}
\DoxyCodeLine{01852\ \ \ \ \ \textcolor{comment}{/*\ Index\ of\ hash\ algorithm\ or\ -\/1\ if\ no\ hash\ algorithm\ */}}
\DoxyCodeLine{01853\ \ \ \ \ \textcolor{keywordtype}{int}\ hash\_idx;}
\DoxyCodeLine{01854\ \ \ \ \ \textcolor{comment}{/*\ NID\ of\ signature\ algorithm\ */}}
\DoxyCodeLine{01855\ \ \ \ \ \textcolor{keywordtype}{int}\ sig;}
\DoxyCodeLine{01856\ \ \ \ \ \textcolor{comment}{/*\ Index\ of\ signature\ algorithm\ */}}
\DoxyCodeLine{01857\ \ \ \ \ \textcolor{keywordtype}{int}\ sig\_idx;}
\DoxyCodeLine{01858\ \ \ \ \ \textcolor{comment}{/*\ Combined\ hash\ and\ signature\ NID,\ if\ any\ */}}
\DoxyCodeLine{01859\ \ \ \ \ \textcolor{keywordtype}{int}\ sigandhash;}
\DoxyCodeLine{01860\ \ \ \ \ \textcolor{comment}{/*\ Required\ public\ key\ curve\ (ECDSA\ only)\ */}}
\DoxyCodeLine{01861\ \ \ \ \ \textcolor{keywordtype}{int}\ curve;}
\DoxyCodeLine{01862\ \ \ \ \ \textcolor{comment}{/*\ Whether\ this\ signature\ algorithm\ is\ actually\ available\ for\ use\ */}}
\DoxyCodeLine{01863\ \ \ \ \ \textcolor{keywordtype}{int}\ enabled;}
\DoxyCodeLine{01864\ \}\ \mbox{\hyperlink{structsigalg__lookup__st}{SIGALG\_LOOKUP}};}
\DoxyCodeLine{01865\ }
\DoxyCodeLine{01866\ \textcolor{comment}{/*\ DTLS\ structures\ */}}
\DoxyCodeLine{01867\ }
\DoxyCodeLine{01868\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_SCTP}}
\DoxyCodeLine{01869\ \textcolor{preprocessor}{\#\ \ define\ DTLS1\_SCTP\_AUTH\_LABEL\ \ \ "{}EXPORTER\_DTLS\_OVER\_SCTP"{}}}
\DoxyCodeLine{01870\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{01871\ }
\DoxyCodeLine{01872\ \textcolor{comment}{/*\ Max\ MTU\ overhead\ we\ know\ about\ so\ far\ is\ 40\ for\ IPv6\ +\ 8\ for\ UDP\ */}}
\DoxyCodeLine{01873\ \textcolor{preprocessor}{\#\ define\ DTLS1\_MAX\_MTU\_OVERHEAD\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 48}}
\DoxyCodeLine{01874\ }
\DoxyCodeLine{01875\ \textcolor{comment}{/*}}
\DoxyCodeLine{01876\ \textcolor{comment}{\ *\ Flag\ used\ in\ message\ reuse\ to\ indicate\ the\ buffer\ contains\ the\ record}}
\DoxyCodeLine{01877\ \textcolor{comment}{\ *\ header\ as\ well\ as\ the\ handshake\ message\ header.}}
\DoxyCodeLine{01878\ \textcolor{comment}{\ */}}
\DoxyCodeLine{01879\ \textcolor{preprocessor}{\#\ define\ DTLS1\_SKIP\_RECORD\_HEADER\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 2}}
\DoxyCodeLine{01880\ }
\DoxyCodeLine{01881\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structdtls1__retransmit__state}{dtls1\_retransmit\_state}}\ \{}
\DoxyCodeLine{01882\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structossl__record__method__st}{OSSL\_RECORD\_METHOD}}\ *wrlmethod;}
\DoxyCodeLine{01883\ \ \ \ \ \mbox{\hyperlink{structossl__record__layer__st}{OSSL\_RECORD\_LAYER}}\ *wrl;}
\DoxyCodeLine{01884\ \};}
\DoxyCodeLine{01885\ }
\DoxyCodeLine{01886\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structhm__header__st}{hm\_header\_st}}\ \{}
\DoxyCodeLine{01887\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ type;}
\DoxyCodeLine{01888\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ msg\_len;}
\DoxyCodeLine{01889\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ seq;}
\DoxyCodeLine{01890\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ frag\_off;}
\DoxyCodeLine{01891\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ frag\_len;}
\DoxyCodeLine{01892\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ is\_ccs;}
\DoxyCodeLine{01893\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structdtls1__retransmit__state}{dtls1\_retransmit\_state}}\ saved\_retransmit\_state;}
\DoxyCodeLine{01894\ \};}
\DoxyCodeLine{01895\ }
\DoxyCodeLine{01896\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structhm__fragment__st}{hm\_fragment\_st}}\ \{}
\DoxyCodeLine{01897\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structhm__header__st}{hm\_header\_st}}\ msg\_header;}
\DoxyCodeLine{01898\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *fragment;}
\DoxyCodeLine{01899\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *reassembly;}
\DoxyCodeLine{01900\ \}\ \mbox{\hyperlink{structhm__fragment__st}{hm\_fragment}};}
\DoxyCodeLine{01901\ }
\DoxyCodeLine{01902\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structpqueue__st}{pqueue\_st}}\ \mbox{\hyperlink{structpqueue__st}{pqueue}};}
\DoxyCodeLine{01903\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structpitem__st}{pitem\_st}}\ \mbox{\hyperlink{structpitem__st}{pitem}};}
\DoxyCodeLine{01904\ }
\DoxyCodeLine{01905\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structpitem__st}{pitem\_st}}\ \{}
\DoxyCodeLine{01906\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ priority[8];\ \ \textcolor{comment}{/*\ 64-\/bit\ value\ in\ big-\/endian\ encoding\ */}}
\DoxyCodeLine{01907\ \ \ \ \ \textcolor{keywordtype}{void}\ *data;}
\DoxyCodeLine{01908\ \ \ \ \ \mbox{\hyperlink{structpitem__st}{pitem}}\ *next;}
\DoxyCodeLine{01909\ \};}
\DoxyCodeLine{01910\ }
\DoxyCodeLine{01911\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structpitem__st}{pitem\_st}}\ *\mbox{\hyperlink{structpitem__st}{piterator}};}
\DoxyCodeLine{01912\ }
\DoxyCodeLine{01913\ \mbox{\hyperlink{structpitem__st}{pitem}}\ *pitem\_new(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *prio64be,\ \textcolor{keywordtype}{void}\ *data);}
\DoxyCodeLine{01914\ \textcolor{keywordtype}{void}\ pitem\_free(\mbox{\hyperlink{structpitem__st}{pitem}}\ *item);}
\DoxyCodeLine{01915\ \mbox{\hyperlink{structpqueue__st}{pqueue}}\ *pqueue\_new(\textcolor{keywordtype}{void});}
\DoxyCodeLine{01916\ \textcolor{keywordtype}{void}\ pqueue\_free(\mbox{\hyperlink{structpqueue__st}{pqueue}}\ *pq);}
\DoxyCodeLine{01917\ \mbox{\hyperlink{structpitem__st}{pitem}}\ *pqueue\_insert(\mbox{\hyperlink{structpqueue__st}{pqueue}}\ *pq,\ \mbox{\hyperlink{structpitem__st}{pitem}}\ *item);}
\DoxyCodeLine{01918\ \mbox{\hyperlink{structpitem__st}{pitem}}\ *pqueue\_peek(\mbox{\hyperlink{structpqueue__st}{pqueue}}\ *pq);}
\DoxyCodeLine{01919\ \mbox{\hyperlink{structpitem__st}{pitem}}\ *pqueue\_pop(\mbox{\hyperlink{structpqueue__st}{pqueue}}\ *pq);}
\DoxyCodeLine{01920\ \mbox{\hyperlink{structpitem__st}{pitem}}\ *pqueue\_find(\mbox{\hyperlink{structpqueue__st}{pqueue}}\ *pq,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *prio64be);}
\DoxyCodeLine{01921\ \mbox{\hyperlink{structpitem__st}{pitem}}\ *pqueue\_iterator(\mbox{\hyperlink{structpqueue__st}{pqueue}}\ *pq);}
\DoxyCodeLine{01922\ \mbox{\hyperlink{structpitem__st}{pitem}}\ *pqueue\_next(\mbox{\hyperlink{structpitem__st}{piterator}}\ *iter);}
\DoxyCodeLine{01923\ \textcolor{keywordtype}{size\_t}\ pqueue\_size(\mbox{\hyperlink{structpqueue__st}{pqueue}}\ *pq);}
\DoxyCodeLine{01924\ }
\DoxyCodeLine{01925\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structdtls1__state__st}{dtls1\_state\_st}}\ \{}
\DoxyCodeLine{01926\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ cookie[DTLS1\_COOKIE\_LENGTH];}
\DoxyCodeLine{01927\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ cookie\_len;}
\DoxyCodeLine{01928\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ cookie\_verified;}
\DoxyCodeLine{01929\ \ \ \ \ \textcolor{comment}{/*\ handshake\ message\ numbers\ */}}
\DoxyCodeLine{01930\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ handshake\_write\_seq;}
\DoxyCodeLine{01931\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ next\_handshake\_write\_seq;}
\DoxyCodeLine{01932\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ handshake\_read\_seq;}
\DoxyCodeLine{01933\ \ \ \ \ \textcolor{comment}{/*\ Buffered\ handshake\ messages\ */}}
\DoxyCodeLine{01934\ \ \ \ \ \mbox{\hyperlink{structpqueue__st}{pqueue}}\ *buffered\_messages;}
\DoxyCodeLine{01935\ \ \ \ \ \textcolor{comment}{/*\ Buffered\ (sent)\ handshake\ records\ */}}
\DoxyCodeLine{01936\ \ \ \ \ \mbox{\hyperlink{structpqueue__st}{pqueue}}\ *sent\_messages;}
\DoxyCodeLine{01937\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ link\_mtu;\ \ \ \ \ \ \textcolor{comment}{/*\ max\ on-\/the-\/wire\ DTLS\ packet\ size\ */}}
\DoxyCodeLine{01938\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ mtu;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ max\ DTLS\ packet\ size\ */}}
\DoxyCodeLine{01939\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structhm__header__st}{hm\_header\_st}}\ w\_msg\_hdr;}
\DoxyCodeLine{01940\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structhm__header__st}{hm\_header\_st}}\ r\_msg\_hdr;}
\DoxyCodeLine{01941\ \ \ \ \ \textcolor{comment}{/*\ Number\ of\ alerts\ received\ so\ far\ */}}
\DoxyCodeLine{01942\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ timeout\_num\_alerts;}
\DoxyCodeLine{01943\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01944\ \textcolor{comment}{\ \ \ \ \ *\ Indicates\ when\ the\ last\ handshake\ msg\ sent\ will\ timeout}}
\DoxyCodeLine{01945\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01946\ \ \ \ \ \mbox{\hyperlink{struct_o_s_s_l___t_i_m_e}{OSSL\_TIME}}\ next\_timeout;}
\DoxyCodeLine{01947\ \ \ \ \ \textcolor{comment}{/*\ Timeout\ duration\ */}}
\DoxyCodeLine{01948\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ timeout\_duration\_us;}
\DoxyCodeLine{01949\ }
\DoxyCodeLine{01950\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ retransmitting;}
\DoxyCodeLine{01951\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_SCTP}}
\DoxyCodeLine{01952\ \ \ \ \ \textcolor{keywordtype}{int}\ shutdown\_received;}
\DoxyCodeLine{01953\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{01954\ }
\DoxyCodeLine{01955\ \ \ \ \ DTLS\_timer\_cb\ timer\_cb;}
\DoxyCodeLine{01956\ }
\DoxyCodeLine{01957\ \}\ \mbox{\hyperlink{structdtls1__state__st}{DTLS1\_STATE}};}
\DoxyCodeLine{01958\ }
\DoxyCodeLine{01959\ \textcolor{comment}{/*}}
\DoxyCodeLine{01960\ \textcolor{comment}{\ *\ From\ ECC-\/TLS\ draft,\ used\ in\ encoding\ the\ curve\ type\ in\ ECParameters}}
\DoxyCodeLine{01961\ \textcolor{comment}{\ */}}
\DoxyCodeLine{01962\ \textcolor{preprocessor}{\#\ \ define\ EXPLICIT\_PRIME\_CURVE\_TYPE\ \ 1}}
\DoxyCodeLine{01963\ \textcolor{preprocessor}{\#\ \ define\ EXPLICIT\_CHAR2\_CURVE\_TYPE\ \ 2}}
\DoxyCodeLine{01964\ \textcolor{preprocessor}{\#\ \ define\ NAMED\_CURVE\_TYPE\ \ \ \ \ \ \ \ \ \ \ 3}}
\DoxyCodeLine{01965\ }
\DoxyCodeLine{01966\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_COMP\_ALG}}
\DoxyCodeLine{01967\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structossl__comp__cert__st}{ossl\_comp\_cert\_st}}\ \{}
\DoxyCodeLine{01968\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *data;}
\DoxyCodeLine{01969\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ len;}
\DoxyCodeLine{01970\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ orig\_len;}
\DoxyCodeLine{01971\ \ \ \ \ \mbox{\hyperlink{struct_c_r_y_p_t_o___r_e_f___c_o_u_n_t}{CRYPTO\_REF\_COUNT}}\ references;}
\DoxyCodeLine{01972\ \ \ \ \ \textcolor{keywordtype}{int}\ alg;}
\DoxyCodeLine{01973\ \};}
\DoxyCodeLine{01974\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structossl__comp__cert__st}{ossl\_comp\_cert\_st}}\ \mbox{\hyperlink{structossl__comp__cert__st}{OSSL\_COMP\_CERT}};}
\DoxyCodeLine{01975\ }
\DoxyCodeLine{01976\ \textcolor{keywordtype}{void}\ OSSL\_COMP\_CERT\_free(\mbox{\hyperlink{structossl__comp__cert__st}{OSSL\_COMP\_CERT}}\ *c);}
\DoxyCodeLine{01977\ \textcolor{keywordtype}{int}\ OSSL\_COMP\_CERT\_up\_ref(\mbox{\hyperlink{structossl__comp__cert__st}{OSSL\_COMP\_CERT}}\ *c);}
\DoxyCodeLine{01978\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{01979\ }
\DoxyCodeLine{01980\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structcert__pkey__st}{cert\_pkey\_st}}\ \{}
\DoxyCodeLine{01981\ \ \ \ \ X509\ *x509;}
\DoxyCodeLine{01982\ \ \ \ \ EVP\_PKEY\ *privatekey;}
\DoxyCodeLine{01983\ \ \ \ \ \textcolor{comment}{/*\ Chain\ for\ this\ certificate\ */}}
\DoxyCodeLine{01984\ \ \ \ \ STACK\_OF(X509)\ *chain;}
\DoxyCodeLine{01985\ \ \ \ \ \textcolor{comment}{/*-\/}}
\DoxyCodeLine{01986\ \textcolor{comment}{\ \ \ \ \ *\ serverinfo\ data\ for\ this\ certificate.\ \ The\ data\ is\ in\ TLS\ Extension}}
\DoxyCodeLine{01987\ \textcolor{comment}{\ \ \ \ \ *\ wire\ format,\ specifically\ it's\ a\ series\ of\ records\ like:}}
\DoxyCodeLine{01988\ \textcolor{comment}{\ \ \ \ \ *\ \ \ uint16\_t\ extension\_type;\ //\ (RFC\ 5246,\ 7.4.1.4,\ Extension)}}
\DoxyCodeLine{01989\ \textcolor{comment}{\ \ \ \ \ *\ \ \ uint16\_t\ length;}}
\DoxyCodeLine{01990\ \textcolor{comment}{\ \ \ \ \ *\ \ \ uint8\_t\ data[length];}}
\DoxyCodeLine{01991\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01992\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *serverinfo;}
\DoxyCodeLine{01993\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ serverinfo\_length;}
\DoxyCodeLine{01994\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_COMP\_ALG}}
\DoxyCodeLine{01995\ \ \ \ \ \textcolor{comment}{/*\ Compressed\ certificate\ data\ -\/\ index\ 0\ is\ unused\ */}}
\DoxyCodeLine{01996\ \ \ \ \ \mbox{\hyperlink{structossl__comp__cert__st}{OSSL\_COMP\_CERT}}\ *comp\_cert[TLSEXT\_comp\_cert\_limit];}
\DoxyCodeLine{01997\ \ \ \ \ \textcolor{keywordtype}{int}\ cert\_comp\_used;}
\DoxyCodeLine{01998\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{01999\ \};}
\DoxyCodeLine{02000\ \textcolor{comment}{/*\ Retrieve\ Suite\ B\ flags\ */}}
\DoxyCodeLine{02001\ \textcolor{preprocessor}{\#\ define\ tls1\_suiteb(s)\ \ (s-\/>cert-\/>cert\_flags\ \&\ SSL\_CERT\_FLAG\_SUITEB\_128\_LOS)}}
\DoxyCodeLine{02002\ \textcolor{comment}{/*\ Uses\ to\ check\ strict\ mode:\ suite\ B\ modes\ are\ always\ strict\ */}}
\DoxyCodeLine{02003\ \textcolor{preprocessor}{\#\ define\ SSL\_CERT\_FLAGS\_CHECK\_TLS\_STRICT\ \(\backslash\)}}
\DoxyCodeLine{02004\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ (SSL\_CERT\_FLAG\_SUITEB\_128\_LOS|SSL\_CERT\_FLAG\_TLS\_STRICT)}}
\DoxyCodeLine{02005\ }
\DoxyCodeLine{02006\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{02007\ \ \ \ \ ENDPOINT\_CLIENT\ =\ 0,}
\DoxyCodeLine{02008\ \ \ \ \ ENDPOINT\_SERVER,}
\DoxyCodeLine{02009\ \ \ \ \ ENDPOINT\_BOTH}
\DoxyCodeLine{02010\ \}\ ENDPOINT;}
\DoxyCodeLine{02011\ }
\DoxyCodeLine{02012\ }
\DoxyCodeLine{02013\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{02014\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ ext\_type;}
\DoxyCodeLine{02015\ \ \ \ \ ENDPOINT\ role;}
\DoxyCodeLine{02016\ \ \ \ \ \textcolor{comment}{/*\ The\ context\ which\ this\ extension\ applies\ to\ */}}
\DoxyCodeLine{02017\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ context;}
\DoxyCodeLine{02018\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{02019\ \textcolor{comment}{\ \ \ \ \ *\ Per-\/connection\ flags\ relating\ to\ this\ extension\ type:\ not\ used\ if}}
\DoxyCodeLine{02020\ \textcolor{comment}{\ \ \ \ \ *\ part\ of\ an\ SSL\_CTX\ structure.}}
\DoxyCodeLine{02021\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{02022\ \ \ \ \ uint32\_t\ ext\_flags;}
\DoxyCodeLine{02023\ \ \ \ \ SSL\_custom\_ext\_add\_cb\_ex\ add\_cb;}
\DoxyCodeLine{02024\ \ \ \ \ SSL\_custom\_ext\_free\_cb\_ex\ free\_cb;}
\DoxyCodeLine{02025\ \ \ \ \ \textcolor{keywordtype}{void}\ *add\_arg;}
\DoxyCodeLine{02026\ \ \ \ \ SSL\_custom\_ext\_parse\_cb\_ex\ parse\_cb;}
\DoxyCodeLine{02027\ \ \ \ \ \textcolor{keywordtype}{void}\ *parse\_arg;}
\DoxyCodeLine{02028\ \}\ \mbox{\hyperlink{structcustom__ext__method}{custom\_ext\_method}};}
\DoxyCodeLine{02029\ }
\DoxyCodeLine{02030\ \textcolor{comment}{/*\ ext\_flags\ values\ */}}
\DoxyCodeLine{02031\ }
\DoxyCodeLine{02032\ \textcolor{comment}{/*}}
\DoxyCodeLine{02033\ \textcolor{comment}{\ *\ Indicates\ an\ extension\ has\ been\ received.\ Used\ to\ check\ for\ unsolicited\ or}}
\DoxyCodeLine{02034\ \textcolor{comment}{\ *\ duplicate\ extensions.}}
\DoxyCodeLine{02035\ \textcolor{comment}{\ */}}
\DoxyCodeLine{02036\ \textcolor{preprocessor}{\#\ define\ SSL\_EXT\_FLAG\_RECEIVED\ \ \ 0x1}}
\DoxyCodeLine{02037\ \textcolor{comment}{/*}}
\DoxyCodeLine{02038\ \textcolor{comment}{\ *\ Indicates\ an\ extension\ has\ been\ sent:\ used\ to\ enable\ sending\ of}}
\DoxyCodeLine{02039\ \textcolor{comment}{\ *\ corresponding\ ServerHello\ extension.}}
\DoxyCodeLine{02040\ \textcolor{comment}{\ */}}
\DoxyCodeLine{02041\ \textcolor{preprocessor}{\#\ define\ SSL\_EXT\_FLAG\_SENT\ \ \ \ \ \ \ 0x2}}
\DoxyCodeLine{02042\ }
\DoxyCodeLine{02043\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{02044\ \ \ \ \ \mbox{\hyperlink{structcustom__ext__method}{custom\_ext\_method}}\ *meths;}
\DoxyCodeLine{02045\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ meths\_count;}
\DoxyCodeLine{02046\ \}\ \mbox{\hyperlink{structcustom__ext__methods}{custom\_ext\_methods}};}
\DoxyCodeLine{02047\ }
\DoxyCodeLine{02048\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structcert__st}{cert\_st}}\ \{}
\DoxyCodeLine{02049\ \ \ \ \ \textcolor{comment}{/*\ Current\ active\ set\ */}}
\DoxyCodeLine{02050\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{02051\ \textcolor{comment}{\ \ \ \ \ *\ ALWAYS\ points\ to\ an\ element\ of\ the\ pkeys\ array}}
\DoxyCodeLine{02052\ \textcolor{comment}{\ \ \ \ \ *\ Probably\ it\ would\ make\ more\ sense\ to\ store}}
\DoxyCodeLine{02053\ \textcolor{comment}{\ \ \ \ \ *\ an\ index,\ not\ a\ pointer.}}
\DoxyCodeLine{02054\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{02055\ \ \ \ \ \mbox{\hyperlink{structcert__pkey__st}{CERT\_PKEY}}\ *key;}
\DoxyCodeLine{02056\ }
\DoxyCodeLine{02057\ \ \ \ \ EVP\_PKEY\ *dh\_tmp;}
\DoxyCodeLine{02058\ \ \ \ \ DH\ *(*dh\_tmp\_cb)\ (SSL\ *ssl,\ \textcolor{keywordtype}{int}\ is\_export,\ \textcolor{keywordtype}{int}\ keysize);}
\DoxyCodeLine{02059\ \ \ \ \ \textcolor{keywordtype}{int}\ dh\_tmp\_auto;}
\DoxyCodeLine{02060\ \ \ \ \ \textcolor{comment}{/*\ Flags\ related\ to\ certificates\ */}}
\DoxyCodeLine{02061\ \ \ \ \ uint32\_t\ cert\_flags;}
\DoxyCodeLine{02062\ \ \ \ \ \mbox{\hyperlink{structcert__pkey__st}{CERT\_PKEY}}\ *pkeys;}
\DoxyCodeLine{02063\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ ssl\_pkey\_num;}
\DoxyCodeLine{02064\ \ \ \ \ \textcolor{comment}{/*\ Custom\ certificate\ types\ sent\ in\ certificate\ request\ message.\ */}}
\DoxyCodeLine{02065\ \ \ \ \ uint8\_t\ *ctype;}
\DoxyCodeLine{02066\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ ctype\_len;}
\DoxyCodeLine{02067\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{02068\ \textcolor{comment}{\ \ \ \ \ *\ supported\ signature\ algorithms.\ When\ set\ on\ a\ client\ this\ is\ sent\ in}}
\DoxyCodeLine{02069\ \textcolor{comment}{\ \ \ \ \ *\ the\ client\ hello\ as\ the\ supported\ signature\ algorithms\ extension.\ For}}
\DoxyCodeLine{02070\ \textcolor{comment}{\ \ \ \ \ *\ servers\ it\ represents\ the\ signature\ algorithms\ we\ are\ willing\ to\ use.}}
\DoxyCodeLine{02071\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{02072\ \ \ \ \ uint16\_t\ *conf\_sigalgs;}
\DoxyCodeLine{02073\ \ \ \ \ \textcolor{comment}{/*\ Size\ of\ above\ array\ */}}
\DoxyCodeLine{02074\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ conf\_sigalgslen;}
\DoxyCodeLine{02075\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{02076\ \textcolor{comment}{\ \ \ \ \ *\ Client\ authentication\ signature\ algorithms,\ if\ not\ set\ then\ uses}}
\DoxyCodeLine{02077\ \textcolor{comment}{\ \ \ \ \ *\ conf\_sigalgs.\ On\ servers\ these\ will\ be\ the\ signature\ algorithms\ sent}}
\DoxyCodeLine{02078\ \textcolor{comment}{\ \ \ \ \ *\ to\ the\ client\ in\ a\ certificate\ request\ for\ TLS\ 1.2.\ On\ a\ client\ this}}
\DoxyCodeLine{02079\ \textcolor{comment}{\ \ \ \ \ *\ represents\ the\ signature\ algorithms\ we\ are\ willing\ to\ use\ for\ client}}
\DoxyCodeLine{02080\ \textcolor{comment}{\ \ \ \ \ *\ authentication.}}
\DoxyCodeLine{02081\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{02082\ \ \ \ \ uint16\_t\ *client\_sigalgs;}
\DoxyCodeLine{02083\ \ \ \ \ \textcolor{comment}{/*\ Size\ of\ above\ array\ */}}
\DoxyCodeLine{02084\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ client\_sigalgslen;}
\DoxyCodeLine{02085\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{02086\ \textcolor{comment}{\ \ \ \ \ *\ Certificate\ setup\ callback:\ if\ set\ is\ called\ whenever\ a\ certificate}}
\DoxyCodeLine{02087\ \textcolor{comment}{\ \ \ \ \ *\ may\ be\ required\ (client\ or\ server).\ the\ callback\ can\ then\ examine\ any}}
\DoxyCodeLine{02088\ \textcolor{comment}{\ \ \ \ \ *\ appropriate\ parameters\ and\ setup\ any\ certificates\ required.\ This}}
\DoxyCodeLine{02089\ \textcolor{comment}{\ \ \ \ \ *\ allows\ advanced\ applications\ to\ select\ certificates\ on\ the\ fly:\ for}}
\DoxyCodeLine{02090\ \textcolor{comment}{\ \ \ \ \ *\ example\ based\ on\ supported\ signature\ algorithms\ or\ curves.}}
\DoxyCodeLine{02091\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{02092\ \ \ \ \ int\ (*cert\_cb)\ (SSL\ *ssl,\ \textcolor{keywordtype}{void}\ *arg);}
\DoxyCodeLine{02093\ \ \ \ \ \textcolor{keywordtype}{void}\ *cert\_cb\_arg;}
\DoxyCodeLine{02094\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{02095\ \textcolor{comment}{\ \ \ \ \ *\ Optional\ X509\_STORE\ for\ chain\ building\ or\ certificate\ validation\ If}}
\DoxyCodeLine{02096\ \textcolor{comment}{\ \ \ \ \ *\ NULL\ the\ parent\ SSL\_CTX\ store\ is\ used\ instead.}}
\DoxyCodeLine{02097\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{02098\ \ \ \ \ X509\_STORE\ *chain\_store;}
\DoxyCodeLine{02099\ \ \ \ \ X509\_STORE\ *verify\_store;}
\DoxyCodeLine{02100\ \ \ \ \ \textcolor{comment}{/*\ Custom\ extensions\ */}}
\DoxyCodeLine{02101\ \ \ \ \ \mbox{\hyperlink{structcustom__ext__methods}{custom\_ext\_methods}}\ custext;}
\DoxyCodeLine{02102\ \ \ \ \ \textcolor{comment}{/*\ Security\ callback\ */}}
\DoxyCodeLine{02103\ \ \ \ \ int\ (*sec\_cb)\ (\textcolor{keyword}{const}\ SSL\ *s,\ \textcolor{keyword}{const}\ SSL\_CTX\ *ctx,\ \textcolor{keywordtype}{int}\ op,\ \textcolor{keywordtype}{int}\ bits,\ \textcolor{keywordtype}{int}\ nid,}
\DoxyCodeLine{02104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *other,\ \textcolor{keywordtype}{void}\ *ex);}
\DoxyCodeLine{02105\ \ \ \ \ \textcolor{comment}{/*\ Security\ level\ */}}
\DoxyCodeLine{02106\ \ \ \ \ \textcolor{keywordtype}{int}\ sec\_level;}
\DoxyCodeLine{02107\ \ \ \ \ \textcolor{keywordtype}{void}\ *sec\_ex;}
\DoxyCodeLine{02108\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_NO\_PSK}}
\DoxyCodeLine{02109\ \ \ \ \ \textcolor{comment}{/*\ If\ not\ NULL\ psk\ identity\ hint\ to\ use\ for\ servers\ */}}
\DoxyCodeLine{02110\ \ \ \ \ \textcolor{keywordtype}{char}\ *psk\_identity\_hint;}
\DoxyCodeLine{02111\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{02112\ \ \ \ \ \mbox{\hyperlink{struct_c_r_y_p_t_o___r_e_f___c_o_u_n_t}{CRYPTO\_REF\_COUNT}}\ references;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ >1\ only\ if\ SSL\_copy\_session\_id\ is\ used\ */}}
\DoxyCodeLine{02113\ \}\ \mbox{\hyperlink{structcert__st}{CERT}};}
\DoxyCodeLine{02114\ }
\DoxyCodeLine{02115\ \textcolor{preprocessor}{\#\ define\ FP\_ICC\ \ (int\ (*)(const\ void\ *,const\ void\ *))}}
\DoxyCodeLine{02116\ }
\DoxyCodeLine{02117\ \textcolor{comment}{/*}}
\DoxyCodeLine{02118\ \textcolor{comment}{\ *\ This\ is\ for\ the\ SSLv3/TLSv1.0\ differences\ in\ crypto/hash\ stuff\ It\ is\ a\ bit}}
\DoxyCodeLine{02119\ \textcolor{comment}{\ *\ of\ a\ mess\ of\ functions,\ but\ hell,\ think\ of\ it\ as\ an\ opaque\ structure\ :-\/)}}
\DoxyCodeLine{02120\ \textcolor{comment}{\ */}}
\DoxyCodeLine{02121\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structssl3__enc__method}{ssl3\_enc\_method}}\ \{}
\DoxyCodeLine{02122\ \ \ \ \ int\ (*setup\_key\_block)\ (\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *);}
\DoxyCodeLine{02123\ \ \ \ \ int\ (*generate\_master\_secret)\ (\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *,}
\DoxyCodeLine{02124\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *,\ size\_t,\ \textcolor{keywordtype}{size\_t}\ *);}
\DoxyCodeLine{02125\ \ \ \ \ int\ (*change\_cipher\_state)\ (\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *,\ int);}
\DoxyCodeLine{02126\ \ \ \ \ size\_t\ (*final\_finish\_mac)\ (\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *,\ size\_t,}
\DoxyCodeLine{02127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *);}
\DoxyCodeLine{02128\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *client\_finished\_label;}
\DoxyCodeLine{02129\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ client\_finished\_label\_len;}
\DoxyCodeLine{02130\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *server\_finished\_label;}
\DoxyCodeLine{02131\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ server\_finished\_label\_len;}
\DoxyCodeLine{02132\ \ \ \ \ int\ (*alert\_value)\ (int);}
\DoxyCodeLine{02133\ \ \ \ \ int\ (*export\_keying\_material)\ (\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *,\ size\_t,}
\DoxyCodeLine{02134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *,\ size\_t,}
\DoxyCodeLine{02135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *,\ size\_t,}
\DoxyCodeLine{02136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ use\_context);}
\DoxyCodeLine{02137\ \ \ \ \ \textcolor{comment}{/*\ Various\ flags\ indicating\ protocol\ version\ requirements\ */}}
\DoxyCodeLine{02138\ \ \ \ \ uint32\_t\ enc\_flags;}
\DoxyCodeLine{02139\ \ \ \ \ \textcolor{comment}{/*\ Set\ the\ handshake\ header\ */}}
\DoxyCodeLine{02140\ \ \ \ \ int\ (*set\_handshake\_header)\ (\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \mbox{\hyperlink{structwpacket__st}{WPACKET}}\ *pkt,\ \textcolor{keywordtype}{int}\ type);}
\DoxyCodeLine{02141\ \ \ \ \ \textcolor{comment}{/*\ Close\ construction\ of\ the\ handshake\ message\ */}}
\DoxyCodeLine{02142\ \ \ \ \ int\ (*close\_construct\_packet)\ (\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \mbox{\hyperlink{structwpacket__st}{WPACKET}}\ *pkt,\ \textcolor{keywordtype}{int}\ htype);}
\DoxyCodeLine{02143\ \ \ \ \ \textcolor{comment}{/*\ Write\ out\ handshake\ message\ */}}
\DoxyCodeLine{02144\ \ \ \ \ int\ (*do\_write)\ (\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02145\ \}\ \mbox{\hyperlink{structssl3__enc__method}{SSL3\_ENC\_METHOD}};}
\DoxyCodeLine{02146\ }
\DoxyCodeLine{02147\ \textcolor{preprocessor}{\#\ define\ ssl\_set\_handshake\_header(s,\ pkt,\ htype)\ \(\backslash\)}}
\DoxyCodeLine{02148\ \textcolor{preprocessor}{\ \ \ \ SSL\_CONNECTION\_GET\_SSL(s)-\/>method-\/>ssl3\_enc-\/>set\_handshake\_header((s),\ (pkt),\ (htype))}}
\DoxyCodeLine{02149\ \textcolor{preprocessor}{\#\ define\ ssl\_close\_construct\_packet(s,\ pkt,\ htype)\ \(\backslash\)}}
\DoxyCodeLine{02150\ \textcolor{preprocessor}{\ \ \ \ SSL\_CONNECTION\_GET\_SSL(s)-\/>method-\/>ssl3\_enc-\/>close\_construct\_packet((s),\ (pkt),\ (htype))}}
\DoxyCodeLine{02151\ \textcolor{preprocessor}{\#\ define\ ssl\_do\_write(s)\ \ SSL\_CONNECTION\_GET\_SSL(s)-\/>method-\/>ssl3\_enc-\/>do\_write(s)}}
\DoxyCodeLine{02152\ }
\DoxyCodeLine{02153\ \textcolor{comment}{/*\ Values\ for\ enc\_flags\ */}}
\DoxyCodeLine{02154\ }
\DoxyCodeLine{02155\ \textcolor{comment}{/*\ Uses\ explicit\ IV\ for\ CBC\ mode\ */}}
\DoxyCodeLine{02156\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_FLAG\_EXPLICIT\_IV\ \ \ \ \ \ \ \ 0x1}}
\DoxyCodeLine{02157\ \textcolor{comment}{/*\ Uses\ signature\ algorithms\ extension\ */}}
\DoxyCodeLine{02158\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_FLAG\_SIGALGS\ \ \ \ \ \ \ \ \ \ \ \ 0x2}}
\DoxyCodeLine{02159\ \textcolor{comment}{/*\ Uses\ SHA256\ default\ PRF\ */}}
\DoxyCodeLine{02160\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_FLAG\_SHA256\_PRF\ \ \ \ \ \ \ \ \ 0x4}}
\DoxyCodeLine{02161\ \textcolor{comment}{/*\ Is\ DTLS\ */}}
\DoxyCodeLine{02162\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_FLAG\_DTLS\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x8}}
\DoxyCodeLine{02163\ \textcolor{comment}{/*}}
\DoxyCodeLine{02164\ \textcolor{comment}{\ *\ Allow\ TLS\ 1.2\ ciphersuites:\ applies\ to\ DTLS\ 1.2\ as\ well\ as\ TLS\ 1.2:\ may}}
\DoxyCodeLine{02165\ \textcolor{comment}{\ *\ apply\ to\ others\ in\ future.}}
\DoxyCodeLine{02166\ \textcolor{comment}{\ */}}
\DoxyCodeLine{02167\ \textcolor{preprocessor}{\#\ define\ SSL\_ENC\_FLAG\_TLS1\_2\_CIPHERS\ \ \ \ \ 0x10}}
\DoxyCodeLine{02168\ }
\DoxyCodeLine{02169\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{enum}\ downgrade\_en\ \{}
\DoxyCodeLine{02170\ \ \ \ \ DOWNGRADE\_NONE,}
\DoxyCodeLine{02171\ \ \ \ \ DOWNGRADE\_TO\_1\_2,}
\DoxyCodeLine{02172\ \ \ \ \ DOWNGRADE\_TO\_1\_1}
\DoxyCodeLine{02173\ \}\ DOWNGRADE;}
\DoxyCodeLine{02174\ }
\DoxyCodeLine{02175\ \textcolor{comment}{/*}}
\DoxyCodeLine{02176\ \textcolor{comment}{\ *\ Dummy\ status\ type\ for\ the\ status\_type\ extension.\ Indicates\ no\ status\ type}}
\DoxyCodeLine{02177\ \textcolor{comment}{\ *\ set}}
\DoxyCodeLine{02178\ \textcolor{comment}{\ */}}
\DoxyCodeLine{02179\ \textcolor{preprocessor}{\#define\ TLSEXT\_STATUSTYPE\_nothing\ \ -\/1}}
\DoxyCodeLine{02180\ }
\DoxyCodeLine{02181\ \textcolor{comment}{/*\ Sigalgs\ values\ */}}
\DoxyCodeLine{02182\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_ecdsa\_secp256r1\_sha256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0403}}
\DoxyCodeLine{02183\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_ecdsa\_secp384r1\_sha384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0503}}
\DoxyCodeLine{02184\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_ecdsa\_secp521r1\_sha512\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0603}}
\DoxyCodeLine{02185\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_ecdsa\_sha224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0303}}
\DoxyCodeLine{02186\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_ecdsa\_sha1\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0203}}
\DoxyCodeLine{02187\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_rsa\_pss\_rsae\_sha256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0804}}
\DoxyCodeLine{02188\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_rsa\_pss\_rsae\_sha384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0805}}
\DoxyCodeLine{02189\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_rsa\_pss\_rsae\_sha512\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0806}}
\DoxyCodeLine{02190\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_rsa\_pss\_pss\_sha256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0809}}
\DoxyCodeLine{02191\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_rsa\_pss\_pss\_sha384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x080a}}
\DoxyCodeLine{02192\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_rsa\_pss\_pss\_sha512\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x080b}}
\DoxyCodeLine{02193\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_rsa\_pkcs1\_sha256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0401}}
\DoxyCodeLine{02194\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_rsa\_pkcs1\_sha384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0501}}
\DoxyCodeLine{02195\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_rsa\_pkcs1\_sha512\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0601}}
\DoxyCodeLine{02196\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_rsa\_pkcs1\_sha224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0301}}
\DoxyCodeLine{02197\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_rsa\_pkcs1\_sha1\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0201}}
\DoxyCodeLine{02198\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_dsa\_sha256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0402}}
\DoxyCodeLine{02199\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_dsa\_sha384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0502}}
\DoxyCodeLine{02200\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_dsa\_sha512\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0602}}
\DoxyCodeLine{02201\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_dsa\_sha224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0302}}
\DoxyCodeLine{02202\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_dsa\_sha1\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0202}}
\DoxyCodeLine{02203\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_gostr34102012\_256\_intrinsic\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0840}}
\DoxyCodeLine{02204\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_gostr34102012\_512\_intrinsic\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0841}}
\DoxyCodeLine{02205\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_gostr34102012\_256\_gostr34112012\_256\ \ \ \ \ \ \ 0xeeee}}
\DoxyCodeLine{02206\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_gostr34102012\_512\_gostr34112012\_512\ \ \ \ \ \ \ 0xefef}}
\DoxyCodeLine{02207\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_gostr34102001\_gostr3411\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0xeded}}
\DoxyCodeLine{02208\ }
\DoxyCodeLine{02209\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_ed25519\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0807}}
\DoxyCodeLine{02210\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_ed448\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0808}}
\DoxyCodeLine{02211\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_ecdsa\_brainpoolP256r1\_sha256\ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x081a}}
\DoxyCodeLine{02212\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_ecdsa\_brainpoolP384r1\_sha384\ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x081b}}
\DoxyCodeLine{02213\ \textcolor{preprocessor}{\#define\ TLSEXT\_SIGALG\_ecdsa\_brainpoolP512r1\_sha512\ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x081c}}
\DoxyCodeLine{02214\ }
\DoxyCodeLine{02215\ \textcolor{comment}{/*\ Known\ PSK\ key\ exchange\ modes\ */}}
\DoxyCodeLine{02216\ \textcolor{preprocessor}{\#define\ TLSEXT\_KEX\_MODE\_KE\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00}}
\DoxyCodeLine{02217\ \textcolor{preprocessor}{\#define\ TLSEXT\_KEX\_MODE\_KE\_DHE\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x01}}
\DoxyCodeLine{02218\ }
\DoxyCodeLine{02219\ \textcolor{comment}{/*}}
\DoxyCodeLine{02220\ \textcolor{comment}{\ *\ Internal\ representations\ of\ key\ exchange\ modes}}
\DoxyCodeLine{02221\ \textcolor{comment}{\ */}}
\DoxyCodeLine{02222\ \textcolor{preprocessor}{\#define\ TLSEXT\_KEX\_MODE\_FLAG\_NONE\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0}}
\DoxyCodeLine{02223\ \textcolor{preprocessor}{\#define\ TLSEXT\_KEX\_MODE\_FLAG\_KE\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1}}
\DoxyCodeLine{02224\ \textcolor{preprocessor}{\#define\ TLSEXT\_KEX\_MODE\_FLAG\_KE\_DHE\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 2}}
\DoxyCodeLine{02225\ }
\DoxyCodeLine{02226\ \textcolor{preprocessor}{\#define\ SSL\_USE\_PSS(s)\ (s-\/>s3.tmp.peer\_sigalg\ !=\ NULL\ \&\&\ \(\backslash\)}}
\DoxyCodeLine{02227\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s-\/>s3.tmp.peer\_sigalg-\/>sig\ ==\ EVP\_PKEY\_RSA\_PSS)}}
\DoxyCodeLine{02228\ }
\DoxyCodeLine{02229\ \textcolor{comment}{/*\ A\ dummy\ signature\ value\ not\ valid\ for\ TLSv1.2\ signature\ algs\ */}}
\DoxyCodeLine{02230\ \textcolor{preprocessor}{\#define\ TLSEXT\_signature\_rsa\_pss\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0101}}
\DoxyCodeLine{02231\ }
\DoxyCodeLine{02232\ \textcolor{comment}{/*\ TLSv1.3\ downgrade\ protection\ sentinel\ values\ */}}
\DoxyCodeLine{02233\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tls11downgrade[8];}
\DoxyCodeLine{02234\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tls12downgrade[8];}
\DoxyCodeLine{02235\ }
\DoxyCodeLine{02236\ \textcolor{keyword}{extern}\ \mbox{\hyperlink{structssl3__enc__method}{SSL3\_ENC\_METHOD}}\ ssl3\_undef\_enc\_method;}
\DoxyCodeLine{02237\ }
\DoxyCodeLine{02238\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_METHOD\ *ssl\_bad\_method(\textcolor{keywordtype}{int}\ ver);}
\DoxyCodeLine{02239\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_METHOD\ *sslv3\_method(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02240\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_METHOD\ *sslv3\_server\_method(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02241\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_METHOD\ *sslv3\_client\_method(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02242\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_METHOD\ *tlsv1\_method(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02243\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_METHOD\ *tlsv1\_server\_method(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02244\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_METHOD\ *tlsv1\_client\_method(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02245\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_METHOD\ *tlsv1\_1\_method(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02246\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_METHOD\ *tlsv1\_1\_server\_method(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02247\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_METHOD\ *tlsv1\_1\_client\_method(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02248\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_METHOD\ *tlsv1\_2\_method(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02249\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_METHOD\ *tlsv1\_2\_server\_method(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02250\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_METHOD\ *tlsv1\_2\_client\_method(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02251\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_METHOD\ *tlsv1\_3\_method(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02252\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_METHOD\ *tlsv1\_3\_server\_method(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02253\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_METHOD\ *tlsv1\_3\_client\_method(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02254\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_METHOD\ *dtlsv1\_method(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02255\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_METHOD\ *dtlsv1\_server\_method(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02256\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_METHOD\ *dtlsv1\_client\_method(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02257\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_METHOD\ *dtls\_bad\_ver\_client\_method(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02258\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_METHOD\ *dtlsv1\_2\_method(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02259\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_METHOD\ *dtlsv1\_2\_server\_method(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02260\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_METHOD\ *dtlsv1\_2\_client\_method(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02261\ }
\DoxyCodeLine{02262\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structssl3__enc__method}{SSL3\_ENC\_METHOD}}\ TLSv1\_enc\_data;}
\DoxyCodeLine{02263\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structssl3__enc__method}{SSL3\_ENC\_METHOD}}\ TLSv1\_1\_enc\_data;}
\DoxyCodeLine{02264\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structssl3__enc__method}{SSL3\_ENC\_METHOD}}\ TLSv1\_2\_enc\_data;}
\DoxyCodeLine{02265\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structssl3__enc__method}{SSL3\_ENC\_METHOD}}\ TLSv1\_3\_enc\_data;}
\DoxyCodeLine{02266\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structssl3__enc__method}{SSL3\_ENC\_METHOD}}\ SSLv3\_enc\_data;}
\DoxyCodeLine{02267\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structssl3__enc__method}{SSL3\_ENC\_METHOD}}\ DTLSv1\_enc\_data;}
\DoxyCodeLine{02268\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structssl3__enc__method}{SSL3\_ENC\_METHOD}}\ DTLSv1\_2\_enc\_data;}
\DoxyCodeLine{02269\ }
\DoxyCodeLine{02270\ \textcolor{comment}{/*}}
\DoxyCodeLine{02271\ \textcolor{comment}{\ *\ Flags\ for\ SSL\ methods}}
\DoxyCodeLine{02272\ \textcolor{comment}{\ */}}
\DoxyCodeLine{02273\ \textcolor{preprocessor}{\#\ define\ SSL\_METHOD\_NO\_FIPS\ \ \ \ \ \ (1U<<0)}}
\DoxyCodeLine{02274\ \textcolor{preprocessor}{\#\ define\ SSL\_METHOD\_NO\_SUITEB\ \ \ \ (1U<<1)}}
\DoxyCodeLine{02275\ }
\DoxyCodeLine{02276\ \textcolor{preprocessor}{\#\ define\ IMPLEMENT\_tls\_meth\_func(version,\ flags,\ mask,\ func\_name,\ s\_accept,\ \(\backslash\)}}
\DoxyCodeLine{02277\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s\_connect,\ enc\_data)\ \(\backslash\)}}
\DoxyCodeLine{02278\ \textcolor{preprocessor}{const\ SSL\_METHOD\ *func\_name(void)\ \ \(\backslash\)}}
\DoxyCodeLine{02279\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \{\ \(\backslash\)}}
\DoxyCodeLine{02280\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ static\ const\ SSL\_METHOD\ func\_name\#\#\_data=\ \{\ \(\backslash\)}}
\DoxyCodeLine{02281\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ version,\ \(\backslash\)}}
\DoxyCodeLine{02282\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ flags,\ \(\backslash\)}}
\DoxyCodeLine{02283\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mask,\ \(\backslash\)}}
\DoxyCodeLine{02284\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ossl\_ssl\_connection\_new,\ \(\backslash\)}}
\DoxyCodeLine{02285\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ossl\_ssl\_connection\_free,\ \(\backslash\)}}
\DoxyCodeLine{02286\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ossl\_ssl\_connection\_reset,\ \(\backslash\)}}
\DoxyCodeLine{02287\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tls1\_new,\ \(\backslash\)}}
\DoxyCodeLine{02288\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tls1\_clear,\ \(\backslash\)}}
\DoxyCodeLine{02289\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tls1\_free,\ \(\backslash\)}}
\DoxyCodeLine{02290\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s\_accept,\ \(\backslash\)}}
\DoxyCodeLine{02291\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s\_connect,\ \(\backslash\)}}
\DoxyCodeLine{02292\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_read,\ \(\backslash\)}}
\DoxyCodeLine{02293\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_peek,\ \(\backslash\)}}
\DoxyCodeLine{02294\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_write,\ \(\backslash\)}}
\DoxyCodeLine{02295\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_shutdown,\ \(\backslash\)}}
\DoxyCodeLine{02296\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_renegotiate,\ \(\backslash\)}}
\DoxyCodeLine{02297\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_renegotiate\_check,\ \(\backslash\)}}
\DoxyCodeLine{02298\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_read\_bytes,\ \(\backslash\)}}
\DoxyCodeLine{02299\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_write\_bytes,\ \(\backslash\)}}
\DoxyCodeLine{02300\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_dispatch\_alert,\ \(\backslash\)}}
\DoxyCodeLine{02301\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_ctrl,\ \(\backslash\)}}
\DoxyCodeLine{02302\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_ctx\_ctrl,\ \(\backslash\)}}
\DoxyCodeLine{02303\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_get\_cipher\_by\_char,\ \(\backslash\)}}
\DoxyCodeLine{02304\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_put\_cipher\_by\_char,\ \(\backslash\)}}
\DoxyCodeLine{02305\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_pending,\ \(\backslash\)}}
\DoxyCodeLine{02306\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_num\_ciphers,\ \(\backslash\)}}
\DoxyCodeLine{02307\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_get\_cipher,\ \(\backslash\)}}
\DoxyCodeLine{02308\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tls1\_default\_timeout,\ \(\backslash\)}}
\DoxyCodeLine{02309\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&enc\_data,\ \(\backslash\)}}
\DoxyCodeLine{02310\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl\_undefined\_void\_function,\ \(\backslash\)}}
\DoxyCodeLine{02311\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_callback\_ctrl,\ \(\backslash\)}}
\DoxyCodeLine{02312\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_ctx\_callback\_ctrl,\ \(\backslash\)}}
\DoxyCodeLine{02313\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \};\ \(\backslash\)}}
\DoxyCodeLine{02314\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ return\ \&func\_name\#\#\_data;\ \(\backslash\)}}
\DoxyCodeLine{02315\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{02316\ }
\DoxyCodeLine{02317\ \textcolor{preprocessor}{\#\ define\ IMPLEMENT\_ssl3\_meth\_func(func\_name,\ s\_accept,\ s\_connect)\ \(\backslash\)}}
\DoxyCodeLine{02318\ \textcolor{preprocessor}{const\ SSL\_METHOD\ *func\_name(void)\ \ \(\backslash\)}}
\DoxyCodeLine{02319\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \{\ \(\backslash\)}}
\DoxyCodeLine{02320\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ static\ const\ SSL\_METHOD\ func\_name\#\#\_data=\ \{\ \(\backslash\)}}
\DoxyCodeLine{02321\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SSL3\_VERSION,\ \(\backslash\)}}
\DoxyCodeLine{02322\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SSL\_METHOD\_NO\_FIPS\ |\ SSL\_METHOD\_NO\_SUITEB,\ \(\backslash\)}}
\DoxyCodeLine{02323\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SSL\_OP\_NO\_SSLv3,\ \(\backslash\)}}
\DoxyCodeLine{02324\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ossl\_ssl\_connection\_new,\ \(\backslash\)}}
\DoxyCodeLine{02325\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ossl\_ssl\_connection\_free,\ \(\backslash\)}}
\DoxyCodeLine{02326\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ossl\_ssl\_connection\_reset,\ \(\backslash\)}}
\DoxyCodeLine{02327\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_new,\ \(\backslash\)}}
\DoxyCodeLine{02328\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_clear,\ \(\backslash\)}}
\DoxyCodeLine{02329\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_free,\ \(\backslash\)}}
\DoxyCodeLine{02330\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s\_accept,\ \(\backslash\)}}
\DoxyCodeLine{02331\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s\_connect,\ \(\backslash\)}}
\DoxyCodeLine{02332\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_read,\ \(\backslash\)}}
\DoxyCodeLine{02333\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_peek,\ \(\backslash\)}}
\DoxyCodeLine{02334\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_write,\ \(\backslash\)}}
\DoxyCodeLine{02335\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_shutdown,\ \(\backslash\)}}
\DoxyCodeLine{02336\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_renegotiate,\ \(\backslash\)}}
\DoxyCodeLine{02337\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_renegotiate\_check,\ \(\backslash\)}}
\DoxyCodeLine{02338\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_read\_bytes,\ \(\backslash\)}}
\DoxyCodeLine{02339\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_write\_bytes,\ \(\backslash\)}}
\DoxyCodeLine{02340\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_dispatch\_alert,\ \(\backslash\)}}
\DoxyCodeLine{02341\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_ctrl,\ \(\backslash\)}}
\DoxyCodeLine{02342\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_ctx\_ctrl,\ \(\backslash\)}}
\DoxyCodeLine{02343\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_get\_cipher\_by\_char,\ \(\backslash\)}}
\DoxyCodeLine{02344\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_put\_cipher\_by\_char,\ \(\backslash\)}}
\DoxyCodeLine{02345\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_pending,\ \(\backslash\)}}
\DoxyCodeLine{02346\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_num\_ciphers,\ \(\backslash\)}}
\DoxyCodeLine{02347\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_get\_cipher,\ \(\backslash\)}}
\DoxyCodeLine{02348\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_default\_timeout,\ \(\backslash\)}}
\DoxyCodeLine{02349\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&SSLv3\_enc\_data,\ \(\backslash\)}}
\DoxyCodeLine{02350\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl\_undefined\_void\_function,\ \(\backslash\)}}
\DoxyCodeLine{02351\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_callback\_ctrl,\ \(\backslash\)}}
\DoxyCodeLine{02352\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_ctx\_callback\_ctrl,\ \(\backslash\)}}
\DoxyCodeLine{02353\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \};\ \(\backslash\)}}
\DoxyCodeLine{02354\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ return\ \&func\_name\#\#\_data;\ \(\backslash\)}}
\DoxyCodeLine{02355\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{02356\ }
\DoxyCodeLine{02357\ \textcolor{preprocessor}{\#\ define\ IMPLEMENT\_dtls1\_meth\_func(version,\ flags,\ mask,\ func\_name,\ s\_accept,\ \(\backslash\)}}
\DoxyCodeLine{02358\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s\_connect,\ enc\_data)\ \(\backslash\)}}
\DoxyCodeLine{02359\ \textcolor{preprocessor}{const\ SSL\_METHOD\ *func\_name(void)\ \ \(\backslash\)}}
\DoxyCodeLine{02360\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \{\ \(\backslash\)}}
\DoxyCodeLine{02361\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ static\ const\ SSL\_METHOD\ func\_name\#\#\_data=\ \{\ \(\backslash\)}}
\DoxyCodeLine{02362\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ version,\ \(\backslash\)}}
\DoxyCodeLine{02363\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ flags,\ \(\backslash\)}}
\DoxyCodeLine{02364\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mask,\ \(\backslash\)}}
\DoxyCodeLine{02365\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ossl\_ssl\_connection\_new,\ \(\backslash\)}}
\DoxyCodeLine{02366\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ossl\_ssl\_connection\_free,\ \(\backslash\)}}
\DoxyCodeLine{02367\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ossl\_ssl\_connection\_reset,\ \(\backslash\)}}
\DoxyCodeLine{02368\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dtls1\_new,\ \(\backslash\)}}
\DoxyCodeLine{02369\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dtls1\_clear,\ \(\backslash\)}}
\DoxyCodeLine{02370\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dtls1\_free,\ \(\backslash\)}}
\DoxyCodeLine{02371\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s\_accept,\ \(\backslash\)}}
\DoxyCodeLine{02372\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s\_connect,\ \(\backslash\)}}
\DoxyCodeLine{02373\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_read,\ \(\backslash\)}}
\DoxyCodeLine{02374\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_peek,\ \(\backslash\)}}
\DoxyCodeLine{02375\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_write,\ \(\backslash\)}}
\DoxyCodeLine{02376\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dtls1\_shutdown,\ \(\backslash\)}}
\DoxyCodeLine{02377\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_renegotiate,\ \(\backslash\)}}
\DoxyCodeLine{02378\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_renegotiate\_check,\ \(\backslash\)}}
\DoxyCodeLine{02379\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dtls1\_read\_bytes,\ \(\backslash\)}}
\DoxyCodeLine{02380\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dtls1\_write\_app\_data\_bytes,\ \(\backslash\)}}
\DoxyCodeLine{02381\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dtls1\_dispatch\_alert,\ \(\backslash\)}}
\DoxyCodeLine{02382\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dtls1\_ctrl,\ \(\backslash\)}}
\DoxyCodeLine{02383\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_ctx\_ctrl,\ \(\backslash\)}}
\DoxyCodeLine{02384\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_get\_cipher\_by\_char,\ \(\backslash\)}}
\DoxyCodeLine{02385\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_put\_cipher\_by\_char,\ \(\backslash\)}}
\DoxyCodeLine{02386\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_pending,\ \(\backslash\)}}
\DoxyCodeLine{02387\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_num\_ciphers,\ \(\backslash\)}}
\DoxyCodeLine{02388\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_get\_cipher,\ \(\backslash\)}}
\DoxyCodeLine{02389\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dtls1\_default\_timeout,\ \(\backslash\)}}
\DoxyCodeLine{02390\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&enc\_data,\ \(\backslash\)}}
\DoxyCodeLine{02391\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl\_undefined\_void\_function,\ \(\backslash\)}}
\DoxyCodeLine{02392\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_callback\_ctrl,\ \(\backslash\)}}
\DoxyCodeLine{02393\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ssl3\_ctx\_callback\_ctrl,\ \(\backslash\)}}
\DoxyCodeLine{02394\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \};\ \(\backslash\)}}
\DoxyCodeLine{02395\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ return\ \&func\_name\#\#\_data;\ \(\backslash\)}}
\DoxyCodeLine{02396\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{02397\ }
\DoxyCodeLine{02398\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structopenssl__ssl__test__functions}{openssl\_ssl\_test\_functions}}\ \{}
\DoxyCodeLine{02399\ \ \ \ \ int\ (*p\_ssl\_init\_wbio\_buffer)\ (\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02400\ \};}
\DoxyCodeLine{02401\ }
\DoxyCodeLine{02402\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *ssl\_protocol\_to\_string(\textcolor{keywordtype}{int}\ version);}
\DoxyCodeLine{02403\ }
\DoxyCodeLine{02404\ \textcolor{keyword}{static}\ ossl\_inline\ \textcolor{keywordtype}{int}\ tls12\_rpk\_and\_privkey(\textcolor{keyword}{const}\ \mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *sc,\ \textcolor{keywordtype}{int}\ idx)}
\DoxyCodeLine{02405\ \{}
\DoxyCodeLine{02406\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{02407\ \textcolor{comment}{\ \ \ \ \ *\ This\ is\ to\ check\ for\ special\ cases\ when\ using\ RPK\ with\ just}}
\DoxyCodeLine{02408\ \textcolor{comment}{\ \ \ \ \ *\ a\ private\ key,\ and\ NO\ CERTIFICATE}}
\DoxyCodeLine{02409\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{02410\ \ \ \ \ \textcolor{keywordflow}{return}\ ((sc-\/>server\ \&\&\ sc-\/>ext.server\_cert\_type\ ==\ TLSEXT\_cert\_type\_rpk)}
\DoxyCodeLine{02411\ \ \ \ \ \ \ \ \ \ \ \ \ ||\ (!sc-\/>server\ \&\&\ sc-\/>ext.client\_cert\_type\ ==\ TLSEXT\_cert\_type\_rpk))}
\DoxyCodeLine{02412\ \ \ \ \ \ \ \ \ \&\&\ sc-\/>cert-\/>pkeys[idx].privatekey\ !=\ NULL}
\DoxyCodeLine{02413\ \ \ \ \ \ \ \ \ \&\&\ sc-\/>cert-\/>pkeys[idx].x509\ ==\ NULL;}
\DoxyCodeLine{02414\ \}}
\DoxyCodeLine{02415\ }
\DoxyCodeLine{02416\ \textcolor{keyword}{static}\ ossl\_inline\ \textcolor{keywordtype}{int}\ ssl\_has\_cert\_type(\textcolor{keyword}{const}\ \mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *sc,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ ct)}
\DoxyCodeLine{02417\ \{}
\DoxyCodeLine{02418\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *ptr;}
\DoxyCodeLine{02419\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ len;}
\DoxyCodeLine{02420\ }
\DoxyCodeLine{02421\ \ \ \ \ \textcolor{keywordflow}{if}\ (sc-\/>server)\ \{}
\DoxyCodeLine{02422\ \ \ \ \ \ \ \ \ ptr\ =\ sc-\/>server\_cert\_type;}
\DoxyCodeLine{02423\ \ \ \ \ \ \ \ \ len\ =\ sc-\/>server\_cert\_type\_len;}
\DoxyCodeLine{02424\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02425\ \ \ \ \ \ \ \ \ ptr\ =\ sc-\/>client\_cert\_type;}
\DoxyCodeLine{02426\ \ \ \ \ \ \ \ \ len\ =\ sc-\/>client\_cert\_type\_len;}
\DoxyCodeLine{02427\ \ \ \ \ \}}
\DoxyCodeLine{02428\ }
\DoxyCodeLine{02429\ \ \ \ \ \textcolor{keywordflow}{if}\ (ptr\ ==\ NULL)}
\DoxyCodeLine{02430\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{02431\ }
\DoxyCodeLine{02432\ \ \ \ \ \textcolor{keywordflow}{return}\ memchr(ptr,\ ct,\ len)\ !=\ NULL;}
\DoxyCodeLine{02433\ \}}
\DoxyCodeLine{02434\ }
\DoxyCodeLine{02435\ \textcolor{comment}{/*\ Returns\ true\ if\ certificate\ and\ private\ key\ for\ 'idx'\ are\ present\ */}}
\DoxyCodeLine{02436\ \textcolor{keyword}{static}\ ossl\_inline\ \textcolor{keywordtype}{int}\ ssl\_has\_cert(\textcolor{keyword}{const}\ \mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{int}\ idx)}
\DoxyCodeLine{02437\ \{}
\DoxyCodeLine{02438\ \ \ \ \ \textcolor{keywordflow}{if}\ (idx\ <\ 0\ ||\ idx\ >=\ (\textcolor{keywordtype}{int})s-\/>ssl\_pkey\_num)}
\DoxyCodeLine{02439\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{02440\ }
\DoxyCodeLine{02441\ \ \ \ \ \textcolor{comment}{/*\ If\ RPK\ is\ enabled\ for\ this\ SSL...\ only\ require\ private\ key\ */}}
\DoxyCodeLine{02442\ \ \ \ \ \textcolor{keywordflow}{if}\ (ssl\_has\_cert\_type(s,\ TLSEXT\_cert\_type\_rpk))}
\DoxyCodeLine{02443\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ s-\/>cert-\/>pkeys[idx].privatekey\ !=\ NULL;}
\DoxyCodeLine{02444\ }
\DoxyCodeLine{02445\ \ \ \ \ \textcolor{keywordflow}{return}\ s-\/>cert-\/>pkeys[idx].x509\ !=\ NULL}
\DoxyCodeLine{02446\ \ \ \ \ \ \ \ \ \&\&\ s-\/>cert-\/>pkeys[idx].privatekey\ !=\ NULL;}
\DoxyCodeLine{02447\ \}}
\DoxyCodeLine{02448\ }
\DoxyCodeLine{02449\ \textcolor{keyword}{static}\ ossl\_inline\ \textcolor{keywordtype}{void}\ tls1\_get\_peer\_groups(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,}
\DoxyCodeLine{02450\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint16\_t\ **pgroups,}
\DoxyCodeLine{02451\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ *pgroupslen)}
\DoxyCodeLine{02452\ \{}
\DoxyCodeLine{02453\ \ \ \ \ *pgroups\ =\ s-\/>ext.peer\_supportedgroups;}
\DoxyCodeLine{02454\ \ \ \ \ *pgroupslen\ =\ s-\/>ext.peer\_supportedgroups\_len;}
\DoxyCodeLine{02455\ \}}
\DoxyCodeLine{02456\ }
\DoxyCodeLine{02457\ \textcolor{preprocessor}{\#\ ifndef\ OPENSSL\_UNIT\_TEST}}
\DoxyCodeLine{02458\ }
\DoxyCodeLine{02459\ \_\_owur\ \textcolor{keywordtype}{int}\ ossl\_ssl\_init(SSL\ *ssl,\ SSL\_CTX\ *ctx,\ \textcolor{keyword}{const}\ SSL\_METHOD\ *method,}
\DoxyCodeLine{02460\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ type);}
\DoxyCodeLine{02461\ \_\_owur\ SSL\ *ossl\_ssl\_connection\_new\_int(SSL\_CTX\ *ctx,\ \textcolor{keyword}{const}\ SSL\_METHOD\ *method);}
\DoxyCodeLine{02462\ \_\_owur\ SSL\ *ossl\_ssl\_connection\_new(SSL\_CTX\ *ctx);}
\DoxyCodeLine{02463\ \textcolor{keywordtype}{void}\ ossl\_ssl\_connection\_free(SSL\ *ssl);}
\DoxyCodeLine{02464\ \_\_owur\ \textcolor{keywordtype}{int}\ ossl\_ssl\_connection\_reset(SSL\ *ssl);}
\DoxyCodeLine{02465\ }
\DoxyCodeLine{02466\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_read\_internal(SSL\ *s,\ \textcolor{keywordtype}{void}\ *buf,\ \textcolor{keywordtype}{size\_t}\ num,\ \textcolor{keywordtype}{size\_t}\ *readbytes);}
\DoxyCodeLine{02467\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_write\_internal(SSL\ *s,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *buf,\ \textcolor{keywordtype}{size\_t}\ num,\ \textcolor{keywordtype}{size\_t}\ *written);}
\DoxyCodeLine{02468\ \textcolor{keywordtype}{int}\ ssl\_clear\_bad\_session(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02469\ \_\_owur\ \mbox{\hyperlink{structcert__st}{CERT}}\ *ssl\_cert\_new(\textcolor{keywordtype}{size\_t}\ ssl\_pkey\_num);}
\DoxyCodeLine{02470\ \_\_owur\ \mbox{\hyperlink{structcert__st}{CERT}}\ *ssl\_cert\_dup(\mbox{\hyperlink{structcert__st}{CERT}}\ *cert);}
\DoxyCodeLine{02471\ \textcolor{keywordtype}{void}\ ssl\_cert\_clear\_certs(\mbox{\hyperlink{structcert__st}{CERT}}\ *c);}
\DoxyCodeLine{02472\ \textcolor{keywordtype}{void}\ ssl\_cert\_free(\mbox{\hyperlink{structcert__st}{CERT}}\ *c);}
\DoxyCodeLine{02473\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_generate\_session\_id(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ SSL\_SESSION\ *ss);}
\DoxyCodeLine{02474\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_get\_new\_session(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{int}\ session);}
\DoxyCodeLine{02475\ \_\_owur\ SSL\_SESSION\ *lookup\_sess\_in\_cache(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,}
\DoxyCodeLine{02476\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *sess\_id,}
\DoxyCodeLine{02477\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ sess\_id\_len);}
\DoxyCodeLine{02478\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_get\_prev\_session(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \mbox{\hyperlink{struct_c_l_i_e_n_t_h_e_l_l_o___m_s_g}{CLIENTHELLO\_MSG}}\ *hello);}
\DoxyCodeLine{02479\ \_\_owur\ SSL\_SESSION\ *ssl\_session\_dup(\textcolor{keyword}{const}\ SSL\_SESSION\ *src,\ \textcolor{keywordtype}{int}\ ticket);}
\DoxyCodeLine{02480\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_cipher\_id\_cmp(\textcolor{keyword}{const}\ SSL\_CIPHER\ *a,\ \textcolor{keyword}{const}\ SSL\_CIPHER\ *\mbox{\hyperlink{structb}{b}});}
\DoxyCodeLine{02481\ DECLARE\_OBJ\_BSEARCH\_GLOBAL\_CMP\_FN(SSL\_CIPHER,\ SSL\_CIPHER,\ ssl\_cipher\_id);}
\DoxyCodeLine{02482\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_cipher\_ptr\_id\_cmp(\textcolor{keyword}{const}\ SSL\_CIPHER\ *\textcolor{keyword}{const}\ *ap,}
\DoxyCodeLine{02483\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ SSL\_CIPHER\ *\textcolor{keyword}{const}\ *bp);}
\DoxyCodeLine{02484\ \_\_owur\ STACK\_OF(SSL\_CIPHER)\ *ssl\_create\_cipher\_list(SSL\_CTX\ *ctx,}
\DoxyCodeLine{02485\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STACK\_OF(SSL\_CIPHER)\ *tls13\_ciphersuites,}
\DoxyCodeLine{02486\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STACK\_OF(SSL\_CIPHER)\ **cipher\_list,}
\DoxyCodeLine{02487\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STACK\_OF(SSL\_CIPHER)\ **cipher\_list\_by\_id,}
\DoxyCodeLine{02488\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *rule\_str,}
\DoxyCodeLine{02489\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structcert__st}{CERT}}\ *c);}
\DoxyCodeLine{02490\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_cache\_cipherlist(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \mbox{\hyperlink{struct_p_a_c_k_e_t}{PACKET}}\ *cipher\_suites,}
\DoxyCodeLine{02491\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ sslv2format);}
\DoxyCodeLine{02492\ \_\_owur\ \textcolor{keywordtype}{int}\ ossl\_bytes\_to\_cipher\_list(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \mbox{\hyperlink{struct_p_a_c_k_e_t}{PACKET}}\ *cipher\_suites,}
\DoxyCodeLine{02493\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STACK\_OF(SSL\_CIPHER)\ **skp,}
\DoxyCodeLine{02494\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STACK\_OF(SSL\_CIPHER)\ **scsvs,\ \textcolor{keywordtype}{int}\ sslv2format,}
\DoxyCodeLine{02495\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ fatal);}
\DoxyCodeLine{02496\ \textcolor{keywordtype}{void}\ ssl\_update\_cache(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{int}\ mode);}
\DoxyCodeLine{02497\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_cipher\_get\_evp\_cipher(SSL\_CTX\ *ctx,\ \textcolor{keyword}{const}\ SSL\_CIPHER\ *sslc,}
\DoxyCodeLine{02498\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ EVP\_CIPHER\ **enc);}
\DoxyCodeLine{02499\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_cipher\_get\_evp(SSL\_CTX\ *ctxc,\ \textcolor{keyword}{const}\ SSL\_SESSION\ *s,}
\DoxyCodeLine{02500\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ EVP\_CIPHER\ **enc,\ \textcolor{keyword}{const}\ EVP\_MD\ **md,}
\DoxyCodeLine{02501\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *mac\_pkey\_type,\ \textcolor{keywordtype}{size\_t}\ *mac\_secret\_size,}
\DoxyCodeLine{02502\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SSL\_COMP\ **comp,\ \textcolor{keywordtype}{int}\ use\_etm);}
\DoxyCodeLine{02503\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_cipher\_get\_overhead(\textcolor{keyword}{const}\ SSL\_CIPHER\ *c,\ \textcolor{keywordtype}{size\_t}\ *mac\_overhead,}
\DoxyCodeLine{02504\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ *int\_overhead,\ \textcolor{keywordtype}{size\_t}\ *blocksize,}
\DoxyCodeLine{02505\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ *ext\_overhead);}
\DoxyCodeLine{02506\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_cert\_is\_disabled(SSL\_CTX\ *ctx,\ \textcolor{keywordtype}{size\_t}\ idx);}
\DoxyCodeLine{02507\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_CIPHER\ *ssl\_get\_cipher\_by\_char(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *ssl,}
\DoxyCodeLine{02508\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *ptr,}
\DoxyCodeLine{02509\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ all);}
\DoxyCodeLine{02510\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_cert\_set0\_chain(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ SSL\_CTX\ *ctx,}
\DoxyCodeLine{02511\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STACK\_OF(X509)\ *chain);}
\DoxyCodeLine{02512\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_cert\_set1\_chain(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ SSL\_CTX\ *ctx,}
\DoxyCodeLine{02513\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STACK\_OF(X509)\ *chain);}
\DoxyCodeLine{02514\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_cert\_add0\_chain\_cert(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ SSL\_CTX\ *ctx,\ X509\ *x);}
\DoxyCodeLine{02515\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_cert\_add1\_chain\_cert(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ SSL\_CTX\ *ctx,\ X509\ *x);}
\DoxyCodeLine{02516\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_cert\_select\_current(\mbox{\hyperlink{structcert__st}{CERT}}\ *c,\ X509\ *x);}
\DoxyCodeLine{02517\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_cert\_set\_current(\mbox{\hyperlink{structcert__st}{CERT}}\ *c,\ \textcolor{keywordtype}{long}\ arg);}
\DoxyCodeLine{02518\ \textcolor{keywordtype}{void}\ ssl\_cert\_set\_cert\_cb(\mbox{\hyperlink{structcert__st}{CERT}}\ *c,\ \textcolor{keywordtype}{int}\ (*cb)\ (SSL\ *ssl,\ \textcolor{keywordtype}{void}\ *arg),\ \textcolor{keywordtype}{void}\ *arg);}
\DoxyCodeLine{02519\ }
\DoxyCodeLine{02520\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_verify\_cert\_chain(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ STACK\_OF(X509)\ *sk);}
\DoxyCodeLine{02521\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_verify\_rpk(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ EVP\_PKEY\ *rpk);}
\DoxyCodeLine{02522\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_build\_cert\_chain(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ SSL\_CTX\ *ctx,\ \textcolor{keywordtype}{int}\ flags);}
\DoxyCodeLine{02523\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_cert\_set\_cert\_store(\mbox{\hyperlink{structcert__st}{CERT}}\ *c,\ X509\_STORE\ *store,\ \textcolor{keywordtype}{int}\ chain,}
\DoxyCodeLine{02524\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ ref);}
\DoxyCodeLine{02525\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_cert\_get\_cert\_store(\mbox{\hyperlink{structcert__st}{CERT}}\ *c,\ X509\_STORE\ **pstore,\ \textcolor{keywordtype}{int}\ chain);}
\DoxyCodeLine{02526\ }
\DoxyCodeLine{02527\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_security(\textcolor{keyword}{const}\ \mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{int}\ op,\ \textcolor{keywordtype}{int}\ bits,\ \textcolor{keywordtype}{int}\ nid,}
\DoxyCodeLine{02528\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *other);}
\DoxyCodeLine{02529\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_ctx\_security(\textcolor{keyword}{const}\ SSL\_CTX\ *ctx,\ \textcolor{keywordtype}{int}\ op,\ \textcolor{keywordtype}{int}\ bits,\ \textcolor{keywordtype}{int}\ nid,}
\DoxyCodeLine{02530\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *other);}
\DoxyCodeLine{02531\ \textcolor{keywordtype}{int}\ ssl\_get\_security\_level\_bits(\textcolor{keyword}{const}\ SSL\ *s,\ \textcolor{keyword}{const}\ SSL\_CTX\ *ctx,\ \textcolor{keywordtype}{int}\ *levelp);}
\DoxyCodeLine{02532\ }
\DoxyCodeLine{02533\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_cert\_lookup\_by\_nid(\textcolor{keywordtype}{int}\ nid,\ \textcolor{keywordtype}{size\_t}\ *pidx,\ SSL\_CTX\ *ctx);}
\DoxyCodeLine{02534\ \_\_owur\ \mbox{\hyperlink{struct_s_s_l___c_e_r_t___l_o_o_k_u_p}{SSL\_CERT\_LOOKUP}}\ *ssl\_cert\_lookup\_by\_pkey(\textcolor{keyword}{const}\ EVP\_PKEY\ *pk,}
\DoxyCodeLine{02535\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ *pidx,}
\DoxyCodeLine{02536\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SSL\_CTX\ *ctx);}
\DoxyCodeLine{02537\ \_\_owur\ \mbox{\hyperlink{struct_s_s_l___c_e_r_t___l_o_o_k_u_p}{SSL\_CERT\_LOOKUP}}\ *ssl\_cert\_lookup\_by\_idx(\textcolor{keywordtype}{size\_t}\ idx,\ SSL\_CTX\ *ctx);}
\DoxyCodeLine{02538\ }
\DoxyCodeLine{02539\ \textcolor{keywordtype}{int}\ ssl\_undefined\_function(SSL\ *s);}
\DoxyCodeLine{02540\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_undefined\_void\_function(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02541\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_undefined\_const\_function(\textcolor{keyword}{const}\ SSL\ *s);}
\DoxyCodeLine{02542\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_get\_server\_cert\_serverinfo(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,}
\DoxyCodeLine{02543\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ **serverinfo,}
\DoxyCodeLine{02544\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ *serverinfo\_length);}
\DoxyCodeLine{02545\ \textcolor{keywordtype}{void}\ ssl\_set\_masks(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02546\ \_\_owur\ STACK\_OF(SSL\_CIPHER)\ *ssl\_get\_ciphers\_by\_id(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *sc);}
\DoxyCodeLine{02547\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_x509err2alert(\textcolor{keywordtype}{int}\ type);}
\DoxyCodeLine{02548\ \textcolor{keywordtype}{void}\ ssl\_sort\_cipher\_list(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02549\ \textcolor{keywordtype}{int}\ ssl\_load\_ciphers(SSL\_CTX\ *ctx);}
\DoxyCodeLine{02550\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_setup\_sigalgs(SSL\_CTX\ *ctx);}
\DoxyCodeLine{02551\ \textcolor{keywordtype}{int}\ ssl\_load\_groups(SSL\_CTX\ *ctx);}
\DoxyCodeLine{02552\ \textcolor{keywordtype}{int}\ ssl\_load\_sigalgs(SSL\_CTX\ *ctx);}
\DoxyCodeLine{02553\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_fill\_hello\_random(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{int}\ server,}
\DoxyCodeLine{02554\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *field,\ \textcolor{keywordtype}{size\_t}\ len,}
\DoxyCodeLine{02555\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ DOWNGRADE\ dgrd);}
\DoxyCodeLine{02556\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_generate\_master\_secret(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *pms,}
\DoxyCodeLine{02557\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ pmslen,\ \textcolor{keywordtype}{int}\ free\_pms);}
\DoxyCodeLine{02558\ \_\_owur\ EVP\_PKEY\ *ssl\_generate\_pkey(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ EVP\_PKEY\ *pm);}
\DoxyCodeLine{02559\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_gensecret(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *pms,\ \textcolor{keywordtype}{size\_t}\ pmslen);}
\DoxyCodeLine{02560\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_derive(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ EVP\_PKEY\ *privkey,\ EVP\_PKEY\ *\mbox{\hyperlink{structpubkey}{pubkey}},}
\DoxyCodeLine{02561\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ genmaster);}
\DoxyCodeLine{02562\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_decapsulate(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ EVP\_PKEY\ *privkey,}
\DoxyCodeLine{02563\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *ct,\ \textcolor{keywordtype}{size\_t}\ ctlen,}
\DoxyCodeLine{02564\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ gensecret);}
\DoxyCodeLine{02565\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_encapsulate(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ EVP\_PKEY\ *\mbox{\hyperlink{structpubkey}{pubkey}},}
\DoxyCodeLine{02566\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ **ctp,\ \textcolor{keywordtype}{size\_t}\ *ctlenp,}
\DoxyCodeLine{02567\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ gensecret);}
\DoxyCodeLine{02568\ \_\_owur\ EVP\_PKEY\ *ssl\_dh\_to\_pkey(DH\ *dh);}
\DoxyCodeLine{02569\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_set\_tmp\_ecdh\_groups(uint16\_t\ **pext,\ \textcolor{keywordtype}{size\_t}\ *pextlen,}
\DoxyCodeLine{02570\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *key);}
\DoxyCodeLine{02571\ \_\_owur\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ssl\_get\_max\_send\_fragment(\textcolor{keyword}{const}\ \mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *sc);}
\DoxyCodeLine{02572\ \_\_owur\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ssl\_get\_split\_send\_fragment(\textcolor{keyword}{const}\ \mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *sc);}
\DoxyCodeLine{02573\ }
\DoxyCodeLine{02574\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_CIPHER\ *ssl3\_get\_cipher\_by\_id(uint32\_t\ \textcolor{keywordtype}{id});}
\DoxyCodeLine{02575\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_CIPHER\ *ssl3\_get\_cipher\_by\_std\_name(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *stdname);}
\DoxyCodeLine{02576\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_CIPHER\ *ssl3\_get\_cipher\_by\_char(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p);}
\DoxyCodeLine{02577\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl3\_put\_cipher\_by\_char(\textcolor{keyword}{const}\ SSL\_CIPHER\ *c,\ \mbox{\hyperlink{structwpacket__st}{WPACKET}}\ *pkt,}
\DoxyCodeLine{02578\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ *len);}
\DoxyCodeLine{02579\ \textcolor{keywordtype}{int}\ ssl3\_init\_finished\_mac(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02580\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl3\_setup\_key\_block(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02581\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl3\_change\_cipher\_state(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{int}\ which);}
\DoxyCodeLine{02582\ \textcolor{keywordtype}{void}\ ssl3\_cleanup\_key\_block(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02583\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl3\_do\_write(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ uint8\_t\ type);}
\DoxyCodeLine{02584\ \textcolor{keywordtype}{int}\ ssl3\_send\_alert(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{int}\ level,\ \textcolor{keywordtype}{int}\ desc);}
\DoxyCodeLine{02585\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl3\_generate\_master\_secret(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *out,}
\DoxyCodeLine{02586\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p,\ \textcolor{keywordtype}{size\_t}\ len,}
\DoxyCodeLine{02587\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ *secret\_size);}
\DoxyCodeLine{02588\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl3\_get\_req\_cert\_type(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \mbox{\hyperlink{structwpacket__st}{WPACKET}}\ *pkt);}
\DoxyCodeLine{02589\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl3\_num\_ciphers(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02590\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_CIPHER\ *ssl3\_get\_cipher(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ u);}
\DoxyCodeLine{02591\ \textcolor{keywordtype}{int}\ ssl3\_renegotiate(SSL\ *ssl);}
\DoxyCodeLine{02592\ \textcolor{keywordtype}{int}\ ssl3\_renegotiate\_check(SSL\ *ssl,\ \textcolor{keywordtype}{int}\ initok);}
\DoxyCodeLine{02593\ \textcolor{keywordtype}{void}\ ssl3\_digest\_master\_key\_set\_params(\textcolor{keyword}{const}\ SSL\_SESSION\ *session,}
\DoxyCodeLine{02594\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ OSSL\_PARAM\ params[]);}
\DoxyCodeLine{02595\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl3\_dispatch\_alert(SSL\ *s);}
\DoxyCodeLine{02596\ \_\_owur\ \textcolor{keywordtype}{size\_t}\ ssl3\_final\_finish\_mac(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *sender,}
\DoxyCodeLine{02597\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ slen,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p);}
\DoxyCodeLine{02598\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl3\_finish\_mac(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *buf,}
\DoxyCodeLine{02599\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ len);}
\DoxyCodeLine{02600\ \textcolor{keywordtype}{void}\ ssl3\_free\_digest\_list(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02601\ \_\_owur\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ ssl3\_output\_cert\_chain(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \mbox{\hyperlink{structwpacket__st}{WPACKET}}\ *pkt,}
\DoxyCodeLine{02602\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structcert__pkey__st}{CERT\_PKEY}}\ *cpk,\ \textcolor{keywordtype}{int}\ for\_comp);}
\DoxyCodeLine{02603\ \_\_owur\ \textcolor{keyword}{const}\ SSL\_CIPHER\ *ssl3\_choose\_cipher(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,}
\DoxyCodeLine{02604\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STACK\_OF(SSL\_CIPHER)\ *clnt,}
\DoxyCodeLine{02605\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STACK\_OF(SSL\_CIPHER)\ *srvr);}
\DoxyCodeLine{02606\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl3\_digest\_cached\_records(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{int}\ keep);}
\DoxyCodeLine{02607\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl3\_new(SSL\ *s);}
\DoxyCodeLine{02608\ \textcolor{keywordtype}{void}\ ssl3\_free(SSL\ *s);}
\DoxyCodeLine{02609\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl3\_read(SSL\ *s,\ \textcolor{keywordtype}{void}\ *buf,\ \textcolor{keywordtype}{size\_t}\ len,\ \textcolor{keywordtype}{size\_t}\ *readbytes);}
\DoxyCodeLine{02610\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl3\_peek(SSL\ *s,\ \textcolor{keywordtype}{void}\ *buf,\ \textcolor{keywordtype}{size\_t}\ len,\ \textcolor{keywordtype}{size\_t}\ *readbytes);}
\DoxyCodeLine{02611\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl3\_write(SSL\ *s,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *buf,\ \textcolor{keywordtype}{size\_t}\ len,\ \textcolor{keywordtype}{size\_t}\ *written);}
\DoxyCodeLine{02612\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl3\_shutdown(SSL\ *s);}
\DoxyCodeLine{02613\ \textcolor{keywordtype}{int}\ ssl3\_clear(SSL\ *s);}
\DoxyCodeLine{02614\ \_\_owur\ \textcolor{keywordtype}{long}\ ssl3\_ctrl(SSL\ *s,\ \textcolor{keywordtype}{int}\ cmd,\ \textcolor{keywordtype}{long}\ larg,\ \textcolor{keywordtype}{void}\ *parg);}
\DoxyCodeLine{02615\ \_\_owur\ \textcolor{keywordtype}{long}\ ssl3\_ctx\_ctrl(SSL\_CTX\ *s,\ \textcolor{keywordtype}{int}\ cmd,\ \textcolor{keywordtype}{long}\ larg,\ \textcolor{keywordtype}{void}\ *parg);}
\DoxyCodeLine{02616\ \_\_owur\ \textcolor{keywordtype}{long}\ ssl3\_callback\_ctrl(SSL\ *s,\ \textcolor{keywordtype}{int}\ cmd,\ \textcolor{keywordtype}{void}\ (*fp)\ (\textcolor{keywordtype}{void}));}
\DoxyCodeLine{02617\ \_\_owur\ \textcolor{keywordtype}{long}\ ssl3\_ctx\_callback\_ctrl(SSL\_CTX\ *s,\ \textcolor{keywordtype}{int}\ cmd,\ \textcolor{keywordtype}{void}\ (*fp)\ (\textcolor{keywordtype}{void}));}
\DoxyCodeLine{02618\ }
\DoxyCodeLine{02619\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl3\_do\_change\_cipher\_spec(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02620\ \_\_owur\ \mbox{\hyperlink{struct_o_s_s_l___t_i_m_e}{OSSL\_TIME}}\ ssl3\_default\_timeout(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02621\ }
\DoxyCodeLine{02622\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl3\_set\_handshake\_header(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \mbox{\hyperlink{structwpacket__st}{WPACKET}}\ *pkt,}
\DoxyCodeLine{02623\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ htype);}
\DoxyCodeLine{02624\ \_\_owur\ \textcolor{keywordtype}{int}\ tls\_close\_construct\_packet(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \mbox{\hyperlink{structwpacket__st}{WPACKET}}\ *pkt,\ \textcolor{keywordtype}{int}\ htype);}
\DoxyCodeLine{02625\ \_\_owur\ \textcolor{keywordtype}{int}\ tls\_setup\_handshake(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02626\ \_\_owur\ \textcolor{keywordtype}{int}\ dtls1\_set\_handshake\_header(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \mbox{\hyperlink{structwpacket__st}{WPACKET}}\ *pkt,\ \textcolor{keywordtype}{int}\ htype);}
\DoxyCodeLine{02627\ \_\_owur\ \textcolor{keywordtype}{int}\ dtls1\_close\_construct\_packet(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \mbox{\hyperlink{structwpacket__st}{WPACKET}}\ *pkt,\ \textcolor{keywordtype}{int}\ htype);}
\DoxyCodeLine{02628\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl3\_handshake\_write(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02629\ }
\DoxyCodeLine{02630\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_allow\_compression(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02631\ }
\DoxyCodeLine{02632\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_version\_supported(\textcolor{keyword}{const}\ \mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{int}\ version,}
\DoxyCodeLine{02633\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ SSL\_METHOD\ **meth);}
\DoxyCodeLine{02634\ }
\DoxyCodeLine{02635\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_set\_client\_hello\_version(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02636\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_check\_version\_downgrade(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02637\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_set\_version\_bound(\textcolor{keywordtype}{int}\ method\_version,\ \textcolor{keywordtype}{int}\ version,\ \textcolor{keywordtype}{int}\ *bound);}
\DoxyCodeLine{02638\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_choose\_server\_version(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \mbox{\hyperlink{struct_c_l_i_e_n_t_h_e_l_l_o___m_s_g}{CLIENTHELLO\_MSG}}\ *hello,}
\DoxyCodeLine{02639\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ DOWNGRADE\ *dgrd);}
\DoxyCodeLine{02640\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_choose\_client\_version(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{int}\ version,}
\DoxyCodeLine{02641\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structraw__extension__st}{RAW\_EXTENSION}}\ *extensions);}
\DoxyCodeLine{02642\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_get\_min\_max\_version(\textcolor{keyword}{const}\ \mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{int}\ *min\_version,}
\DoxyCodeLine{02643\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *max\_version,\ \textcolor{keywordtype}{int}\ *real\_max);}
\DoxyCodeLine{02644\ }
\DoxyCodeLine{02645\ \_\_owur\ \mbox{\hyperlink{struct_o_s_s_l___t_i_m_e}{OSSL\_TIME}}\ tls1\_default\_timeout(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02646\ \_\_owur\ \textcolor{keywordtype}{int}\ dtls1\_do\_write(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ uint8\_t\ type);}
\DoxyCodeLine{02647\ \textcolor{keywordtype}{void}\ dtls1\_set\_message\_header(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,}
\DoxyCodeLine{02648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ mt,}
\DoxyCodeLine{02649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ len,}
\DoxyCodeLine{02650\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ frag\_off,\ \textcolor{keywordtype}{size\_t}\ frag\_len);}
\DoxyCodeLine{02651\ }
\DoxyCodeLine{02652\ \textcolor{keywordtype}{int}\ dtls1\_write\_app\_data\_bytes(SSL\ *s,\ uint8\_t\ type,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *buf\_,}
\DoxyCodeLine{02653\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ len,\ \textcolor{keywordtype}{size\_t}\ *written);}
\DoxyCodeLine{02654\ }
\DoxyCodeLine{02655\ \_\_owur\ \textcolor{keywordtype}{int}\ dtls1\_read\_failed(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{int}\ code);}
\DoxyCodeLine{02656\ \_\_owur\ \textcolor{keywordtype}{int}\ dtls1\_buffer\_message(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{int}\ ccs);}
\DoxyCodeLine{02657\ \_\_owur\ \textcolor{keywordtype}{int}\ dtls1\_retransmit\_message(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ seq,}
\DoxyCodeLine{02658\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *found);}
\DoxyCodeLine{02659\ \_\_owur\ \textcolor{keywordtype}{int}\ dtls1\_get\_queue\_priority(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ seq,\ \textcolor{keywordtype}{int}\ is\_ccs);}
\DoxyCodeLine{02660\ \textcolor{keywordtype}{int}\ dtls1\_retransmit\_buffered\_messages(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02661\ \textcolor{keywordtype}{void}\ dtls1\_clear\_received\_buffer(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02662\ \textcolor{keywordtype}{void}\ dtls1\_clear\_sent\_buffer(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02663\ \textcolor{keywordtype}{void}\ dtls1\_get\_message\_header(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *data,}
\DoxyCodeLine{02664\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structhm__header__st}{hm\_header\_st}}\ *msg\_hdr);}
\DoxyCodeLine{02665\ \_\_owur\ \mbox{\hyperlink{struct_o_s_s_l___t_i_m_e}{OSSL\_TIME}}\ dtls1\_default\_timeout(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02666\ \_\_owur\ \textcolor{keywordtype}{int}\ dtls1\_get\_timeout(\textcolor{keyword}{const}\ \mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \mbox{\hyperlink{struct_o_s_s_l___t_i_m_e}{OSSL\_TIME}}\ *timeleft);}
\DoxyCodeLine{02667\ \_\_owur\ \textcolor{keywordtype}{int}\ dtls1\_check\_timeout\_num(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02668\ \_\_owur\ \textcolor{keywordtype}{int}\ dtls1\_handle\_timeout(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02669\ \textcolor{keywordtype}{void}\ dtls1\_start\_timer(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02670\ \textcolor{keywordtype}{void}\ dtls1\_stop\_timer(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02671\ \_\_owur\ \textcolor{keywordtype}{int}\ dtls1\_is\_timer\_expired(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02672\ \_\_owur\ \textcolor{keywordtype}{int}\ dtls\_raw\_hello\_verify\_request(\mbox{\hyperlink{structwpacket__st}{WPACKET}}\ *pkt,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *cookie,}
\DoxyCodeLine{02673\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ cookie\_len);}
\DoxyCodeLine{02674\ \_\_owur\ \textcolor{keywordtype}{size\_t}\ dtls1\_min\_mtu(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02675\ \textcolor{keywordtype}{void}\ dtls1\_hm\_fragment\_free(\mbox{\hyperlink{structhm__fragment__st}{hm\_fragment}}\ *frag);}
\DoxyCodeLine{02676\ \_\_owur\ \textcolor{keywordtype}{int}\ dtls1\_query\_mtu(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02677\ }
\DoxyCodeLine{02678\ \_\_owur\ \textcolor{keywordtype}{int}\ tls1\_new(SSL\ *s);}
\DoxyCodeLine{02679\ \textcolor{keywordtype}{void}\ tls1\_free(SSL\ *s);}
\DoxyCodeLine{02680\ \textcolor{keywordtype}{int}\ tls1\_clear(SSL\ *s);}
\DoxyCodeLine{02681\ }
\DoxyCodeLine{02682\ \_\_owur\ \textcolor{keywordtype}{int}\ dtls1\_new(SSL\ *s);}
\DoxyCodeLine{02683\ \textcolor{keywordtype}{void}\ dtls1\_free(SSL\ *s);}
\DoxyCodeLine{02684\ \textcolor{keywordtype}{int}\ dtls1\_clear(SSL\ *s);}
\DoxyCodeLine{02685\ \textcolor{keywordtype}{long}\ dtls1\_ctrl(SSL\ *s,\ \textcolor{keywordtype}{int}\ cmd,\ \textcolor{keywordtype}{long}\ larg,\ \textcolor{keywordtype}{void}\ *parg);}
\DoxyCodeLine{02686\ \_\_owur\ \textcolor{keywordtype}{int}\ dtls1\_shutdown(SSL\ *s);}
\DoxyCodeLine{02687\ }
\DoxyCodeLine{02688\ \_\_owur\ \textcolor{keywordtype}{int}\ dtls1\_dispatch\_alert(SSL\ *s);}
\DoxyCodeLine{02689\ }
\DoxyCodeLine{02690\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_init\_wbio\_buffer(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02691\ \textcolor{keywordtype}{int}\ ssl\_free\_wbio\_buffer(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02692\ }
\DoxyCodeLine{02693\ \_\_owur\ \textcolor{keywordtype}{int}\ tls1\_change\_cipher\_state(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{int}\ which);}
\DoxyCodeLine{02694\ \_\_owur\ \textcolor{keywordtype}{int}\ tls1\_setup\_key\_block(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02695\ \_\_owur\ \textcolor{keywordtype}{size\_t}\ tls1\_final\_finish\_mac(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *str,}
\DoxyCodeLine{02696\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ slen,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p);}
\DoxyCodeLine{02697\ \_\_owur\ \textcolor{keywordtype}{int}\ tls1\_generate\_master\_secret(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *out,}
\DoxyCodeLine{02698\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p,\ \textcolor{keywordtype}{size\_t}\ len,}
\DoxyCodeLine{02699\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ *secret\_size);}
\DoxyCodeLine{02700\ \_\_owur\ \textcolor{keywordtype}{int}\ tls13\_setup\_key\_block(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02701\ \_\_owur\ \textcolor{keywordtype}{size\_t}\ tls13\_final\_finish\_mac(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *str,\ \textcolor{keywordtype}{size\_t}\ slen,}
\DoxyCodeLine{02702\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p);}
\DoxyCodeLine{02703\ \_\_owur\ \textcolor{keywordtype}{int}\ tls13\_change\_cipher\_state(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{int}\ which);}
\DoxyCodeLine{02704\ \_\_owur\ \textcolor{keywordtype}{int}\ tls13\_update\_key(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{int}\ send);}
\DoxyCodeLine{02705\ \_\_owur\ \textcolor{keywordtype}{int}\ tls13\_hkdf\_expand(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,}
\DoxyCodeLine{02706\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ EVP\_MD\ *md,}
\DoxyCodeLine{02707\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *secret,}
\DoxyCodeLine{02708\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *label,\ \textcolor{keywordtype}{size\_t}\ labellen,}
\DoxyCodeLine{02709\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *data,\ \textcolor{keywordtype}{size\_t}\ datalen,}
\DoxyCodeLine{02710\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *out,\ \textcolor{keywordtype}{size\_t}\ outlen,\ \textcolor{keywordtype}{int}\ fatal);}
\DoxyCodeLine{02711\ \_\_owur\ \textcolor{keywordtype}{int}\ tls13\_hkdf\_expand\_ex(OSSL\_LIB\_CTX\ *libctx,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *propq,}
\DoxyCodeLine{02712\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ EVP\_MD\ *md,}
\DoxyCodeLine{02713\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *secret,}
\DoxyCodeLine{02714\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *label,\ \textcolor{keywordtype}{size\_t}\ labellen,}
\DoxyCodeLine{02715\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *data,\ \textcolor{keywordtype}{size\_t}\ datalen,}
\DoxyCodeLine{02716\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *out,\ \textcolor{keywordtype}{size\_t}\ outlen,}
\DoxyCodeLine{02717\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ raise\_error);}
\DoxyCodeLine{02718\ \_\_owur\ \textcolor{keywordtype}{int}\ tls13\_derive\_key(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keyword}{const}\ EVP\_MD\ *md,}
\DoxyCodeLine{02719\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *secret,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *key,}
\DoxyCodeLine{02720\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ keylen);}
\DoxyCodeLine{02721\ \_\_owur\ \textcolor{keywordtype}{int}\ tls13\_derive\_iv(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keyword}{const}\ EVP\_MD\ *md,}
\DoxyCodeLine{02722\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *secret,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *iv,}
\DoxyCodeLine{02723\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ ivlen);}
\DoxyCodeLine{02724\ \_\_owur\ \textcolor{keywordtype}{int}\ tls13\_derive\_finishedkey(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keyword}{const}\ EVP\_MD\ *md,}
\DoxyCodeLine{02725\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *secret,}
\DoxyCodeLine{02726\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *fin,\ \textcolor{keywordtype}{size\_t}\ finlen);}
\DoxyCodeLine{02727\ \textcolor{keywordtype}{int}\ tls13\_generate\_secret(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keyword}{const}\ EVP\_MD\ *md,}
\DoxyCodeLine{02728\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *prevsecret,}
\DoxyCodeLine{02729\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *insecret,}
\DoxyCodeLine{02730\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ insecretlen,}
\DoxyCodeLine{02731\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *outsecret);}
\DoxyCodeLine{02732\ \_\_owur\ \textcolor{keywordtype}{int}\ tls13\_generate\_handshake\_secret(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,}
\DoxyCodeLine{02733\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *insecret,}
\DoxyCodeLine{02734\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ insecretlen);}
\DoxyCodeLine{02735\ \_\_owur\ \textcolor{keywordtype}{int}\ tls13\_generate\_master\_secret(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *out,}
\DoxyCodeLine{02736\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *prev,\ \textcolor{keywordtype}{size\_t}\ prevlen,}
\DoxyCodeLine{02737\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ *secret\_size);}
\DoxyCodeLine{02738\ \_\_owur\ \textcolor{keywordtype}{int}\ tls1\_export\_keying\_material(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,}
\DoxyCodeLine{02739\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *out,\ \textcolor{keywordtype}{size\_t}\ olen,}
\DoxyCodeLine{02740\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *label,\ \textcolor{keywordtype}{size\_t}\ llen,}
\DoxyCodeLine{02741\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p,\ \textcolor{keywordtype}{size\_t}\ plen,}
\DoxyCodeLine{02742\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ use\_context);}
\DoxyCodeLine{02743\ \_\_owur\ \textcolor{keywordtype}{int}\ tls13\_export\_keying\_material(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,}
\DoxyCodeLine{02744\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *out,\ \textcolor{keywordtype}{size\_t}\ olen,}
\DoxyCodeLine{02745\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *label,\ \textcolor{keywordtype}{size\_t}\ llen,}
\DoxyCodeLine{02746\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *context,}
\DoxyCodeLine{02747\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ contextlen,\ \textcolor{keywordtype}{int}\ use\_context);}
\DoxyCodeLine{02748\ \_\_owur\ \textcolor{keywordtype}{int}\ tls13\_export\_keying\_material\_early(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,}
\DoxyCodeLine{02749\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *out,\ \textcolor{keywordtype}{size\_t}\ olen,}
\DoxyCodeLine{02750\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *label,\ \textcolor{keywordtype}{size\_t}\ llen,}
\DoxyCodeLine{02751\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *context,}
\DoxyCodeLine{02752\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ contextlen);}
\DoxyCodeLine{02753\ \_\_owur\ \textcolor{keywordtype}{int}\ tls1\_alert\_code(\textcolor{keywordtype}{int}\ code);}
\DoxyCodeLine{02754\ \_\_owur\ \textcolor{keywordtype}{int}\ tls13\_alert\_code(\textcolor{keywordtype}{int}\ code);}
\DoxyCodeLine{02755\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl3\_alert\_code(\textcolor{keywordtype}{int}\ code);}
\DoxyCodeLine{02756\ }
\DoxyCodeLine{02757\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_check\_srvr\_ecc\_cert\_and\_alg(X509\ *x,\ \mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02758\ }
\DoxyCodeLine{02759\ SSL\_COMP\ *ssl3\_comp\_find(STACK\_OF(SSL\_COMP)\ *sk,\ \textcolor{keywordtype}{int}\ n);}
\DoxyCodeLine{02760\ }
\DoxyCodeLine{02761\ \_\_owur\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structtls__group__info__st}{TLS\_GROUP\_INFO}}\ *tls1\_group\_id\_lookup(SSL\_CTX\ *ctx,\ uint16\_t\ curve\_id);}
\DoxyCodeLine{02762\ \_\_owur\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *tls1\_group\_id2name(SSL\_CTX\ *ctx,\ uint16\_t\ group\_id);}
\DoxyCodeLine{02763\ \_\_owur\ \textcolor{keywordtype}{int}\ tls1\_group\_id2nid(uint16\_t\ group\_id,\ \textcolor{keywordtype}{int}\ include\_unknown);}
\DoxyCodeLine{02764\ \_\_owur\ uint16\_t\ tls1\_nid2group\_id(\textcolor{keywordtype}{int}\ nid);}
\DoxyCodeLine{02765\ \_\_owur\ \textcolor{keywordtype}{int}\ tls1\_check\_group\_id(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ uint16\_t\ group\_id,}
\DoxyCodeLine{02766\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ check\_own\_curves);}
\DoxyCodeLine{02767\ \_\_owur\ uint16\_t\ tls1\_shared\_group(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{int}\ nmatch);}
\DoxyCodeLine{02768\ \_\_owur\ \textcolor{keywordtype}{int}\ tls1\_set\_groups(uint16\_t\ **pext,\ \textcolor{keywordtype}{size\_t}\ *pextlen,}
\DoxyCodeLine{02769\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *curves,\ \textcolor{keywordtype}{size\_t}\ ncurves);}
\DoxyCodeLine{02770\ \_\_owur\ \textcolor{keywordtype}{int}\ tls1\_set\_groups\_list(SSL\_CTX\ *ctx,\ uint16\_t\ **pext,\ \textcolor{keywordtype}{size\_t}\ *pextlen,}
\DoxyCodeLine{02771\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *str);}
\DoxyCodeLine{02772\ \_\_owur\ EVP\_PKEY\ *ssl\_generate\_pkey\_group(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ uint16\_t\ \textcolor{keywordtype}{id});}
\DoxyCodeLine{02773\ \_\_owur\ \textcolor{keywordtype}{int}\ tls\_valid\_group(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ uint16\_t\ group\_id,\ \textcolor{keywordtype}{int}\ minversion,}
\DoxyCodeLine{02774\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ maxversion,\ \textcolor{keywordtype}{int}\ isec,\ \textcolor{keywordtype}{int}\ *okfortls13);}
\DoxyCodeLine{02775\ \_\_owur\ EVP\_PKEY\ *ssl\_generate\_param\_group(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ uint16\_t\ \textcolor{keywordtype}{id});}
\DoxyCodeLine{02776\ \textcolor{keywordtype}{void}\ tls1\_get\_formatlist(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ **pformats,}
\DoxyCodeLine{02777\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ *num\_formats);}
\DoxyCodeLine{02778\ \_\_owur\ \textcolor{keywordtype}{int}\ tls1\_check\_ec\_tmp\_key(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{id});}
\DoxyCodeLine{02779\ }
\DoxyCodeLine{02780\ \_\_owur\ \textcolor{keywordtype}{int}\ tls\_group\_allowed(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ uint16\_t\ curve,\ \textcolor{keywordtype}{int}\ op);}
\DoxyCodeLine{02781\ \textcolor{keywordtype}{void}\ tls1\_get\_supported\_groups(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keyword}{const}\ uint16\_t\ **pgroups,}
\DoxyCodeLine{02782\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ *pgroupslen);}
\DoxyCodeLine{02783\ }
\DoxyCodeLine{02784\ \_\_owur\ \textcolor{keywordtype}{int}\ tls1\_set\_server\_sigalgs(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02785\ }
\DoxyCodeLine{02786\ \_\_owur\ SSL\_TICKET\_STATUS\ tls\_get\_ticket\_from\_client(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,}
\DoxyCodeLine{02787\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_c_l_i_e_n_t_h_e_l_l_o___m_s_g}{CLIENTHELLO\_MSG}}\ *hello,}
\DoxyCodeLine{02788\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SSL\_SESSION\ **ret);}
\DoxyCodeLine{02789\ \_\_owur\ SSL\_TICKET\_STATUS\ tls\_decrypt\_ticket(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,}
\DoxyCodeLine{02790\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *etick,}
\DoxyCodeLine{02791\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ eticklen,}
\DoxyCodeLine{02792\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *sess\_id,}
\DoxyCodeLine{02793\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ sesslen,\ SSL\_SESSION\ **psess);}
\DoxyCodeLine{02794\ }
\DoxyCodeLine{02795\ \_\_owur\ \textcolor{keywordtype}{int}\ tls\_use\_ticket(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02796\ }
\DoxyCodeLine{02797\ \textcolor{keywordtype}{void}\ ssl\_set\_sig\_mask(uint32\_t\ *pmask\_a,\ \mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{int}\ op);}
\DoxyCodeLine{02798\ }
\DoxyCodeLine{02799\ \_\_owur\ \textcolor{keywordtype}{int}\ tls1\_set\_sigalgs\_list(\mbox{\hyperlink{structcert__st}{CERT}}\ *c,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *str,\ \textcolor{keywordtype}{int}\ client);}
\DoxyCodeLine{02800\ \_\_owur\ \textcolor{keywordtype}{int}\ tls1\_set\_raw\_sigalgs(\mbox{\hyperlink{structcert__st}{CERT}}\ *c,\ \textcolor{keyword}{const}\ uint16\_t\ *psigs,\ \textcolor{keywordtype}{size\_t}\ salglen,}
\DoxyCodeLine{02801\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ client);}
\DoxyCodeLine{02802\ \_\_owur\ \textcolor{keywordtype}{int}\ tls1\_set\_sigalgs(\mbox{\hyperlink{structcert__st}{CERT}}\ *c,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ *salg,\ \textcolor{keywordtype}{size\_t}\ salglen,}
\DoxyCodeLine{02803\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ client);}
\DoxyCodeLine{02804\ \textcolor{keywordtype}{int}\ tls1\_check\_chain(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ X509\ *x,\ EVP\_PKEY\ *pk,}
\DoxyCodeLine{02805\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ STACK\_OF(X509)\ *chain,\ \textcolor{keywordtype}{int}\ idx);}
\DoxyCodeLine{02806\ \textcolor{keywordtype}{void}\ tls1\_set\_cert\_validity(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02807\ }
\DoxyCodeLine{02808\ \textcolor{preprocessor}{\#\ \ ifndef\ OPENSSL\_NO\_CT}}
\DoxyCodeLine{02809\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_validate\_ct(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02810\ \textcolor{preprocessor}{\#\ \ endif}}
\DoxyCodeLine{02811\ }
\DoxyCodeLine{02812\ \_\_owur\ EVP\_PKEY\ *ssl\_get\_auto\_dh(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02813\ }
\DoxyCodeLine{02814\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_security\_cert(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ SSL\_CTX\ *ctx,\ X509\ *x,\ \textcolor{keywordtype}{int}\ vfy,}
\DoxyCodeLine{02815\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ is\_ee);}
\DoxyCodeLine{02816\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_security\_cert\_chain(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ STACK\_OF(X509)\ *sk,}
\DoxyCodeLine{02817\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ X509\ *ex,\ \textcolor{keywordtype}{int}\ vfy);}
\DoxyCodeLine{02818\ }
\DoxyCodeLine{02819\ \textcolor{keywordtype}{int}\ tls\_choose\_sigalg(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{int}\ fatalerrs);}
\DoxyCodeLine{02820\ }
\DoxyCodeLine{02821\ \_\_owur\ \textcolor{keywordtype}{long}\ ssl\_get\_algorithm2(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02822\ \_\_owur\ \textcolor{keywordtype}{int}\ tls12\_copy\_sigalgs(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \mbox{\hyperlink{structwpacket__st}{WPACKET}}\ *pkt,}
\DoxyCodeLine{02823\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint16\_t\ *psig,\ \textcolor{keywordtype}{size\_t}\ psiglen);}
\DoxyCodeLine{02824\ \_\_owur\ \textcolor{keywordtype}{int}\ tls1\_save\_u16(\mbox{\hyperlink{struct_p_a_c_k_e_t}{PACKET}}\ *pkt,\ uint16\_t\ **pdest,\ \textcolor{keywordtype}{size\_t}\ *pdestlen);}
\DoxyCodeLine{02825\ \_\_owur\ \textcolor{keywordtype}{int}\ tls1\_save\_sigalgs(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \mbox{\hyperlink{struct_p_a_c_k_e_t}{PACKET}}\ *pkt,\ \textcolor{keywordtype}{int}\ cert);}
\DoxyCodeLine{02826\ \_\_owur\ \textcolor{keywordtype}{int}\ tls1\_process\_sigalgs(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02827\ \_\_owur\ \textcolor{keywordtype}{int}\ tls1\_set\_peer\_legacy\_sigalg(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keyword}{const}\ EVP\_PKEY\ *pkey);}
\DoxyCodeLine{02828\ \_\_owur\ \textcolor{keywordtype}{int}\ tls1\_lookup\_md(SSL\_CTX\ *ctx,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsigalg__lookup__st}{SIGALG\_LOOKUP}}\ *lu,}
\DoxyCodeLine{02829\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ EVP\_MD\ **pmd);}
\DoxyCodeLine{02830\ \_\_owur\ \textcolor{keywordtype}{size\_t}\ tls12\_get\_psigalgs(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{int}\ sent,}
\DoxyCodeLine{02831\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint16\_t\ **psigs);}
\DoxyCodeLine{02832\ \_\_owur\ \textcolor{keywordtype}{int}\ tls\_check\_sigalg\_curve(\textcolor{keyword}{const}\ \mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{int}\ curve);}
\DoxyCodeLine{02833\ \_\_owur\ \textcolor{keywordtype}{int}\ tls12\_check\_peer\_sigalg(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ uint16\_t,\ EVP\_PKEY\ *pkey);}
\DoxyCodeLine{02834\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_set\_client\_disabled(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02835\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_cipher\_disabled(\textcolor{keyword}{const}\ \mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keyword}{const}\ SSL\_CIPHER\ *c,}
\DoxyCodeLine{02836\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ op,\ \textcolor{keywordtype}{int}\ echde);}
\DoxyCodeLine{02837\ }
\DoxyCodeLine{02838\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_handshake\_hash(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,}
\DoxyCodeLine{02839\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *out,\ \textcolor{keywordtype}{size\_t}\ outlen,}
\DoxyCodeLine{02840\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ *hashlen);}
\DoxyCodeLine{02841\ \_\_owur\ \textcolor{keyword}{const}\ EVP\_MD\ *ssl\_md(SSL\_CTX\ *ctx,\ \textcolor{keywordtype}{int}\ idx);}
\DoxyCodeLine{02842\ \textcolor{keywordtype}{int}\ ssl\_get\_md\_idx(\textcolor{keywordtype}{int}\ md\_nid);}
\DoxyCodeLine{02843\ \_\_owur\ \textcolor{keyword}{const}\ EVP\_MD\ *ssl\_handshake\_md(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02844\ \_\_owur\ \textcolor{keyword}{const}\ EVP\_MD\ *ssl\_prf\_md(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02845\ }
\DoxyCodeLine{02846\ \textcolor{comment}{/*}}
\DoxyCodeLine{02847\ \textcolor{comment}{\ *\ ssl\_log\_rsa\_client\_key\_exchange\ logs\ |premaster|\ to\ the\ SSL\_CTX\ associated}}
\DoxyCodeLine{02848\ \textcolor{comment}{\ *\ with\ |ssl|,\ if\ logging\ is\ enabled.\ It\ returns\ one\ on\ success\ and\ zero\ on}}
\DoxyCodeLine{02849\ \textcolor{comment}{\ *\ failure.\ The\ entry\ is\ identified\ by\ the\ first\ 8\ bytes\ of}}
\DoxyCodeLine{02850\ \textcolor{comment}{\ *\ |encrypted\_premaster|.}}
\DoxyCodeLine{02851\ \textcolor{comment}{\ */}}
\DoxyCodeLine{02852\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_log\_rsa\_client\_key\_exchange(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,}
\DoxyCodeLine{02853\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint8\_t\ *encrypted\_premaster,}
\DoxyCodeLine{02854\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ encrypted\_premaster\_len,}
\DoxyCodeLine{02855\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint8\_t\ *premaster,}
\DoxyCodeLine{02856\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ premaster\_len);}
\DoxyCodeLine{02857\ }
\DoxyCodeLine{02858\ \textcolor{comment}{/*}}
\DoxyCodeLine{02859\ \textcolor{comment}{\ *\ ssl\_log\_secret\ logs\ |secret|\ to\ the\ SSL\_CTX\ associated\ with\ |ssl|,\ if}}
\DoxyCodeLine{02860\ \textcolor{comment}{\ *\ logging\ is\ available.\ It\ returns\ one\ on\ success\ and\ zero\ on\ failure.\ It\ tags}}
\DoxyCodeLine{02861\ \textcolor{comment}{\ *\ the\ entry\ with\ |label|.}}
\DoxyCodeLine{02862\ \textcolor{comment}{\ */}}
\DoxyCodeLine{02863\ \_\_owur\ \textcolor{keywordtype}{int}\ ssl\_log\_secret(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *label,}
\DoxyCodeLine{02864\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint8\_t\ *secret,\ \textcolor{keywordtype}{size\_t}\ secret\_len);}
\DoxyCodeLine{02865\ }
\DoxyCodeLine{02866\ \textcolor{preprocessor}{\#define\ MASTER\_SECRET\_LABEL\ "{}CLIENT\_RANDOM"{}}}
\DoxyCodeLine{02867\ \textcolor{preprocessor}{\#define\ CLIENT\_EARLY\_LABEL\ "{}CLIENT\_EARLY\_TRAFFIC\_SECRET"{}}}
\DoxyCodeLine{02868\ \textcolor{preprocessor}{\#define\ CLIENT\_HANDSHAKE\_LABEL\ "{}CLIENT\_HANDSHAKE\_TRAFFIC\_SECRET"{}}}
\DoxyCodeLine{02869\ \textcolor{preprocessor}{\#define\ SERVER\_HANDSHAKE\_LABEL\ "{}SERVER\_HANDSHAKE\_TRAFFIC\_SECRET"{}}}
\DoxyCodeLine{02870\ \textcolor{preprocessor}{\#define\ CLIENT\_APPLICATION\_LABEL\ "{}CLIENT\_TRAFFIC\_SECRET\_0"{}}}
\DoxyCodeLine{02871\ \textcolor{preprocessor}{\#define\ CLIENT\_APPLICATION\_N\_LABEL\ "{}CLIENT\_TRAFFIC\_SECRET\_N"{}}}
\DoxyCodeLine{02872\ \textcolor{preprocessor}{\#define\ SERVER\_APPLICATION\_LABEL\ "{}SERVER\_TRAFFIC\_SECRET\_0"{}}}
\DoxyCodeLine{02873\ \textcolor{preprocessor}{\#define\ SERVER\_APPLICATION\_N\_LABEL\ "{}SERVER\_TRAFFIC\_SECRET\_N"{}}}
\DoxyCodeLine{02874\ \textcolor{preprocessor}{\#define\ EARLY\_EXPORTER\_SECRET\_LABEL\ "{}EARLY\_EXPORTER\_SECRET"{}}}
\DoxyCodeLine{02875\ \textcolor{preprocessor}{\#define\ EXPORTER\_SECRET\_LABEL\ "{}EXPORTER\_SECRET"{}}}
\DoxyCodeLine{02876\ }
\DoxyCodeLine{02877\ \_\_owur\ \textcolor{keywordtype}{int}\ srp\_generate\_server\_master\_secret(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02878\ \_\_owur\ \textcolor{keywordtype}{int}\ srp\_generate\_client\_master\_secret(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02879\ \_\_owur\ \textcolor{keywordtype}{int}\ srp\_verify\_server\_param(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02880\ }
\DoxyCodeLine{02881\ \textcolor{comment}{/*\ statem/statem\_srvr.c\ */}}
\DoxyCodeLine{02882\ }
\DoxyCodeLine{02883\ \_\_owur\ \textcolor{keywordtype}{int}\ send\_certificate\_request(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02884\ }
\DoxyCodeLine{02885\ \textcolor{comment}{/*\ statem/extensions\_cust.c\ */}}
\DoxyCodeLine{02886\ }
\DoxyCodeLine{02887\ \mbox{\hyperlink{structcustom__ext__method}{custom\_ext\_method}}\ *custom\_ext\_find(\textcolor{keyword}{const}\ \mbox{\hyperlink{structcustom__ext__methods}{custom\_ext\_methods}}\ *exts,}
\DoxyCodeLine{02888\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ENDPOINT\ role,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ext\_type,}
\DoxyCodeLine{02889\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ *idx);}
\DoxyCodeLine{02890\ }
\DoxyCodeLine{02891\ \textcolor{keywordtype}{void}\ custom\_ext\_init(\mbox{\hyperlink{structcustom__ext__methods}{custom\_ext\_methods}}\ *meths);}
\DoxyCodeLine{02892\ }
\DoxyCodeLine{02893\ \textcolor{keywordtype}{int}\ ossl\_tls\_add\_custom\_ext\_intern(SSL\_CTX\ *ctx,\ \mbox{\hyperlink{structcustom__ext__methods}{custom\_ext\_methods}}\ *exts,}
\DoxyCodeLine{02894\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ENDPOINT\ role,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ext\_type,}
\DoxyCodeLine{02895\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ context,}
\DoxyCodeLine{02896\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SSL\_custom\_ext\_add\_cb\_ex\ add\_cb,}
\DoxyCodeLine{02897\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SSL\_custom\_ext\_free\_cb\_ex\ free\_cb,}
\DoxyCodeLine{02898\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *add\_arg,}
\DoxyCodeLine{02899\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SSL\_custom\_ext\_parse\_cb\_ex\ parse\_cb,}
\DoxyCodeLine{02900\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *parse\_arg);}
\DoxyCodeLine{02901\ \_\_owur\ \textcolor{keywordtype}{int}\ custom\_ext\_parse(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ context,}
\DoxyCodeLine{02902\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ext\_type,}
\DoxyCodeLine{02903\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *ext\_data,\ \textcolor{keywordtype}{size\_t}\ ext\_size,}
\DoxyCodeLine{02904\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ X509\ *x,\ \textcolor{keywordtype}{size\_t}\ chainidx);}
\DoxyCodeLine{02905\ \_\_owur\ \textcolor{keywordtype}{int}\ custom\_ext\_add(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{int}\ context,\ \mbox{\hyperlink{structwpacket__st}{WPACKET}}\ *pkt,\ X509\ *x,}
\DoxyCodeLine{02906\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ chainidx,\ \textcolor{keywordtype}{int}\ maxversion);}
\DoxyCodeLine{02907\ }
\DoxyCodeLine{02908\ \_\_owur\ \textcolor{keywordtype}{int}\ custom\_exts\_copy(\mbox{\hyperlink{structcustom__ext__methods}{custom\_ext\_methods}}\ *dst,}
\DoxyCodeLine{02909\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structcustom__ext__methods}{custom\_ext\_methods}}\ *src);}
\DoxyCodeLine{02910\ \_\_owur\ \textcolor{keywordtype}{int}\ custom\_exts\_copy\_flags(\mbox{\hyperlink{structcustom__ext__methods}{custom\_ext\_methods}}\ *dst,}
\DoxyCodeLine{02911\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structcustom__ext__methods}{custom\_ext\_methods}}\ *src);}
\DoxyCodeLine{02912\ \textcolor{keywordtype}{void}\ custom\_exts\_free(\mbox{\hyperlink{structcustom__ext__methods}{custom\_ext\_methods}}\ *exts);}
\DoxyCodeLine{02913\ }
\DoxyCodeLine{02914\ \textcolor{keywordtype}{void}\ ssl\_comp\_free\_compression\_methods\_int(\textcolor{keywordtype}{void});}
\DoxyCodeLine{02915\ }
\DoxyCodeLine{02916\ \textcolor{comment}{/*\ ssl\_mcnf.c\ */}}
\DoxyCodeLine{02917\ \textcolor{keywordtype}{void}\ ssl\_ctx\_system\_config(SSL\_CTX\ *ctx);}
\DoxyCodeLine{02918\ }
\DoxyCodeLine{02919\ \textcolor{keyword}{const}\ EVP\_CIPHER\ *ssl\_evp\_cipher\_fetch(OSSL\_LIB\_CTX\ *libctx,}
\DoxyCodeLine{02920\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ nid,}
\DoxyCodeLine{02921\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *properties);}
\DoxyCodeLine{02922\ \textcolor{keywordtype}{int}\ ssl\_evp\_cipher\_up\_ref(\textcolor{keyword}{const}\ EVP\_CIPHER\ *cipher);}
\DoxyCodeLine{02923\ \textcolor{keywordtype}{void}\ ssl\_evp\_cipher\_free(\textcolor{keyword}{const}\ EVP\_CIPHER\ *cipher);}
\DoxyCodeLine{02924\ \textcolor{keyword}{const}\ EVP\_MD\ *ssl\_evp\_md\_fetch(OSSL\_LIB\_CTX\ *libctx,}
\DoxyCodeLine{02925\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ nid,}
\DoxyCodeLine{02926\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *properties);}
\DoxyCodeLine{02927\ \textcolor{keywordtype}{int}\ ssl\_evp\_md\_up\_ref(\textcolor{keyword}{const}\ EVP\_MD\ *md);}
\DoxyCodeLine{02928\ \textcolor{keywordtype}{void}\ ssl\_evp\_md\_free(\textcolor{keyword}{const}\ EVP\_MD\ *md);}
\DoxyCodeLine{02929\ }
\DoxyCodeLine{02930\ \textcolor{keywordtype}{void}\ tls\_engine\_finish(ENGINE\ *\mbox{\hyperlink{structe}{e}});}
\DoxyCodeLine{02931\ \textcolor{keyword}{const}\ EVP\_CIPHER\ *tls\_get\_cipher\_from\_engine(\textcolor{keywordtype}{int}\ nid);}
\DoxyCodeLine{02932\ \textcolor{keyword}{const}\ EVP\_MD\ *tls\_get\_digest\_from\_engine(\textcolor{keywordtype}{int}\ nid);}
\DoxyCodeLine{02933\ \textcolor{keywordtype}{int}\ tls\_engine\_load\_ssl\_client\_cert(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ X509\ **px509,}
\DoxyCodeLine{02934\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ EVP\_PKEY\ **ppkey);}
\DoxyCodeLine{02935\ \textcolor{keywordtype}{int}\ ssl\_hmac\_old\_new(\mbox{\hyperlink{structssl__hmac__st}{SSL\_HMAC}}\ *ret);}
\DoxyCodeLine{02936\ \textcolor{keywordtype}{void}\ ssl\_hmac\_old\_free(\mbox{\hyperlink{structssl__hmac__st}{SSL\_HMAC}}\ *ctx);}
\DoxyCodeLine{02937\ \textcolor{keywordtype}{int}\ ssl\_hmac\_old\_init(\mbox{\hyperlink{structssl__hmac__st}{SSL\_HMAC}}\ *ctx,\ \textcolor{keywordtype}{void}\ *key,\ \textcolor{keywordtype}{size\_t}\ len,\ \textcolor{keywordtype}{char}\ *md);}
\DoxyCodeLine{02938\ \textcolor{keywordtype}{int}\ ssl\_hmac\_old\_update(\mbox{\hyperlink{structssl__hmac__st}{SSL\_HMAC}}\ *ctx,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *data,\ \textcolor{keywordtype}{size\_t}\ len);}
\DoxyCodeLine{02939\ \textcolor{keywordtype}{int}\ ssl\_hmac\_old\_final(\mbox{\hyperlink{structssl__hmac__st}{SSL\_HMAC}}\ *ctx,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *md,\ \textcolor{keywordtype}{size\_t}\ *len);}
\DoxyCodeLine{02940\ \textcolor{keywordtype}{size\_t}\ ssl\_hmac\_old\_size(\textcolor{keyword}{const}\ \mbox{\hyperlink{structssl__hmac__st}{SSL\_HMAC}}\ *ctx);}
\DoxyCodeLine{02941\ }
\DoxyCodeLine{02942\ \textcolor{keywordtype}{int}\ ssl\_ctx\_srp\_ctx\_free\_intern(SSL\_CTX\ *ctx);}
\DoxyCodeLine{02943\ \textcolor{keywordtype}{int}\ ssl\_ctx\_srp\_ctx\_init\_intern(SSL\_CTX\ *ctx);}
\DoxyCodeLine{02944\ \textcolor{keywordtype}{int}\ ssl\_srp\_ctx\_free\_intern(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02945\ \textcolor{keywordtype}{int}\ ssl\_srp\_ctx\_init\_intern(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02946\ }
\DoxyCodeLine{02947\ \textcolor{keywordtype}{int}\ ssl\_srp\_calc\_a\_param\_intern(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s);}
\DoxyCodeLine{02948\ \textcolor{keywordtype}{int}\ ssl\_srp\_server\_param\_with\_username\_intern(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,\ \textcolor{keywordtype}{int}\ *ad);}
\DoxyCodeLine{02949\ }
\DoxyCodeLine{02950\ \textcolor{keywordtype}{void}\ ssl\_session\_calculate\_timeout(SSL\_SESSION\ *ss);}
\DoxyCodeLine{02951\ }
\DoxyCodeLine{02952\ \textcolor{preprocessor}{\#\ else\ }\textcolor{comment}{/*\ OPENSSL\_UNIT\_TEST\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{02953\ }
\DoxyCodeLine{02954\ \textcolor{preprocessor}{\#\ \ define\ ssl\_init\_wbio\_buffer\ SSL\_test\_functions()-\/>p\_ssl\_init\_wbio\_buffer}}
\DoxyCodeLine{02955\ }
\DoxyCodeLine{02956\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{02957\ }
\DoxyCodeLine{02958\ \textcolor{comment}{/*\ Some\ helper\ routines\ to\ support\ TSAN\ operations\ safely\ */}}
\DoxyCodeLine{02959\ \textcolor{keyword}{static}\ ossl\_unused\ ossl\_inline\ \textcolor{keywordtype}{int}\ ssl\_tsan\_lock(\textcolor{keyword}{const}\ SSL\_CTX\ *ctx)}
\DoxyCodeLine{02960\ \{}
\DoxyCodeLine{02961\ \textcolor{preprocessor}{\#ifdef\ TSAN\_REQUIRES\_LOCKING}}
\DoxyCodeLine{02962\ \ \ \ \ \textcolor{keywordflow}{if}\ (!CRYPTO\_THREAD\_write\_lock(ctx-\/>tsan\_lock))}
\DoxyCodeLine{02963\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{02964\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02965\ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{02966\ \}}
\DoxyCodeLine{02967\ }
\DoxyCodeLine{02968\ \textcolor{keyword}{static}\ ossl\_unused\ ossl\_inline\ \textcolor{keywordtype}{void}\ ssl\_tsan\_unlock(\textcolor{keyword}{const}\ SSL\_CTX\ *ctx)}
\DoxyCodeLine{02969\ \{}
\DoxyCodeLine{02970\ \textcolor{preprocessor}{\#ifdef\ TSAN\_REQUIRES\_LOCKING}}
\DoxyCodeLine{02971\ \ \ \ \ CRYPTO\_THREAD\_unlock(ctx-\/>tsan\_lock);}
\DoxyCodeLine{02972\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02973\ \}}
\DoxyCodeLine{02974\ }
\DoxyCodeLine{02975\ \textcolor{keyword}{static}\ ossl\_unused\ ossl\_inline\ \textcolor{keywordtype}{void}\ ssl\_tsan\_counter(\textcolor{keyword}{const}\ SSL\_CTX\ *ctx,}
\DoxyCodeLine{02976\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TSAN\_QUALIFIER\ \textcolor{keywordtype}{int}\ *stat)}
\DoxyCodeLine{02977\ \{}
\DoxyCodeLine{02978\ \ \ \ \ \textcolor{keywordflow}{if}\ (ssl\_tsan\_lock(ctx))\ \{}
\DoxyCodeLine{02979\ \ \ \ \ \ \ \ \ tsan\_counter(stat);}
\DoxyCodeLine{02980\ \ \ \ \ \ \ \ \ ssl\_tsan\_unlock(ctx);}
\DoxyCodeLine{02981\ \ \ \ \ \}}
\DoxyCodeLine{02982\ \}}
\DoxyCodeLine{02983\ }
\DoxyCodeLine{02984\ \textcolor{keywordtype}{int}\ ossl\_comp\_has\_alg(\textcolor{keywordtype}{int}\ a);}
\DoxyCodeLine{02985\ \textcolor{keywordtype}{size\_t}\ ossl\_calculate\_comp\_expansion(\textcolor{keywordtype}{int}\ alg,\ \textcolor{keywordtype}{size\_t}\ length);}
\DoxyCodeLine{02986\ }
\DoxyCodeLine{02987\ \textcolor{keywordtype}{void}\ ossl\_ssl\_set\_custom\_record\_layer(\mbox{\hyperlink{structssl__connection__st}{SSL\_CONNECTION}}\ *s,}
\DoxyCodeLine{02988\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structossl__record__method__st}{OSSL\_RECORD\_METHOD}}\ *meth,}
\DoxyCodeLine{02989\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *rlarg);}
\DoxyCodeLine{02990\ }
\DoxyCodeLine{02991\ \textcolor{keywordtype}{long}\ ossl\_ctrl\_internal(SSL\ *s,\ \textcolor{keywordtype}{int}\ cmd,\ \textcolor{keywordtype}{long}\ larg,\ \textcolor{keywordtype}{void}\ *parg,\ \textcolor{keywordtype}{int}\ no\_quic);}
\DoxyCodeLine{02992\ }
\DoxyCodeLine{02993\ \textcolor{comment}{/*}}
\DoxyCodeLine{02994\ \textcolor{comment}{\ *\ Options\ which\ no\ longer\ have\ any\ effect,\ but\ which\ can\ be\ implemented}}
\DoxyCodeLine{02995\ \textcolor{comment}{\ *\ as\ no-\/ops\ for\ QUIC.}}
\DoxyCodeLine{02996\ \textcolor{comment}{\ */}}
\DoxyCodeLine{02997\ \textcolor{preprocessor}{\#define\ OSSL\_LEGACY\_SSL\_OPTIONS\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{02998\ \textcolor{preprocessor}{\ \ \ \ (SSL\_OP\_NETSCAPE\_REUSE\_CIPHER\_CHANGE\_BUG\ \ |\ \(\backslash\)}}
\DoxyCodeLine{02999\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_MICROSOFT\_BIG\_SSLV3\_BUFFER\ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03000\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_SSLEAY\_080\_CLIENT\_DH\_BUG\ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03001\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_TLS\_D5\_BUG\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03002\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_TLS\_BLOCK\_PADDING\_BUG\ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03003\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_MSIE\_SSLV2\_RSA\_PADDING\ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03004\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_SSLREF2\_REUSE\_CERT\_TYPE\_BUG\ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03005\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_MICROSOFT\_SESS\_ID\_BUG\ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03006\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_NETSCAPE\_CHALLENGE\_BUG\ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03007\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_PKCS1\_CHECK\_1\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03008\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_PKCS1\_CHECK\_2\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03009\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_SINGLE\_DH\_USE\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03010\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_SINGLE\_ECDH\_USE\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03011\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_EPHEMERAL\_RSA\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}}
\DoxyCodeLine{03012\ }
\DoxyCodeLine{03013\ \textcolor{comment}{/*\ This\ option\ is\ undefined\ in\ public\ headers\ with\ no-\/dtls1-\/method.\ */}}
\DoxyCodeLine{03014\ \textcolor{preprocessor}{\#ifndef\ SSL\_OP\_CISCO\_ANYCONNECT}}
\DoxyCodeLine{03015\ \textcolor{preprocessor}{\#\ define\ SSL\_OP\_CISCO\_ANYCONNECT\ 0}}
\DoxyCodeLine{03016\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03017\ \textcolor{comment}{/*}}
\DoxyCodeLine{03018\ \textcolor{comment}{\ *\ Options\ which\ are\ no-\/ops\ under\ QUIC\ or\ TLSv1.3\ and\ which\ are\ therefore}}
\DoxyCodeLine{03019\ \textcolor{comment}{\ *\ allowed\ but\ ignored\ under\ QUIC.}}
\DoxyCodeLine{03020\ \textcolor{comment}{\ */}}
\DoxyCodeLine{03021\ \textcolor{preprocessor}{\#define\ OSSL\_TLS1\_2\_OPTIONS\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{03022\ \textcolor{preprocessor}{\ \ \ \ (SSL\_OP\_CRYPTOPRO\_TLSEXT\_BUG\ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03023\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_DONT\_INSERT\_EMPTY\_FRAGMENTS\ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03024\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_ALLOW\_CLIENT\_RENEGOTIATION\ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03025\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_ALLOW\_UNSAFE\_LEGACY\_RENEGOTIATION\ |\ \(\backslash\)}}
\DoxyCodeLine{03026\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_NO\_COMPRESSION\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03027\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_NO\_SSLv3\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03028\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_NO\_TLSv1\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03029\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_NO\_TLSv1\_1\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03030\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_NO\_TLSv1\_2\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03031\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_NO\_DTLSv1\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03032\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_NO\_DTLSv1\_2\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03033\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_NO\_SESSION\_RESUMPTION\_ON\_RENEGOTIATION\ |\ \(\backslash\)}}
\DoxyCodeLine{03034\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_CISCO\_ANYCONNECT\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03035\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_NO\_RENEGOTIATION\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03036\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_NO\_EXTENDED\_MASTER\_SECRET\ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03037\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_NO\_ENCRYPT\_THEN\_MAC\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03038\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_COOKIE\_EXCHANGE\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03039\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_LEGACY\_SERVER\_CONNECT\ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03040\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_IGNORE\_UNEXPECTED\_EOF\ \ \ \ \ \ \ \ \ \ \ \ \ )}}
\DoxyCodeLine{03041\ }
\DoxyCodeLine{03042\ \textcolor{comment}{/*\ Total\ mask\ of\ connection-\/level\ options\ permitted\ or\ ignored\ under\ QUIC.\ */}}
\DoxyCodeLine{03043\ \textcolor{preprocessor}{\#define\ OSSL\_QUIC\_PERMITTED\_OPTIONS\_CONN\ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{03044\ \textcolor{preprocessor}{\ \ \ \ (OSSL\_LEGACY\_SSL\_OPTIONS\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03045\ \textcolor{preprocessor}{\ \ \ \ \ OSSL\_TLS1\_2\_OPTIONS\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03046\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_CIPHER\_SERVER\_PREFERENCE\ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03047\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_DISABLE\_TLSEXT\_CA\_NAMES\ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03048\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_NO\_TX\_CERTIFICATE\_COMPRESSION\ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03049\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_NO\_RX\_CERTIFICATE\_COMPRESSION\ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03050\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_PRIORITIZE\_CHACHA\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03051\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_NO\_QUERY\_MTU\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03052\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_NO\_TICKET\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03053\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_NO\_ANTI\_REPLAY\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}}
\DoxyCodeLine{03054\ }
\DoxyCodeLine{03055\ \textcolor{comment}{/*\ Total\ mask\ of\ stream-\/level\ options\ permitted\ or\ ignored\ under\ QUIC.\ */}}
\DoxyCodeLine{03056\ \textcolor{preprocessor}{\#define\ OSSL\_QUIC\_PERMITTED\_OPTIONS\_STREAM\ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{03057\ \textcolor{preprocessor}{\ \ \ \ (OSSL\_LEGACY\_SSL\_OPTIONS\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03058\ \textcolor{preprocessor}{\ \ \ \ \ OSSL\_TLS1\_2\_OPTIONS\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \(\backslash\)}}
\DoxyCodeLine{03059\ \textcolor{preprocessor}{\ \ \ \ \ SSL\_OP\_CLEANSE\_PLAINTEXT\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}}
\DoxyCodeLine{03060\ }
\DoxyCodeLine{03061\ \textcolor{comment}{/*\ Total\ mask\ of\ options\ permitted\ on\ either\ connections\ or\ streams.\ */}}
\DoxyCodeLine{03062\ \textcolor{preprocessor}{\#define\ OSSL\_QUIC\_PERMITTED\_OPTIONS\ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{03063\ \textcolor{preprocessor}{\ \ \ \ (OSSL\_QUIC\_PERMITTED\_OPTIONS\_CONN\ |\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{03064\ \textcolor{preprocessor}{\ \ \ \ \ OSSL\_QUIC\_PERMITTED\_OPTIONS\_STREAM)}}
\DoxyCodeLine{03065\ }
\DoxyCodeLine{03066\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
