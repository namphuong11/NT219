\doxysection{des\+\_\+local.\+h}
\hypertarget{des__local_8h_source}{}\label{des__local_8h_source}\index{C:/Users/namph/Downloads/openssl/openssl-\/3.2.1/crypto/des/des\_local.h@{C:/Users/namph/Downloads/openssl/openssl-\/3.2.1/crypto/des/des\_local.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ *\ Copyright\ 1995-\/2023\ The\ OpenSSL\ Project\ Authors.\ All\ Rights\ Reserved.}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *\ Licensed\ under\ the\ Apache\ License\ 2.0\ (the\ "{}License"{}).\ \ You\ may\ not\ use}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ *\ this\ file\ except\ in\ compliance\ with\ the\ License.\ \ You\ can\ obtain\ a\ copy}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ *\ in\ the\ file\ LICENSE\ in\ the\ source\ distribution\ or\ at}}
\DoxyCodeLine{00007\ \textcolor{comment}{\ *\ https://www.openssl.org/source/license.html}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#ifndef\ OSSL\_CRYPTO\_DES\_LOCAL\_H}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#\ define\ OSSL\_CRYPTO\_DES\_LOCAL\_H}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#\ include\ <openssl/e\_os2.h>}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#\ include\ <stdio.h>}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#\ include\ <stdlib.h>}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#\ include\ <string.h>}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#\ include\ <openssl/des.h>}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#\ ifdef\ OPENSSL\_BUILD\_SHLIBCRYPTO}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#\ \ undef\ OPENSSL\_EXTERN}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#\ \ define\ OPENSSL\_EXTERN\ OPENSSL\_EXPORT}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#\ define\ ITERATIONS\ 16}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#\ define\ HALF\_ITERATIONS\ 8}}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#\ define\ c2l(c,l)\ \ \ \ \ \ \ \ (l\ =((DES\_LONG)(*((c)++)))\ \ \ \ ,\ \(\backslash\)}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ l|=((DES\_LONG)(*((c)++)))<<\ 8L,\ \(\backslash\)}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ l|=((DES\_LONG)(*((c)++)))<<16L,\ \(\backslash\)}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ l|=((DES\_LONG)(*((c)++)))<<24L)}}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \textcolor{comment}{/*\ NOTE\ -\/\ c\ is\ not\ incremented\ as\ per\ c2l\ */}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#\ define\ c2ln(c,l1,l2,n)\ \{\ \(\backslash\)}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c+=n;\ \(\backslash\)}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ l1=l2=0;\ \(\backslash\)}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ switch\ (n)\ \{\ \(\backslash\)}}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case\ 8:\ l2\ =((DES\_LONG)(*(-\/-\/(c))))<<24L;\ \(\backslash\)}}
\DoxyCodeLine{00040\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{/*\ fall\ through\ */}\textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case\ 7:\ l2|=((DES\_LONG)(*(-\/-\/(c))))<<16L;\ \(\backslash\)}}
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{/*\ fall\ through\ */}\textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case\ 6:\ l2|=((DES\_LONG)(*(-\/-\/(c))))<<\ 8L;\ \(\backslash\)}}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{/*\ fall\ through\ */}\textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case\ 5:\ l2|=((DES\_LONG)(*(-\/-\/(c))));\ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00046\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{/*\ fall\ through\ */}\textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00047\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case\ 4:\ l1\ =((DES\_LONG)(*(-\/-\/(c))))<<24L;\ \(\backslash\)}}
\DoxyCodeLine{00048\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{/*\ fall\ through\ */}\textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00049\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case\ 3:\ l1|=((DES\_LONG)(*(-\/-\/(c))))<<16L;\ \(\backslash\)}}
\DoxyCodeLine{00050\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{/*\ fall\ through\ */}\textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00051\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case\ 2:\ l1|=((DES\_LONG)(*(-\/-\/(c))))<<\ 8L;\ \(\backslash\)}}
\DoxyCodeLine{00052\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{/*\ fall\ through\ */}\textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00053\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case\ 1:\ l1|=((DES\_LONG)(*(-\/-\/(c))));\ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00054\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \(\backslash\)}}
\DoxyCodeLine{00055\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \textcolor{preprocessor}{\#\ define\ l2c(l,c)\ \ \ \ \ \ \ \ (*((c)++)=(unsigned\ char)(((l)\ \ \ \ \ )\&0xff),\ \(\backslash\)}}
\DoxyCodeLine{00058\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *((c)++)=(unsigned\ char)(((l)>>\ 8L)\&0xff),\ \(\backslash\)}}
\DoxyCodeLine{00059\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *((c)++)=(unsigned\ char)(((l)>>16L)\&0xff),\ \(\backslash\)}}
\DoxyCodeLine{00060\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *((c)++)=(unsigned\ char)(((l)>>24L)\&0xff))}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \textcolor{comment}{/*\ NOTE\ -\/\ c\ is\ not\ incremented\ as\ per\ l2c\ */}}
\DoxyCodeLine{00063\ \textcolor{preprocessor}{\#\ define\ l2cn(l1,l2,c,n)\ \{\ \(\backslash\)}}
\DoxyCodeLine{00064\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c+=n;\ \(\backslash\)}}
\DoxyCodeLine{00065\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ switch\ (n)\ \{\ \(\backslash\)}}
\DoxyCodeLine{00066\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case\ 8:\ *(-\/-\/(c))=(unsigned\ char)(((l2)>>24L)\&0xff);\ \(\backslash\)}}
\DoxyCodeLine{00067\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{/*\ fall\ through\ */}\textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00068\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case\ 7:\ *(-\/-\/(c))=(unsigned\ char)(((l2)>>16L)\&0xff);\ \(\backslash\)}}
\DoxyCodeLine{00069\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{/*\ fall\ through\ */}\textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00070\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case\ 6:\ *(-\/-\/(c))=(unsigned\ char)(((l2)>>\ 8L)\&0xff);\ \(\backslash\)}}
\DoxyCodeLine{00071\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{/*\ fall\ through\ */}\textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00072\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case\ 5:\ *(-\/-\/(c))=(unsigned\ char)(((l2)\ \ \ \ \ )\&0xff);\ \(\backslash\)}}
\DoxyCodeLine{00073\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{/*\ fall\ through\ */}\textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00074\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case\ 4:\ *(-\/-\/(c))=(unsigned\ char)(((l1)>>24L)\&0xff);\ \(\backslash\)}}
\DoxyCodeLine{00075\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{/*\ fall\ through\ */}\textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00076\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case\ 3:\ *(-\/-\/(c))=(unsigned\ char)(((l1)>>16L)\&0xff);\ \(\backslash\)}}
\DoxyCodeLine{00077\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{/*\ fall\ through\ */}\textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00078\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case\ 2:\ *(-\/-\/(c))=(unsigned\ char)(((l1)>>\ 8L)\&0xff);\ \(\backslash\)}}
\DoxyCodeLine{00079\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{/*\ fall\ through\ */}\textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00080\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case\ 1:\ *(-\/-\/(c))=(unsigned\ char)(((l1)\ \ \ \ \ )\&0xff);\ \(\backslash\)}}
\DoxyCodeLine{00081\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \(\backslash\)}}
\DoxyCodeLine{00082\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \textcolor{preprocessor}{\#\ if\ defined(\_MSC\_VER)}}
\DoxyCodeLine{00085\ \textcolor{preprocessor}{\#\ \ define\ ROTATE(a,n)\ \ \ \ \ (\_lrotr(a,n))}}
\DoxyCodeLine{00086\ \textcolor{preprocessor}{\#\ elif\ defined(\_\_ICC)}}
\DoxyCodeLine{00087\ \textcolor{preprocessor}{\#\ \ define\ ROTATE(a,n)\ \ \ \ \ (\_rotr(a,n))}}
\DoxyCodeLine{00088\ \textcolor{preprocessor}{\#\ elif\ defined(\_\_GNUC\_\_)\ \&\&\ \_\_GNUC\_\_>=2\ \&\&\ !defined(\_\_STRICT\_ANSI\_\_)\ \&\&\ !defined(OPENSSL\_NO\_ASM)\ \&\&\ !defined(OPENSSL\_NO\_INLINE\_ASM)\ \&\&\ !defined(PEDANTIC)}}
\DoxyCodeLine{00089\ \textcolor{preprocessor}{\#\ \ if\ defined(\_\_i386)\ ||\ defined(\_\_i386\_\_)\ ||\ defined(\_\_x86\_64)\ ||\ defined(\_\_x86\_64\_\_)}}
\DoxyCodeLine{00090\ \textcolor{preprocessor}{\#\ \ \ define\ ROTATE(a,n)\ \ \ (\{\ register\ unsigned\ int\ ret;\ \ \ \(\backslash\)}}
\DoxyCodeLine{00091\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ asm\ ("{}rorl\ \%1,\%0"{}\ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00092\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ "{}=r"{}(ret)\ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00093\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ "{}I"{}(n),"{}0"{}(a)\ \(\backslash\)}}
\DoxyCodeLine{00094\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ "{}cc"{});\ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00095\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ret;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00096\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \})}}
\DoxyCodeLine{00097\ \textcolor{preprocessor}{\#\ \ elif\ defined(\_\_riscv\_zbb)\ ||\ defined(\_\_riscv\_zbkb)}}
\DoxyCodeLine{00098\ \textcolor{preprocessor}{\#\ \ \ if\ \_\_riscv\_xlen\ ==\ 64}}
\DoxyCodeLine{00099\ \textcolor{preprocessor}{\#\ \ \ \ define\ ROTATE(x,\ n)\ (\{\ register\ unsigned\ int\ ret;\ \(\backslash\)}}
\DoxyCodeLine{00100\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ asm\ ("{}roriw\ \%0,\ \%1,\ \%2"{}\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00101\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ "{}=r"{}(ret)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00102\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ "{}r"{}(x),\ "{}i"{}(n));\ ret;\ \})}}
\DoxyCodeLine{00103\ \textcolor{preprocessor}{\#\ \ \ endif}}
\DoxyCodeLine{00104\ \textcolor{preprocessor}{\#\ \ \ if\ \_\_riscv\_xlen\ ==\ 32}}
\DoxyCodeLine{00105\ \textcolor{preprocessor}{\#\ \ \ \ define\ ROTATE(x,\ n)\ (\{\ register\ unsigned\ int\ ret;\ \(\backslash\)}}
\DoxyCodeLine{00106\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ asm\ ("{}rori\ \%0,\ \%1,\ \%2"{}\ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00107\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ "{}=r"{}(ret)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00108\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ "{}r"{}(x),\ "{}i"{}(n));\ ret;\ \})}}
\DoxyCodeLine{00109\ \textcolor{preprocessor}{\#\ \ \ endif}}
\DoxyCodeLine{00110\ \textcolor{preprocessor}{\#\ \ endif}}
\DoxyCodeLine{00111\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{00112\ \textcolor{preprocessor}{\#\ ifndef\ ROTATE}}
\DoxyCodeLine{00113\ \textcolor{preprocessor}{\#\ \ define\ ROTATE(a,n)\ \ \ \ \ (((a)>>(n))+((a)<<(32-\/(n))))}}
\DoxyCodeLine{00114\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \textcolor{comment}{/*}}
\DoxyCodeLine{00117\ \textcolor{comment}{\ *\ Don't\ worry\ about\ the\ LOAD\_DATA()\ stuff,\ that\ is\ used\ by\ fcrypt()\ to\ add}}
\DoxyCodeLine{00118\ \textcolor{comment}{\ *\ it's\ little\ bit\ to\ the\ front}}
\DoxyCodeLine{00119\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \textcolor{preprocessor}{\#\ ifdef\ DES\_FCRYPT}}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \textcolor{preprocessor}{\#\ \ define\ LOAD\_DATA\_tmp(R,S,u,t,E0,E1)\ \(\backslash\)}}
\DoxyCodeLine{00124\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \{\ DES\_LONG\ tmp;\ LOAD\_DATA(R,S,u,t,E0,E1,tmp);\ \}}}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \textcolor{preprocessor}{\#\ \ define\ LOAD\_DATA(R,S,u,t,E0,E1,tmp)\ \(\backslash\)}}
\DoxyCodeLine{00127\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ t=R\string^(R>>16L);\ \(\backslash\)}}
\DoxyCodeLine{00128\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ u=t\&E0;\ t\&=E1;\ \(\backslash\)}}
\DoxyCodeLine{00129\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ tmp=(u<<16);\ u\string^=R\string^s[S\ \ ];\ u\string^=tmp;\ \(\backslash\)}}
\DoxyCodeLine{00130\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ tmp=(t<<16);\ t\string^=R\string^s[S+1];\ t\string^=tmp}}
\DoxyCodeLine{00131\ \textcolor{preprocessor}{\#\ else}}
\DoxyCodeLine{00132\ \textcolor{preprocessor}{\#\ \ define\ LOAD\_DATA\_tmp(a,b,c,d,e,f)\ LOAD\_DATA(a,b,c,d,e,f,g)}}
\DoxyCodeLine{00133\ \textcolor{preprocessor}{\#\ \ define\ LOAD\_DATA(R,S,u,t,E0,E1,tmp)\ \(\backslash\)}}
\DoxyCodeLine{00134\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ u=R\string^s[S\ \ ];\ \(\backslash\)}}
\DoxyCodeLine{00135\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ t=R\string^s[S+1]}}
\DoxyCodeLine{00136\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \textcolor{comment}{/*}}
\DoxyCodeLine{00139\ \textcolor{comment}{\ *\ It\ recently\ occurred\ to\ me\ that\ 0\string^0\string^0\string^0\string^0\string^0\string^0\ ==\ 0,\ so\ there\ is\ no\ reason}}
\DoxyCodeLine{00140\ \textcolor{comment}{\ *\ to\ not\ xor\ all\ the\ sub\ items\ together.\ \ This\ potentially\ saves\ a\ register}}
\DoxyCodeLine{00141\ \textcolor{comment}{\ *\ since\ things\ can\ be\ xored\ directly\ into\ L}}
\DoxyCodeLine{00142\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \textcolor{preprocessor}{\#\ define\ D\_ENCRYPT(LL,R,S)\ \{\ \(\backslash\)}}
\DoxyCodeLine{00145\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ LOAD\_DATA\_tmp(R,S,u,t,E0,E1);\ \(\backslash\)}}
\DoxyCodeLine{00146\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ t=ROTATE(t,4);\ \(\backslash\)}}
\DoxyCodeLine{00147\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ LL\string^=\ \(\backslash\)}}
\DoxyCodeLine{00148\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ DES\_SPtrans[0][(u>>\ 2L)\&0x3f]\string^\ \(\backslash\)}}
\DoxyCodeLine{00149\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ DES\_SPtrans[2][(u>>10L)\&0x3f]\string^\ \(\backslash\)}}
\DoxyCodeLine{00150\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ DES\_SPtrans[4][(u>>18L)\&0x3f]\string^\ \(\backslash\)}}
\DoxyCodeLine{00151\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ DES\_SPtrans[6][(u>>26L)\&0x3f]\string^\ \(\backslash\)}}
\DoxyCodeLine{00152\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ DES\_SPtrans[1][(t>>\ 2L)\&0x3f]\string^\ \(\backslash\)}}
\DoxyCodeLine{00153\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ DES\_SPtrans[3][(t>>10L)\&0x3f]\string^\ \(\backslash\)}}
\DoxyCodeLine{00154\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ DES\_SPtrans[5][(t>>18L)\&0x3f]\string^\ \(\backslash\)}}
\DoxyCodeLine{00155\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ DES\_SPtrans[7][(t>>26L)\&0x3f];\ \}}}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*-\/}}
\DoxyCodeLine{00158\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ IP\ and\ FP}}
\DoxyCodeLine{00159\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ The\ problem\ is\ more\ of\ a\ geometric\ problem\ that\ random\ bit\ fiddling.}}
\DoxyCodeLine{00160\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ 0\ \ 1\ \ 2\ \ 3\ \ 4\ \ 5\ \ 6\ \ 7\ \ \ \ \ \ 62\ 54\ 46\ 38\ 30\ 22\ 14\ \ 6}}
\DoxyCodeLine{00161\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ 8\ \ 9\ 10\ 11\ 12\ 13\ 14\ 15\ \ \ \ \ \ 60\ 52\ 44\ 36\ 28\ 20\ 12\ \ 4}}
\DoxyCodeLine{00162\ \textcolor{comment}{\ \ \ \ \ \ \ \ 16\ 17\ 18\ 19\ 20\ 21\ 22\ 23\ \ \ \ \ \ 58\ 50\ 42\ 34\ 26\ 18\ 10\ \ 2}}
\DoxyCodeLine{00163\ \textcolor{comment}{\ \ \ \ \ \ \ \ 24\ 25\ 26\ 27\ 28\ 29\ 30\ 31\ \ to\ \ 56\ 48\ 40\ 32\ 24\ 16\ \ 8\ \ 0}}
\DoxyCodeLine{00164\ \textcolor{comment}{}}
\DoxyCodeLine{00165\ \textcolor{comment}{\ \ \ \ \ \ \ \ 32\ 33\ 34\ 35\ 36\ 37\ 38\ 39\ \ \ \ \ \ 63\ 55\ 47\ 39\ 31\ 23\ 15\ \ 7}}
\DoxyCodeLine{00166\ \textcolor{comment}{\ \ \ \ \ \ \ \ 40\ 41\ 42\ 43\ 44\ 45\ 46\ 47\ \ \ \ \ \ 61\ 53\ 45\ 37\ 29\ 21\ 13\ \ 5}}
\DoxyCodeLine{00167\ \textcolor{comment}{\ \ \ \ \ \ \ \ 48\ 49\ 50\ 51\ 52\ 53\ 54\ 55\ \ \ \ \ \ 59\ 51\ 43\ 35\ 27\ 19\ 11\ \ 3}}
\DoxyCodeLine{00168\ \textcolor{comment}{\ \ \ \ \ \ \ \ 56\ 57\ 58\ 59\ 60\ 61\ 62\ 63\ \ \ \ \ \ 57\ 49\ 41\ 33\ 25\ 17\ \ 9\ \ 1}}
\DoxyCodeLine{00169\ \textcolor{comment}{}}
\DoxyCodeLine{00170\ \textcolor{comment}{\ \ \ \ \ \ \ \ The\ output\ has\ been\ subject\ to\ swaps\ of\ the\ form}}
\DoxyCodeLine{00171\ \textcolor{comment}{\ \ \ \ \ \ \ \ 0\ 1\ -\/>\ 3\ 1\ but\ the\ odd\ and\ even\ bits\ have\ been\ put\ into}}
\DoxyCodeLine{00172\ \textcolor{comment}{\ \ \ \ \ \ \ \ 2\ 3\ \ \ \ 2\ 0}}
\DoxyCodeLine{00173\ \textcolor{comment}{\ \ \ \ \ \ \ \ different\ words.\ \ The\ main\ trick\ is\ to\ remember\ that}}
\DoxyCodeLine{00174\ \textcolor{comment}{\ \ \ \ \ \ \ \ t=((l>>size)\string^r)\&(mask);}}
\DoxyCodeLine{00175\ \textcolor{comment}{\ \ \ \ \ \ \ \ r\string^=t;}}
\DoxyCodeLine{00176\ \textcolor{comment}{\ \ \ \ \ \ \ \ l\string^=(t<<size);}}
\DoxyCodeLine{00177\ \textcolor{comment}{\ \ \ \ \ \ \ \ can\ be\ used\ to\ swap\ and\ move\ bits\ between\ words.}}
\DoxyCodeLine{00178\ \textcolor{comment}{}}
\DoxyCodeLine{00179\ \textcolor{comment}{\ \ \ \ \ \ \ \ So\ l\ =\ \ 0\ \ 1\ \ 2\ \ 3\ \ r\ =\ 16\ 17\ 18\ 19}}
\DoxyCodeLine{00180\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 4\ \ 5\ \ 6\ \ 7\ \ \ \ \ \ 20\ 21\ 22\ 23}}
\DoxyCodeLine{00181\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 8\ \ 9\ 10\ 11\ \ \ \ \ \ 24\ 25\ 26\ 27}}
\DoxyCodeLine{00182\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 12\ 13\ 14\ 15\ \ \ \ \ \ 28\ 29\ 30\ 31}}
\DoxyCodeLine{00183\ \textcolor{comment}{\ \ \ \ \ \ \ \ becomes\ (for\ size\ ==\ 2\ and\ mask\ ==\ 0x3333)}}
\DoxyCodeLine{00184\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ t\ =\ \ \ 2\string^16\ \ 3\string^17\ -\/-\/\ -\/-\/\ \ \ l\ =\ \ 0\ \ 1\ 16\ 17\ \ r\ =\ \ 2\ \ 3\ 18\ 19}}
\DoxyCodeLine{00185\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 6\string^20\ \ 7\string^21\ -\/-\/\ -\/-\/\ \ \ \ \ \ \ \ 4\ \ 5\ 20\ 21\ \ \ \ \ \ \ 6\ \ 7\ 22\ 23}}
\DoxyCodeLine{00186\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 10\string^24\ 11\string^25\ -\/-\/\ -\/-\/\ \ \ \ \ \ \ \ 8\ \ 9\ 24\ 25\ \ \ \ \ \ 10\ 11\ 24\ 25}}
\DoxyCodeLine{00187\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 14\string^28\ 15\string^29\ -\/-\/\ -\/-\/\ \ \ \ \ \ \ 12\ 13\ 28\ 29\ \ \ \ \ \ 14\ 15\ 28\ 29}}
\DoxyCodeLine{00188\ \textcolor{comment}{}}
\DoxyCodeLine{00189\ \textcolor{comment}{\ \ \ \ \ \ \ \ Thanks\ for\ hints\ from\ Richard\ Outerbridge\ -\/\ he\ told\ me\ IP\&FP}}
\DoxyCodeLine{00190\ \textcolor{comment}{\ \ \ \ \ \ \ \ could\ be\ done\ in\ 15\ xor,\ 10\ shifts\ and\ 5\ ands.}}
\DoxyCodeLine{00191\ \textcolor{comment}{\ \ \ \ \ \ \ \ When\ I\ finally\ started\ to\ think\ of\ the\ problem\ in\ 2D}}
\DoxyCodeLine{00192\ \textcolor{comment}{\ \ \ \ \ \ \ \ I\ first\ got\ \string~42\ operations\ without\ xors.\ \ When\ I\ remembered}}
\DoxyCodeLine{00193\ \textcolor{comment}{\ \ \ \ \ \ \ \ how\ to\ use\ xors\ :-\/)\ I\ got\ it\ to\ its\ final\ state.}}
\DoxyCodeLine{00194\ \textcolor{comment}{\ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00195\ \textcolor{preprocessor}{\#\ define\ PERM\_OP(a,b,t,n,m)\ ((t)=((((a)>>(n))\string^(b))\&(m)),\(\backslash\)}}
\DoxyCodeLine{00196\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ (b)\string^=(t),\(\backslash\)}}
\DoxyCodeLine{00197\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ (a)\string^=((t)<<(n)))}}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00199\ \textcolor{preprocessor}{\#\ define\ IP(l,r)\ \(\backslash\)}}
\DoxyCodeLine{00200\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \{\ \(\backslash\)}}
\DoxyCodeLine{00201\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ register\ DES\_LONG\ tt;\ \(\backslash\)}}
\DoxyCodeLine{00202\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ PERM\_OP(r,l,tt,\ 4,0x0f0f0f0fL);\ \(\backslash\)}}
\DoxyCodeLine{00203\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ PERM\_OP(l,r,tt,16,0x0000ffffL);\ \(\backslash\)}}
\DoxyCodeLine{00204\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ PERM\_OP(r,l,tt,\ 2,0x33333333L);\ \(\backslash\)}}
\DoxyCodeLine{00205\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ PERM\_OP(l,r,tt,\ 8,0x00ff00ffL);\ \(\backslash\)}}
\DoxyCodeLine{00206\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ PERM\_OP(r,l,tt,\ 1,0x55555555L);\ \(\backslash\)}}
\DoxyCodeLine{00207\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00209\ \textcolor{preprocessor}{\#\ define\ FP(l,r)\ \(\backslash\)}}
\DoxyCodeLine{00210\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \{\ \(\backslash\)}}
\DoxyCodeLine{00211\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ register\ DES\_LONG\ tt;\ \(\backslash\)}}
\DoxyCodeLine{00212\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ PERM\_OP(l,r,tt,\ 1,0x55555555L);\ \(\backslash\)}}
\DoxyCodeLine{00213\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ PERM\_OP(r,l,tt,\ 8,0x00ff00ffL);\ \(\backslash\)}}
\DoxyCodeLine{00214\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ PERM\_OP(l,r,tt,\ 2,0x33333333L);\ \(\backslash\)}}
\DoxyCodeLine{00215\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ PERM\_OP(r,l,tt,16,0x0000ffffL);\ \(\backslash\)}}
\DoxyCodeLine{00216\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ PERM\_OP(l,r,tt,\ 4,0x0f0f0f0fL);\ \(\backslash\)}}
\DoxyCodeLine{00217\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00218\ }
\DoxyCodeLine{00219\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ DES\_LONG\ DES\_SPtrans[8][64];}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \textcolor{keywordtype}{void}\ fcrypt\_body(DES\_LONG\ *out,\ DES\_key\_schedule\ *ks,}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ DES\_LONG\ Eswap0,\ DES\_LONG\ Eswap1);}
\DoxyCodeLine{00223\ }
\DoxyCodeLine{00224\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
